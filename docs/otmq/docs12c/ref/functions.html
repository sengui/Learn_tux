<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="" />
<meta name="LOC_US_CHANGE" content="" />
<meta name="LOC_US_SRCFILE" content="" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="06/27/12 02:35:24" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Oracle Tuxedo Message Queue <br />Function Reference</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Reference Guide
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq26" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="comands.html"><img id="LongDescNotReq27" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq28" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq29" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/ref.pdf" target="pdf"><img id="LongDescNotReq30" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq31" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1074157"> </a>
Oracle Tuxedo Message Queue <br />Function Reference
</h1>
<p class="pGraphic"><a name="wp1075180"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1075242table1075237"><caption><a name="wp1075242"> </a>
Table 1-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Oracle Tuxedo Message Queue Functions</span>&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1075246"> </a>
Name
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1075248"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075252"> </a>
<a href="functions.html#wp1111177"><code class="cCode">tpdequeue()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075255"> </a>
Routine to dequeue a message from a queue.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075260"> </a>
<a href="functions.html#wp1112161"><code class="cCode">tpenqueue()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075262"> </a>
Routine to enqueue a message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075267"> </a>
<a href="functions.html#wp1076259"><code class="cCode">tpqattach()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1077580"> </a>
Connects an application program to the OTMQ message queuing space by attaching it to a message queue. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075274"> </a>
<a href="functions.html#wp1075796"><code class="cCode">tpqdetach()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075276"> </a>
Detaches a selected message queue or all of the application&#39;s message queues from the message queuing qspace. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075281"> </a>
<a href="functions.html#wp1075764"><code class="cCode">tpqbind()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075283"> </a>
Dynamically associates a queue name to a queue reference at run-time.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075288"> </a>
<a href="functions.html#wp1075871"><code class="cCode">tpqlocate()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075290"> </a>
Locates the queue name for the specified queue name or queue alias.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075295"> </a>
<a href="functions.html#wp1075897"><code class="cCode">tpenqplus()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075297"> </a>
Sends a message to a target queue in target qspace using a set of standard OTMQ delivery modes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075302"> </a>
<a href="functions.html#wp1075920"><code class="cCode">tpdeqplus()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075304"> </a>
Retrieves the next available message from a selected queue and moves it to the location specified in the data argument. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075309"> </a>
<a href="functions.html#wp1075943"><code class="cCode">tpqpublish()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075311"> </a>
Used to publish a topic data.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075315"> </a>
<a href="functions.html#wp1075976"><code class="cCode">tpqsubscribe()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075318"> </a>
Used to subscribe to a topic.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075323"> </a>
<a href="functions.html#wp1075999"><code class="cCode">tpqunsubscribe()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1101195"> </a>
Used to remove a subscription.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075330"> </a>
<a href="functions.html#wp1079387"><code class="cCode">tpqconfirmmsg()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075332"> </a>
Confirms receipt of a message that requires explicit confirmation.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075337"> </a>
<a href="functions.html#wp1076053"><code class="cCode">tpqsetselect()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075339"> </a>
Allows application developers to define complex selection criteria for message reception.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075344"> </a>
<a href="functions.html#wp1076082"><code class="cCode">tpqcancelselect()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075346"> </a>
Releases the selection array and index handle associated with a previously generated selection mask. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075351"> </a>
<a href="functions.html#wp1076105"><code class="cCode">tpqreadjrn()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075353"> </a>
Reads a message from an OTMQ local group journal. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075358"> </a>
<a href="functions.html#wp1076128"><code class="cCode">tpqshowpending()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075360"> </a>
Requests the number of pending messages for a list of selected queues.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075365"> </a>
<a href="functions.html#wp1076163"><code class="cCode">tpqgetmsga()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075367"> </a>
Requests asynchronous notification of a message arrival. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075372"> </a>
<a href="functions.html#wp1076186"><code class="cCode">tpqcancelget()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075374"> </a>
Cancels all pending <code class="cCode">tpqgetmsga</code> requests that match the value specified in the <code class="cCode">sel_filter</code> argument.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113825"> </a>
<a href="functions.html#wp1113516">tpqerrno()</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113827"> </a>
Gets the <code class="cCode">errno</code> of OTMQ system call. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075379"> </a>
<a href="functions.html#wp1076209"><code class="cCode">tpqexit()</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075381"> </a>
Terminates all attachments between the application and the OTMQ queue service.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113562"> </a>
<a href="functions.html#wp1113653">tpqstrerror()</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113564"> </a>
Gets Oracle Tuxedo Message Queue error message string details.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1111177"> </a>
tpdequeue()
</h3>
<h4 class="pHeading3"><a name="wp1111178"> </a>
Name
</h4>
<p class="pBody"><a name="wp1111179"> </a>
<code class="cCode">tpdequeue()</code>&#8212;Routine to dequeue a message from a queue.
</p>
<h4 class="pHeading3"><a name="wp1111180"> </a>
Synopsis
</h4>
<a name="wp1129024"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpdequeue(char *qspace, char *qname, TPQCTL *ctl, char **data, long *len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1111182"> </a>
Description
</h4>
<p class="pBody"><a name="wp1111183"> </a>
<code class="cCode">tpdequeue()</code> takes a message for processing from the queue named by <code class="cCodeEmphasis">qname</code> in the <code class="cCodeEmphasis">qspace</code> queue space.
</p>
<p class="pBody"><a name="wp1111184"> </a>
By default, the message at the top of the queue is dequeued. The order of messages on the queue is defined when the queue is created. The application can request a particular message for dequeuing by specifying its message identifier or correlation identifier using the <code class="cCodeEmphasis">ctl</code> parameter. <code class="cCodeEmphasis">ctl</code> flags can also be used to indicate that the application wants to wait for a message, in the case when a message is not currently available. It is possible to use the <code class="cCodeEmphasis">ctl</code> parameter to look at a message without removing it from the queue or changing its relative position on the queue. See the section below describing this parameter.
</p>
<p class="pBody"><a name="wp1111185"> </a>
<code class="cCodeEmphasis">data</code> is the address of a pointer to the buffer into which a message is read, and <code class="cCodeEmphasis">len</code> points to the length of that message. *<code class="cCodeEmphasis">data</code> must point to a buffer originally allocated by <code class="cCode">tpalloc()</code>. If a message is larger than the buffer passed to <code class="cCode">tpdequeue</code>, the buffer is increased in size to accommodate the message. To determine whether a message buffer changed in size, compare its (total) size before <code class="cCode">tpdequeue()</code> was issued with *<code class="cCodeEmphasis">len</code>. If *<code class="cCodeEmphasis">len</code> is larger, then the buffer has grown; otherwise, the buffer has not changed size. Note that *<code class="cCodeEmphasis">data</code> may change for reasons other than the buffer&#8217;s size increased. If *<code class="cCodeEmphasis">len</code> is 0 upon return, then the message dequeued has no data portion and neither *<code class="cCodeEmphasis">data</code> nor the buffer it points to were modified. It is an error for *<code class="cCodeEmphasis">data</code> or <code class="cCodeEmphasis">len</code> to be NULL.
</p>
<p class="pBody"><a name="wp1111186"> </a>
The message is dequeued in transaction mode if the caller is in transaction mode and the <code class="cCode">TPNOTRAN</code> flag is not set. This has the effect that if <code class="cCode">tpdequeue()</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is removed from the queue. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be left on the queue (that is, the removal of the message from the queue is also rolled back). It is not possible to enqueue and dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp1111187"> </a>
The message is not dequeued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully dequeued and the message may be lost.
</p>
<p class="pBody"><a name="wp1111188"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1111189"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1111190"> </a>
If the caller is in transaction mode and this flag is set, the message is not dequeued within the caller&#8217;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when dequeuing the message. If message dequeuing fails, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1111191"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1111192"> </a>
The message is not dequeued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on a Oracle product other than the Oracle Tuxedo ATMI system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<div class="pDefParaCont"><a name="wp1111193"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). This blocking condition does not include blocking on the queue itself if the <code class="cCode">TPQWAIT</code> option in <code class="cCodeEmphasis">flags</code> (of the <code class="cCode">TPQCTL</code> structure) is specified.
</div>
<h4 class="pDefTerm"><a name="wp1111194"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1111195"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1111196"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1111197"> </a>
When this flag is set, the type of the buffer pointed to by *<code class="cCodeEmphasis">data</code> is not allowed to change. By default, if a buffer is received that differs in type from the buffer pointed to by *<code class="cCodeEmphasis">data</code>, then *<code class="cCodeEmphasis">data</code>&#8217;s buffer type changes to the received buffer&#8217;s type so long as the receiver recognizes the incoming buffer type. That is, the type and subtype of the dequeued message must match the type and subtype of the buffer pointed to by *<code class="cCodeEmphasis">data</code>.
</div>
<h4 class="pDefTerm"><a name="wp1111198"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1111199"> </a>
Setting this flag indicates that any underlying system calls that are interrupted by a signal should be reissued. When this flag is not set and a signal interrupts a system call, the call fails and sets <code class="cCode">tperrno</code> to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1111200"> </a>
If <code class="cCode">tpdequeue()</code> returns successfully, the application can retrieve additional information about the message using the <code class="cCodeEmphasis">ctl</code> data structure. The information may include the message identifier for the dequeued message; a correlation identifier that should accompany any reply or failure message so that the originator can correlate the message with the original request; the quality of service the message was delivered with, the quality of service any replies to the message should be delivered with; the name of a reply queue if a reply is desired; and the name of the failure queue on which the application can queue information regarding failure to dequeue the message. These are described below.
</p>
<p class="pBody"><a name="wp1111201"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpdequeue()</code>.
</p>
<h4 class="pHeading3"><a name="wp1111202"> </a>
Control Parameter
</h4>
<p class="pBody"><a name="wp1111203"> </a>
The <code class="cCode">TPQCTL</code> structure is used by the application program to pass and retrieve parameters associated with dequeuing the message. The <code class="cCodeEmphasis">flags</code> element of <code class="cCode">TPQCTL</code> is used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp1111204"> </a>
On input to <code class="cCode">tpdequeue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1111205"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values<br />                        * are set */<br />char msgid[32];        /* ID of message to dequeue */<br />char corrid[32];       /* correlation identifier of<br />                        * message to dequeue */</pre></div><p class="pBody"><a name="wp1111206"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpdequeue()</code>:
</p>
<h4 class="pDefTerm"><a name="wp1111207"> </a>
<code class="cCode">TPNOFLAGS</code>
</h4><div class="pDefPara"><a name="wp1111208"> </a>
No flags are set. No information is taken from the control structure.
</div>
<h4 class="pDefTerm"><a name="wp1111209"> </a>
<code class="cCode">TPQGETBYMSGID</code>
</h4><div class="pDefPara"><a name="wp1111210"> </a>
Setting this flag requests that the message with the message identifier specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq1" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> be dequeued. The message identifier may be acquired by a prior call to <a href="functions.html#wp1112161"><code class="cCode">tpenqueue()</code></a>. Note that a message identifier changes if the message has moved from one queue to another. Note also that the entire 32 bytes of the message identifier value are significant, so the value specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq2" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1111214"> </a>
<code class="cCode">TPQGETBYCORRID</code>
</h4><div class="pDefPara"><a name="wp1111215"> </a>
Setting this flag requests that the message with the correlation identifier specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq3" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> be dequeued. The correlation identifier is specified by the application when enqueuing the message with <code class="cCode">tpenqueue()</code>. Note that the entire 32 bytes of the correlation identifier value are significant, so the value specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq4" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1111216"> </a>
<code class="cCode">TPQWAIT</code> 
</h4><div class="pDefPara"><a name="wp1111217"> </a>
Setting this flag indicates that an error should not be returned if the queue is empty. Instead, the process should wait until a message is available. If <code class="cCode">TPQWAIT</code> is set in conjunction with <code class="cCode">TPQGETBYMSGID</code> or <code class="cCode">TPQGETBYCORRID</code>, it indicates that an error should not be returned if no message with the specified message identifier or correlation identifier is present in the queue. Instead, the process should wait until a message meeting the criteria is available. The process is still subject to the caller&#8217;s transaction timeout, or, when not in transaction mode, the process is subject to the timeout specified on the <code class="cCode">TMQUEUE</code> process by the <code class="cCode">-t</code> option.
</div>
<div class="pDefParaCont"><a name="wp1111218"> </a>
If a message matching the desired criteria is not immediately available and the configured action resources are exhausted, <code class="cCode">tpdequeue()</code>returns -1, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESYSTEM</code>.
<a name="wp1111219"> </a>
Note that each <code class="cCode">tpdequeue()</code> request specifying the <code class="cCode">TPQWAIT</code> control parameter requires that a queue manager (<code class="cCode">TMQUEUE</code>) action object be available if a message satisfying the condition is not immediately available. If an action object is not available, the <code class="cCode">tpdequeue()</code> request fails. The number of available queue manager actions are specified when a queue space is created or modified. When a waiting dequeue request completes, the associated action object associated is made available for another request.
</div>
<h4 class="pDefTerm"><a name="wp1111220"> </a>
<code class="cCode">TPQPEEK</code>
</h4><div class="pDefPara"><a name="wp1111221"> </a>
If this flag is set, the specified message is read but is not removed from the queue. This flag implies the <code class="cCode">TPNOTRAN</code> flag has been set for the <code class="cCode">tpdequeue</code>() operation. That is, non-destructive dequeuing is non-transactional. Note that it is not possible to read messages enqueued or dequeued within a transaction before the transaction completes.
</div>
<div class="pDefParaCont"><a name="wp1111222"> </a>
When a thread is non-destructively dequeuing a message using <code class="cCode">TPQPEEK</code>, the message may not be seen by other non-blocking dequeuers for the brief time the system is processing the non-destructive dequeue request. This includes dequeuers using specific selection criteria (such as message identifier and correlation identifier) that are looking for the message currently being non-destructively dequeued.
</div>
<p class="pBody"><a name="wp1111223"> </a>
On output from <code class="cCode">tpdequeue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure: 
</p>
<a name="wp1111224"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values <br />                        * should be set */<br /> <br />long priority;         /* enqueue priority */ <br />char msgid[32];        /* ID of message dequeued */ <br />char corrid[32];       /* correlation identifier used to<br />                        * identify the message */<br />long delivery_qos;     /* delivery quality of service */<br />long reply_qos;        /* reply message quality of service */<br />char replyqueue[16];   /* queue name for reply */ <br />char failurequeue[16]; /* queue name for failure */ <br />long diagnostic;       /* reason for failure */ <br />long appkey;           /* application authentication client <br />                        * key */ <br />long urcode;           /* user-return code */ <br />CLIENTID cltid;        /* client identifier for originating <br />                        * client */</pre></div><p class="pBody"><a name="wp1111225"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling output information from <code class="cCode">tpdequeue()</code>. For any of these bits, if the flag bit is turned on when <code class="cCode">tpdequeue()</code> is called, the associated element in the structure is populated with the value provided when the message was queued, and the bit remains set. If a value is not available or the bit is not set when <code class="cCode">tpdequeue()</code> is called, <code class="cCode">tpdequeue()</code> completes with the flag turned off.
</p>
<h4 class="pDefTerm"><a name="wp1111226"> </a>
<code class="cCode">TPQPRIORITY</code> 
</h4><div class="pDefPara"><a name="wp1111227"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with an explicit priority, then the priority is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq5" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">priority</code>. The priority is in the range 1 to 100, inclusive, and the higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). For queues not ordered by priority, the value is informational.
</div>
<div class="pDefParaCont"><a name="wp1111228"> </a>
If no priority was explicitly specified when the message was queued and the call to <code class="cCode">tpdequeue()</code> is successful, the priority for the message is 50.
</div>
<h4 class="pDefTerm"><a name="wp1111229"> </a>
<code class="cCode">TPQMSGID</code> 
</h4><div class="pDefPara"><a name="wp1111230"> </a>
If this flag is set and the call to <code class="cCode">tpdequeue()</code> is successful, the message identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq6" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. The entire 32 bytes of the message identifier value are significant.
</div>
<h4 class="pDefTerm"><a name="wp1111231"> </a>
<code class="cCode">TPQCORRID</code> 
</h4><div class="pDefPara"><a name="wp1111232"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a correlation identifier, then the correlation identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq7" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code>. The entire 32 bytes of the correlation identifier value are significant. Any Oracle Tuxedo ATMI /Q provided reply to a message has the correlation identifier of the original request message.
</div>
<h4 class="pDefTerm"><a name="wp1111233"> </a>
<code class="cCode">TPQDELIVERYQOS</code>
</h4><div class="pDefPara"><a name="wp1111234"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a delivery quality of service, then the flag&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;is stored in <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code>. If no delivery quality of service was explicitly specified when the message was queued, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<h4 class="pDefTerm"><a name="wp1111235"> </a>
<code class="cCode">TPQREPLYQOS</code>
</h4><div class="pDefPara"><a name="wp1111236"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a reply quality of service, then the flag&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;is stored in <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>. If no reply quality of service was explicitly specified when the message was queued, the default delivery policy of the <code class="cCodeEmphasis">ctl-&gt;replyqueue</code> queue dictates the delivery quality of service for any reply.
</div>
<div class="pDefParaCont"><a name="wp1111237"> </a>
Note that the default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
</div>
<h4 class="pDefTerm"><a name="wp1111238"> </a>
<code class="cCode">TPQREPLYQ</code> 
</h4><div class="pDefPara"><a name="wp1111239"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a reply queue, then the name of the reply queue is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq8" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">replyqueue</code>. Any reply to the message should go to the named reply queue within the same queue space as the request message.
</div>
<h4 class="pDefTerm"><a name="wp1111240"> </a>
<code class="cCode">TPQFAILUREQ</code> 
</h4><div class="pDefPara"><a name="wp1111241"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a failure queue, then the name of the failure queue is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq9" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">failurequeue</code>. Any failure message should go to the named failure queue within the same queue space as the request message.
</div>
<p class="pBody"><a name="wp1111242"> </a>
The following remaining bits for the <code class="cCodeEmphasis">flags</code> parameter are cleared (set to zero) when <code class="cCode">tpdequeue()</code> is called: <code class="cCode">TPQTOP</code>, <code class="cCode">TPQBEFOREMSGID</code>, <code class="cCode">TPQTIME_ABS</code>, <code class="cCode">TPQTIME_REL</code>, <code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code>. These bits are valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpenqueue()</code>.
</p>
<p class="pBody"><a name="wp1111243"> </a>
If the call to <code class="cCode">tpdequeue()</code> failed and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq10" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">diagnostic</code>. The possible values are defined below in the Diagnostics section.
</p>
<p class="pBody"><a name="wp1111244"> </a>
Additionally on output, if the call to <code class="cCode">tpdequeue()</code> is successful, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq11" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">appkey</code> is set to the application authentication key, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq12" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">cltid</code> is set to the identifier for the client originating the request, and <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq13" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">urcode</code> is set to the user-return code value that was set when the message was enqueued.
</p>
<p class="pBody"><a name="wp1111245"> </a>
If the <code class="cCodeEmphasis">ctl</code> parameter is NULL, the input flags are considered to be <code class="cCode">TPNOFLAGS</code>, and no output information is made available to the application program.
</p>
<h4 class="pHeading3"><a name="wp1111246"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1111247"> </a>
Upon failure, <code class="cCode">tpdequeue()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1111248"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1111249"> </a>
Upon failure, <code class="cCode">tpdequeue()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1111250"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1111251"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">qname</code> is NULL, <code class="cCodeEmphasis">data</code> does not point to space allocated with <code class="cCode">tpalloc()</code> or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1111252"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1111254"> </a>
Cannot access the <code class="cCodeEmphasis">qspace</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp1111255"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp1111256"> </a>
Either the type and subtype of the dequeued message are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set in <code class="cCodeEmphasis">flags</code> and the type and subtype of *<code class="cCodeEmphasis">data</code> do not match the type and subtype of the dequeued message. In either case, *<code class="cCodeEmphasis">data</code>, its contents, and *<code class="cCodeEmphasis">len</code> are <em class="cEmphasis">not</em> changed. When the call is made in transaction mode and this error occurs, the transaction is marked abort-only, and the message remains on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1111257"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1111258"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpdequeue()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1111259"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.) In either case, no changes are made to <code class="cCode">*data</code>, its contents, or <code class="cCode">*len</code>.
<a name="wp1111260"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to perform further conversational work, send new requests, or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1111261"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1111262"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1111263"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1111264"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1111265"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1111266"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1111267"> </a>
<code class="cCode">tpdequeue()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1111268"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1111269"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1111270"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1111271"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1111272"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp1111273"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via <code class="cCodeEmphasis">ctl</code> structure.
</div>
<h4 class="pHeading3"><a name="wp1111274"> </a>
Diagnostic
</h4>
<p class="pBody"><a name="wp1111275"> </a>
The following diagnostic values are returned during the dequeuing of a message: 
</p>
<h4 class="pDefTerm"><a name="wp1111276"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1111277"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1111278"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp1111279"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1111280"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp1111281"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1111282"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1111283"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> flag set and an error occurred trying to start a transaction in which to dequeue the message. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1111284"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp1111285"> </a>
An invalid message identifier was specified for dequeuing.
</div>
<h4 class="pDefTerm"><a name="wp1111286"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1111287"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1111288"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp1111289"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1111290"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp1111291"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1111292"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1111293"> </a>
A dequeue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1111294"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp1111295"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1111296"> </a>
[<code class="cCode">QMENOMSG</code>] 
</h4><div class="pDefPara"><a name="wp1111297"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1111298"> </a>
[<code class="cCode">QMEINUSE</code>] 
</h4><div class="pDefPara"><a name="wp1111299"> </a>
When dequeuing a message by message identifier or correlation identifier, the specified message is in use by another transaction. Otherwise, all messages currently on the queue are in use by other transactions. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1111300"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1111301"> </a>
When dequeuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp1111302"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1111312"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>,<code class="cCode"> </code><span class="cHyperlink">
tpalloc(3c)</span>, <a href="functions.html#wp1112161"><code class="cCode">tpenqueue()</code></a>, <a href="../rf5/rf5.html">APPQ_MIB(5)</a>,<code class="cCode"> </code><span class="cHyperlink">
<a href="../rf5/rf5.html">TMQUEUE(5)</a></span> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1112161"> </a>
tpenqueue()
</h3>
<h4 class="pHeading3"><a name="wp1112162"> </a>
Name
</h4>
<p class="pBody"><a name="wp1112163"> </a>
<code class="cCode">tpenqueue()</code>&#8212;Routine to enqueue a message.
</p>
<h4 class="pHeading3"><a name="wp1112164"> </a>
Synopsis
</h4>
<a name="wp1112165"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpenqueue(char *qspace, char *qname, TPQCTL *ctl, char *data, long len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1112166"> </a>
Description
</h4>
<p class="pBody"><a name="wp1112167"> </a>
<code class="cCode">tpenqueue()</code> stores a message on the queue named by <code class="cCodeEmphasis">qname</code> in the <code class="cCodeEmphasis">qspace</code> queue space. A queue space is a collection of queues, one of which must be <code class="cCodeEmphasis">qname</code>.
</p>
<p class="pBody"><a name="wp1112168"> </a>
When the message is intended for an Oracle Tuxedo ATMI system server, the <code class="cCodeEmphasis">qname</code> matches the name of a service provided by the server. The system provided server, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, provides a default mechanism for dequeuing messages from the queue and forwarding them to servers that provide a service matching the queue name. If the originator expects a reply, then the reply to the forwarded service request is stored on the originator&#8217;s queue, unless otherwise specified. The originator will dequeue the reply message at a subsequent time. Queues can also be used for a reliable message transfer mechanism between any pair of Oracle Tuxedo ATMI system processes (clients and/or servers). In this case, the queue name does not match a service name but some agreed upon name for transferring the message.
</p>
<p class="pBody"><a name="wp1112170"> </a>
If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should specify the amount of data in the buffer that should be queued. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored. If <code class="cCodeEmphasis">data</code> is NULL, <code class="cCodeEmphasis">len</code> is ignored and a message is queued with no data portion.
</p>
<p class="pBody"><a name="wp1112171"> </a>
The message is queued at the priority defined for <code class="cCodeEmphasis">qspace</code> unless overridden by a previous call to <code class="cCode">tpsprio()</code>.
</p>
<p class="pBody"><a name="wp1112172"> </a>
If the caller is within a transaction and the <code class="cCode">TPNOTRAN</code> flag is not set, the message is queued in transaction mode. This has the effect that if <code class="cCode">tpenqueue()</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is guaranteed to be available subsequent to the transaction completing. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be removed from the queue (that is, the placing of the message on the queue is also rolled back). It is not possible to enqueue then dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp1112173"> </a>
The message is not queued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. Once <code class="cCode">tpenqueue()</code> returns successfully, the submitted message is guaranteed to be in the queue. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully stored on the queue.
</p>
<p class="pBody"><a name="wp1112174"> </a>
The order in which messages are placed on the queue is controlled by the application via <code class="cCodeEmphasis">ctl</code> data structure as described below; the default queue ordering is set when the queue is created.
</p>
<p class="pBody"><a name="wp1112175"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp1112176"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1112177"> </a>
If the caller is in transaction mode and this flag is set, the message is not queued within the caller&#8217;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when queuing the message. If message queuing fails, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1112178"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1112179"> </a>
The message is not enqueued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on an Oracle product other than the Oracle Tuxedo ATMI system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<div class="pDefParaCont"><a name="wp1112180"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). If a timeout occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1112181"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1112182"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1112183"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1112184"> </a>
If this flag is set and a signal interrupts any underlying system calls, the interrupted system call is reissued. If <code class="cCode">TPSIGRSTRT</code> is not set and a signal interrupts a system call, <code class="cCode">tpenqueue()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1112185"> </a>
Additional information about queuing the message can be specified via <code class="cCodeEmphasis">ctl</code> data structure. This information includes values to override the default queue ordering placing the message at the top of the queue or before an enqueued message; an absolute or relative time after which a queued message is made available; an absolute or relative time when a message expires and is removed from the queue; the quality of service for delivering the message; the quality of service that any replies to the message should use; a correlation identifier that aids in correlating a reply or failure message with the queued message; the name of a queue to which a reply should be enqueued; and the name of a queue to which any failure message should be enqueued.
</p>
<p class="pBody"><a name="wp1112186"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpenqueue()</code>.
</p>
<h4 class="pHeading3"><a name="wp1112187"> </a>
Control Parameter
</h4>
<p class="pBody"><a name="wp1112188"> </a>
The <code class="cCode">TPQCTL</code> structure is used by the application program to pass and retrieve parameters associated with enqueuing the message. The <code class="cCodeEmphasis">flags</code> element of <code class="cCode">TPQCTL</code> is used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp1112189"> </a>
On input to <code class="cCode">tpenqueue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1112190"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values  <br />                        * are set */  <br />long deq_time;         /* absolute/relative for dequeuing */  <br />long priority;         /* enqueue priority */  <br />long exp_time          /* expiration time */  <br />long delivery_qos      /* delivery quality of service */  <br />long reply_qos         /* reply quality of service */  <br />long urcode;           /* user-return code */  <br />char msgid[32];        /* ID of message before which to queue  <br />                        * request */  <br />char corrid[32];       /* correlation identifier used to  <br />                        * identify the msg */  <br />char replyqueue[16];   /* queue name for reply message */  <br />char failurequeue[16]; /* queue name for failure message */</pre></div><p class="pBody"><a name="wp1112191"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpenqueue()</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1112192"> </a>
<code class="cCode">TPNOFLAGS</code> 
</h4><div class="pDefPara"><a name="wp1112193"> </a>
No flags or values are set. No information is taken from the control structure.
</div>
<h4 class="pDefTerm"><a name="wp1112194"> </a>
<code class="cCode">TPQTOP</code> 
</h4><div class="pDefPara"><a name="wp1112195"> </a>
Setting this flag indicates that the queue ordering be overridden and the message placed at the top of the queue. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. <code class="cCode">TPQTOP</code> and <code class="cCode">TPQBEFOREMSGID</code> are mutually exclusive flags.
</div>
<h4 class="pDefTerm"><a name="wp1112196"> </a>
<code class="cCode">TPQBEFOREMSGID</code> 
</h4><div class="pDefPara"><a name="wp1112197"> </a>
Setting this flag indicates that the queue ordering be overridden and the message placed in the queue before the message identified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq14" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. <code class="cCode">TPQTOP</code> and <code class="cCode">TPQBEFOREMSGID</code> are mutually exclusive flags. Note that the entire 32 bytes of the message identifier value are significant, so the value identified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq15" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1112198"> </a>
<code class="cCode">TPQTIME_ABS</code>
</h4><div class="pDefPara"><a name="wp1112199"> </a>
If this flag is set, the message is made available after the time specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq16" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">deq_time</code>. The <code class="cCodeEmphasis">deq_time</code> is an absolute time value as generated by <code class="cCode">time</code>(2), <code class="cCode">mktime</code>(3C), or <span class="cHyperlink">
gp_mktime(3c)</span> (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970). <code class="cCode">TPQTIME_ABS</code> and <code class="cCode">TPQTIME_REL</code> are mutually exclusive flags. The absolute time is determined by the clock on the machine where the queue manager process resides.
</div>
<h4 class="pDefTerm"><a name="wp1112203"> </a>
<code class="cCode">TPQTIME_REL</code>
</h4><div class="pDefPara"><a name="wp1112204"> </a>
If this flag is set, the message is made available after a time relative to the completion of the enqueuing operation. <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq17" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">deq_time</code> specifies the number of seconds to delay after the enqueuing completes before the submitted message should be available. <code class="cCode">TPQTIME_ABS</code> and <code class="cCode">TPQTIME_REL</code> are mutually exclusive flags.
</div>
<h4 class="pDefTerm"><a name="wp1112205"> </a>
<code class="cCode">TPQPRIORITY</code>
</h4><div class="pDefPara"><a name="wp1112206"> </a>
If this flag is set, the priority at which the message should be enqueued is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq18" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">priority</code>. The priority must be in the range 1 to 100, inclusive. The higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). For queues not ordered by priority, this value is informational.
</div>
<div class="pDefParaCont"><a name="wp1112207"> </a>
If this flag is not set, the priority for the message is 50 by default.
</div>
<h4 class="pDefTerm"><a name="wp1112208"> </a>
<code class="cCode">TPQCORRID</code>
</h4><div class="pDefParaCont"><a name="wp1112209"> </a>
If this flag is set, the correlation identifier value specified in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq19" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> is available when a message is dequeued with <code class="cCode">tpdequeue()</code>. This identifier accompanies any reply or failure message that is queued so that an application can correlate a reply with a particular request. Note that the entire 32 bytes of the correlation identifier value are significant, so the value specified in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq20" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1112210"> </a>
<code class="cCode">TPQREPLYQ</code>
</h4><div class="pDefPara"><a name="wp1112211"> </a>
If this flag is set, a reply queue named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq21" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">replyqueue</code> is associated with the queued message. Any reply to the message will be queued to the named queue within the same queue space as the request message. This string must be NULL terminated (maximum 15 characters in length).
</div>
<h4 class="pDefTerm"><a name="wp1112212"> </a>
<code class="cCode">TPQFAILUREQ</code>
</h4><div class="pDefPara"><a name="wp1112213"> </a>
If this flag is set, a failure queue named in the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq22" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">failurequeue</code> is associated with the queued message. If (1) the enqueued message is processed by <code class="cCode">TMQFORWARD()</code>, (2) <code class="cCode">TMQFORWARD</code> was started with the <code class="cCode">-d</code> option, and (3) the service fails and returns a non-NULL reply, a failure message consisting of the reply and its associated <code class="cCode">tpurcode</code> is enqueued to the named queue within the same queue space as the original request message. This string must be NULL-terminated (maximum 15 characters in length).
</div>
<h4 class="pDefTerm"><a name="wp1112214"> </a>
<code class="cCode">TPQDELIVERYQOS</code>, <code class="cCode">TPQREPLYQOS</code>
</h4><div class="pDefPara"><a name="wp1112215"> </a>
If the <code class="cCode">TPQDELIVERYQOS</code> flag is set, the flags specified by <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code> control the quality of service for delivery of the message. In this case, one of three mutually exclusive flags&#8212; <code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;must be set in <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code>. If <code class="cCode">TPQDELIVERYQOS</code> is not set, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<div class="pDefParaCont"><a name="wp1112216"> </a>
If the <code class="cCode">TPQREPLYQOS</code> flag is set, the flags specified by <code class="cCodeEmphasis">ctl-&gt;reply_qos</code> control the quality of service for any reply to the message. In this case, one of three mutually exclusive flags&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;must be set in <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>. The <code class="cCode">TPQREPLYQOS</code> flag is used when a reply is returned from messages processed by <code class="cCode">TMQFORWARD</code>. Applications not using <code class="cCode">TMQFORWARD</code> to invoke services may use the <code class="cCode">TPQREPLYQOS</code> flag as a hint for their own reply mechanism.
<a name="wp1112217"> </a>
If TPQREPLYQOS is not set, the default delivery policy of the <code class="cCodeEmphasis">ctl-&gt;replyqueue</code> queue dictates the delivery quality of service for any reply. Note that the default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
<a name="wp1112218"> </a>
The following is the list of valid flags for <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code> and <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1112219"> </a>
<code class="cCode">TPQQOSDEFAULTPERSIST</code>
</h4></div>
<div class="pDefPara2"><a name="wp1112220"> </a>
This flag specifies that the message is to be delivered using the default delivery policy specified on the target queue.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1112221"> </a>
<code class="cCode">TPQQOSPERSISTENT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1112222"> </a>
This flag specifies that the message is to be delivered in a persistent manner using the disk-based delivery method. Setting this flag overrides the default delivery policy specified on the target queue.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1112223"> </a>
<code class="cCode">TPQQOSNONPERSISTENT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1112224"> </a>
This flag specifies that the message is to be delivered in a non-persistent manner using the memory-based delivery method. Specifically, the message is queued in memory until it is dequeued. Setting this flag overrides the default delivery policy specified on the target queue. If the caller is transactional, non-persistent messages are enqueued within the caller&#8217;s transaction, however, non-persistent messages are lost if the system is shut down, crashes, or the IPC shared memory for the queue space is removed.
</div><h4 class="pDefTerm"><a name="wp1112225"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>
</h4><div class="pDefPara"><a name="wp1112226"> </a>
If this flag is set, the message has an absolute expiration time, which is the absolute time when the message will be removed from the queue.
<a name="wp1112227"> </a>
The absolute expiration time is determined by the clock on the machine where the queue manager process resides.
</div>
<div class="pDefParaCont"><a name="wp1112228"> </a>
The absolute expiration time is indicated by the value stored in <code class="cCodeEmphasis">ctl-&gt;exp_time</code>. The value of <code class="cCodeEmphasis">ctl-&gt;exp_time</code> must be set to an absolute time value generated by <code class="cCode">time</code>(2), <code class="cCode">mktime</code>(3C), or <span class="cHyperlink">
gp_mktime(3c)</span> (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970).
<a name="wp1112232"> </a>
If an absolute time is specified that is earlier than the time of the enqueue operation, the operation succeeds, but the message is not counted for the purpose of calculating thresholds. If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. If a message expires while it is within a transaction, the expiration does not cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no notification that the message has expired.
<a name="wp1112233"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<h4 class="pDefTerm"><a name="wp1112234"> </a>
<code class="cCode">TPQEXPTIME_REL</code>
</h4><div class="pDefPara"><a name="wp1112235"> </a>
If this flag is set, the message has a relative expiration time, which is the number of seconds <em class="cEmphasis">after</em> the message arrives at the queue that the message is removed from the queue. The relative expiration time is indicated by the value stored in <code class="cCodeEmphasis">ctl-&gt;exp_time</code>.
</div>
<div class="pDefParaCont"><a name="wp1112236"> </a>
If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. The expiration of a message during a transaction, does not cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no acknowledgment that the message has expired.
<a name="wp1112237"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<h4 class="pDefTerm"><a name="wp1112238"> </a>
<code class="cCode">TPQEXPTIME_NONE</code>
</h4><div class="pDefPara"><a name="wp1112239"> </a>
Setting this flag indicates that the message should not expire. This flag overrides any default expiration policy associated with the target queue. A message can be removed by dequeuing it or by deleting it via an administrative interface.
</div>
<div class="pDefParaCont"><a name="wp1112240"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<p class="pBody"><a name="wp1112241"> </a>
Additionally, the <code class="cCodeEmphasis">urcode</code> element of <code class="cCode">TPQCTL</code> can be set with a user-return code. This value will be returned to the application that dequeues the message.
</p>
<p class="pBody"><a name="wp1112242"> </a>
On output from <code class="cCode">tpenqueue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1112243"> </a><div class="pPreformatted"><pre>long flags;         /* indicates which of the values  <br />                                * are set */  <br />char msgid[32];                /* ID of enqueued message */  <br />long diagnostic;               /* indicates reason for failure */</pre></div><p class="pBody"><a name="wp1112244"> </a>
The following is a valid bit for the <code class="cCodeEmphasis">flags</code> parameter controlling output information from <code class="cCode">tpenqueue()</code>. If this flag is turned on when <code class="cCode">tpenqueue()</code> is called, the /Q server <a href="../rf5/rf5.html">TMQUEUE(5)</a> populates the associated element in the structure with a message identifier. If this flag is turned off when <code class="cCode">tpenqueue()</code> is called, <code class="cCode">TMQUEUE()</code> does <em class="cEmphasis">not</em> populate the associated element in the structure with a message identifier.
</p>
<h4 class="pDefTerm"><a name="wp1112246"> </a>
<code class="cCode">TPQMSGID</code> 
</h4><div class="pDefPara"><a name="wp1112247"> </a>
If this flag is set and the call to <code class="cCode">tpenqueue()</code> is successful, the message identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq23" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. The entire 32 bytes of the message identifier value are significant, so the value stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq24" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> is completely initialized (for example, padded with NULL characters). The actual padding character used for initialization varies between releases of the Oracle Tuxedo ATMI /Q component.
</div>
<p class="pBody"><a name="wp1112248"> </a>
The remaining members of the control structure are not used on input to <code class="cCode">tpenqueue()</code>.
</p>
<p class="pBody"><a name="wp1112249"> </a>
If the call to <code class="cCode">tpenqueue()</code> failed and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq25" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">diagnostic</code>. The possible values are defined below in the Diagnostics section.
</p>
<p class="pBody"><a name="wp1112250"> </a>
If this parameter is NULL, the input flags are considered to be <code class="cCode">TPNOFLAGS</code> and no output information is made available to the application program.
</p>
<h4 class="pHeading3"><a name="wp1112251"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1112252"> </a>
Upon failure, <code class="cCode">tpenqueue()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the message has been successfully queued when <code class="cCode">tpenqueue()</code> returns.
</p>
<h4 class="pHeading3"><a name="wp1112253"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1112254"> </a>
Upon failure, <code class="cCode">tpenqueue()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1112255"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1112256"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">qspace</code> is NULL, <code class="cCodeEmphasis">data</code> does not point to space allocated with <code class="cCode">tpalloc()</code>, or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1112257"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1112259"> </a>
Cannot access the <code class="cCodeEmphasis">qspace</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp1112260"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1112261"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpenqueue()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1112262"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1112263"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1112264"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1112265"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1112266"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1112267"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1112268"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1112269"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1112270"> </a>
<code class="cCode">tpenqueue()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1112271"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1112272"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1112273"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1112274"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1112275"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp1112276"> </a>
Enqueuing a message on the specified queue failed. The reason for failure can be determined by the diagnostic returned via <code class="cCodeEmphasis">ctl</code>.
</div>
<h4 class="pHeading3"><a name="wp1112277"> </a>
Diagnostic
</h4>
<p class="pBody"><a name="wp1112278"> </a>
The following diagnostic values are returned during the enqueuing of a message: 
</p>
<h4 class="pDefTerm"><a name="wp1112279"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1112280"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1112281"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp1112282"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1112283"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp1112284"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1112285"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1112286"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> flag set and an error occurred trying to start a transaction in which to enqueue the message. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1112287"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp1112288"> </a>
An invalid message identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1112289"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1112290"> </a>
A system error occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1112291"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp1112292"> </a>
An operating system error occurred.
</div>
<h4 class="pDefTerm"><a name="wp1112293"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp1112294"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1112295"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1112296"> </a>
An enqueue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1112297"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp1112298"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1112299"> </a>
[<code class="cCode">QMENOSPACE</code>] 
</h4><div class="pDefPara"><a name="wp1112300"> </a>
Due to an insufficient resource, such as no space on the queue, the message with its required quality of service (persistent or non-persistent storage) was not enqueued. <code class="cCode">QMENOSPACE</code> is returned when any of the following configured resources is exceeded: (1) the amount of disk (persistent) space allotted to the queue space, (2) the amount of memory (non-persistent) space allotted to the queue space, (3) the maximum number of simultaneously active transactions allowed for the queue space, (4) the maximum number of messages that the queue space can contain at any one time, (5) the maximum number of concurrent actions that the Queuing Services component can handle, or (6) the maximum number of authenticated users that may concurrently use the Queuing Services component.
</div>
<h4 class="pDefTerm"><a name="wp1112301"> </a>
[<code class="cCode">QMERELEASE</code>]
</h4><div class="pDefPara"><a name="wp1112302"> </a>
An attempt was made to enqueue a message to a queue manager that is from a version of the Oracle Tuxedo system that does not support a newer feature.
</div>
<h4 class="pDefTerm"><a name="wp1112303"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1112304"> </a>
When enqueuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp1112305"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1112322"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>, <span class="cHyperlink">
gp_mktime(3c)</span>, <span class="cHyperlink">
tpacall(3c)</span>, <span class="cHyperlink">
tpalloc(3c)</span>, <a href="functions.html#wp1111177"><code class="cCode">tpdequeue()</code></a>, <span class="cHyperlink">
tpinit(3c)</span>, <span class="cHyperlink">
tpsprio(3c)</span>, <a href="../rf5/rf5.html">APPQ_MIB(5)</a>, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, <a href="../rf5/rf5.html">TMQUEUE(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076259"> </a>
tpqattach()
</h3>
<h4 class="pHeading3"><a name="wp1075785"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075788"> </a>
<code class="cCode">tpqattach()</code>&#8212;Connects an application program to the OTMQ message queuing space by attaching it to a message queue.
</p>
<h4 class="pHeading3"><a name="wp1075791"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1075783"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqattach (qspace, queue, ctl, qattachctl, flags)
</p>
<h4 class="pHeading3"><a name="wp1075798"> </a>
Description
</h4>
<p class="pBody"><a name="wp1082735"> </a>
A message queue qspace is a collection of message queues that reside on a system, share global memory sections and files, and are served by the same server processes. An OTMQ message queue is an area of memory or disk where messages are stored and retrieved. See the installation and configuration guide for the platform you are using to learn how to configure the OTMQ environment.
</p>
<p class="pBody"><a name="wp1082736"> </a>
To receive OTMQ messages, an application must attach to at least one message queue. The <code class="cCode">tpqattach</code> function enables an application to attach in the following ways:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1082737"> </a>An application can attach to a queue by specifying a name. To attach by name, the message queue must be created by run <code class="cCode">createqueue</code> command of <code class="cCode">tmqadmin</code>. Attaching by name enables an application to attach to a specific queue, send messages to the queue, and retrieve messages sent to that queue. </li>
<li><a name="wp1082738"> </a>An application can attach to a queue by specifying the queue alias. To attach by name alias, the message queue must be created by running the <code class="cCode">tmqadmin</code> <code class="cCode">createqueue</code> command. Attaching by name alias enables an application to attach to a specific queue, send messages to the queue, and retrieve messages sent to that queue. In addition, attaching by name alias eliminates the need to change code or recompile if the queue name alias changes. Therefore, attaching by name alias protects applications from changes in the OTMQ environment configuration. </li>
<li><a name="wp1082739"> </a>An application can attach to a temporary queue. To attach to a temporary queue, the application does not have to give a specific queue name or name alias. OTMQ will assign a queue and return the name of the queue which has been assigned. Temporary queues allow an application to perform messaging without knowing configuration details of the group. </li>
</ul></div>
<p class="pBody"><a name="wp1082740"> </a>
Applications can specify an attachment as primary or secondary. All applications must have a primary queue. In addition, applications can attach to one or more secondary queues. Primary queues can be configured in the queue create command as the owners of secondary queues. When an application attaches to a primary queue that is the owner of secondary queues, the application is automatically attached to the secondary queues at the same time it is attached to the primary queue.
</p>
<p class="pBody"><a name="wp1114740"> </a>
In addition, an application can attach to a multi-reader queue. A multi-reader queue can be read by many applications and is configured as part of the group definition.
</p>
<p class="pBody"><a name="wp1114744"> </a>
<a href="functions.html#wp1114748">Table&#160;1-2</a> lists <code class="cCode">tpqattach()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1114817"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1114748table1114745"><caption><a name="wp1114748"> </a>
Table 1-2  tpqattach() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1114758"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1114760"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1114762"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1114764"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1114766"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114768"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114770"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114772"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114774"> </a>
char*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114776"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114778"> </a>
queue
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114780"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114782"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114784"> </a>
char*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114786"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114788"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114790"> </a>
TPQCTL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114792"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114794"> </a>
TPQCTL*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114796"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114798"> </a>
Qattachctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114800"> </a>
Q_ATTACH_CTL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114802"> </a>
Reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114804"> </a>
Q_ATTACH_CTL *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114806"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114808"> </a>
Flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114810"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114812"> </a>
Reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114814"> </a>
Long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1114816"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1082743"> </a>
<code class="cCodeBold">qspace</code>
</h4><div class="pDefPara"><a name="wp1082744"> </a>
Supplies the queue space name for enqueue the message. The max length is 15.
</div>
<h4 class="pDefTerm"><a name="wp1082745"> </a>
<code class="cCodeBold">queue</code>
</h4><div class="pDefPara"><a name="wp1082746"> </a>
Supplies the name of the permanent queue to attach to the application if the <code class="cCode">attach_mode</code> argument specifies attachment by queue name or queue alias. Queue names are alphanumeric strings with no embedded spaces and allow the following special characters: underscore <code class="cCode">(_)</code>, hyphen <code class="cCode">(-)</code>, and dollar sign <code class="cCode">($)</code>. The max length is 127.
</div>
<div class="pDefParaCont"><a name="wp1082747"> </a>
References to queue names are case sensitive and must match the queue name entered in the create queue command by <code class="cCode">tmqadmin</code>. Some example queue names are: <code class="cCode">QUEUE_1</code>, high-priority, and <code class="cCode">My$Queue</code>.
</div>
<h4 class="pDefTerm"><a name="wp1082748"> </a>
<code class="cCodeBold">ctl</code>
</h4><p class="pBody"><a name="wp1127315"> </a>
The TPQCTL structure is used by the application program to pass and retrieve parameters associated with enqueuing the message. The TPQCTL flags element is used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp1127316"> </a>
On input to <code class="cCode">tpenqplus()</code>, the elements shown in <a href="functions.html#wp1127317">Listing&#160;1-1</a>may be set in the TPQCTL structure.
</p>
<div class="pCodeTitle"><a name="wp1127317"> </a>
Listing&#160;1-1	   tpenqplus() Elements
</div> <p class="pBody"><a name="wp1126997"> </a>
&#160;&#160;&#160;&#160;&#160;long flags;                  /* indicates which of the values are set */<br />&#160;&#160;&#160;&#160;&#160;long deq_time;                  /* absolute/relative  time for dequeuing */<br />&#160;&#160;&#160;&#160;&#160;long priority;             /* enqueue priority */<br />&#160;&#160;&#160;&#160;&#160;long diagnostic;        /* indicates reason for failure */<br />&#160;&#160;&#160;&#160;&#160;char msgid[TMMSGIDLEN];    /* id of message before which to queue */<br />&#160;&#160;&#160;&#160;&#160;char corrid[TMCORRIDLEN];/* correlation id used to identify message */<br />&#160;&#160;&#160;&#160;&#160;char replyqueue[TMQNAMELEN+1];       /* queue name for reply message */<br />&#160;&#160;&#160;&#160;&#160;char failurequeue[TMQNAMELEN+1];/* queue name for failure message */<br />&#160;&#160;&#160;&#160;&#160;CLIENTID cltid; &#160;&#160;&#160;/* client identifier for originating client */<br />&#160;&#160;&#160;&#160;&#160;long urcode;              /* application user-return code */<br />&#160;&#160;&#160;&#160;&#160;long appkey;              /* application authentication client key */<br />&#160;&#160;&#160;&#160;&#160;long delivery_qos;      /* delivery quality of service  */<br />&#160;&#160;&#160;&#160;&#160;long reply_qos;         /* reply message quality of service  */<br />&#160;&#160;&#160;&#160;&#160;long exp_time;          /* expiration time  */<br />&#160;&#160;&#160;&#160;&#160;/* new members for TMQPlus */<br />&#160;&#160;&#160;&#160;&#160;long block;             /* specify block mode: WF, AK, NN */<br />&#160;&#160;&#160;&#160;&#160;long DIP; &#160;&#160;&#160;/* specify the delivery interesting point:MEM, SAF, DQF, &#160;&#160;&#160;&#160;&#160;DEQ, ACK, &#160;&#160;&#160;&#160;&#160;CONF &#160;&#160;&#160;&#160;&#160;*/<br />&#160;&#160;&#160;&#160;&#160;long uma;               /* undelivered message action */<br />&#160;&#160;&#160;&#160;&#160;long msg_class;         /* message class */<br />&#160;&#160;&#160;&#160;&#160;long msg_type;          /* message type  */<br />&#160;&#160;&#160;&#160;&#160;PSB  status_block;      /* message delivery control point and UMA status &#160;&#160;&#160;&#160;&#160;block */<br />&#160;&#160;&#160;&#160;&#160;long redeliver_count;   /* the max count which the message can be &#160;&#160;&#160;&#160;&#160;redelivered */<br />&#160;&#160;&#160;&#160;&#160;long seq_number[2];        /* message seq number, which is decided in &#160;&#160;&#160;&#160;&#160;client side to &#160;&#160;&#160;&#160;&#160;decrease the TMQ load */<br />&#160;&#160;&#160;&#160;&#160;long timeout;           /* timeout value for block enq/deq operation */<br />&#160;&#160;&#160;&#160;&#160;char src_qspace[TMQSNAMELEN+1];     /* the source QSpace name. */<br />&#160;&#160;&#160;&#160;&#160;char src_qname[TMQNAMELEN+1];           /* the source queue name. */<br />&#160;&#160;&#160;&#160;&#160;char tgt_qspace[TMQSNAMELEN+1];     /* the source QSpace name. */<br />&#160;&#160;&#160;&#160;&#160;char tgt_qname[TMQNAMELEN+1];           /* the source queue name. */<br />&#160;&#160;&#160;&#160;&#160;char orig_src_qspace[TMQSNAMELEN+1];/* the original source QSpace &#160;&#160;&#160;&#160;&#160;name. */<br />&#160;&#160;&#160;&#160;&#160;char orig_src_qname[TMQNAMELEN+1];  /* the original source queue name. &#160;&#160;&#160;&#160;&#160;*/<br />&#160;&#160;&#160;&#160;&#160;char orig_tgt_qspace[TMQSNAMELEN+1];/* the original target QSpace &#160;&#160;&#160;&#160;&#160;name. */<br />&#160;&#160;&#160;&#160;&#160;char orig_tgt_qname[TMQNAMELEN+1];  /* the original target queue name. &#160;&#160;&#160;&#160;&#160;*/<br />&#160;&#160;&#160;&#160;&#160;char hops;              /* net hops */<br />&#160;&#160;&#160;&#160;&#160;long opcode;<br />&#160;&#160;&#160;&#160;&#160;long filter_idx;<br />&#160;&#160;&#160;&#160;&#160;long user_tag;<br />&#160;&#160;&#160;&#160;&#160;long geta_idx;           /* index of pending pams_get_msga requests */<br />&#160;&#160;&#160;&#160;&#160;long endian;<br />&#160;&#160;&#160;&#160;&#160;long receipt_msg_type;  /*used for uma message*/
</p>
<h4 class="pDefTerm"><a name="wp1082750"> </a>
<code class="cCodeBold">Qattachctl</code>
</h4><p class="pBody"><a name="wp1127851"> </a>
The is used by the application program to pass parameters associated with attach the queue. The elements shown in <span class="cHyperlink">
Listing&#160;1-2</span> may be set in the Q_ATTACH_CTL structure:
</p>
<div class="pCodeTitle"><a name="wp1128058"> </a>
Listing&#160;1-2	   Q_ATTACH_CTL Elements
</div> <a name="wp1128054"> </a><div class="pPreformatted"><pre>&#160;&#160;&#160;&#160;&#160;TM32I attachmode;   /* Supplies the mode for attaching the application &#160;&#160;&#160;&#160;&#160;to a message queue.*/ <br />&#160;&#160;&#160;&#160;&#160;TM32I qtype;        /* Supplies the queue type for the attachment. */<br />&#160;&#160;&#160;&#160;&#160;TM32I * namespace_list;  /* Supplies a list of name tables to search &#160;&#160;&#160;&#160;&#160;when the attach_mode argument. */<br />&#160;&#160;&#160;&#160;&#160;TM32I         namespace_list_len; /* Supplies the number of entries in &#160;&#160;&#160;&#160;&#160;the name_space_list &#160;&#160;&#160;&#160;&#160;argument. */<br />&#160;&#160;&#160;&#160;&#160;long          timeout;      /* The number of OTMQ time units (1 second &#160;&#160;&#160;&#160;&#160;intervals) to allow for the attach to complete. */</pre></div><h4 class="pDefTerm"><a name="wp1082752"> </a>
<code class="cCodeBold">Flags</code>
</h4><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1082753"> </a>
<code class="cCodeBold">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1082754"> </a>
If the caller is in transaction mode and this flag is set, the message is not queued within the caller transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other), when queuing the message. If message queuing fails, the caller transaction is not affected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1082755"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1082756"> </a>
Caller attaches to the queue if a blocking condition exists. If this flag is set and a blocking condition exists (such as the internal buffers into which the message is transferred are full), the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened exclusively by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the TPQCTL structure is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on an Oracle product other than the Oracle Tuxedo ATMI system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div><div class="pDefPara2"><a name="wp1082757"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). If a timeout occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPETIME</code>.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1082758"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1082759"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1082760"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075761"> </a>
If this flag is set and a signal interrupts any underlying system calls, the interrupted system call is reissued. If <code class="cCode">TPSIGRSTRT</code> is not set and a signal interrupts a system call, <code class="cCode">tpenqueue()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div><h4 class="pHeading3"><a name="wp1078568"> </a>
Return Value(s)
</h4>
<h4 class="pDefTerm"><a name="wp1083430"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1083431"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1083432"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1083433"> </a>
Cannot access the qspace because it is not available
</div>
<h4 class="pDefTerm"><a name="wp1083434"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1083435"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqattach()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1083436"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1083437"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1083438"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1083439"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1083440"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1083441"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1083442"> </a>
<code class="cCodeBold">[TPEDIAGNOSTIC]</code>
</h4><div class="pDefPara"><a name="wp1083443"> </a>
Attach to the specified queue failed. The reason for failure can be determined by the diagnostic returned via ctl.
</div>
<div class="pDefParaCont"><a name="wp1083444"> </a>
Diagnostic:
</div>
<h4 class="pDefTerm"><a name="wp1083445"> </a>
<code class="cCodeBold">[QMEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1083446"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1083447"> </a>
<code class="cCodeBold">[QMESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1083448"> </a>
A system error occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1083449"> </a>
<code class="cCodeBold">[QMEOS]</code>
</h4><div class="pDefPara"><a name="wp1083450"> </a>
An operating system error occurred.
</div>
<h4 class="pDefTerm"><a name="wp1083451"> </a>
<code class="cCodeBold">[QMEABORTED]</code>
</h4><div class="pDefPara"><a name="wp1083452"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1083453"> </a>
<code class="cCodeBold">[QMEBADQUEUE]</code>
</h4><div class="pDefPara"><a name="wp1083454"> </a>
An invalid or deleted queue name was specified.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075796"> </a>
tpqdetach()
</h3>
<h4 class="pHeading3"><a name="wp1083706"> </a>
Name
</h4>
<p class="pBody"><a name="wp1083707"> </a>
<code class="cCode">tpqdetach()</code>&#8212;Detaches a selected message queue or all of the application message queues from the message queuing qspace.
</p>
<h4 class="pHeading3"><a name="wp1083708"> </a>
Synopsis
</h4>
<a name="wp1083767"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqdetach ( qspace, queue,  detach_opt_list, detach_opt_len, msg_flushed , flags) </pre></div><h4 class="pHeading3"><a name="wp1075817"> </a>
Description
</h4>
<p class="pBody"><a name="wp1083890"> </a>
Detaches a selected message queue or all of the application&#39;s message queues from the message queuing qspace. When an application detaches from its primary queue, this function automatically detaches all secondary queue attachments defined for the primary queue. When the last message queue has been detached, the application is automatically detached from the OTMQ message queuing qspace.
</p>
<p class="pBody"><a name="wp1083946"> </a>
If you are using implicit confirmation with recoverable messaging, you must ensure that the last message is confirmed before:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1083891"> </a>detaching from the queue which received the message by calling <code class="cCode">tpqdetach</code> </li>
<li><a name="wp1083892"> </a>detaching from the OTMQ qspace by calling <code class="cCode">tpqexit</code> </li>
<li><a name="wp1083893"> </a>exiting your application</li>
</ul></div>
<p class="pBody"><a name="wp1122760"> </a>
If you do not ensure that the last message was confirmed before detaching or exiting, the message will be re-delivered when the queue is reattached. The easiest method to ensure confirmation is to save the PSB delivery status of the last message received, check it for the required confirmation status, and then exit after the message has been confirmed.
</p>
<p class="pBody"><a name="wp1122764"> </a>
<a href="functions.html#wp1122768">Table&#160;1-3</a> lists <code class="cCode">tpqdetach()</code> supported arguments.
</p>
<p class="pGraphic"><a name="wp1122847"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1122768table1122765"><caption><a name="wp1122768"> </a>
Table 1-3  tpqdetach () Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1122778"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1122780"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1122782"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1122784"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1122786"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122788"> </a>
<code class="cCode">qspace</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122790"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122792"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122794"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122796"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122798"> </a>
<code class="cCode">queue</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122800"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122802"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122804"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122806"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122808"> </a>
<code class="cCode">detach_opt_list</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122810"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122812"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122814"> </a>
int *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122816"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122818"> </a>
<code class="cCode">detach_opt_len</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122820"> </a>
int 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122822"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122824"> </a>
int  
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122826"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122828"> </a>
<code class="cCode">msg_flushed</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122830"> </a>
int 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122832"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122834"> </a>
int * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122836"> </a>
returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122838"> </a>
<code class="cCode">flags</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122840"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122842"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122844"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1122846"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1084064"> </a>
qspace 
</h4><div class="pDefPara"><a name="wp1084065"> </a>
Supplies the queue space of the queue to be detached. This function can be used to detach primary, secondary, and multi-reader queues.
</div>
<h4 class="pDefTerm"><a name="wp1084066"> </a>
queue
</h4><div class="pDefPara"><a name="wp1084067"> </a>
Supplies the queue name to be detached.
</div>
<h4 class="pDefTerm"><a name="wp1084068"> </a>
detach_opt_list 
</h4><div class="pDefPara"><a name="wp1084069"> </a>
Supplies an array of <code class="cCode">int</code> values used to control how the queue is detached. The predefined constants for this argument are:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1084070"> </a>
<code class="cCode">TMQ_NOFLUSH_Q</code>
</h4></div>
<div class="pDefPara2"><a name="wp1084167"> </a>
Detaches the queue without flushing the pending messages stored in memory no matter the input parameter queue. The default action is to flush pending messages in the queue before it is detached. Messages are never flushed from multi-reader queues. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1084071"> </a>
<code class="cCode">TMQ_DETACH_ALL</code>
</h4></div>
<div class="pDefPara2"><a name="wp1084201"> </a>
Detaches all of the application&#39;s message queues from the message queuing qspace. Using this constant performs the same action as calling the <code class="cCode">tpqexit</code> function. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1084072"> </a>
TMQ_CANCEL_SEL
</h4></div>
<div class="pDefPara2"><a name="wp1084208"> </a>
Cancels all selection masks that reference the queue or queues that you are detaching. If you do not select this option and you do not cancel selection masks, OTMQ invalidates all selection masks that reference the queue or queues that you are detaching. You must cancel the invalidated selection masks using the <code class="cCode">tpqcancelget</code> function. 
</div><h4 class="pDefTerm"><a name="wp1084073"> </a>
detach_opt_len 
</h4><div class="pDefPara"><a name="wp1084074"> </a>
Supplies the number of <code class="cCode">int</code> values in the <code class="cCode">detach_opt_list</code> array. The maximum number of <code class="cCode">int</code> values is 32767.
</div>
<h4 class="pDefTerm"><a name="wp1084075"> </a>
msgs_flushed 
</h4><div class="pDefPara"><a name="wp1084076"> </a>
Receives the number of messages that were flushed from the queue. Message count statistics are enabled on all systems by default; therefore, it is not necessary to enable statistics on UNIX and Windows NT systems in order to properly return this value. 
</div>
<h4 class="pDefTerm"><a name="wp1084077"> </a>
flags
</h4><div class="pDefPara"><a name="wp1084078"> </a>
The following is a list of valid flags:
<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp1084079"> </a>TPNOTRAN</li>
<li><a name="wp1084080"> </a>TPNOBLOCK</li>
<li><a name="wp1084081"> </a>TPNOTIME</li>
<li><a name="wp1084082"> </a>TPSIGRSTRT</li>
</ul></div>
</div>
<h4 class="pHeading3"><a name="wp1084873"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1085009"> </a>
Upon failure, <code class="cCode">tpqdetach()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the queue has been successfully detached when <code class="cCode">tpqdetach()</code> returns.
</p>
<p class="pBody"><a name="wp1085010"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1085011"> </a>
[TPEINVAL]
</h4><div class="pDefPara"><a name="wp1085012"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1085013"> </a>
[TPENOENT]
</h4><div class="pDefPara"><a name="wp1085014"> </a>
Cannot access the qspace because it is not available
</div>
<h4 class="pDefTerm"><a name="wp1085015"> </a>
[TPETIME]
</h4><div class="pDefPara"><a name="wp1085016"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqdetach()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1085017"> </a>
[TPEBLOCK]
</h4><div class="pDefPara"><a name="wp1085018"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1085019"> </a>
[TPGOTSIG]
</h4><div class="pDefPara"><a name="wp1085020"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1085021"> </a>
[TPEPROTO]
</h4><div class="pDefPara"><a name="wp1085022"> </a>
<code class="cCode">tpqdetach()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1085023"> </a>
[TPESYSTEM]
</h4><div class="pDefPara"><a name="wp1085024"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1085025"> </a>
[TPEOS]
</h4><div class="pDefPara"><a name="wp1085026"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075764"> </a>
tpqbind()
</h3>
<h4 class="pHeading3"><a name="wp1075874"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075875"> </a>
<code class="cCode">tpqbind()</code> &#8212;Dynamically associates a queue name to a queue reference at run-time.
</p>
<h4 class="pHeading3"><a name="wp1075876"> </a>
Synopsis
</h4>
<a name="wp1075877"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqbind (qspace , pNameCtl , scope, timeout);</pre></div><h4 class="pHeading3"><a name="wp1075878"> </a>
Description
</h4>
<p class="pBody"><a name="wp1075879"> </a>
Dynamically associates a queue name to a queue reference at run-time. This enables a server application to dynamically sign up to service a queue alias at run-time. Thus, an end user can access a service without having to be aware that its normal host computer is down and that the service is being provided from another host computer. To use t<code class="cCode">pqbind()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1085566"> </a>
<a href="functions.html#wp1115194">Table&#160;1-4</a>I lists the <code class="cCode">tpqbind()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1115286"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1115194table1115192"><caption><a name="wp1115194"> </a>
Table 1-4   tpqbind() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1115204"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1115206"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1115208"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1115210"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1115212"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115214"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115216"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115218"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115220"> </a>
char *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115222"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115224"> </a>
pNameCtl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115226"> </a>
Q_NAME_CTL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115228"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115230"> </a>
Q_NAME_CTL *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115232"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115234"> </a>
Scope
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115236"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115238"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115240"> </a>
long *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115242"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115244"> </a>
timeout
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115246"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115248"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115250"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1115252"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1085594"> </a>
<code class="cCodeBold">qspace</code>
</h4><div class="pDefPara"><a name="wp1085595"> </a>
Identifies the queue space to be bound. The qspace argument must same with the qspace argument of <code class="cCode">tpqattach()</code>. 
</div>
<h4 class="pDefTerm"><a name="wp1085596"> </a>
<code class="cCodeBold">pNameCtl </code>
</h4><div class="pDefPara"><a name="wp1085597"> </a>
The Q_NAME_CTL structure is used by the application program to pass and retrieve parameters associated with bind alias to queue name
<p class="pBodyRelative"><a name="wp1085598"> </a>
<code class="cCode">typedef struct {</code>
</p>
<p class="pBodyRelative"><a name="wp1085599"> </a>
<code class="cCode">   char          pName[TMQALIASLEN+1];</code>
</p>
<p class="pBodyRelative"><a name="wp1085600"> </a>
<code class="cCode">   char          pGroup[TMQSNAMELEN+1];</code>
</p>
<p class="pBodyRelative"><a name="wp1085601"> </a>
<code class="cCode">   char          pQueue[TMQNAMELEN+1];</code>
</p>
<p class="pBodyRelative"><a name="wp1085602"> </a>
<code class="cCode">   TM32I         nFlags;</code>
</p>
<p class="pBodyRelative"><a name="wp1085603"> </a>
<code class="cCode">   TM32I         nType;         /* L/G */</code>
</p>
<p class="pBodyRelative"><a name="wp1085604"> </a>
<code class="cCode">   TM32I         type;          /* client type */</code>
</p>
<p class="pBodyRelative"><a name="wp1085605"> </a>
<code class="cCode">   TM32I         nOwnerPid;     /* client pid */</code>
</p>
<p class="pBodyRelative"><a name="wp1085606"> </a>
<code class="cCode">   CLIENTID      cltid;</code>
</p>
<p class="pBodyRelative"><a name="wp1085607"> </a>
<code class="cCode">   TM32I       * namespace_list;        /* for using pams interface */</code>
</p>
<p class="pBodyRelative"><a name="wp1085934"> </a>
<code class="cCode">   TM32I         namespace_list_len;    /* for using pams interface */} Q_NAME_CTL;</code>
</p>
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085935"> </a>
<code class="cCodeBold">pName </code>
</h4></div>
<div class="pDefPara2"><a name="wp1085611"> </a>
Alias name for bind, identifies a global queue reference or a local queue reference.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085612"> </a>
<code class="cCodeBold">pGroup</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085613"> </a>
Identifies the queue space to be bound.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085614"> </a>
<code class="cCodeBold">pQueue</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085615"> </a>
Queue name.
</div><div class="pDefPara2"><a name="wp1085617"> </a>
Note: <code class="cCode">pGroup</code> and<code class="cCode"> pQueue</code> values specified to this argument controls whether the queue name is bound or unbound:
</div><div class="pDefPara2"><a name="wp1085618"> </a>
If the queue <code class="cCode">pGroup</code> and <code class="cCode">pQueue</code> are specified, this function binds it to a <code class="cCode">pName</code>. &quot;If 0 is specified, this function unbinds the <code class="cCode">pName</code> from its queue name. The calling application must be bound to pName to set it back to zero.&#8221; 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085620"> </a>
<code class="cCodeBold">name_space_list</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085621"> </a>
The <code class="cCode">name_space_list</code> argument also controls the cache access as follows:
</div><div class="pDefPara2"><a name="wp1085622"> </a>
To lookup a local queue reference or queue name, specify both <code class="cCode">OTMQ _TBL_GRP</code> and <code class="cCode">OTMQ _TBL_PROC</code>. This causes the process cache to be checked before looking into the group cache. 
</div><div class="pDefPara2"><a name="wp1085623"> </a>
To lookup a global queue reference, specify <code class="cCode">OTMQ_TBL_BUS  OTMQ _TBL_GRP</code> and <code class="cCode">OTMQ _TBL_PROC</code>. This causes the process cache to be checked. Then, the group cache is checked before looking into the global name space. 
</div><div class="pDefPara2"><a name="wp1085624"> </a>
Note that to lookup all caches in the global name space before looking in the master database, specify <code class="cCode">OTMQ _TBL_BUS_LOW</code> instead of <code class="cCode">OTMQ _TBL_BUS</code>. 
</div><div class="pDefPara2"><a name="wp1085625"> </a>
To lookup only the slower but more up-to-date caches in the global name space before looking in the master database, specify <code class="cCode">OTMQ _TBL_BUS_MEDIUM</code> instead of <code class="cCode">OTMQ _TBL_BUS</code>.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085626"> </a>
<code class="cCodeBold">name_space_list_len</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085627"> </a>
Supplies the number of entries in the <code class="cCode">name_space_list</code> argument. If the <code class="cCode">name_space_list_len</code> argument is zero, uses <code class="cCode">OTMQ_TBL_GRP</code> as the default in the <code class="cCode">name_space_list</code> argument.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085628"> </a>
<code class="cCodeBold">nFlags</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085629"> </a>
<code class="cCode">CORE_FLAGS_BOUND</code>: binds the alias to the queue name
</div><div class="pDefPara2"><a name="wp1085630"> </a>
<code class="cCode">CORE_FLAGS_CACHED</code>: cache the alias to locale share memory.
</div><div class="pDefPara2"><a name="wp1085631"> </a>
<code class="cCode">CORE_FLAGS_LOCKED</code>: lock the alias. If it is locked, it cannot be accessed.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085633"> </a>
<code class="cCodeBold">nOwnerPid</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085634"> </a>
Not used
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085635"> </a>
<code class="cCodeBold">nType</code>
</h4></div>
<div class="pDefPara2"><a name="wp1085636"> </a>
Not usedN
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1085637"> </a>
<code class="cCodeBold">cltid</code>
</h4></div>
<div class="pDefPara2"><a name="wp1123086"> </a>
 Not used.
</div><h4 class="pDefTerm"><a name="wp1123087"> </a>
scope
</h4><div class="pDefPara"><a name="wp1123088"> </a>
Specifies the scope for <code class="cCode">pName</code>. The identifier for scope:
</div>
<div class="pDefParaCont"><a name="wp1085642"> </a>
<code class="cCode">NAME_SCOPE_P</code>: scope is process
<a name="wp1085643"> </a>
<code class="cCode">NAME_SCOPE_L</code>: scope is local
<a name="wp1085644"> </a>
<code class="cCode">NAME_SCOPE_G</code>: scope is global
</div>
<div class="pDefPara"><a name="wp1085646"> </a>
For TP APIs, scope and <code class="cCode">namespace_list</code> arguments, If scope is NULL, <code class="cCode">namespace_list</code> must not NULL too, and if scope has a data value, <code class="cCode">namespace_list</code> will invalidate.
</div>
<h4 class="pDefTerm"><a name="wp1085648"> </a>
timeout 
</h4><div class="pDefPara"><a name="wp1085649"> </a>
The number of OTMQ time units (1 second intervals) to allow for the attach to complete. If a null pointer is specified, the <code class="cCode">BLOCKTIME</code> property of the group&#39;s attach service is used (configured in the UBBCONFIG <code class="cCode">*SERVICES</code> section). If service-wide <code class="cCode">BLOCKTIME</code> is not configured, system-wide BLOCKTIME specified in the UBBCONFIG <code class="cCode">*RESOURCES</code> section is used (default to approximately 60 seconds). 
</div>
<h4 class="pHeading3"><a name="wp1084987"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1086710"> </a>
Upon failure, <code class="cCode">tpqbind() </code>returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the queue alias has been successfully binded when <code class="cCode">tpqbind()</code> returns.
</p>
<p class="pBody"><a name="wp1086711"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1086712"> </a>
[TPEINVAL]
</h4><div class="pDefPara"><a name="wp1086713"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1086714"> </a>
[TPENOENT]
</h4><div class="pDefPara"><a name="wp1086715"> </a>
Cannot access the qspace because it is not available
</div>
<h4 class="pDefTerm"><a name="wp1086716"> </a>
[TPETIME]
</h4><div class="pDefPara"><a name="wp1086717"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqbind()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1086718"> </a>
 [TPEPROTO]
</h4><div class="pDefPara"><a name="wp1086719"> </a>
<code class="cCode">tpqbind()</code> was called improperly. For example, invoke <code class="cCode">tpqbind</code> without invoke <code class="cCode">tpqattach()</code> first.
</div>
<h4 class="pDefTerm"><a name="wp1086720"> </a>
[TPESYSTEM]
</h4><div class="pDefPara"><a name="wp1086721"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1086722"> </a>
[TPEOS]
</h4><div class="pDefPara"><a name="wp1086723"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075871"> </a>
tpqlocate()
</h3>
<h4 class="pHeading3"><a name="wp1075900"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075901"> </a>
<code class="cCode">tpqlocate()</code> &#8212;Locates the queue name for the specified queue name or queue alias.
</p>
<h4 class="pHeading3"><a name="wp1075902"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1087282"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">int tpqlocate (qspace, pNameCtl,  req_id, resp_q, scope, wait_mode, timeout )</code>
</p>
<h4 class="pHeading3"><a name="wp1087432"> </a>
Description
</h4>
<p class="pBody"><a name="wp1122586"> </a>
Locates the queue name for the specified queue name or queue alias. By default, this function waits for the queue name to be returned. To use <code class="cCode">tpqlocate()</code>, you must first invoke<code class="cCode"> tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1122590"> </a>
<a href="functions.html#wp1116082">Table&#160;1-5</a> lists <code class="cCode">tpqlocate()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1116294"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1116082table1116080"><caption><a name="wp1116082"> </a>
Table 1-5  tpqlocate() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1116092"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116094"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116096"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116098"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116100"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116102"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116104"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116106"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116108"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116110"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116112"> </a>
pNameCtl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116114"> </a>
pNameCtl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116116"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116118"> </a>
pNameCtl * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116120"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116122"> </a>
req_id
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116124"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116126"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116128"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116130"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116132"> </a>
resp_q
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116134"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116136"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116138"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116140"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116142"> </a>
scope
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116144"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116146"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116148"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116150"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116152"> </a>
wait_mode
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116154"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116156"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116158"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116160"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116172"> </a>
timeout
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116174"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116176"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116178"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116180"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1115786"> </a>
qspace 
</h4><div class="pDefPara"><a name="wp1088263"> </a>
Supplies the queue space whose queue name is requested. Must be same with the <code class="cCode">tpqattach()</code> qspace argument.
</div>
<h4 class="pDefTerm"><a name="wp1088264"> </a>
pNameCtl 
</h4><div class="pDefPara"><a name="wp1088265"> </a>
The Q_NAME_CTL structure is used by the application program to pass and retrieve parameters associated with bind alias to queue name
<a name="wp1088266"> </a><div class="pPreformatted"><pre>typedef struct {</pre></div><a name="wp1088267"> </a><div class="pPreformatted"><pre>   char          pName[TMQALIASLEN+1];</pre></div><a name="wp1088268"> </a><div class="pPreformatted"><pre>   char          pGroup[TMQSNAMELEN+1];</pre></div><a name="wp1088269"> </a><div class="pPreformatted"><pre>   char          pQueue[TMQNAMELEN+1];</pre></div><a name="wp1088270"> </a><div class="pPreformatted"><pre>   TM32I         nFlags;</pre></div><a name="wp1088271"> </a><div class="pPreformatted"><pre>   TM32I         nType;         /* L/G */</pre></div><a name="wp1088272"> </a><div class="pPreformatted"><pre>   TM32I         type;          /* client type */</pre></div><a name="wp1088273"> </a><div class="pPreformatted"><pre>   TM32I         nOwnerPid;     /* client pid */</pre></div><a name="wp1088274"> </a><div class="pPreformatted"><pre>   CLIENTID      cltid;</pre></div><a name="wp1088275"> </a><div class="pPreformatted"><pre>TM32I       * namespace_list;        /* for using pams interface */</pre></div><a name="wp1088276"> </a><div class="pPreformatted"><pre>   TM32I         namespace_list_len;    /* for using pams interface */</pre></div><a name="wp1088277"> </a><div class="pPreformatted"><pre>} Q_NAME_CTL;</pre></div></div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088279"> </a>
<code class="cCode">pName</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1088280"> </a>
Alias name for bind, Identifies a global queue reference or a local queue reference.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088281"> </a>
<code class="cCode">pGroup</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088282"> </a>
qspace, identifies the qspace name of the alias bind.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088283"> </a>
<code class="cCode">pQueue</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088284"> </a>
queue name, identifies the queue name of the alias bind.
</div><div class="pDefParaCont"><a name="wp1088891"> </a>
<code class="cCode">pGroup</code> and <code class="cCode">pQueue</code> values specified to this argument controls whether the queue name is bound or unbound:
</div>
<div class="pSmartList1Bullet"><ul>
<div class="pSmartList2Bullet"><ul>
<div class="pSmartList3Bullet"><ul class="SmartList3Bullet">
<li><a name="wp1088892"> </a>If the queue<code class="cCode"> pGroup</code> and <code class="cCode">pQueue</code> are specified, this function binds it to a <code class="cCode">pName</code>. </li>
<li><a name="wp1088893"> </a>If 0 is specified, this function unbinds the <code class="cCode">pName</code> from its queue name. The calling application must be bound to pName to set it back to zero. </li>
</ul></div>
</ul></div>
</ul></div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088289"> </a>
<code class="cCodeBold">name_space_list</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088290"> </a>
The <code class="cCode">name_space_list </code>argument also controls the cache access as follows:
</div><div class="pDefPara2"><a name="wp1088291"> </a>
To lookup a local queue reference or queue name, specify both OTMQ_TBL_GRP and <code class="cCode">OTMQ_TBL_PROC</code>. This causes the process cache to be checked before looking into the qspace cache. 
</div><div class="pDefPara2"><a name="wp1088292"> </a>
To lookup a global queue reference, specify <code class="cCode">OTMQ_TBL_BUS</code>, <code class="cCode">OTMQ _TBL_GRP</code> and <code class="cCode">OTMQ_TBL_PROC</code>. This causes the process cache to be checked. Then, the qspace cache is checked before looking into the global name space. 
</div><div class="pDefPara2"><a name="wp1088293"> </a>
Note: that to lookup all caches in the global name space before looking in the master database, specify<code class="cCode"> OTMQ_TBL_BUS_LOW</code> instead of<code class="cCode"> OTMQ _TBL_BUS</code>. 
</div><div class="pDefPara2"><a name="wp1088294"> </a>
To lookup only the slower but more up-to-date caches in the global name space before looking in the master database, specify<code class="cCode"> OTMQ_TBL_BUS_MEDIUM</code> instead of <code class="cCode">OTMQ_TBL_BUS</code>.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088295"> </a>
<code class="cCodeBold">name_space_list_len</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088296"> </a>
Supplies the number of entries in the <code class="cCode">name_space_list</code> argument. If the <code class="cCode">name_space_list_len</code> argument is zero, uses <code class="cCode">OTMQ_TBL_GRP</code> as the default in the <code class="cCode">name_space_lis</code>t argument.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088297"> </a>
<code class="cCodeBold">nFlags</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088298"> </a>
<code class="cCode">CORE_FLAGS_BOUND</code>: binds the alias to the queue name
</div><div class="pDefPara2"><a name="wp1088299"> </a>
<code class="cCode">CORE_FLAGS_CACHED</code>: cache the alias to locale share memory.
</div><div class="pDefPara2"><a name="wp1088300"> </a>
<code class="cCode">CORE_FLAGS_LOCKED</code>: lock the alias.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088301"> </a>
<code class="cCodeBold">nOwnerPid</code>
</h4></div>
<div class="pDefPara2"><a name="wp1089029"> </a>
 Reserved for future use
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1089030"> </a>
<code class="cCodeBold">nType</code>
</h4></div>
<div class="pDefPara2"><a name="wp1089031"> </a>
Reserved for future use 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1088305"> </a>
<code class="cCodeBold">cltid</code>
</h4></div>
<div class="pDefPara2"><a name="wp1088306"> </a>
Reserved for future use
</div><h4 class="pDefTerm"><a name="wp1088307"> </a>
wait_mode 
</h4><div class="pDefPara"><a name="wp1088308"> </a>
Supplies the search mode of the tpqlocate function. The mode indicates whether the application waits for the search completion or receives the response in an acknowledgment message. There are two predefined constants for this argument:
</div>
<div class="pSmartList1Bullet"><ul>
<div class="pSmartList2Bullet"><ul>
<div class="pSmartList3Bullet"><ul class="SmartList3Bullet">
<li><a name="wp1088309"> </a>&quot;<code class="cCode">OTMQ_WF_RESP</code> (default setting)-The application issues the tpqlocate request and waits for the queue name to be returned. </li>
<li><a name="wp1088310"> </a><code class="cCode">&quot;OTMQ_AK_RESP</code>-The application issues the <code class="cCode">tpqlocate</code> name and continues processing. When the search is completed, the queue name is returned to the application&#39;s primary queue in a <code class="cCode">LOCATE_Q_REP</code> message. The response message can be redirected to an alternate queue name using the <code class="cCode">resp_q</code> argument, The details of <code class="cCode">LOCATE_Q_REP</code> message as next.</li>
</ul></div>
</ul></div>
</ul></div>
<h4 class="pDefTerm"><a name="wp1088312"> </a>
req_id 
</h4><div class="pDefPara"><a name="wp1088313"> </a>
Supplies an application-specified transaction ID to associate with the <code class="cCode">tpqlocate</code> function.
</div>
<h4 class="pDefTerm"><a name="wp1088314"> </a>
resp_q 
</h4><div class="pDefPara"><a name="wp1088315"> </a>
Supplies an alternate queue to use for receiving the acknowledgment message of the queue name. If no response queue is specified, the acknowledgment message is sent to the sender program primary queue. 
</div>
<div class="pDefParaCont"><a name="wp1088316"> </a>
Note: the sender program cannot specify a response queue outside its qspace.
<a name="wp1088318"> </a>
The<code class="cCode"> name_space_list</code> argument also controls the cache access as follows:
<a name="wp1088319"> </a>
To lookup a local queue reference or queue name, specify both <code class="cCode">OTMQ _TBL_GRP</code> and <code class="cCode">OTMQ_TBL_PROC</code>. This causes the process cache to be checked before looking into the group cache. 
<a name="wp1088320"> </a>
To lookup a global queue reference, specify <code class="cCode">OTMQ_TBL_BUS</code> (or <code class="cCode">OTMQ _TBL_BUS_LOW</code> or <code class="cCode">OTMQ _TBL_BUS_MEDIUM</code>), <code class="cCode">OTMQ _TBL_GRP</code> and <code class="cCode">OTMQ _TBL_PROC</code>. This causes the process cache to be checked. Then, the group cache is checked before looking into the global name space. 
<a name="wp1088321"> </a>
Note that to lookup all caches in the global name space before looking in the master database, specify <code class="cCode">OTMQ _TBL_BUS_LOW</code> instead of <code class="cCode">OTMQ _TBL_BUS</code>. 
<a name="wp1088322"> </a>
To lookup only the slower but more up-to-date caches in the global name space before looking in the master database, specify <code class="cCode">OTMQ _TBL_BUS_MEDIUM</code> instead of <code class="cCode">OTMQ _TBL_BUS</code>.
<a name="wp1088323"> </a>
<code class="cCode">name_space_list_len</code>:
<a name="wp1089181"> </a>
Supplies the number of entries in the <code class="cCode">name_space_list</code> argument. If the <code class="cCode">name_space_list_len</code> argument is zero, uses <code class="cCode">OTMQ_TBL_GRP</code> as the default in the <code class="cCode">name_space_list</code> argument.
</div>
<h4 class="pDefTerm"><a name="wp1089182"> </a>
scope 
</h4><div class="pDefPara"><a name="wp1089183"> </a>
Specifies the scope for <code class="cCode">pName</code>.
</div>
<div class="pDefParaCont"><a name="wp1088328"> </a>
The identifies for scope:
<a name="wp1088329"> </a>
<code class="cCode">NAME_SCOPE_P</code>: scope is process
<a name="wp1088330"> </a>
<code class="cCode">NAME_SCOPE_L</code>: scope is local
<a name="wp1088331"> </a>
<code class="cCode">NAME_SCOPE_G</code>: scope is global
<a name="wp1088333"> </a>
For TP APIs <code class="cCode">scope</code> and <code class="cCode">namespace_list</code> arguments, if scope is NULL, <code class="cCode">namespace_list</code> must not NULL too, and if scope has a data value, <code class="cCode">namespace_lis</code>t will invalidate.
</div>
<h4 class="pDefTerm"><a name="wp1088335"> </a>
timeout 
</h4><div class="pDefPara"><a name="wp1088336"> </a>
The number of OTMQ time units (1 second intervals) to allow for the attach to complete. If a null pointer is specified, the <code class="cCode">BLOCKTIME</code> property of the group&#39;s attach service is used (configured in the UBBCONFIG <code class="cCode">*SERVICES</code> section). If service-wide <code class="cCode">BLOCKTIME</code> is not configured, system-wide <code class="cCode">BLOCKTIME</code> specified in the UBBCONFIG <code class="cCode">*RESOURCES</code> section is used (default to approximately 60 seconds). 
</div>
<h4 class="pHeading3"><a name="wp1087839"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1089370"> </a>
Upon failure, <code class="cCode">tpqlocate()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the queue has been successfully located when <code class="cCode">tpqlocate ()</code> returns.
</p>
<p class="pBody"><a name="wp1089371"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1089372"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1089373"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1089374"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1089375"> </a>
Cannot access the qspace because it is not available
</div>
<h4 class="pDefTerm"><a name="wp1089376"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1089377"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqlocate()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1089406"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1089407"> </a>
<code class="cCode">tpqlocate()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1089408"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1089409"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1089410"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1089411"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075897"> </a>
tpenqplus()
</h3>
<h4 class="pHeading3"><a name="wp1075923"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075924"> </a>
<code class="cCode">tpenqplus()</code> &#8212;Locates the queue name for the specified queue name or queue alias.
</p>
<h4 class="pHeading3"><a name="wp1075925"> </a>
Synopsis
</h4>
<a name="wp1075926"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpenqplus (qspace, qname, ctl, data, len, flags)</pre></div><h4 class="pHeading3"><a name="wp1075927"> </a>
Description
</h4>
<p class="pBody"><a name="wp1089955"> </a>
Sends a message to a target queue in target qspace using a set of standard OTMQ delivery modes. 
</p>
<p class="pBody"><a name="wp1089956"> </a>
The block and DIP argument of the TPQCTL struct can be used to guarantee message delivery if a system, process, or network fails. Recoverable messages are stored on disk by the message recovery system until they can be delivered to the target queue of the receiver program. When sending a recoverable message, you must specify the uma argument of TPQCTL structure if the message recovery cannot store the message. You must also supply the TPQCTL structure PSB argument to receive the operation return status.
</p>
<p class="pBody"><a name="wp1131131"> </a>
The optional timeout argument lets you set a maximum amount of time for the send operation to complete before the function times out. The optional replyqueue of TPQCTL struct argument allows you to specify an alternate queue for receiving the response messages rather than directing responses to the primary queue of the sender program. In synchronous mode, fail to receive response message from reply queue will cause tpenqplus() return error, but the message may be still sent to target queue successfully.
</p>
<p class="pBody"><a name="wp1089958"> </a>
To use OTMQ features, you must invoke <code class="cCode">tpqattach</code> before invoke <code class="cCode">tpenqplus</code>. And the <code class="cCode">qspace</code> argument of <code class="cCode">tpenqplus</code> must same with the <code class="cCode">qspace</code> argument of <code class="cCode">tpqattach</code>.
</p>
<p class="pBody"><a name="wp1089959"> </a>
If the caller is within a transaction and the <code class="cCode">TPNOTRAN</code> flag is not set, the message is queued in transaction mode. This has the effect that if <code class="cCode">tpenqplus()</code> returns successfully and the caller transaction is committed successfully, then the message is guaranteed to be available subsequent to the transaction completing. If the caller transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be removed from the queue (that is, the placing of the message on the queue is also rolled back). It is not possible to enqueue then dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp1128151"> </a>
The message is not queued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. Once <code class="cCode">tpenqplus()</code> returns successfully, the submitted message is guaranteed to be in the queue. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully stored on the queue.
</p>
<p class="pBody"><a name="wp1128152"> </a>
To use <code class="cCode">tpenqplus()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1128156"> </a>
<a href="functions.html#wp1116722">Table&#160;1-6</a> lists <code class="cCode">tpenqplus()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1116606"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1116722table1116720"><caption><a name="wp1116722"> </a>
Table 1-6  tpenqplus() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1116732"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116734"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116736"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116738"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116740"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116742"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116744"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116746"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116748"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116750"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116752"> </a>
qname
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116754"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116756"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116758"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116760"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116762"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116764"> </a>
TPQCTL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116766"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116768"> </a>
TPQCTL *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116770"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116772"> </a>
data
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116774"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116776"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116778"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116780"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116782"> </a>
len
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116784"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116786"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116788"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116790"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116792"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116794"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116796"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116798"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116800"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1090025"> </a>
<code class="cCodeBold">qspace</code> 
</h4><div class="pDefPara"><a name="wp1090026"> </a>
Supplies the queue space name for enqueueing the message. The max length is 15
</div>
<h4 class="pDefTerm"><a name="wp1090028"> </a>
<code class="cCodeBold">qname</code> 
</h4><div class="pDefPara"><a name="wp1090029"> </a>
Supplies the queue name for enqueueing the message, the max length is 127
</div>
<h4 class="pDefTerm"><a name="wp1090031"> </a>
<code class="cCodeBold">Control Parameter</code>
</h4><div class="pDefPara"><a name="wp1090033"> </a>
The TPQCTL structure is used by the application program to pass and retrieve parameters associated with enqueuing the message. The flags element of TPQCTL is used to indicate what other elements in the structure are valid.
</div>
<div class="pDefParaCont"><a name="wp1090034"> </a>
On input to <code class="cCode">tpenqplus()</code>, the following elements may be set in the TPQCTL structure:
<a name="wp1090036"> </a>
The element of TPQCTL used for OTMQ:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090037"> </a>
<code class="cCodeBold">flags</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090038"> </a>
The following is a list of valid bits for the flags parameter controlling input information for <code class="cCode">tpenqplus()</code>.
</div><div class="pDefPara2"><a name="wp1090039"> </a>
<code class="cCodeBold">TPNOFLAGS</code>
</div><div class="pDefPara2"><a name="wp1090040"> </a>
<code class="cCodeBold">TPQTOPI</code>
</div><div class="pDefPara2"><a name="wp1090041"> </a>
<code class="cCodeBold">TPQBEFOREMSGID</code>
</div><div class="pDefPara2"><a name="wp1090042"> </a>
<code class="cCodeBold">TPQTIME_ABS</code>
</div><div class="pDefPara2"><a name="wp1090043"> </a>
<code class="cCodeBold">TPQTIME_REL</code>
</div><div class="pDefPara2"><a name="wp1090044"> </a>
<code class="cCodeBold">TPQPRIORITY</code>
</div><div class="pDefPara2"><a name="wp1090045"> </a>
<code class="cCodeBold">TPQCORRID</code>
</div><div class="pDefPara2"><a name="wp1090046"> </a>
<code class="cCodeBold">TPQREPLYQ</code>
</div><div class="pDefPara2"><a name="wp1090047"> </a>
<code class="cCodeBold">TPQFAILUREQ</code>
</div><div class="pDefPara2"><a name="wp1090048"> </a>
<code class="cCodeBold">TPQDELIVERYQOS, TPQREPLYQOS</code>
</div><div class="pDefPara2"><a name="wp1090049"> </a>
<code class="cCodeBold">TPQEXPTIME_ABS</code>
</div><div class="pDefPara2"><a name="wp1090050"> </a>
<code class="cCodeBold">TPQEXPTIME_REL</code>
</div><div class="pDefPara2"><a name="wp1090051"> </a>
<code class="cCodeBold">TPQEXPTIME_NONE</code>
</div><div class="pDefPara2"><a name="wp1090052"> </a>
<code class="cCodeBold">TPQMSGID</code>
</div><div class="pDefPara2"><a name="wp1090053"> </a>
<code class="cCodeBold">OTMQ</code>
</div><div class="pDefPara2"><a name="wp1090054"> </a>
<code class="cCodeBold">TPQGETBYFILTER</code>
</div><div class="pDefPara2"><a name="wp1090055"> </a>
<code class="cCodeBold">TPQGETMSGA</code>
</div><div class="pDefPara2"><a name="wp1090056"> </a>
<code class="cCodeBold">TPQREADJRN</code>
</div><div class="pDefPara2"><a name="wp1090057"> </a>
<code class="cCodeBold">TPQENDIAN</code>
</div><div class="pDefPara2"><a name="wp1090058"> </a>
<code class="cCodeBold">TPQGETBYSEQNUM</code>
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090060"> </a>
<code class="cCodeBold">priority </code>
</h4></div>
<div class="pDefPara2"><a name="wp1090061"> </a>
Supplies the priority level for selective message reception. Priority ranges from 0 (lowest priority) to 99 (highest priority).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090062"> </a>
<b class="cBold">msg_class </b>
</h4></div>
<div class="pDefPara2"><a name="wp1090063"> </a>
Supplies the class code of message being sent. OTMQ supports the use of symbolic names for class argument values. Symbolic class names should begin with <code class="cCode">MSG_CLAS_</code>. For information on defining class symbols, see the tmqsym.h include file. On UNIX and Windows NT systems, the tmqsym.h include file cannot be edited. You must create an include file to define type and class symbols for use by your application.
</div><div class="pDefPara2"><a name="wp1090064"> </a>
Class symbols reserved by OTMQ are as follows:
</div><div class="pDefPara2"><a name="wp1090065"> </a>
<code class="cCode">Reserved Class 	Symbol Value</code>
</div><div class="pDefPara2"><a name="wp1090066"> </a>
<code class="cCode">MSG_CLAS_XXX 	30000 through 32767 (except 31001-31003)</code>
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090067"> </a>
<code class="cCodeBold">msg_type</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1090068"> </a>
Supplies the type code for the message being sent. OTMQ supports the use of symbolic names for <code class="cCode">msg_type</code> argument values. Symbolic type names begin with <code class="cCode">MSG_TYPE_</code>. For information on defining type symbols, see the <code class="cCode">tmqsym.h</code> include file.
</div><div class="pDefPara2"><a name="wp1090069"> </a>
OTMQ has reserved the symbol value range -1 through -5000. A zero value for this argument indicates that no processing by message type is expected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090070"> </a>
<code class="cCodeBold">block</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090071"> </a>
Supplies the delivery mode for the message using the following format:
</div><div class="pDefPara2"><a name="wp1090072"> </a>
<code class="cCode">OTMQ_DEL_sn</code>-where sn is one of the following sender notification constants: 
</div><div class="pDefPara2"><a name="wp1090073"> </a>
WF-Wait for completion.
</div><div class="pDefPara2"><a name="wp1090074"> </a>
AK-Asynchronous acknowledgment 
</div><div class="pDefPara2"><a name="wp1090075"> </a>
NN-No notification 
</div><div class="pDefPara2"><a name="wp1090076"> </a>
Note: NN mode does not support transaction, TPNOTRAN flag is set automatically for this mode.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090077"> </a>
<code class="cCodeBold">DIP</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090078"> </a>
Dip is one of the following delivery interest point constants:
</div><div class="pDefPara2"><a name="wp1090079"> </a>
&quot;ACK-Read from target queue and explicitly acknowledged using the <code class="cCode">tpqconfirmmsg</code> function. ACK can also be an implicit acknowledgement sent after the second <code class="cCode">tpdeqplus</code> call by the receiving application. 
</div><div class="pDefPara2"><a name="wp1090080"> </a>
&quot;CONF-Delivered from the DQF and explicitly confirmed using the <code class="cCode">tpqconfirmmsg</code> function (recoverable) 
</div><div class="pDefPara2"><a name="wp1090081"> </a>
&quot;DEQ-Read from the target queue 
</div><div class="pDefPara2"><a name="wp1090082"> </a>
&quot;DQF-Stored in the destination queue file (recoverable) 
</div><div class="pDefPara2"><a name="wp1090083"> </a>
&quot;MEM-Stored in the target queue 
</div><div class="pDefPara2"><a name="wp1090084"> </a>
&quot;SAF-Stored in the store and forward file (recoverable) 
</div><div class="pDefPara2"><a name="wp1090085"> </a>
Note: If temporary queues are used, deleted, and reused quickly, it is possible in isolated cases for an implicit ACK response from a previous temporary queue to be placed on the new temporary queue.
</div><div class="pDefPara2"><a name="wp1090086"> </a>
If you set <code class="cCode">OTMQ_DEL_WF</code> and <code class="cCode">OTMQ_DIP_ACK</code>, the ACK message will be read in <code class="cCode">tpenqplus</code>, client do not need to call another API to read the ACK message.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090087"> </a>
<code class="cCodeBold">timeout</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1090088"> </a>
Supplies the maximum amount of time the <code class="cCode">tpenqplus</code> function waits for a message to arrive before returning control to the application. If the timeout occurs before a message arrives, the status code <code class="cCode">OTMQ__TIMEOUT</code> is returned. Specifying 0 as the timeout value sets the timeout to the default value of 30 seconds.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090089"> </a>
<code class="cCodeBold">psb</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1090090"> </a>
Receives a value in the OTMQ Status Block specifying the final completion status. The <code class="cCode">psb</code> argument is used when sending or receiving recoverable messages. The PSB structure stores the status information from the message recovery system and may be checked after sending or receiving a message as shown in <a href="functions.html#wp1128173">Listing&#160;1-3</a>.
</div><div class="pCodeTitle"><a name="wp1128173"> </a>
Listing&#160;1-3	   PSB Structure
</div> <a name="wp1128174"> </a><div class="pPreformatted"><pre>struct psb_t {</pre></div><a name="wp1128175"> </a><div class="pPreformatted"><pre>	long type_of_psb;             /* PSB type */<br />	long del_psb_status;        /* The completion status of the function. It contains the status from TuxMsgQ. It can also contain a value of TPSUCCESS when the message is not sent recoverably. */<br />	long uma_psb_status;      /* The completion status of the undeliverable message action (UMA). The PSB UMA status indicates if the UMA was not executed or applicable. */<br />	l<br /></pre></div><a name="wp1128180"> </a><div class="pPreformatted"><pre>typedef struct psb_t PSB;<br />Note: this structure is already defined at atmi.h.</pre></div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090132"> </a>
<code class="cCodeBold">uma </code>
</h4></div>
<div class="pDefPara2"><a name="wp1090133"> </a>
Supplies the action to be performed if the message cannot be stored at the specified -delivery interest point. The format of this argument is <code class="cCode">OTMQ_UMA_XXX</code> where <code class="cCode">XXX</code> is one of the following symbols:
</div><div class="pDefPara2"><a name="wp1090134"> </a>
Symbol: &#160;&#160;&#160;&#160;&#160;&#160;&#160;Description
</div><div class="pDefPara2"><a name="wp1090135"> </a>
DISC: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Discard message
</div><div class="pDefPara2"><a name="wp1090136"> </a>
RTS: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Return to sender
</div><div class="pDefPara2"><a name="wp1090137"> </a>
SAF: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Store and Forward
</div><div class="pDefPara2"><a name="wp1090138"> </a>
DLJ: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dead letter journal
</div><div class="pDefPara2"><a name="wp1090139"> </a>
DLQ: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dead letter queue
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090140"> </a>
<code class="cCodeBold">replyqueue</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090141"> </a>
Supplies a <code class="cCode">q_name</code> to use as the alternate queue for receiving response messages from the receiver program. The sender program must be attached to the queue specified in the <code class="cCode">replyqueue</code> argument to receive the response messages. To use <code class="cCode">replyqueue</code>, flags must address <code class="cCode">TPQREPLYQ</code>.
</div><div class="pDefPara2"><a name="wp1090142"> </a>
Note the sender program cannot assign a response queue outside its qspace.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090143"> </a>
<code class="cCodeBold">correlation_id </code>
</h4></div>
<div class="pDefPara2"><a name="wp1090144"> </a>
Supplies the correlation id, a user-defined identifier stored as a 32-byte value 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090146"> </a>
seq_number 
</h4></div>
<div class="pDefPara2"><a name="wp1131271"> </a>
If the value of  seq_number[0] or seq_number[1] is not specified as &quot;(long)0&quot;, OTMQ will not generate unique number for this message.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1131248"> </a>
<code class="cCodeBold">Data</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090148"> </a>
If data is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and len should specify the amount of data in the buffer that should be queued. Note that if data points to a buffer of a type that does not require a length to be specified (for example, an FML fielded buffer), then len is ignored. If data is NULL, len is ignored and a message is queued with no data portion. Consult <code class="cCode">tpalloc()</code> for more details.
</div><h4 class="pDefTerm"><a name="wp1090150"> </a>
<code class="cCodeBold">Len</code>
</h4><div class="pDefPara"><a name="wp1090151"> </a>
 The length of data, if data is non-NULL.
</div>
<h4 class="pDefTerm"><a name="wp1090153"> </a>
<code class="cCodeBold">Flags</code>
</h4><div class="pDefPara"><a name="wp1090154"> </a>
The following is a list of valid flags:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090156"> </a>
<code class="cCodeBold">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090157"> </a>
If the caller is in transaction mode and this flag is set, the message is not queued within the caller transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when queuing the message. If message queuing fails, the caller&#39;s transaction is not affected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090159"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090160"> </a>
The message is not enqueued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened exclusively by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the TPQCTL structure is set to <code class="cCode">QMESHARE</code>.
</div><div class="pDefPara2"><a name="wp1090161"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). If a timeout occurs, the call fails and <code class="cCode">tperrno</code> is set to TPETIME.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090163"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090164"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1090166"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1090167"> </a>
If this flag is set and a signal interrupts any underlying system calls, the interrupted system call is reissued. If <code class="cCode">TPSIGRSTRT</code> is not set and a signal interrupts a system call, <code class="cCode">tpenqplus()</code> fails and tperrno is set to <code class="cCode">TPGOTSIG</code>.
</div><h4 class="pHeading3"><a name="wp1079014"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1092104"> </a>
Upon failure, <code class="cCode">tpenqplus() </code>returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the message has been successfully enque when <code class="cCode">tpenqplus()</code> returns.
</p>
<p class="pBody"><a name="wp1092105"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1092106"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1092107"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1092108"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1092109"> </a>
Cannot access the qspace because it is not available
</div>
<h4 class="pDefTerm"><a name="wp1092110"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1092111"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpenqplus()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1092112"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1092113"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1092114"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1092115"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1092116"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1092117"> </a>
<code class="cCode">tpenqplus()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1092118"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1092119"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1092120"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1092121"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1092122"> </a>
<code class="cCodeBold">[TPEDIAGNOSTIC]</code>
</h4><div class="pDefPara"><a name="wp1092123"> </a>
Enqueuing a message on the specified queue failed. The reason for failure can be determined by the diagnostic returned via ctl.
</div>
<div class="pDefParaCont"><a name="wp1092124"> </a>
Diagnostic:
</div>
<h4 class="pDefTerm"><a name="wp1092125"> </a>
<code class="cCodeBold">[QMEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1092126"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1092127"> </a>
<code class="cCodeBold">[QMEBADRMID]</code>
</h4><div class="pDefPara"><a name="wp1092128"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1092129"> </a>
<code class="cCodeBold">[QMENOTOPEN]</code>
</h4><div class="pDefPara"><a name="wp1092130"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1092131"> </a>
<code class="cCodeBold">[QMETRAN]</code>
</h4><div class="pDefPara"><a name="wp1092132"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> flag set and an error occurred trying to start a transaction in which to enqueue the message. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1092133"> </a>
<code class="cCodeBold">[QMEBADMSGID]</code>
</h4><div class="pDefPara"><a name="wp1092134"> </a>
An invalid message identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1092135"> </a>
<code class="cCodeBold">[QMESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1092136"> </a>
A system error occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1092137"> </a>
<code class="cCodeBold">[QMEOS]</code>
</h4><div class="pDefPara"><a name="wp1092138"> </a>
An operating system error occurred.
</div>
<h4 class="pDefTerm"><a name="wp1092139"> </a>
<code class="cCodeBold">[QMEABORTED]</code>
</h4><div class="pDefPara"><a name="wp1092140"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1092141"> </a>
<code class="cCodeBold">[QMEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1092142"> </a>
An enqueue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1092143"> </a>
<code class="cCodeBold">[QMEBADQUEUE]</code>
</h4><div class="pDefPara"><a name="wp1092144"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1092145"> </a>
<code class="cCodeBold">[QMENOSPACE]</code>
</h4><div class="pDefPara"><a name="wp1092146"> </a>
Due to an insufficient resource, such as no space on the queue, the message with its required quality of service (persistent or non-persistent storage) was not enqueued. 
</div>
<h4 class="pDefTerm"><a name="wp1092147"> </a>
<code class="cCodeBold">[QMERELEASE]</code>
</h4><div class="pDefPara"><a name="wp1092148"> </a>
An attempt was made to enqueue a message to a queue manager that is from a version of the Oracle Tuxedo system that does not support a newer feature.
</div>
<h4 class="pDefTerm"><a name="wp1092149"> </a>
<code class="cCodeBold">[QMBADDELIVERY]</code>
</h4><div class="pDefPara"><a name="wp1092150"> </a>
Invalid delivery mode.
</div>
<h4 class="pDefTerm"><a name="wp1092151"> </a>
<code class="cCodeBold">[QMBADPRIORITY]</code>
</h4><div class="pDefPara"><a name="wp1092152"> </a>
Invalid priority value on send operation.
</div>
<h4 class="pDefTerm"><a name="wp1092153"> </a>
<code class="cCodeBold">[QMBADPROCNUM]</code>
</h4><div class="pDefPara"><a name="wp1092154"> </a>
Invalid target queue name specified.
</div>
<h4 class="pDefTerm"><a name="wp1092155"> </a>
<code class="cCodeBold">[QMBADRESPQ]</code>
</h4><div class="pDefPara"><a name="wp1092156"> </a>
Response queue not owned by process.
</div>
<h4 class="pDefTerm"><a name="wp1092157"> </a>
<code class="cCodeBold">[QMBADUMA]</code>
</h4><div class="pDefPara"><a name="wp1092158"> </a>
Undeliverable message action (UMA) is invalid.
</div>
<h4 class="pDefTerm"><a name="wp1092159"> </a>
<code class="cCodeBold">[QMNOTSUPPORTED]</code>
</h4><div class="pDefPara"><a name="wp1092160"> </a>
The combination of delivery mode and uma selected is not supported.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075920"> </a>
tpdeqplus()
</h3>
<h4 class="pHeading3"><a name="wp1075946"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075947"> </a>
<code class="cCode">tpdeqplus()</code>&#8212;Retrieves the next available message from a selected queue and moves it to the location specified in the data argument. 
</p>
<h4 class="pHeading3"><a name="wp1075948"> </a>
Synopsis
</h4>
<a name="wp1075949"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpdeqplus (qspace, qname, ctl, data, len, flags)</pre></div><h4 class="pHeading3"><a name="wp1075950"> </a>
Description
</h4>
<p class="pBody"><a name="wp1093176"> </a>
Retrieves the next available message from a selected queue and moves it to the location specified in the data argument. When no selection filter is specified, the function returns the next available message in first-in/first-out (FIFO) order based on message priority to the buffer specified in the data argument. Priority ranges from 0 (lowest priority) to 99 (highest priority). For example, priority 1 messages are always placed before priority 0 messages. Messages are placed in first-in/first out order by message priority. If a selection filter is specified, then only messages that meet the selection criteria are retrieved. If no messages are available or meet the selection criteria, then the return status is <code class="cCode">QMENOMSG</code>.
</p>
<p class="pBody"><a name="wp1093177"> </a>
Applications should check the PSB status field of each message to determine if the message was sent with a recoverable delivery mode. If an application receives a recoverable message, it must call the <code class="cCode">tpqconfirmmsg</code> function to delete it from the message recovery journal disk storage. If receipt of a recoverable message is not confirmed, the message continues to be stored by the recovery system and will be re-delivered if the application detaches and then reattaches to the queue.
</p>
<p class="pBody"><a name="wp1093178"> </a>
To use<code class="cCode"> tpdepplus()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1093248"> </a>
<a href="functions.html#wp1116879">Table&#160;1-7</a> lists <code class="cCode">tpdepplus()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1116974"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1116879table1116877"><caption><a name="wp1116879"> </a>
Table 1-7  tpdepplus() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1116889"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116891"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116893"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116895"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1116897"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116899"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116901"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116903"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116905"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116907"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116909"> </a>
qname
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116911"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116913"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116915"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116917"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116919"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116921"> </a>
TPQCTL 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116923"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116925"> </a>
TPQCTL * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116927"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116929"> </a>
data
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116931"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116933"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116935"> </a>
char * *
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116937"> </a>
returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116939"> </a>
len
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116941"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116943"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116945"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116947"> </a>
returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116949"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116951"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116953"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116955"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1116957"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1093268"> </a>
<code class="cCodeBold">qspace</code> 
</h4><div class="pDefPara"><a name="wp1093269"> </a>
Supplies the queue space name for enqueue the message. The max length is 15
</div>
<h4 class="pDefTerm"><a name="wp1093270"> </a>
<code class="cCodeBold">qname</code> 
</h4><div class="pDefPara"><a name="wp1093271"> </a>
Supplies the queue name for enqueue the message, the max length is 127
</div>
<h4 class="pDefTerm"><a name="wp1093272"> </a>
<code class="cCodeBold">Data</code>
</h4><div class="pDefPara"><a name="wp1093273"> </a>
Data is the address of a pointer to the buffer into which a message is read, and len points to the length of that message. *data must point to a buffer originally allocated by <code class="cCode">tpalloc()</code>. If a message is larger than the buffer passed to <code class="cCode">tpdeqplus</code>, the buffer is increased in size to accommodate the message. To determine whether a message buffer changed in size, compare its (total) size before <code class="cCode">tpdeqplus()</code> was issued with <code class="cCode">*len</code>. If <code class="cCode">*len</code> is larger, then the buffer has grown; otherwise, the buffer has not changed size. Note that <code class="cCode">*data</code> may change for reasons other than if the buffer size increased. If <code class="cCode">*len</code> is 0 upon return, then the message dequeued has no data portion and neither <code class="cCode">*data</code> nor the buffer it points to were modified. It is an error for *data or len to be NULL. Consult <code class="cCode">tpalloc()</code> for more details.
<a name="wp1093275"> </a>
The message is dequeued in transaction mode if the caller is in transaction mode and the <code class="cCode">TPNOTRAN</code> flag is not set. This has the effect that if <code class="cCode">tpdeqplus()</code> returns successfully and the caller transaction is committed successfully, then the message is removed from the queue. If the caller&#39;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be left on the queue (that is, the removal of the message from the queue is also rolled back). It is not possible to enqueue and dequeue the same message within the same transaction.
<a name="wp1093277"> </a>
The message is not dequeued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully dequeued and the message may be lost.
</div>
<h4 class="pDefTerm"><a name="wp1093279"> </a>
<code class="cCodeBold">Len</code>
</h4><div class="pDefPara"><a name="wp1093280"> </a>
 The length of data, if data is non-NULL.
</div>
<h4 class="pDefTerm"><a name="wp1093282"> </a>
<code class="cCodeBold">ctrl</code>
</h4><div class="pDefPara"><a name="wp1093283"> </a>
The TPQCTL structure .
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1093717"> </a>
<code class="cCodeBold">flags</code>
</h4></div>
<div class="pDefPara2"><a name="wp1093718"> </a>
The following is a list of valid bits for the flags parameter controlling input information for <code class="cCode">tpdeqplus()</code>.
</div><div class="pDefPara2"><a name="wp1093719"> </a>
<code class="cCodeBold">TPNOFLAGS</code>
</div><div class="pDefPara2"><a name="wp1093720"> </a>
<code class="cCodeBold">TPQGETBYMSGID</code>
</div><div class="pDefPara2"><a name="wp1093721"> </a>
<code class="cCodeBold">TPQGETBYCORRID</code>
</div><div class="pDefPara2"><a name="wp1093722"> </a>
<code class="cCodeBold">TPQWAIT</code>
</div><div class="pDefPara2"><a name="wp1093723"> </a>
<code class="cCodeBold">TPQPEEK</code>
</div><div class="pDefPara2"><a name="wp1093724"> </a>
<code class="cCodeBold">OTMQ</code>
</div><div class="pDefPara2"><a name="wp1093725"> </a>
<code class="cCodeBold">TPQGETBYFILTER</code>
</div><div class="pDefPara2"><a name="wp1093726"> </a>
<code class="cCodeBold">TPQGETMSGA</code>
</div><div class="pDefPara2"><a name="wp1093727"> </a>
<code class="cCodeBold">TPQREADJRN</code>
</div><div class="pDefPara2"><a name="wp1093728"> </a>
<code class="cCodeBold">TPQENDIAN</code>
</div><div class="pDefPara2"><a name="wp1093729"> </a>
<code class="cCodeBold">TPQGETBYSEQNUM</code>
</div><div class="pDefPara2"><a name="wp1093730"> </a>
<code class="cCodeBold">TPQGETBYMSGCLASS</code>
</div><div class="pDefPara2"><a name="wp1093731"> </a>
<code class="cCodeBold">TPQGETBYMSGTYPE</code>
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1093734"> </a>
<code class="cCodeBold">priority</code>
</h4></div>
<div class="pDefPara2"><a name="wp1093735"> </a>
Supplies the priority level for selective message reception. Priority ranges from 0 (lowest priority) to 99 (highest priority).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1093738"> </a>
<code class="cCodeBold">msg_class</code>
</h4></div>
<div class="pDefPara2"><a name="wp1093739"> </a>
Supplies the class code of message being sent. OTMQ supports the use of symbolic names for class argument values. Symbolic class names should begin with <code class="cCode">MSG_CLAS_</code>. For information on defining class symbols, see the tmqsym.h include file. On UNIX and Windows NT systems, the tmqsym.h include file cannot be edited. You must create an include file to define type and class symbols for use by your application.
</div><div class="pDefPara2"><a name="wp1093740"> </a>
Class symbols reserved by OTMQ are as follows:
</div><div class="pDefPara2"><a name="wp1094063"> </a>
<span style="font-weight: bold">Reserved Class</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="font-weight: bold">Symbol Value</span>
</div><div class="pDefPara2"><a name="wp1096486"> </a>
<code class="cCode">ACK_CLASS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;28</code>
</div><div class="pDefPara2"><a name="wp1096487"> </a>
<code class="cCode">MSG_CLAS_PAMS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;29</code>
</div><div class="pDefPara2"><a name="wp1096488"> </a>
<code class="cCode">TUXEDO_MSG&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;31001</code>
</div><div class="pDefPara2"><a name="wp1096489"> </a>
<code class="cCode">MSG_CLAS_TUXEDO_TPSUCCESS&#160;&#160;&#160;&#160;31002</code>
</div><div class="pDefPara2"><a name="wp1096490"> </a>
<code class="cCode">MSG_CLAS_TUXEDO_TPFAIL&#160;&#160;&#160;&#160;&#160;&#160;&#160;31003</code>
</div><div class="pDefPara2"><a name="wp1096484"> </a>
<code class="cCode">MSG_CLAS_XXX &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;30000 through 32767<br />(except 31001-31003)</code>
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094200"> </a>
<code class="cCodeBold">msg_type</code>
</h4></div>
<div class="pDefPara2"><a name="wp1094201"> </a>
Supplies the type code for the message being sent. OTMQ supports the use of symbolic names for <code class="cCode">msg_type</code> argument values. Symbolic type names begin with <code class="cCode">MSG_TYPE_</code>. For information on defining type symbols, see the <code class="cCode">tmqsym.h</code> include file.
</div><div class="pDefPara2"><a name="wp1094202"> </a>
OTMQ has reserved the symbol value range -1 through -5000. A zero value for this argument indicates that no processing by message type is expected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094203"> </a>
<code class="cCodeBold">block</code>
</h4></div>
<div class="pDefPara2"><a name="wp1094204"> </a>
Supplies the delivery mode for the message using the following format:
</div><div class="pDefPara2"><a name="wp1094205"> </a>
&quot;OTMQ_DEL_sn-where sn is one of the following sender notification constants: 
</div><div class="pDefPara2"><a name="wp1094206"> </a>
&quot;WF-Wait for completion 
</div><div class="pDefPara2"><a name="wp1094207"> </a>
&quot;AK-Asynchronous acknowledgment 
</div><div class="pDefPara2"><a name="wp1094208"> </a>
&quot;NN-No notification 
</div><div class="pDefPara2"><a name="wp1094209"> </a>
Note: NN mode does not support transaction, <code class="cCode">TPNOTRAN</code> flag is set automatically for this mode.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094210"> </a>
<code class="cCodeBold">DIP</code>
</h4></div>
<div class="pDefPara2"><a name="wp1094211"> </a>
Dip is one of the following delivery interest point constants:
</div><div class="pDefPara2"><a name="wp1094212"> </a>
&quot;ACK-Read from target queue and explicitly acknowledged using the <code class="cCode">tpqconfirmmsg</code> function. ACK can also be an implicit acknowledgement sent after the second tpdeqplus call by the receiving application. 
</div><div class="pDefPara2"><a name="wp1094213"> </a>
&quot;CONF-Delivered from the DQF and explicitly confirmed using the <code class="cCode">tpqconfirmmsg</code> function (recoverable) 
</div><div class="pDefPara2"><a name="wp1094214"> </a>
&quot;DEQ-Read from the target queue 
</div><div class="pDefPara2"><a name="wp1094215"> </a>
&quot;DQF-Stored in the destination queue file (recoverable) 
</div><div class="pDefPara2"><a name="wp1094216"> </a>
&quot;MEM-Stored in the target queue 
</div><div class="pDefPara2"><a name="wp1094217"> </a>
&quot;SAF-Stored in the store and forward file (recoverable) 
</div><div class="pDefPara2"><a name="wp1094218"> </a>
Note: If temporary queues are used, deleted, and reused quickly, it is possible in isolated cases for an implicit ACK response from a previous temporary queue to be placed on the new temporary queue.
</div><div class="pDefPara2"><a name="wp1094219"> </a>
If set <code class="cCode">OTMQ_DIP_ACK</code> and  <code class="cCode">OTMQ_DEL_WF</code>, the ACK message will be read in <code class="cCode">tpenqplus,_client</code> do not need to call another API to read the ACK message.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094220"> </a>
<code class="cCodeBold">timeout</code>
</h4></div>
<div class="pDefPara2"><a name="wp1094221"> </a>
Supplies the maximum amount of time the <code class="cCode">tpenqplus</code> function waits for a message to arrive before returning control to the application. If the timeout occurs before a message arrives, the status code <code class="cCode">OTMQ_TIMEOUT</code> is returned. Specifying 0 as the timeout value sets the timeout to the default value of 30 seconds.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094411"> </a>
<code class="cCodeBold">psb</code>
</h4></div>
<div class="pDefPara2"><a name="wp1094412"> </a>
Receives a value in the OTMQ Status Block specifying the final completion status. The <code class="cCode">psb</code> argument is used when sending or receiving recoverable messages. The PSB structure stores the status information from the message recovery system and may be checked after sending or receiving a message as shown in <a href="functions.html#wp1121778">Listing&#160;1-4</a>.
</div><div class="pCodeTitle"><a name="wp1121778"> </a>
Listing&#160;1-4	   PSB Structure
</div> <a name="wp1121685"> </a><div class="pPreformatted"><pre>struct psb_t {</pre></div><a name="wp1121686"> </a><div class="pPreformatted"><pre>	long type_of_psb;             /* PSB type */</pre></div><a name="wp1121687"> </a><div class="pPreformatted"><pre>	long del_psb_status;        /* The completion status of the function. It contains the status from TuxMsgQ. It can also contain a value of TPSUCCESS when the message is not sent recoverably. */</pre></div><a name="wp1121688"> </a><div class="pPreformatted"><pre>	long uma_psb_status;      /* The completion status of the undeliverable message action (UMA). The PSB UMA status indicates if the UMA was not executed or applicable. */</pre></div><a name="wp1121689"> </a><div class="pPreformatted"><pre>	long psb_reserved[6];    /* reserved filed */</pre></div><a name="wp1121690"> </a><div class="pPreformatted"><pre>};</pre></div><a name="wp1121691"> </a><div class="pPreformatted"><pre>typedef struct psb_t PSB;</pre></div><a name="wp1121692"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>This structure is already defined at <code class="cCode">atmi.h</code>.</td>
</tr>
</table>

<p class="pGraphic"><a name="wp1122062"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1121906table1121904"><caption><a name="wp1121906"> </a>
Table 1-8  PSB Delivery

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1121914"> </a>
PSB Delivery Status 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121916"> </a>
Platform
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121918"> </a>
Description
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121920"> </a>
API
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121922"> </a>
OTMQ__CONFIRMREQ
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121924"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121926"> </a>
Confirmation required for this message.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121928"> </a>
<code class="cCode">Tpdeqplus()</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121930"> </a>
OTMQ__DOWN
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121932"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121934"> </a>
The specified OTMQ Queue Service Group is not running.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121936"> </a>
All
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121938"> </a>
OTMQ__POSSDUPL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121940"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121942"> </a>
Message is a possible duplicate.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121944"> </a>
<code class="cCode">Tpdeqplus()</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121946"> </a>
OTMQ__NO_DQF
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121948"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121950"> </a>
When DQF is disabled, message delivery with DQF mode will return PSB del_psb_status as OTMQ__NO_DQF
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121952"> </a>
<code class="cCode">Tpenqplus()</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121954"> </a>
OTMQ__NO_SAF
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121956"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121958"> </a>
When SAF/DQF journal is disabled, message delivery with SAF mode will return PSB <code class="cCode">del_psb_status</code> as <code class="cCode">OTMQ__NO_SAF</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121960"> </a>
<code class="cCode">Tpenqplus()</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121962"> </a>
OTMQ __SUCCESS
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121964"> </a>
All
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121966"> </a>
Indicates successful completion.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121968"> </a>
All
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094621"> </a>
<code class="cCodeBold">uma</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1094891"> </a>
Supplies the action to be performed if the message cannot be stored at the specified -delivery interest point. The format of this argument is <code class="cCode">OTMQ_UMA_XXX</code> where <code class="cCode">XXX</code> is one of the following symbols:
</div><div class="pDefPara2"><a name="wp1094892"> </a>
<span style="font-weight: bold">Symbol&#160;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="font-weight: bold">Description</span>
</div><div class="pDefPara2"><a name="wp1094893"> </a>
<code class="cCode">DISC&#160;&#160;&#160;&#160;&#160;&#160;&#160;Discard message</code>
</div><div class="pDefPara2"><a name="wp1094698"> </a>
<code class="cCode">RTS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Return to sender</code>
</div><div class="pDefPara2"><a name="wp1094699"> </a>
<code class="cCode">SAF&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Store and Forward</code>
</div><div class="pDefPara2"><a name="wp1094700"> </a>
<code class="cCode">DLJ&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dead letter journal</code>
</div><div class="pDefPara2"><a name="wp1094701"> </a>
<code class="cCode">DLQ&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Dead letter queue</code>
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094943"> </a>
<code class="cCodeBold">replyqueue</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1094944"> </a>
Supplies a <code class="cCode">q_name</code> to use as the alternate queue for receiving response messages from the receiver program. The sender program must be attached to the queue specified in the <code class="cCode">replyqueue</code> argument to receive the response messages.The sender program cannot assign a response queue outside its qspace.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1094946"> </a>
<code class="cCodeBold">correlation_id </code>
</h4></div>
<div class="pDefPara2"><a name="wp1095023"> </a>
Supplies the correlation id, a user-defined identifier stored as a 32-byte value 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1095024"> </a>
<code class="cCodeBold">filter_idx</code>
</h4></div>
<div class="pDefPara2"><a name="wp1095025"> </a>
Get message by filter, <code class="cCode">filter_idx</code> set as <code class="cCode">index_handle</code> is created using the <code class="cCode">tpqsetselect</code> function.
</div><h4 class="pDefTerm"><a name="wp1095207"> </a>
<code class="cCodeBold">Data</code>
</h4><div class="pDefPara"><a name="wp1095209"> </a>
If data is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and len should specify the amount of data in the buffer that should be queued. Note that if data points to a buffer of a type that does not require a length to be specified (for example, an FML fielded buffer), then len is ignored. If data is NULL, len is ignored and a message is queued with no data portion. Consult <code class="cCode">tpalloc()</code> for more details.
</div>
<h4 class="pDefTerm"><a name="wp1095211"> </a>
<code class="cCodeBold">Len</code>
</h4><div class="pDefPara"><a name="wp1095212"> </a>
 The length of data, if data is non-NULL.
</div>
<h4 class="pDefTerm"><a name="wp1095214"> </a>
<code class="cCodeBold">Flags</code>
</h4><div class="pDefPara"><a name="wp1095215"> </a>
The following is
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1095515"> </a>
<code class="cCodeBold">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1095516"> </a>
If the caller is in transaction mode and this flag is set, the message is not queued within the caller transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when queuing the message. If message queuing fails, the caller&#39;s transaction is not affected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1095518"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1095519"> </a>
The message is not enqueued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened exclusively by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the TPQCTL structure is set to <code class="cCode">QMESHARE</code>.
</div><div class="pDefPara2"><a name="wp1095520"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). If a timeout occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPETIME</code>.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1095522"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1095523"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1095525"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1095526"> </a>
If this flag is set and a signal interrupts any underlying system calls, the interrupted system call is reissued. If <code class="cCode">TPSIGRSTRT</code> is not set and a signal interrupts a system call, <code class="cCode">tpenqplus()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div><h4 class="pHeading3"><a name="wp1079136"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1096869"> </a>
Upon failure,<code class="cCode"> tpdeqplus()</code> returns -1 and sets tperrno to indicate the error condition. Otherwise, the queue has been successfully dequeued when <code class="cCode">tpdeqplus()</code> returns.
</p>
<p class="pBody"><a name="wp1096871"> </a>
Errors:
</p>
<p class="pBody"><a name="wp1096872"> </a>
Upon failure, <code class="cCode">tpdeqplus()</code> sets<code class="cCode"> tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#39;s transaction, if one exists.)
</p>
<h4 class="pDefTerm"><a name="wp1096874"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1096875"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1096876"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1096877"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1096878"> </a>
<code class="cCodeBold">[TPEOTYPE]</code>
</h4><div class="pDefPara"><a name="wp1096879"> </a>
Either the type and subtype of the dequeued message are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set in flags and the type and subtype of <code class="cCode">*data</code> do not match the type and subtype of the dequeued message. In either case, <code class="cCode">*data</code>, its contents, and <code class="cCode">*len</code> are not changed. When the call is made in transaction mode and this error occurs, the transaction is marked abort-only, and the message remains on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1096880"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1096881"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1096882"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1096883"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1096884"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1096885"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1096886"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1096887"> </a>
<code class="cCode">tpdeqplus()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1096888"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1096889"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1096890"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1096891"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1096892"> </a>
<code class="cCodeBold">[TPEDIAGNOSTIC]</code>
</h4><div class="pDefPara"><a name="wp1096893"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via ctl structure.
<a name="wp1096894"> </a>
Diagnostic:
<a name="wp1096895"> </a>
The following diagnostic values are returned during the dequeuing of a message:
</div>
<h4 class="pDefTerm"><a name="wp1096897"> </a>
<code class="cCodeBold">[QMEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1096898"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1096899"> </a>
<code class="cCodeBold">[QMEBADRMID]</code>
</h4><div class="pDefPara"><a name="wp1096900"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1096901"> </a>
<code class="cCodeBold">[QMENOTOPEN]</code>
</h4><div class="pDefPara"><a name="wp1096902"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1096903"> </a>
<code class="cCodeBold">[QMEBADMSGID]</code>
</h4><div class="pDefPara"><a name="wp1096904"> </a>
An invalid message identifier was specified for dequeuing.
</div>
<h4 class="pDefTerm"><a name="wp1096905"> </a>
<code class="cCodeBold">[QMESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1096906"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1096907"> </a>
<code class="cCodeBold">[QMEOS]</code>
</h4><div class="pDefPara"><a name="wp1096908"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1096909"> </a>
<code class="cCodeBold">[QMEABORTED]</code>
</h4><div class="pDefPara"><a name="wp1096910"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1096911"> </a>
<code class="cCodeBold">[QMEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1096912"> </a>
A dequeue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1096913"> </a>
<code class="cCodeBold">[QMEBADQUEUE]</code>
</h4><div class="pDefPara"><a name="wp1096914"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1096915"> </a>
<code class="cCodeBold">[QMENOMSG]</code>
</h4><div class="pDefPara"><a name="wp1096916"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1096917"> </a>
<code class="cCodeBold">[QMBADPRIORITY]</code>
</h4><div class="pDefPara"><a name="wp1096918"> </a>
Invalid priority value used for receive.
</div>
<h4 class="pDefTerm"><a name="wp1096919"> </a>
<code class="cCodeBold">[QMNOTDCL]</code>
</h4><div class="pDefPara"><a name="wp1096920"> </a>
Process has not been attached to OTMQ.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075943"> </a>
tpqpublish()
</h3>
<h4 class="pHeading3"><a name="wp1075979"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075980"> </a>
<code class="cCode">tpqpublish()</code>&#8212;Used to publish a topic data.
</p>
<h4 class="pHeading3"><a name="wp1128774"> </a>
Synopsis
</h4>
<a name="wp1128775"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqpublish (topic_name, data, len, flags)</pre></div><h4 class="pHeading3"><a name="wp1128776"> </a>
Description
</h4>
<p class="pBody"><a name="wp1118323"> </a>
The caller uses <code class="cCode">tpqpublish()</code> to publish a topic data. The topic is named by topic and data, if not NULL, points to the data. The topic and its data are dispatched by the Oracle Tuxedo ATMI EventBroker to all subscribers whose subscriptions successfully evaluate against topic and whose optional filter rules successfully evaluate against data.
</p>
<p class="pBody"><a name="wp1118324"> </a>
<a href="functions.html#wp1118342">Table&#160;1-9</a> lists <code class="cCode">tpqpublish(</code>) supported arguments:
</p>
<p class="pGraphic"><a name="wp1118335"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1118342table1118340"><caption><a name="wp1118342"> </a>
Table 1-9  tpqpublish() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1118352"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118354"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118356"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118358"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118360"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118362"> </a>
topicname
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118364"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118366"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118368"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118370"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118372"> </a>
data
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118374"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118376"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118378"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118380"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118382"> </a>
len
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118384"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118386"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118388"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118390"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118392"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118394"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118396"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118398"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118400"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1097682"> </a>
to<code class="cCodeBold">picname</code>
</h4><div class="pDefPara"><a name="wp1097683"> </a>
<code class="cCode">topicname</code> is a NULL-terminated string of at most 31 characters and start with &quot;TMQ:&lt;QNOT&gt;:qspace name&quot;, such as&quot;TMQ:QNOT:QSPACE:usertopic&quot;. The first topicname character cannot be a dot (&quot;.&quot;) as this character is reserved as the starting character for all events defined by the Oracle Tuxedo ATMI system itself. The topicname &quot;TMQ:QNOT: qspace name&quot; is the suffix for all user topic and can not be used as user topic name alone.&quot;QNOT&quot; is not an necessary string. But if topicname cotain &quot;QNOT&quot;, means the message which will be published is an <code class="cCode">AVAIL/UNAVALI</code> message.
</div>
<h4 class="pDefTerm"><a name="wp1097686"> </a>
<code class="cCodeBold">Data</code>
</h4><div class="pDefPara"><a name="wp1097687"> </a>
If data is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and len should specify the amount of data in the buffer that should be posted with the event. Note that if data points to a buffer of a type that does not require a length to be specified (for example, an FML fielded buffer), then len is ignored. If data is NULL, len is ignored and the event is posted with no data.
</div>
<h4 class="pDefTerm"><a name="wp1097689"> </a>
<code class="cCodeBold">Flags</code>
</h4><div class="pDefPara"><a name="wp1097690"> </a>
If the publisher is within a transaction and the <code class="cCode">TPNOTRAN</code> flag is not set, the publish topic  goes to the EventBroker in transaction mode such that it dispatches the event as part of the publisher transaction. The broker dispatches transactional event notifications only to those service routine and stable-storage queue subscriptions that used the <code class="cCode">TPEVTRAN</code> bit setting in the ctl-? flags parameter passed to <code class="cCode">tpqsubscribe()</code>. Client notifications, and those service routine and stable-storage queue subscriptions that did not use the <code class="cCode">TPEVTRAN</code> bit setting in the <code class="cCode">ctl-?</code> flags parameter passed to <code class="cCode">tpqsubscribe()</code>, are also dispatched by the EventBroker but not as part of the publiser process transaction.
</div>
<div class="pDefParaCont"><a name="wp1097692"> </a>
If the publisher is outside a transaction, <code class="cCode">tpqpublish()</code> is a one-way publish topic with no acknowledgement when the service associated with the event fails. This occurs even when <code class="cCode">TPEVTRA</code>N is set for that event (using the ctl.flags parameter passed to <code class="cCode">tpqsubscribe()</code>. If the publisher is in a transaction, then <code class="cCode">tpqpublish ()</code> returns <code class="cCode">TPESVCFAIL</code> when the associated service fails in the event.
<a name="wp1097694"> </a>
The following is a list of valid flags:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1097696"> </a>
<code class="cCodeBold">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1097698"> </a>
If the caller is in transaction mode and this flag is set, then the event publishing is not made on behalf of the caller transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when posting events. If the event posting fails, the caller&#39;s transaction is not affected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1097699"> </a>
<code class="cCodeBold">TPNOREPLY</code>
</h4></div>
<div class="pDefPara2"><a name="wp1097701"> </a>
Informs <code class="cCode">tpqpublish()</code> not to wait for the EventBroker to process all subscriptions for topic before returning. When <code class="cCode">TPNOREPLY</code> is set, <code class="cCode">tpurcode()</code> is set to zero regardless of whether <code class="cCode">tpqpublish()</code> returns successfully or not. When the caller is in transaction mode, this setting cannot be used unless <code class="cCode">TPNOTRAN</code> is also set.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1097702"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1097704"> </a>
The topic is not published if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1097705"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1097707"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1097708"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1097710"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tpqpublish()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div><div class="pDefPara2"><a name="wp1097711"> </a>
In a multithreaded application, a thread in the<code class="cCode"> TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpqpublish()</code>.
</div><h4 class="pHeading3"><a name="wp1079231"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1098415"> </a>
Upon failure, <code class="cCode">tpqpublish()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the message has been successfully broadcasted when <code class="cCode">tpqpublish()</code> returns.
</p>
<p class="pBody"><a name="wp1098416"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1098417"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1098418"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1098419"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1098420"> </a>
Cannot access the TMQEVT
</div>
<h4 class="pDefTerm"><a name="wp1098421"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1098422"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqpublish()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1098423"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1098424"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1098425"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1098426"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1098427"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1098428"> </a>
<code class="cCode">tpqpublish()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1098429"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1098430"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1098431"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1098432"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075976"> </a>
tpqsubscribe()
</h3>
<h4 class="pHeading3"><a name="wp1076002"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076003"> </a>
<code class="cCode">tpqsubscribe()</code>&#8212;Used to subscribe to a topic.
</p>
<h4 class="pHeading3"><a name="wp1076004"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1076005"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">long tpqsubscirbe (topic, filter, ctl, flags)</code>
</p>
<h4 class="pHeading3"><a name="wp1076006"> </a>
Description
</h4>
<p class="pBody"><a name="wp1118919"> </a>
The caller uses <code class="cCode">tpqsubscribe()</code> to subscribe to a topic. Topic is a NULL-terminated string of at most 255 characters containing a regular expression. If present, filter is a string containing a Boolean filter rule that must be evaluated successfully before the TMQEVT posts the topic. Upon receiving an topic to be published, the TMQEVT applies the filter rule, if one exists, to the publish topic string. If the data passes the filter rule, the TMQEVT invokes the notification method; otherwise, the broker does not invoke the associated notification method. The caller can subscribe to the same event multiple times with different filter rules.
</p>
<p class="pBody"><a name="wp1118981"> </a>
<a href="functions.html#wp1118922">Table&#160;1-10</a> lists <code class="cCode">tpqsubscribe()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1118993"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1118922table1118920"><caption><a name="wp1118922"> </a>
Table 1-10  tpqsubscribe() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1118932"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118934"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118936"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118938"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1118940"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118942"> </a>
topic
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118944"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118946"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118948"> </a>
char*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118950"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118952"> </a>
filter
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118954"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118956"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118958"> </a>
char*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118960"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118962"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118964"> </a>
TPEVCTL 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118966"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118968"> </a>
TPEVCTL * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118970"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118972"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118974"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118976"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118978"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1118980"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1098945"> </a>
<code class="cCodeBold">topic</code>
</h4><div class="pDefPara"><a name="wp1098946"> </a>
Topic is a NULL-terminated string of at most 255 characters containing a regular expression which start with &quot;<code class="cCode">TMQ:QNOT:QSPACE</code>&quot;. <code class="cCode">QSPACE</code> is the qspace name.
</div>
<h4 class="pDefTerm"><a name="wp1098949"> </a>
<code class="cCodeBold">filter</code>
</h4><div class="pDefPara"><a name="wp1099524"> </a>
filter is a string containing a Boolean filter rule that must be evaluated successfully before the TMQEVT posts the topic. See Regular Expressions.
</div>
<h4 class="pDefTerm"><a name="wp1099563"> </a>
ctrl
</h4><div class="pDefPara"><a name="wp1099715"> </a>
TPEVCTL Control Parameter. The TPEVCTL structure as shown at atmi.h
</div>
<div class="pDefParaCont"><a name="wp1099565"> </a>
This structure contains the following elements:
<a name="wp1099566"> </a>
<code class="cCode">/* Subscription Control structure */</code>
<a name="wp1099567"> </a>
<code class="cCode">struct tpevctl_t {</code>
<a name="wp1099568"> </a>
<code class="cCode">	long flags;</code>
<a name="wp1099569"> </a>
<code class="cCode">	char name1[XATMI_SERVICE_NAME_LENGTH];</code>
<a name="wp1099570"> </a>
<code class="cCode">	char name2[XATMI_SERVICE_NAME_LENGTH];</code>
<a name="wp1099571"> </a>
<code class="cCode">	TPQCTL qctl;</code>
<a name="wp1099572"> </a>
<code class="cCode">};</code>
<a name="wp1099573"> </a>
<code class="cCode">typedef struct tpevctl_t TPEVCTL;</code>
<a name="wp1099574"> </a>
The following is a list of valid bits for the ctl-&gt;flags element controlling options for topic subscriptions:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1099575"> </a>
<code class="cCodeBold">TPEVQUEUE</code>
</h4></div>
<div class="pDefPara2"><a name="wp1099576"> </a>
Setting this flag indicates that the subscriber wants topic notifications to be enqueued to the queue space named in <code class="cCode">ctl-&gt;name</code>1 and the queue named in ctl-&gt;name2. That is, when an topic name is published that evaluates successfully against topic, the TMQEVT tests the published data against the filter rule associated with topic. If the data passes the filter rule or if there is no filter rule for the topic, then the TMQEVT enqueues a message to the queue space named in <code class="cCode">ctl-&gt;name1</code> and the queue named in <code class="cCode">ctl-&gt;name2</code> along with any data published with the topic. The queue space and queue name can be any valid Oracle Tuxedo ATMI system queue space and queue name, either of which may or may not exist at the time the subscription is made.
</div><div class="pDefPara2"><a name="wp1099577"> </a>
<code class="cCode">ctl-&gt;qctl </code>can contain options further directing the TMQEVT enqueuing of the published topic. If no options are specified, then <code class="cCode">ctl-&gt;qctl</code>.flags should be set to <code class="cCode">TPNOFLAGS</code>. Otherwise, options can be set as described in the &quot;Control Parameter&quot; subsection of <code class="cCode">tpenqplus</code>. <code class="cCode">TPEVQUEUE</code> are mutually exclusive flags. If <code class="cCode">TPEVTRAN</code> is also set in <code class="cCode">ctl-&gt;flags</code>, then if the process calling <code class="cCode">tpqpublish() </code>is in transaction mode, the TMQEVT enqueues the published topic and its data such that it will be part of the publisher transaction. The TMQEVT must belong to a server group that supports transactions (see UBBCONFIG for details). If <code class="cCode">TPEVTRAN</code> is not set in <code class="cCode">ctl-&gt;flags</code>, then the TMQEVT enqueues the published topic and its data such that it will not be part of the publisher transaction.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1099579"> </a>
<code class="cCodeBold">TPEVTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1099580"> </a>
Setting this flag indicates that the subscriber wants the topic notification for this subscription to be included in the publisher transaction, if one exists. If the publisher is not a transaction, then a transaction is started for this topic notification. If this flag is not set, then any topics published for this subscription will not be done on behalf of any transaction in which the publisher is participating.
</div><div class="pDefPara2"><a name="wp1099582"> </a>
For subscriptions to stable-storage queues, the queue space, queue name, and correlation identifier are used, in addition to topic and filter, when determining matches. The correlation identifier can be used to differentiate among several subscriptions for the same topic expression and filter rule, destined for the same queue. Thus, if the caller has set <code class="cCode">ctl-&gt;flag</code>s to <code class="cCode">TPEVQUEUE</code>, and <code class="cCode">TPQCOORID</code> is not set in <code class="cCode">ctl-&gt;qctl.flags</code>, then <code class="cCode">tpqsubscribe()</code> fails if topic, filter, the queue space name set in <code class="cCode">ctl-&gt;name1</code>, and the queue name set in <code class="cCode">ctl-&gt;name2</code> match those of a subscription (which also does not have a correlation identifier specified) already known to the TMQEVT. Further, if <code class="cCode">TPQCOORID</code> is set in <code class="cCode">ctl-&gt;qctl.flags</code>, then <code class="cCode">tpqsubscribe()</code> fails if <code class="cCode">topic</code>, <code class="cCode">filter</code>, <code class="cCode">ctl-&gt;name1</code>, <code class="cCode">ctl-&gt;name2</code>, and <code class="cCode">ctl-&gt;qctl.corrid</code> match those of a subscription (which has the same correlation identifier specified) already known to the TMQEVT.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1099584"> </a>
<code class="cCodeBold">TPEVPERSIST</code>
</h4></div>
<div class="pDefPara2"><a name="wp1099585"> </a>
By default, the OTMQ deletes subscriptions when the resource to which it is posting is not available (for example, the OTMQ cannot access a service routine and/or a queue space/queue name associated with an subscription). Setting this flag indicates that the subscriber wants this subscription to persist across such errors (usually because the resource will become available again in the future). When this flag is not used, the OTMQ will remove this subscription if it encounters an error accessing either the service name or queue space/queue name designated in this subscription.
</div><div class="pDefPara2"><a name="wp1099586"> </a>
If this flag is used with <code class="cCode">TPEVTRAN</code> and the resource is not available at the time of event notification, then the <code class="cCode">EventBroker</code> will return to the poster such that its transaction must be aborted. That is, even though the subscription remains intact, the resource&#39;s unavailability will cause the poster&#39;s transaction to fail.
</div><h4 class="pDefTerm"><a name="wp1099525"> </a>
<code class="cCodeBold">flags</code>
</h4><div class="pDefPara"><a name="wp1099526"> </a>
The following is a list of valid flags for <code class="cCode">tpqsubscribe()</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1098955"> </a>
OTMQ
</h4></div>
<div class="pDefPara2"><a name="wp1098956"> </a>
Note: OTMQ is must be set for <code class="cCode">TPQCTL-&gt;flags</code>.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1098958"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1098960"> </a>
The subscription is not made if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1098961"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1098963"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1098964"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1098966"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tpqsubscribe()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div><div class="pDefPara2"><a name="wp1098967"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpqsubscribe()</code>.
</div><h4 class="pHeading3"><a name="wp1079314"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1099945"> </a>
Upon failure, <code class="cCode">tpqsubscribe()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the topic has been successfully subscribed when <code class="cCode">tpqsubscribe()</code> returns and returns a subscription handle.
</p>
<p class="pBody"><a name="wp1099946"> </a>
Errors:
</p>
<h4 class="pDefTerm"><a name="wp1099947"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1099948"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1099949"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1099950"> </a>
Cannot access TMQEVT
</div>
<h4 class="pDefTerm"><a name="wp1099951"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1099952"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpqsubscribe()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<h4 class="pDefTerm"><a name="wp1099953"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1099954"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1099955"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1099956"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1099957"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1099958"> </a>
<code class="cCode">tpqsubscribe()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1099959"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1099960"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1099961"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1099962"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1099963"> </a>
<code class="cCodeBold">[TPELIMIT] </code>
</h4><div class="pDefPara"><a name="wp1099964"> </a>
The subscription failed because the <code class="cCode">EventBroker</code> maximum number of subscriptions has been reached.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1075999"> </a>
tpqunsubscribe()
</h3>
<h4 class="pHeading3"><a name="wp1076025"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076026"> </a>
<code class="cCode">tpqunsubscribe()</code>&#8212;Used to remove a subscription. 
</p>
<h4 class="pHeading3"><a name="wp1076027"> </a>
Synopsis
</h4>
<a name="wp1076028"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqunsubscirbe (subscription,flags)</pre></div><h4 class="pHeading3"><a name="wp1119470"> </a>
Description
</h4>
<p class="pBody"><a name="wp1119474"> </a>
Used to remove a subscription. 
</p>
<p class="pBody"><a name="wp1119530"> </a>
<a href="functions.html#wp1119478">Table&#160;1-11</a> lists <code class="cCode">tpqunsubscribe()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1119517"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1119478table1119475"><caption><a name="wp1119478"> </a>
Table 1-11  tpqunsubscribe() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1119488"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1119490"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1119492"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1119494"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1119496"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119498"> </a>
subscription
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119500"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119502"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119504"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119506"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119508"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119510"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119512"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119514"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1119516"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1100437"> </a>
<code class="cCodeBold">Subscription</code>
</h4><div class="pDefPara"><a name="wp1100438"> </a>
subscription is an subscription handle returned by <code class="cCode">tpqsubscribe(</code>).Setting subscription to the wildcard value, -1, directs <code class="cCode">tpqunsubscribe()</code> to unsubscribe to all non-persistent subscriptions previously made by the calling process. Non-persistent subscriptions are those made without the <code class="cCode">TPEVPERSIST</code> bit setting in the <code class="cCode">ctl-?flags</code> parameter of <code class="cCode">tpqsubscribe()</code>. Persistent subscriptions can be deleted only by using the handle returned by <code class="cCode">tpqsubscribe()</code>.
</div>
<h4 class="pDefTerm"><a name="wp1100442"> </a>
<code class="cCodeBold">flags</code>
</h4><div class="pDefPara"><a name="wp1100443"> </a>
The following is a list of valid flags for <code class="cCode">tpqsubscribe()</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1100445"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1100447"> </a>
The subscription is not made if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1100448"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1100450"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1100451"> </a>
<code class="cCodeBold">TPSIGRSTRT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1100453"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tpunsubscribe()</code> fails and <code class="cCode">tperrno</code> is set to<code class="cCode"> TPGOTSIG</code>.
</div><div class="pDefPara2"><a name="wp1100454"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpqunsubscribe()</code>.
</div><h4 class="pHeading3"><a name="wp1079434"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1100894"> </a>
Upon failure, <code class="cCode">tpqunsubscribe() </code>sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#39;s transaction, if one exists.)
</p>
<h4 class="pDefTerm"><a name="wp1100895"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1100896"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1100897"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1100898"> </a>
Cannot access the OTMQ EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1100899"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1100900"> </a>
This error code indicates that either a timeout has occurred 
</div>
<h4 class="pDefTerm"><a name="wp1100901"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1100902"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1100903"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1100904"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1100905"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1100906"> </a>
<code class="cCode">tpqunsubscribe()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1100907"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1100908"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1100909"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1100910"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1079387"> </a>
tpqconfirmmsg()
</h3>
<h4 class="pHeading3"><a name="wp1076058"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076059"> </a>
<code class="cCode">tpqconfirmmsg()</code>&#8212;Confirms receipt of a message that requires explicit confirmation.
</p>
<h4 class="pHeading3"><a name="wp1076060"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1076061"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">int tpqconfirmmsg (seq_number, force_j)</code>
</p>
<h4 class="pHeading3"><a name="wp1076062"> </a>
Description
</h4>
<p class="pBody"><a name="wp1101244"> </a>
Confirms receipt of a message that requires explicit confirmation. This can be a recoverable message sent to a queue that is configured for explicit confirmation or a message sent using the ACK delivery mode which must be explicitly confirmed upon receipt. Applications should examine the PSB status field of each message received to determine if the message requires explicit confirmation. 
</p>
<p class="pBody"><a name="wp1101245"> </a>
When a recoverable message is received, the application must call the <code class="cCode">tpqconfirmmsg</code> function in order to delete it from the message recovery journal disk storage. If receipt of a recoverable message is not confirmed, the message continues to be stored by the recovery system and will be re-delivered if the application detaches and then reattaches to the queue. 
</p>
<p class="pBody"><a name="wp1101246"> </a>
OTMQ can confirm receipt of a recoverable message automatically when the next consecutive message in the recovery journal is delivered. This feature is called implicit confirmation. 
</p>
<p class="pBody"><a name="wp1101247"> </a>
All queues must be configured for implicit or explicit confirmation. For complete information on how to configure message queues, see <code class="cCode">tmqadmin</code> in the Oracle Tuxedo Message Queue Command Reference Guide.
</p>
<p class="pBody"><a name="wp1101248"> </a>
Successfully delivered recoverable messages can be recorded in the postconfirmation journal (PCJ). The <code class="cCode">tpqconfirmmsg</code> function uses the <code class="cCode">force_j </code>argument to write messages to the PCJ file if the system is not currently configured to store them. Note that successfully delivered recoverable messages cannot be written to the PCJ file unless they are explicitly confirmed using the <code class="cCode">tpqconfirmmsg</code> function.
</p>
<p class="pBody"><a name="wp1120030"> </a>
To use <code class="cCode">tpqconfirmmsg(),</code> you must first invoke <code class="cCode">tpqattach()</code>. 
</p>
<p class="pBody"><a name="wp1120034"> </a>
<a href="functions.html#wp1120038">Table&#160;1-12</a> lists <code class="cCode">tpqconfirmmsg()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1120087"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1120038table1120035"><caption><a name="wp1120038"> </a>
Table 1-12  pqconfirmmsg() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1120048"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120050"> </a>
<code class="cCodeBold">Data Type</code>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120052"> </a>
<code class="cCodeBold">Mechanism</code>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120054"> </a>
<code class="cCodeBold">Prototype</code>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120056"> </a>
<code class="cCodeBold">Access</code>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120058"> </a>
seq_number
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120060"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120062"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120064"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120066"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120068"> </a>
force_j
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120070"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120072"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120074"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120076"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<div class="pDefPara"><a name="wp1101330"> </a>
Supplies the message sequence number of the recoverable message being confirmed. The message sequence number is generated by the OTMQ message recovery system for each recoverable message. This value is passed to the receiver program in the PSB of the <code class="cCode">tpdeqplus</code> function when it reads each recoverable message.
</div>
<h4 class="pDefTerm"><a name="wp1101332"> </a>
<code class="cCodeBold">force_j</code> 
</h4><div class="pDefPara"><a name="wp1101333"> </a>
Supplies the journaling action for this message. Following are the predefined constants for this argument:
</div>
<div class="pDefParaCont"><a name="wp1101422"> </a>
Symbol&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Description
<a name="wp1101423"> </a>
<code class="cCode">OTMQ_DEFAULT_JRN</code>&#160;<code class="cCode">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>Enables writing the message to the PCJ queue only<br /><code class="cCode">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>if the journaling is enabled by qspacecreate <code class="cCode">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>command.
<a name="wp1101424"> </a>
<code class="cCode">OTMQ_FORCE_JRN&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>Enables writing to a journal queue regardless of<br /><code class="cCode">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>whether the enabled by qspacecreate command.
<a name="wp1101425"> </a>
<code class="cCode">OTMQ_NO_JRN&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>Disables journaling regardless of whether<br /><code class="cCode">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code>journaling is configured.
</div>
<h4 class="pHeading3"><a name="wp1079487"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1101621"> </a>
Upon failure, <code class="cCode">tpqconfirmmsg()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#39;s transaction, if one exists.)
</p>
<h4 class="pDefTerm"><a name="wp1101623"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1101624"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1101625"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1101626"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1101627"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1101628"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1101629"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1101630"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1101631"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1101632"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076053"> </a>
tpqsetselect()
</h3>
<h4 class="pHeading3"><a name="wp1103069"> </a>
Name
</h4>
<p class="pBody"><a name="wp1103070"> </a>
<code class="cCode">tpqsetselect()</code>&#8212;Allows application developers to define complex selection criteria for message reception. 
</p>
<h4 class="pHeading3"><a name="wp1103071"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1076088"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">int tpqsetselect (selection_array, num_masks, index_handle)</code>
</p>
<h4 class="pHeading3"><a name="wp1076089"> </a>
Description
</h4>
<p class="pBody"><a name="wp1103180"> </a>
Allows application developers to define complex selection criteria for message reception. The selection array specifies the queues to search, the priority order of message reception, two comparison keys for range checking, and an order key to determine the order in which messages are selected from the queue.
</p>
<p class="pBody"><a name="wp1103181"> </a>
The <code class="cCode">tpqsetselect</code> function creates an index handle that is used as the <code class="cCode">sel_filter</code> argument of OTMQ functions for reading the message. When a selection index handle is passed to <code class="cCode">tpdeqplus</code>, each message received is compared against comparison <code class="cCode">key_1</code> and then comparison key_2. If the message matches both keys (a logical AND operation), the message is added to a set of matched messages. The order in which selected messages are delivered is determined by the order key.
</p>
<p class="pBody"><a name="wp1103182"> </a>
To use <code class="cCode">tpqsetselect()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1103333"> </a>
<a href="functions.html#wp1120220">Table&#160;1-13</a> lists <code class="cCode">tpqsetselect()</code> supported arguments:
</p>
<p class="pGraphic"><a name="wp1120121"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1120220table1120218"><caption><a name="wp1120220"> </a>
Table 1-13   tpqsetselect() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1120230"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120232"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120234"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120236"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120238"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120240"> </a>
selection_array
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120242"> </a>
selection_array_ component_tp 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120244"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120246"> </a>
selection_array_ component_tp * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120248"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120250"> </a>
num_masks
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120252"> </a>
short 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120254"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120256"> </a>
short * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120258"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120260"> </a>
index_handle
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120262"> </a>
Int 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120264"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120266"> </a>
int * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120268"> </a>
returned
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1103507"> </a>
<code class="cCodeBold">selection_array</code> 
</h4><div class="pDefPara"><a name="wp1103508"> </a>
Supplies an array of selection records that contain the selection rules for each queue. The typedef structures define the C data structure for the selection array. The structure is defined in <code class="cCode">tmqentry.h</code> as follows: 
<a name="wp1103509"> </a>
<code class="cCode">typedef struct _selection_array_component_tp {</code>
<a name="wp1103510"> </a>
<code class="cCode">    char qspace[TMQSNAMELEN+1];</code>
<a name="wp1103511"> </a>
<code class="cCode">    char queue[QNAMELEN+1];</code>
<a name="wp1103512"> </a>
<code class="cCode">TM32I priority;</code>
<a name="wp1103513"> </a>
<code class="cCode">    TM32I key_1_offset;</code>
<a name="wp1103514"> </a>
<code class="cCode">    TM32I key_1_size;</code>
<a name="wp1103515"> </a>
<code class="cCode">    TM32I key_1_value;</code>
<a name="wp1103516"> </a>
<code class="cCode">    TM32I key_1_oper;</code>
<a name="wp1103517"> </a>
<code class="cCode">    TM32I key_2_offset;</code>
<a name="wp1103518"> </a>
<code class="cCode">    TM32I key_2_size;</code>
<a name="wp1103519"> </a>
<code class="cCode">    TM32I key_2_value;</code>
<a name="wp1103520"> </a>
<code class="cCode">    TM32I key_2_oper;</code>
<a name="wp1103521"> </a>
<code class="cCode">    TM32I order_offset;</code>
<a name="wp1103522"> </a>
<code class="cCode">    TM32I order_size;</code>
<a name="wp1103523"> </a>
<code class="cCode">    TM32I order_order;</code>
<a name="wp1103524"> </a>
<code class="cCode">    union {</code>
<a name="wp1103525"> </a>
<code class="cCode">       otmq_correlation_id  correlation_id;</code>
<a name="wp1103526"> </a>
<code class="cCode">       otmq_sequence_number sequence number</code>
<a name="wp1103527"> </a>
<code class="cCode">    } extended_key</code>
<a name="wp1103528"> </a>
<code class="cCode">} selection_array_component_tp;</code>
</div>
<div class="pDefParaCont"><a name="wp1103334"> </a>
The <code class="cCode">selection_array_component</code> data structure has the following components:
<p class="pGraphic"><a name="wp1103836"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1103805table1103803"><caption><a name="wp1103805"> </a>
Table 1-14  selection_array_component data Structure Components

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1103809"> </a>
Component 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1103811"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103813"> </a>
Queue and Priority 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103815"> </a>
Allows the application to specify the queue number and priority.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103817"> </a>
Comparison Key 1 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103819"> </a>
Defines the components of the first comparison key used to enable range checking of messages.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103821"> </a>
Comparison Key 2 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103823"> </a>
Defines the components of the second comparison key used to enable range checking of messages.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103825"> </a>
Order Key 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103827"> </a>
Contains the information required to provide selection of messages by FIFO, Minimum Value, or Maximum Value.
</div>
</td>
</tr>
</table>
</div>

</p>
<a name="wp1103785"> </a>
The following tables define the content of each of the components of the <code class="cCode">selection_array_component</code> data structure.
<p class="pGraphic"><a name="wp1103987"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1103935table1103933"><caption><a name="wp1103935"> </a>
Table 1-15  Queue and Priority

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1103941"> </a>
Field 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1103943"> </a>
Values 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1103945"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103947"> </a>
Queue 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103949"> </a>
Queue Name 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103951"> </a>
Specifies the queue name to be searched. The queue name can be any message queue for which the application has read access. The queue name can be obtained from the <code class="cCode">q_attached</code> argument of the <code class="cCode">tpqattach</code> function or qname of the <code class="cCode">tpqlocate</code> function. A value of 0 for this argument specifies the application&#39;s primary queue. The queue must be attached before do this except MRQ, if MRQ is not attached, this api will attach the MRQ first
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103953"> </a>
Priority 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103957"> </a>
Specifies the priority, using either an integer between 0 and 99 inclusive or a variable. (Using the direct interger value is the preferred method of specifying priority.) This argument also accepts the following predefined constants which are set by the application. When the priority is set as 0, it will read priority 0 messages only.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103961"> </a>
OTMQ_PRI_ANY
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103963"> </a>
Read priority 1 before reading priority 0 messages.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103967"> </a>
OTMQ_PRI_P0
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103969"> </a>
Read priority 0 messages only.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103973"> </a>
OTMQ_PRI_P1
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1103975"> </a>
Read priority 1 messages only.
</div>
</td>
</tr>
</table>
</div>

</p>
<a name="wp1103897"> </a>
The following table specifies the arguments and valid values that can be applied to this part of the <code class="cCode">Selection_Array_Components</code> structure:
<p class="pGraphic"><a name="wp1104907"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1104750table1104748"><caption><a name="wp1104750"> </a>
Table 1-16  Comparison Keys

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1104756"> </a>
Field 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1104758"> </a>
Values 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1104760"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104762"> </a>
Offset 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104766"> </a>
Contains a value that specifies where the information to be compared begins inside the message. The following predefined constants apply:
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104770"> </a>
n 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104772"> </a>
User message byte number (0 relative).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104782"> </a>
OTMQ_CLASS 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104784"> </a>
Class of the message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104788"> </a>
OTMQ_TYPE 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104790"> </a>
Type of the message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104794"> </a>
OTMQ_CORRELATION_ID 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104796"> </a>
Correlation ID of the message. May be used for key_1_offset or key_2_offset but not both. If this symbol is specified, the Size field must be set to OTMQ_CORRELATION_ID_SIZE (or 32 bytes).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104800"> </a>
OTMQ_SEQUENCE_NUMBER
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104802"> </a>
Message sequence number acquired from the OTMQ Status Buffer. If this symbol is specified, the Size field must be set to OTMQ_SEQUENCE_NUMBER_SIZE (or 8 bytes).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104804"> </a>
Size 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104808"> </a>
Specifies data type of the key to be compared.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104812"> </a>
0 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104814"> </a>
Disable use of key.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104818"> </a>
1 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104820"> </a>
Byte (8 bits).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104824"> </a>
2 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104826"> </a>
Word (16 bits).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104830"> </a>
4 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104832"> </a>
int32 (32 bits).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104836"> </a>
OTMQ_SEQUENCE_NUMBER_SIZE
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104838"> </a>
8 bytes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104842"> </a>
OTMQ_CORRELATION_ID_SIZE
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104844"> </a>
32 bytes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104846"> </a>
Value 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104848"> </a>
n 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104850"> </a>
Contains the value for message field comparison field that is formatted as an integer of 32 bits.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104852"> </a>
oper 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104856"> </a>
Relational operator comparison.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104860"> </a>
OTMQ_OPER_EQ 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104862"> </a>
Message field = value.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104866"> </a>
OTMQ_OPER_NEQ 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104868"> </a>
Message field &lt;&gt; value.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104872"> </a>
OTMQ_OPER_GTR 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104874"> </a>
Message field &gt; value.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104878"> </a>
OTMQ_OPER_LT 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104880"> </a>
Message field &lt; value.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104884"> </a>
OTMQ_OPER_GTRE 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104886"> </a>
Message field &gt; or = value.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104890"> </a>
OTMQ_OPER_LTE 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1104892"> </a>
Message field &lt; or = value.
</div>
</td>
</tr>
</table>
</div>

</p>
<a name="wp1104698"> </a>
The Order Key part contains variables described in the following table:
<p class="pGraphic"><a name="wp1105777"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1105602table1105600"><caption><a name="wp1105602"> </a>
Table 1-17  Order Key

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1105608"> </a>
Field 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1105610"> </a>
Values 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1105612"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105614"> </a>
Offset 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105618"> </a>
Byte offset of the message field. The offset variable contains a value that specifies where the information to be compared begins inside the message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105622"> </a>
n 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105624"> </a>
User message byte number (0 relative).(only support memory queue)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105634"> </a>
OTMQ_CLASS 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105636"> </a>
Class of the message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105640"> </a>
OTMQ_TYPE 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105642"> </a>
Type of the message.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105646"> </a>
OTMQ_CORRELATION_ID
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105648"> </a>
Correlation ID of the message. If this symbol is specified, the Size field must be set to OTMQ_CORRELATION_ID_SIZE (or 32 bytes).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105652"> </a>
OTMQ_SEQUENCE_NUMBER
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105654"> </a>
Message sequence number acquired from the OTMQ Status Buffer. If this symbol is specified, the Size field must be set to OTMQ_SEQUENCE_NUMBER_SIZE (or 8 bytes).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105656"> </a>
Size 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105660"> </a>
Size of the comparison. The size variable specifies the data type of the key to be compared.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105664"> </a>
0 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105666"> </a>
Disable use of key.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105670"> </a>
1 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105672"> </a>
Byte.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105676"> </a>
2 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105678"> </a>
Word.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105682"> </a>
4 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105684"> </a>
int32 (32 bits).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105688"> </a>
OTMQ_SEQUENCE_NUMBER_SIZE
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105690"> </a>
8 bytes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105694"> </a>
OTMQ_CORRELATION_ID_SIZE
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105696"> </a>
32 bytes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105698"> </a>
Order 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105702"> </a>
Order operator. The order variable specifies the sequence in which the select process is to be performed.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105706"> </a>
OTMQ_ORDER_FIFO 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105708"> </a>
1,Read priority 1 before reading priority 0 messages
</div>
<div class="pCellBody"><a name="wp1106137"> </a>
2,SQL SYNTAX: priority DESC
</div>
<div class="pCellBody"><a name="wp1106142"> </a>
3,First pending.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105724"> </a>
OTMQ_ORDER_MIN 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105726"> </a>
1,Minimum value of all pending.
</div>
<div class="pCellBody"><a name="wp1106226"> </a>
2,SQL SYNTAX: (offset is OTMQ_CLASS) class ASC, priority ASC
</div>
<div class="pCellBody"><a name="wp1106253"> </a>
3,Read the last matched message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105742"> </a>
OTMQ_ORDER_MAX 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1105744"> </a>
1,Maximum value of all pending.
</div>
<div class="pCellBody"><a name="wp1106345"> </a>
2,SQL SYNTAX: (offset is OTMQ_CLASS) class DESC, priority ASC
</div>
<div class="pCellBody"><a name="wp1106392"> </a>
3,Read the last matched message
</div>
</td>
</tr>
</table>
</div>

</p>
<a name="wp1105543"> </a>
<span style="font-weight: bold">Correlation ID</span> 
<a name="wp1106476"> </a>
The correlation ID is a 32-byte user-defined identifier associated with a message. If <code class="cCode">OTMQ_CORRELATION_ID</code> is supplied as the value for either the key_1_offset or key_2_offset field, the correlation ID value is used to match messages with the specified correlation ID. Since there is a single correlation ID per message, <code class="cCode">OTMQ_CORRELATION_ID</code> should only be specified for one of the comparison keys; specifying the correlation ID for both keys results in a TPEINVAL error.
<a name="wp1106477"> </a>
If OTMQ_CORRELATION_ID is supplied as the value for the order_offset field, messages with the specified correlation ID are returned in the order specified by the order_order field.
<a name="wp1103882"> </a>
<span style="font-weight: bold">Sequence Number</span> 
<a name="wp1106516"> </a>
The message sequence number is a unique value for each message. The sequence number is stored in the PSB. Applications should acquire the message sequence number from the PSB and not modify it in any way.
<a name="wp1106517"> </a>
Note: An application may specify only one of the two keys to select by correlation identifier or by sequence number.
</div>
<h4 class="pDefTerm"><a name="wp1106543"> </a>
<code class="cCodeBold">num_masks</code> 
</h4><div class="pDefPara"><a name="wp1106544"> </a>
Supplies the number of records in the selection array. This argument allows a minimum of 1 record to a maximum of 256 records in the selection array.
</div>
<h4 class="pDefTerm"><a name="wp1106545"> </a>
<code class="cCodeBold">index_handle</code> 
</h4><div class="pDefPara"><a name="wp1106546"> </a>
Receives a variable containing the index handle for the selection mask as follows:
</div>
<div class="pDefParaCont"><a name="wp1106547"> </a>
* The high-order word contains OTMQ_BY_MASK. 
<a name="wp1106548"> </a>
* The low-order word contains the index to the selection array. 
<a name="wp1106549"> </a>
The index_handle is passed as the <code class="cCode">sel_filter</code> argument of TPQCTL in <code class="cCode">tpdeqplus</code>, <code class="cCode">tpqgetmsga</code> , and <code class="cCode">tpqcancelselect</code> functions. OTMQ implementations offer up to 32767 index handles.
</div>
<h4 class="pHeading3"><a name="wp1103335"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1106722"> </a>
Upon failure, <code class="cCode">tpqsetselect()</code> sets <code class="cCode">tperrno</code> to one of the following values. 
</p>
<h4 class="pDefTerm"><a name="wp1106723"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1106724"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1106725"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1106726"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1106727"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1106728"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1106729"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1106730"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1106731"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1106732"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076082"> </a>
tpqcancelselect()
</h3>
<h4 class="pHeading3"><a name="wp1076108"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076109"> </a>
<code class="cCode">tpqcancelselect()</code>&#8212;Releases the selection array and index handle associated with a previously generated selection mask. 
</p>
<h4 class="pHeading3"><a name="wp1076110"> </a>
Synopsis
</h4>
<a name="wp1076111"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqcancelselect (index_handle) </pre></div><h4 class="pHeading3"><a name="wp1076112"> </a>
Description
</h4>
<p class="pBody"><a name="wp1106949"> </a>
Releases the selection array and index handle associated with a previously generated selection mask. An <code class="cCode">index_handle</code> and associated selection mask are created using the <code class="cCode">tpqsetselect</code> function. When the selection mask is used with asynchronous read requests, this function also cancels any pending <code class="cCode">tpqgetmsga</code> requests that use the referenced <code class="cCode">index_handle</code>. 
</p>
<p class="pBody"><a name="wp1106950"> </a>
To use <code class="cCode">tpqcancelselect()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1106982"> </a>
<a href="functions.html#wp1120464">Table&#160;1-18</a> lists supported <code class="cCode">tpqcancelselect()</code> arguments:
</p>
<p class="pGraphic"><a name="wp1120526"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1120464table1120462"><caption><a name="wp1120464"> </a>
Table 1-18   tpqcancelselect() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1120474"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120476"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120478"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120480"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120482"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120484"> </a>
index_handle
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120486"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120488"> </a>
Refence 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120490"> </a>
int*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120492"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1106983"> </a>
<code class="cCodeBold">Index_handle</code>
</h4><div class="pDefPara"><a name="wp1106995"> </a>
Returned by <code class="cCode">tpqsetselect</code>.
</div>
<h4 class="pHeading3"><a name="wp1106984"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1107030"> </a>
Upon failure, <code class="cCode">tpqcancelselect()</code> sets <code class="cCode">tperrno</code> to one of the following values. 
</p>
<h4 class="pDefTerm"><a name="wp1107031"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1107032"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1107033"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1107034"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1107035"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1107036"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1107037"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefParaCont"><a name="wp1107038"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1107039"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1107040"> </a>
An operating system error has occurred
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076105"> </a>
tpqreadjrn()
</h3>
<h4 class="pHeading3"><a name="wp1107249"> </a>
Name
</h4>
<p class="pBody"><a name="wp1107250"> </a>
<code class="cCode">tpqreadjrn()</code>&#8212;Reads a message from an OTMQ local group journal.
</p>
<h4 class="pHeading3"><a name="wp1076133"> </a>
Synopsis
</h4>
<a name="wp1076134"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqreadjrn (qspace, qname, ctl, type, odata, olen, timeout)</pre></div><h4 class="pHeading3"><a name="wp1076135"> </a>
Description
</h4>
<p class="pBody"><a name="wp1107311"> </a>
Reads a message from an OTMQ journal. Before using <code class="cCode">tpqreadjrn</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1107633"> </a>
<a href="functions.html#wp1120716">Table&#160;1-19</a> lists supported <code class="cCode">tpqreadjrn</code> arguments:
</p>
<p class="pGraphic"><a name="wp1120826"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1120716table1120714"><caption><a name="wp1120716"> </a>
Table 1-19  tpqreadjrn Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1120726"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120728"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120730"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120732"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120734"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120736"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120738"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120740"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120742"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120744"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120746"> </a>
qname
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120748"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120750"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120752"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120754"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120756"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120758"> </a>
TPQCTL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120760"> </a>
Reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120762"> </a>
TPQCTL*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120764"> </a>
passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120766"> </a>
type
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120768"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120770"> </a>
Reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120772"> </a>
int
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120774"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120776"> </a>
odata
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120778"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120780"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120782"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120784"> </a>
returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120786"> </a>
olen
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120788"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120790"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120792"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120794"> </a>
returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120796"> </a>
timeout
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120798"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120800"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120802"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120804"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1107634"> </a>
<code class="cCodeBold">qspace</code>
</h4><div class="pDefPara"><a name="wp1128867"> </a>
Supplies the queue space name for enqueue the message. SAF/DLQ/DLJ journal queue, queue space is the source queue space which client attached. For PCJ/DQF journal, queue space is the target queue space is client put the message.
</div>
<h4 class="pDefTerm"><a name="wp1128868"> </a>
<code class="cCodeBold">qname </code>
</h4><div class="pDefPara"><a name="wp1128869"> </a>
Supplies the name of the permanent queue to read journal message to the application.
</div>
<div class="pDefParaCont"><a name="wp1107422"> </a>
SAF/DLQ/DLJ journal queue, the queue name is the source queue of client attached. For PCJ/DQF journal, queue name is the target queue name is client put the message.
</div>
<h4 class="pDefTerm"><a name="wp1107423"> </a>
Control Parameter
</h4><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1107424"> </a>
<code class="cCodeBold">flags</code>
</h4></div>
<div class="pDefPara2"><a name="wp1107770"> </a>
For <code class="cCode">tpqreadjrn()</code>, ctl-&gt;flags must contain OTMQ| TPQREADJRN.
</div><h4 class="pDefTerm"><a name="wp1107846"> </a>
<code class="cCodeBold">type</code>
</h4><div class="pDefPara"><a name="wp1107847"> </a>
Supplies the type of the journal to read. The values only be validate as:
</div>
<div class="pDefParaCont"><a name="wp1107849"> </a>
<code class="cCode">SAF_HANDLE </code>
<a name="wp1107850"> </a>
<code class="cCode">DQF_HANDLE</code>
<a name="wp1107851"> </a>
<code class="cCode">DLQ_HANDLE</code>
<a name="wp1107852"> </a>
<code class="cCode">DLJ_HANDLE</code>
<a name="wp1107853"> </a>
<code class="cCode">PCJ_HANDLE</code>
</div>
<h4 class="pDefTerm"><a name="wp1107854"> </a>
<code class="cCodeBold">odata</code>
</h4><div class="pDefPara"><a name="wp1107855"> </a>
Receives the contents of the message retrieved from the selected message recovery journal. This argument contains either the name of a memory region or a message handle where OTMQ writes.
</div>
<h4 class="pDefTerm"><a name="wp1107857"> </a>
<code class="cCodeBold">Olen</code>
</h4><div class="pDefPara"><a name="wp1107858"> </a>
Supplies the size of the buffer (in bytes) for messages
</div>
<h4 class="pDefTerm"><a name="wp1107860"> </a>
<code class="cCodeBold">timeout</code> 
</h4><div class="pDefPara"><a name="wp1107861"> </a>
Supplies the maximum amount of time the <code class="cCode">tpqreadjrn</code> function waits for a message to arrive before returning control to the application. If the timeout occurs before a message arrives, the status code OTMQ_TIMEOUT is returned. Specifying 0 as the timeout value sets the timeout to the default value of 30 seconds.
</div>
<h4 class="pHeading3"><a name="wp1107771"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1108135"> </a>
Upon failure, <code class="cCode">tpqreadjrn()</code> sets <code class="cCode">tperrno</code> to one of the following values. Otherwise, the successfully read messages when <code class="cCode">tpqreadjrn()</code> returns. you can use <code class="cCode">tpqerrno()</code> and <code class="cCode">tpqstrerror() </code>to get the detail OTMQ error number and detail string error message
</p>
<h4 class="pDefTerm"><a name="wp1108136"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1108137"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1108138"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1108139"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1108140"> </a>
<code class="cCodeBold">[TPEOTYPE]</code>
</h4><div class="pDefPara"><a name="wp1108141"> </a>
Either the type and subtype of the dequeued message are not known to the caller; or, TPNOCHANGE was set in flags and the type and subtype of *data do not match the type and subtype of the dequeued message. In either case, *data, its contents, and *len are not changed. When the call is made in transaction mode and this error occurs, the transaction is marked abort-only, and the message remains on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1108142"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1108143"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1108144"> </a>
<code class="cCodeBold">[TPEBLOCK]</code>
</h4><div class="pDefPara"><a name="wp1108145"> </a>
A blocking condition exists and TPNOBLOCK was specified.
</div>
<h4 class="pDefTerm"><a name="wp1108146"> </a>
<code class="cCodeBold">[TPGOTSIG]</code>
</h4><div class="pDefPara"><a name="wp1108147"> </a>
A signal was received and TPSIGRSTRT was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1108148"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1108149"> </a>
<code class="cCode">tpdeqplus()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1108150"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1108151"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1108152"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1108153"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1108154"> </a>
<code class="cCodeBold">[TPEDIAGNOSTIC]</code>
</h4><div class="pDefPara"><a name="wp1108155"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via ctl structure.
</div>
<h4 class="pHeading3"><a name="wp1108156"> </a>
Diagnostic:
</h4>
<p class="pBody"><a name="wp1108157"> </a>
The following diagnostic values are returned during the dequeuing of a message:
</p>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108158"> </a>
<code class="cCodeBold">[QMEINVAL]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108159"> </a>
An invalid flag value was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108160"> </a>
<code class="cCodeBold">[QMEBADRMID</code><code class="cCode">]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108161"> </a>
An invalid resource manager identifier was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108162"> </a>
<code class="cCodeBold">[QMESYSTEM]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108163"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108164"> </a>
<code class="cCodeBold">[QMEOS]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108165"> </a>
An operating system error has occurred.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108166"> </a>
<code class="cCodeBold">[QMEABORTED]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108167"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108168"> </a>
<code class="cCodeBold">[QMEPROTO]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108169"> </a>
A dequeue was done when the transaction state was not active.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108170"> </a>
<code class="cCodeBold">[QMEBADQUEUE]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108171"> </a>
An invalid or deleted queue name was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108172"> </a>
<code class="cCodeBold">[QMENOMSG]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108173"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108174"> </a>
<code class="cCodeBold">[QMBADPRIORITY]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108175"> </a>
Invalid priority value used for receive.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1108176"> </a>
<code class="cCodeBold">[QMNOTDCL]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1108177"> </a>
Process has not been attached to OTMQ.
</div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076128"> </a>
tpqshowpending()
</h3>
<h4 class="pHeading3"><a name="wp1076166"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076167"> </a>
<code class="cCode">tpqshowpending()</code>&#8212;Requests the number of pending messages for a list of selected queues.
</p>
<h4 class="pHeading3"><a name="wp1129424"> </a>
Synopsis
</h4>
<a name="wp1129425"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqshowpending (<br />&#160;&#160;&#160;char * qspace, /* queue space attached */<br />&#160;&#160;&#160;int  count, /* count - ptr to number of queues */<br />&#160;&#160;&#160;char ** in_q_list, /* ptr to array of queues name */<br />&#160;&#160;&#160;long * out_pend_list /* ptr to array of pending msg counts */<br />&#160;&#160;&#160;);</pre></div><h4 class="pHeading3"><a name="wp1076170"> </a>
Description
</h4>
<p class="pBody"><a name="wp1108878"> </a>
Requests the number of pending messages for a list of selected queues. To use the <code class="cCode">tpqshowpending</code> function, specify the number of message queues for which you want to obtain a pending message count and the list of queue names for which you want to obtain a pending message count. The value returned by this function contains the total number of messages in each queue.
</p>
<p class="pBody"><a name="wp1108879"> </a>
To use <code class="cCode">tpqshowpending()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<a name="wp1108882"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>You must allocate the <code class="cCode">out_pend_list</code> array.<br /><br />The number of queue that need to be listed is depend on &quot;count&quot;, you must insure the array of queue list is properly allocated.</td></tr>
</table>

<p class="pBody"><a name="wp1108981"> </a>
<a href="functions.html#wp1130636">Table&#160;1-20</a> lists supported <code class="cCode">tpqshowpending()</code>arguments.
</p>
<p class="pGraphic"><a name="wp1130596"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1130636table1130634"><caption><a name="wp1130636"> </a>
Table 1-20  tpqshowpending() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1130646"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1130648"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1130650"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1130652"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1130654"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130656"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130658"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130660"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130662"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130664"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130666"> </a>
count
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130668"> </a>
int 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130670"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130672"> </a>
int 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130674"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130676"> </a>
in_q_list
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130678"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130680"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130682"> </a>
char **
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130684"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130686"> </a>
out_pend_list
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130688"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130690"> </a>
reference
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130692"> </a>
long*
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1130694"> </a>
passed/returned
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1108994"> </a>
<code class="cCodeBold">qspace </code>
</h4><div class="pDefPara"><a name="wp1108995"> </a>
Supplies the queue space name for enqueue the message. The max length is 15
</div>
<h4 class="pDefTerm"><a name="wp1108997"> </a>
<code class="cCodeBold">count</code>
</h4><div class="pDefPara"><a name="wp1108998"> </a>
Supplies the number of queue entries in the in_q_list argument (the number of indexes in the array). The maximum allowed value is 32,000.
</div>
<h4 class="pDefTerm"><a name="wp1108999"> </a>
<code class="cCodeBold">In_q_list</code>
</h4><div class="pDefPara"><a name="wp1109000"> </a>
Supplies an array containing the queue name for which the pending message count is requested
</div>
<h4 class="pDefTerm"><a name="wp1109001"> </a>
<code class="cCodeBold">Out_pend_list</code>
</h4><div class="pDefPara"><a name="wp1109002"> </a>
Receives the pending message count for each selected queue.
</div>
<h4 class="pHeading3"><a name="wp1079651"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1109148"> </a>
Upon failure, <code class="cCode">tpqshowpending()</code> sets tperrno to one of the following values.You can use <code class="cCode">tpqerrno()</code> and <code class="cCode">tpqstrerror()</code> to get the detail OTMQ error number and detail string error message
</p>
<h4 class="pDefTerm"><a name="wp1109149"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1109150"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1109151"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1109152"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1109153"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1109154"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1109155"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1109156"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1109157"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1109158"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076163"> </a>
tpqgetmsga()
</h3>
<h4 class="pHeading3"><a name="wp1076189"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076190"> </a>
<code class="cCode">tpqgetmsga()</code>&#8212;Requests asynchronous notification of a message arrival.
</p>
<h4 class="pHeading3"><a name="wp1076191"> </a>
Synopsis
</h4>
<a name="wp1109465"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqgetmsga (qspace, qname,  ctl,  data,  len ,  uact, uact_param , uflag, flags)</pre></div><h4 class="pHeading3"><a name="wp1076193"> </a>
Description
</h4>
<p class="pBody"><a name="wp1109393"> </a>
Requests asynchronous notification of a message arrival. In OTMQ, the <code class="cCode">tpqgetmsga</code> function is implemented using unsolicited message of Tuxedo. When calling <code class="cCode">tpqgetmsga</code>, it registers its own UNSOL message handler. When a message arrives in that queue that fits the selection condition of <code class="cCode">tpqgetmsga</code>, the message being dequeued will be sent through an UNSOL message to the application. Also if an UNSOL message has arrived, if the application setup its own message handling callback function, or an flag, the user callback function will be called, or the flag will be set to &quot;1&quot;, to inform the application that an message has been dequeued by <code class="cCode">tpqgetmsga</code>.
</p>
<p class="pBody"><a name="wp1109394"> </a>
Since UNSOL message is the infrastructure of <code class="cCode">tpqgetmsga</code>, to call this API, user must NOT set the NOTIFY to &quot;IGNORE&quot; in UBB. Also for some limitation, &quot;SIGNAL&quot; of notification mode is not supported on OpenVMS. 
</p>
<p class="pBody"><a name="wp1109396"> </a>
If a queue has been sent a recoverable message, the receiver program can confirm receipt of the message using the <code class="cCode">tpqconfirmmsg</code> function. The <code class="cCode">tpqconfirmmsg</code> function enables the successfully delivered message to be deleted from the message recovery system. 
</p>
<p class="pBody"><a name="wp1110400"> </a>
To use <code class="cCode">tpqgetmsga()</code>, you must first invoke <code class="cCode">tpqattach()</code>.
</p>
<p class="pBody"><a name="wp1110401"> </a>
<a href="functions.html#wp1120971">Table&#160;1-21</a> lists supported <code class="cCode">tpqgetmsga()</code> arguments:
</p>
<p class="pGraphic"><a name="wp1120935"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1120971table1120969"><caption><a name="wp1120971"> </a>
Table 1-21  tpqgetmsga() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1120981"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120983"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120985"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120987"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1120989"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120991"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120993"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120995"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120997"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1120999"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121001"> </a>
qname
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121003"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121005"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121007"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121009"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121011"> </a>
ctl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121013"> </a>
TPQCTL 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121015"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121017"> </a>
TPQCTL * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121019"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121021"> </a>
data
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121023"> </a>
char 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121025"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121027"> </a>
char ** 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121029"> </a>
Passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121031"> </a>
len
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121033"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121035"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121037"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121039"> </a>
Passed/returned
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121041"> </a>
uact
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121043"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121045"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121047"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121049"> </a>
Passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121051"> </a>
uact_param
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121053"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121055"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121057"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121059"> </a>
Passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121061"> </a>
uflag
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121063"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121065"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121067"> </a>
long * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121069"> </a>
Passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121071"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121073"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121075"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121077"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121079"> </a>
Passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1110402"> </a>
<code class="cCodeBold">qspace</code> 
</h4><div class="pDefPara"><a name="wp1110403"> </a>
Supplies the queue space name for enqueue the message. The max length is 15
</div>
<h4 class="pDefTerm"><a name="wp1109529"> </a>
<code class="cCodeBold">qname</code> 
</h4><div class="pDefPara"><a name="wp1109530"> </a>
Supplies the queue name for enqueue the message, the max length is 127
</div>
<h4 class="pDefTerm"><a name="wp1109632"> </a>
<code class="cCodeBold">ctl</code>
</h4><div class="pDefPara"><a name="wp1109633"> </a>
The TPQCTL structure 
</div>
<h4 class="pDefTerm"><a name="wp1109531"> </a>
<code class="cCodeBold">data</code>
</h4><div class="pDefPara"><a name="wp1109532"> </a>
For static buffer-style messaging, receives the name of a memory region where OTMQ writes the contents of the retrieved message.
</div>
<h4 class="pDefTerm"><a name="wp1109533"> </a>
<code class="cCodeBold">len</code>
</h4><div class="pDefPara"><a name="wp1109534"> </a>
Supplies the size of the buffer (in bytes) for static message buffers.
</div>
<h4 class="pDefTerm"><a name="wp1109640"> </a>
<code class="cCodeBold">uact</code>
</h4><div class="pDefPara"><a name="wp1109641"> </a>
user action
</div>
<h4 class="pDefTerm"><a name="wp1109643"> </a>
<code class="cCodeBold">uact_param</code>
</h4><div class="pDefPara"><a name="wp1109644"> </a>
user action parameters
</div>
<h4 class="pDefTerm"><a name="wp1109646"> </a>
<code class="cCodeBold">uflag</code>
</h4><div class="pDefPara"><a name="wp1109647"> </a>
Supplies the int value for the flag number to be set when the <code class="cCode">tpqgetmsga</code> function completes. When the <code class="cCode">tpqgetmsga</code> function executes, it clears this flag. If this argument value is not supplied, no flag is used.
</div>
<h4 class="pDefTerm"><a name="wp1109537"> </a>
<code class="cCodeBold">flags</code>
</h4><div class="pDefPara"><a name="wp1109538"> </a>
The flags supported by <code class="cCode">tpdeqplus</code> must be set as TPNOTIME
</div>
<h4 class="pHeading3"><a name="wp1079672"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1112982"> </a>
Upon failure,<code class="cCode"> tpqgetmsga() </code>returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. you can use <code class="cCode">tpqerrno()</code> and <code class="cCode">tpqstrerror()</code> to get the detail OTMQ error number and detail string error message. 
</p>
<p class="pBody"><a name="wp1112990"> </a>
<code class="cCode">tpqgetmsga() </code>sets <code class="cCode">tperrno</code> to one of the following values upon failure. (Unless otherwise noted, failure does not affect caller transaction, if one exists.)
</p>
<h4 class="pDefTerm"><a name="wp1109802"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1109803"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1109804"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1109805"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1109806"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1109807"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1109808"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1109809"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1109810"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1109811"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1109812"> </a>
<code class="cCodeBold">[TPEDIAGNOSTIC]</code>
</h4><div class="pDefPara"><a name="wp1109813"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via ctl structure.
</div>
<div class="pDefParaCont"><a name="wp1109814"> </a>
Diagnostic:
<a name="wp1109815"> </a>
The following diagnostic values are returned during the dequeuing of a message:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109816"> </a>
<code class="cCodeBold">[QMEINVAL]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109817"> </a>
An invalid flag value was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109818"> </a>
<code class="cCodeBold">[QMEBADRMID]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109819"> </a>
An invalid resource manager identifier was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109820"> </a>
<code class="cCodeBold">[QMENOTOPEN]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109821"> </a>
The resource manager is not currently open.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109822"> </a>
<code class="cCodeBold">[QMEBADMSGID]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109823"> </a>
An invalid message identifier was specified for dequeuing.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109824"> </a>
<code class="cCodeBold">[QMESYSTEM]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109825"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109826"> </a>
<code class="cCodeBold">[QMEOS]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109827"> </a>
An operating system error has occurred.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109828"> </a>
<code class="cCodeBold">[QMEABORTED]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109829"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109830"> </a>
<code class="cCodeBold">[QMEPROTO]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109831"> </a>
A dequeue was done when the transaction state was not active.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109832"> </a>
<code class="cCodeBold">[QMEBADQUEUE]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109833"> </a>
An invalid or deleted queue name was specified.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109834"> </a>
<code class="cCodeBold">[QMENOMSG]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109835"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109836"> </a>
<code class="cCodeBold">[QMBADPRIORITY]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109837"> </a>
Invalid priority value used for receive.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1109838"> </a>
<code class="cCodeBold">[QMNOTDCL]</code>
</h4></div>
<div class="pDefPara2"><a name="wp1109839"> </a>
Process has not been attached to OTMQ.
</div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076186"> </a>
tpqcancelget()
</h3>
<h4 class="pHeading3"><a name="wp1076212"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076213"> </a>
<code class="cCode">tpqcancelget()</code>&#8212;Cancels all pending tpqgetmsga requests that match the value specified in the sel_filter argument.
</p>
<h4 class="pHeading3"><a name="wp1076214"> </a>
Synopsis
</h4>
<a name="wp1076215"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqcancelget (qspace, sel_filter , flags)</pre></div><h4 class="pHeading3"><a name="wp1076216"> </a>
Description
</h4>
<p class="pBody"><a name="wp1110292"> </a>
Cancels all pending <code class="cCode">tpqgetmsga</code> requests that match the value specified in the sel_filter argument. When a pending tpqgetmsga request is canceled, the OTMQ Status Block (PSB) delivery status is set to <code class="cCode">OTMQ__CANCEL</code> and the specified action routine is queued. The tpqcancelget function waits until completion to allow for proper synchronization between the tpqcancelget function and the request for tpqgetmsga functions. 
</p>
<p class="pBody"><a name="wp1110293"> </a>
Any outstanding <code class="cCode">tpqgetmsga </code>function requests are canceled by the tpqexit function or at image exit.
</p>
<p class="pBody"><a name="wp1110294"> </a>
To use <code class="cCode">tpqcancelget()</code>, must first invoke <code class="cCode">tpqattach()</code>.
</p>
<a name="wp1110297"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>tpqcancelget can cancel those tpqgetmsga which set priority &gt;= 0 but sel_filter == NULL  by setting its parameter sel_filter to (0 | 0). </td></tr>
</table>

<a name="wp1110386"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>tpqcancelget with &quot;sel_filter&quot; being set as (OTMQ_PQ_PRI | x) CANNOT cancel those tpqgetmsga which set &quot;priority&quot; to x and &quot;sel_filter&quot; set to NULL.</td>
</tr>
</table>
<p class="pBody"><a name="wp1110416"> </a>
<a href="functions.html#wp1121165">Table&#160;1-22</a> lists supported <code class="cCode">tpqcancelget()</code> arguments:
</p>
<p class="pGraphic"><a name="wp1121222"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1121165table1121163"><caption><a name="wp1121165"> </a>
Table 1-22  tpqcancelget () Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1121175"> </a>
Argument
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121177"> </a>
Data Type
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121179"> </a>
Mechanism
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121181"> </a>
Prototype
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1121183"> </a>
Access
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121185"> </a>
qspace
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121187"> </a>
char
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121189"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121191"> </a>
char * 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121193"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121195"> </a>
sel_filter
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121197"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121199"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121201"> </a>
long 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121203"> </a>
passed
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121205"> </a>
flags
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121207"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121209"> </a>
reference 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121211"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1121213"> </a>
passed
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1110473"> </a>
<code class="cCodeBold">qspace </code>
</h4><div class="pDefPara"><a name="wp1110474"> </a>
Supplies the queue space whose requests asynchronous notification of a message arrival. 
</div>
<h4 class="pDefTerm"><a name="wp1110475"> </a>
<code class="cCodeBold">sel_filter</code> 
</h4><div class="pDefPara"><a name="wp1110476"> </a>
Reserve for later release. Only accpect 0 or NULL as input for now. 
</div>
<div class="pDefParaCont"><a name="wp1110477"> </a>
Supplies the criteria that enables the application to selectively cancel outstanding tpqgetmsga requests. For a description of the sel_filter argument, see the tpdeqplus function. For a description of how to create a complex selection filter, see the tpqsetselect function. 
</div>
<h4 class="pDefTerm"><a name="wp1110479"> </a>
<code class="cCodeBold">Flags</code>
</h4><div class="pDefPara"><a name="wp1110480"> </a>
If  tpqcancelget()  is within a transaction and the TPNOTRAN flag is not set, the api goes into transaction mode. 
</div>
<div class="pDefParaCont"><a name="wp1110481"> </a>
The following is a list of valid flags:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1110482"> </a>
<code class="cCodeBold">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1110484"> </a>
If the caller is in transaction mode and this flag is set, then the event publishing is not made on behalf of the caller&#39;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when posting events. If the event posting fails, the caller&#39;s transaction is not affected.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1110485"> </a>
<code class="cCodeBold">TPNOREPLY</code>
</h4></div>
<div class="pDefPara2"><a name="wp1110487"> </a>
Informs tpqcancelget () not to wait for the EventBroker to process all subscriptions for topic before returning. When TPNOREPLY is set, regardless of whether tpqpublish() returns successfully or not. When the caller is in transaction mode, this setting cannot be used unless TPNOTRAN is also set.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1110488"> </a>
<code class="cCodeBold">TPNOBLOCK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1110490"> </a>
The topic is not published if a blocking condition exists. If such a condition occurs, the call fails and tperrno is set to TPEBLOCK. When TPNOBLOCK is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1110491"> </a>
<code class="cCodeBold">TPNOTIME</code>
</h4></div>
<div class="pDefPara2"><a name="wp1110493"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div><h4 class="pHeading3"><a name="wp1079683"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1110624"> </a>
Upon failure, tpqcancelget() returns -1 and sets tperrno to indicate the error condition. You can use tpqerrno() and tpqstrerror() to get the detail OTMQ error number and detail string error message
</p>
<p class="pBody"><a name="wp1113408"> </a>
tpqcancelget () sets tperrno to one of the following values upon failure. 
</p>
<h4 class="pDefTerm"><a name="wp1110625"> </a>
<code class="cCodeBold">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1110626"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1110627"> </a>
<code class="cCodeBold">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp1110628"> </a>
Cannot access the qspace because it is not available.
</div>
<h4 class="pDefTerm"><a name="wp1110629"> </a>
<code class="cCodeBold">[TPETIME]</code>
</h4><div class="pDefPara"><a name="wp1110630"> </a>
This error code indicates that either a timeout has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1110631"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1110632"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1110633"> </a>
<code class="cCodeBold">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1110634"> </a>
An operating system error has occurred.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1113516"> </a>
tpqerrno()
</h3>
<h4 class="pHeading3"><a name="wp1113517"> </a>
Name
</h4>
<p class="pBody"><a name="wp1113518"> </a>
<code class="cCode">tpqerrno()</code>&#8212;Gets OTMQ system call errno. 
</p>
<h4 class="pHeading3"><a name="wp1113519"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1113520"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">Int tpqerrno(void);</code>
</p>
<h4 class="pHeading3"><a name="wp1113521"> </a>
Description
</h4>
<p class="pBody"><a name="wp1113522"> </a>
Tpqerrno() is used to retrieve the error code of OTMQ system call.
</p>
<h4 class="pHeading3"><a name="wp1130791"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1130832"> </a>
Upon success, <code class="cCode">tpqstrerror()</code> returns a pointer to a string that contains the error message text.
</p>
<p class="pBody"><a name="wp1130833"> </a>
If err is an invalid error code, <code class="cCode">tpqstrerror()</code> returns a NULL.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1076209"> </a>
tpqexit()
</h3>
<h4 class="pHeading3"><a name="wp1076247"> </a>
Name
</h4>
<p class="pBody"><a name="wp1076248"> </a>
<code class="cCode">tpqexit()</code>&#8212;Terminates all attachments between the application and the OTMQ queue service.
</p>
<h4 class="pHeading3"><a name="wp1076249"> </a>
Synopsis
</h4>
<a name="wp1130888"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br />int tpqexit(void);</pre></div><h4 class="pHeading3"><a name="wp1076251"> </a>
Description
</h4>
<p class="pBody"><a name="wp1076252"> </a>
Terminates all attachments between the application and the OTMQ queue service. All pending messages in queues which are not unlimited and multi-reader queues are discarded. To retain messages in permanently active queues, call tpdetachq with option TUXMSGQ_NOFLUSH_Q  before calling <code class="cCode">tpexitq</code>.
</p>
<h4 class="pHeading3"><a name="wp1130875"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1130923"> </a>
Upon failure, tpqcancelget() returns -1 and sets tperrno to indicate the error condition.
</p>
<h4 class="pDefTerm"><a name="wp1130925"> </a>
<code class="cCodeBold">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1130926"> </a>
<code class="cCode">tpqexit()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1130927"> </a>
<code class="cCodeBold">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1130928"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1130929"> </a>
<code class="cCodeBold">[TPESVCERR]</code>
</h4><div class="pDefPara"><a name="wp1130930"> </a>
A service routine encountered an error in tpqexit. If either SVCTIMEOUT in the UBBCONFIG file or TA_SVCTIMEOUT in the TM_MIB is non-zero, TPESVCERR is returned when a service timeout occurs.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1113653"> </a>
tpqstrerror()
</h3>
<h4 class="pHeading3"><a name="wp1113738"> </a>
Name
</h4>
<p class="pBody"><a name="wp1113654"> </a>
<code class="cCode">tpqstrerror()</code>&#8212;Gets Oracle Tuxedo Message Queue error message string details.
</p>
<h4 class="pHeading3"><a name="wp1113746"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1113657"> </a>
#include &lt;atmi.h&gt;<br />#include &lt;tmqentry.h&gt;<br />#include &lt;tmqreturn.h&gt;<br /><code class="cCode">Void tpqstrerror(int tpqerrno);</code>
</p>
<h4 class="pHeading3"><a name="wp1113757"> </a>
Description
</h4>
<p class="pBody"><a name="wp1113660"> </a>
<code class="cCode">tpqstrerror()</code> is used to retrieve the text of an error message from TMQ_CAT. err is the error code set in <code class="cCode">tperrno</code> when an OTMQ system function call returns a -1 or other failure value.
</p>
<p class="pBody"><a name="wp1128619"> </a>
You can use the pointer returned by <code class="cCode">tpqstrerror()</code> as an argument to <code class="cCode">userlog() </code>or the UNIX function <code class="cCode">fprintf()</code>.
</p>
<p class="pBody"><a name="wp1128623"> </a>
<a href="functions.html#wp1128627">Table&#160;1-23</a> lists <code class="cCode">tpqstrerror()</code>supported arguments:
</p>
<p class="pGraphic"><a name="wp1128656"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1128627table1128624"><caption><a name="wp1128627"> </a>
Table 1-23  tpqstrerror() Arguments

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1128637"> </a>
<span style="font-weight: bold">Argument</span>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1128639"> </a>
<span style="font-weight: bold">Data Type</span>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1128641"> </a>
<span style="font-weight: bold">Mechanism</span>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1128643"> </a>
<span style="font-weight: bold">Prototype</span>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1128645"> </a>
<span style="font-weight: bold">Access</span>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1128647"> </a>
<code class="cCode">tpqerrno</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1128649"> </a>
<code class="cCode">int </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1128651"> </a>
<code class="cCode">reference </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1128653"> </a>
<code class="cCode">int </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1128655"> </a>
<code class="cCode">passed</code>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pDefTerm"><a name="wp1113668"> </a>
<span style="font-weight: bold">tpqerrno()</span>
</h4><div class="pDefPara"><a name="wp1113774"> </a>
Gets OTMQ system call errno.
</div>
<h4 class="pHeading3"><a name="wp1113787"> </a>
Return Value(s)
</h4>
<p class="pBody"><a name="wp1113671"> </a>
Upon success, <code class="cCode">tpqstrerror()</code> returns a pointer to a string that contains the error message text.
</p>
<p class="pBody"><a name="wp1113672"> </a>
If err is an invalid error code, <code class="cCode">tpqstrerror()</code> returns a char *.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="functions.html"><img id="LongDescNotReq32" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq33" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="comands.html"><img id="LongDescNotReq34" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
