<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="40264" />
<meta name="LOC_US_SRCFILE" content="//depot/ecs/tcp/v11gr1/cicsug/fm/cicsprog.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="08/24/10 07:21:42" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Programming Oracle Tuxedo Mainframe Adapter for TCP (CICS)</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">CICS User Guide
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="cicsconf.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="cicsaper.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/cicsug.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1025409"> </a>
Programming Oracle Tuxedo Mainframe Adapter for TCP (CICS)
</h1>
<p class="pBody"><a name="wp1024222"> </a>
The following subsections identify issues that CICS programmers should be aware of when they develop or modify application programs that operate with Oracle Tuxedo Mainframe Adapter for TCP (CICS) (hereafter referenced as TMA TCP for CICS):
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1024232"> </a><a href="cicsprog.html#wp1024238"><span class="cHyperlink">
Client Application Considerations</span></a><span class="cHyperlink">
 </span></li>
<li><a name="wp1024236"> </a><a href="cicsprog.html#wp1024500"><span class="cHyperlink">
Server Application Considerations</span></a><span class="cHyperlink">
 </span></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024238"> </a>
Client Application Considerations
</h2><p class="pBody"><a name="wp1024988"> </a>
The following sections identify issues that CICS programers should be aware of when they develop or modify application programs that interoperate with TMA TCP for CICS as clients.
</p>
<p class="pBody"><a name="wp1024258"> </a>
To make requests to remote Oracle Tuxedo domains from CICS application programs, use the <code class="cCode">EXEC CICS LINK</code> command. The exact layout of the request/response data area is discussed in a later section.
</p>
<h3 class="pHeading2"><a name="wp1024261"> </a>
Buffer Layout Issues
</h3>
<p class="pBody"><a name="wp1024265"> </a>
The layout of the data buffer sent between CICS and Oracle Tuxedo should be agreed upon by the CICS applications programmer, the Oracle Tuxedo applications developer, and the Oracle Tuxedo administrator to ensure consistency and proper configuration. There are no limitations on the CICS programmer concerning native COBOL or C data types.
</p>
<h3 class="pHeading2"><a name="wp1024273"> </a>
Making Calls from a CICS Client Program
</h3>
<p class="pBody"><a name="wp1024274"> </a>
To make a service call from a CICS program to a remote Oracle Tuxedo domain, make an <code class="cCode">EXEC CICS LINK</code> call to the Pre-requester. The service you want to access must be configured by the Oracle TMA Administrator, but from a programming point of view the <code class="cCode">LINK</code> call is all you need. The following COBOL record is in the COBOL copybook <code class="cCode">client.cbl</code>.
</p>
<div class="pCodeTitle"><a name="wp1024278"> </a>
Listing&#160;5-1	   COBOL Record
</div> <a name="wp1024279"> </a><div class="pPreformatted"><pre>01 REQUEST-RECORD.<br />    05  REQUEST-HEADER.<br />          10 DATALEN           PIC S9(08) COMP.<br />          10 SVCNAME[16]       PIC X(16).<br />          10 REQUESTCD         PIC S9(08) COMP.<br />          10 RETURNCD          PIC S9(08) COMP.<br />          10 REQRETURNCD       PIC S9(08) COMP.<br />    05 REQUEST-DATA.<br />          10 DATA-AREA          PIC X(DATALEN).</pre></div><p class="pBody"><a name="wp1024281"> </a>
The layout of the structure in C that must be passed in the <code class="cCode">LINK</code> call is shown in <a href="cicsprog.html#wp1024286"><span class="cHyperlink">
Listing&#160;5-2</span></a>. The following C structures are in the <code class="cCode">clienth.h</code> <code class="cCode">INCLUDE</code> file.
</p>
<div class="pCodeTitle"><a name="wp1024286"> </a>
Listing&#160;5-2	   C Structures
</div> <a name="wp1024287"> </a><div class="pPreformatted"><pre>typedef struct CLIENTHDR<br />{<br /> long DataLen;          /* THE LEN OF THE DATA FROM AND TO APPL */<br /> char SvcName[16];      /* THE SERVICE NAME */<br /> long RequestCd;        /* THE REQUEST COMMAND FROM THE APPL */<br /> long ReturnCd;         /* THE RETURN CODE TO THE APPL */<br /> long ReqReturnCd;      /* THE RETURN CODE FROM THE PREQ AND REQ */<br />}  CLIENTHDR;<br /><br />typedef struct CMAREA<br />{<br />  CLIENTHDR CltHdr;                    /*HEADER */<br />  char Request_data[MAX_DATA_LENGTH];  /* REQUEST DATA */<br />} CMAREA;<br /></pre></div><p class="pBody"><a name="wp1024289"> </a>
The variables in the previous COBOL and C examples are defined as follows.
</p>
<h4 class="pDefTerm"><a name="wp1024290"> </a>
<code class="cCode">DataLen</code>
</h4><div class="pDefPara"><a name="wp1024291"> </a>
The length of the data in the <code class="cCode">Request_data</code> field.
</div>
<h4 class="pDefTerm"><a name="wp1024292"> </a>
<code class="cCode">SvcName</code>
</h4><div class="pDefPara"><a name="wp1024293"> </a>
The service request name (ask the administrator for the names).
</div>
<h4 class="pDefTerm"><a name="wp1024294"> </a>
<code class="cCode">RequestCd</code>
</h4><div class="pDefPara"><a name="wp1024295"> </a>
A predefined numeric value that indicates the type of call this is.
</div>
<div class="pDefParaCont"><a name="wp1024296"> </a>
<code class="cCode">BEA_REQUEST_NORESPONSE</code> - Value is 7. A No Reply Service Request. In this case the request is sent over to Oracle Tuxedo for the service to be performed, but no response data is sent back.
<a name="wp1024297"> </a>
<code class="cCode">BEA_REQUEST_RESPONSE</code> - Value is 5. A Request/Response Request. A request is sent to Oracle Tuxedo and a response is expected back.
<p class="pGraphic"><a name="wp1024315"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1024300table1024298"><caption><a name="wp1024300"> </a>
Table 5-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Request Codes</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1024304"> </a>
Code
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1024306"> </a>
Value
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024308"> </a>
<code class="cCode">BEA-REQUEST-RESPONSE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024310"> </a>
+5.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024312"> </a>
<code class="cCode">BEA-REQUEST-NORESPONSE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024314"> </a>
+7.
</div>
</td>
</tr>
</table>
</div>

</p>
</div>
<h4 class="pDefTerm"><a name="wp1024316"> </a>
<code class="cCode">ReturnCd</code>
</h4><div class="pDefPara"><a name="wp1024319"> </a>
This code is the return code from the CICS Requester.
</div>
<div class="pDefParaCont"><a name="wp1024320"> </a>
All return codes are listed in the following table. Notify the administrator if any of the return codes indicate a processing or network problem.
<a name="wp1024323"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>For a complete description of these codes, refer to the <a href="cicsaper.html#wp1051397"><span class="cHyperlink">
Codes Returned to a CICS Client Program</span></a> section in Appendix A.</td>
</tr>
</table>

<p class="pGraphic"><a name="wp1024422"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1024327table1024325"><caption><a name="wp1024327"> </a>
Table 5-2  Return Codes

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1024331"> </a>
Code
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1024333"> </a>
Value
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024335"> </a>
<code class="cCode">BEA-NORMAL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024337"> </a>
+0.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024339"> </a>
<code class="cCode">BEA-ERR-LENGTH</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024341"> </a>
+1.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024343"> </a>
<code class="cCode">BEA-ERR-MISSING-SRV-NAME</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024345"> </a>
+2.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024347"> </a>
<code class="cCode">BEA-ERR-REQ-CODE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024349"> </a>
+3.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024351"> </a>
<code class="cCode">BEA-ERR-SRC-NOT-FOUND</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024353"> </a>
+4.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024355"> </a>
<code class="cCode">BEA-ERR-READ-UMT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024357"> </a>
+5.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024359"> </a>
<code class="cCode">BEA-ERR-SERVER</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024361"> </a>
+6.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024363"> </a>
<code class="cCode">BEA-ERR-POST</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024365"> </a>
+7.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024367"> </a>
<code class="cCode">BEA-ERR-CANCEL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024369"> </a>
+8.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024371"> </a>
<code class="cCode">BEA-ERR-WAIT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024373"> </a>
+9.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024375"> </a>
<code class="cCode">BEA-ERR-LMID-NOT-FOUND</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024377"> </a>
+10.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024379"> </a>
<code class="cCode">BEA-ERR-START-TRANSID</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024381"> </a>
+11.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024383"> </a>
<code class="cCode">BEA-ERR-DISABLE-ACQUIRING</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024385"> </a>
+12.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024387"> </a>
<code class="cCode">BEA-ERR-DISABLE-NOT-FND</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024389"> </a>
+13.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024391"> </a>
<code class="cCode">BEA-ERR-DISABLE-NOT-RESPOND</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024393"> </a>
+14.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024395"> </a>
<code class="cCode">BEA-ERR-DISABLE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024397"> </a>
+15.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024399"> </a>
<code class="cCode">BEA-ERR-ALLOC</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024401"> </a>
+16.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024403"> </a>
<code class="cCode">BEA-ERR-TIMEOUT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024405"> </a>
+17.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024407"> </a>
<code class="cCode">BEA-ERR-TSQ</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024409"> </a>
+18.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024411"> </a>
<code class="cCode">BEA-ERR-SOCKET-FAILURE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024413"> </a>
+19.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024415"> </a>
<code class="cCode">BEA-ERR-PROTOCOL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024417"> </a>
+20.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024419"> </a>
<code class="cCode">BEA-ERR-QUEUE-OVERFLOW</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1024421"> </a>
+21.
</div>
</td>
</tr>
</table>
</div>

</p>
</div>
<h4 class="pDefTerm"><a name="wp1024423"> </a>
<code class="cCode">ReqReturnCd</code>
</h4><div class="pDefPara"><a name="wp1025133"> </a>
This code is the return code from the Oracle Tuxedo Domain. See the Tuxedo documentation for a complete list of Tuxedo error codes
</div>
<h4 class="pDefTerm"><a name="wp1025144"> </a>
<code class="cCode">Request_data</code>
</h4><div class="pDefPara"><a name="wp1024424"> </a>
This area is the area where request data gets placed and in which your returned data arrives. The length depends on how long this particular service is configured. Check with the administrator for each service. The maximum value is 32000.
</div>
<h4 class="pHeading3"><a name="wp1024425"> </a>
Examples
</h4>
<p class="pBody"><a name="wp1024426"> </a>
The following sample is an example of a COBOL CICS client program.
</p>
<div class="pCodeTitle"><a name="wp1024427"> </a>
Listing&#160;5-3	   COBOL CICS Client Program Example
</div> <a name="wp1024428"> </a><div class="pPreformatted"><pre> IDENTIFICATION DIVISION.</pre></div><a name="wp1024429"> </a><div class="pPreformatted"><pre> PROGRAM-ID.   TESTCLN.<br /> ENVIRONMENT   DIVISION.<br /> CONFIGURATION SECTION.<br /> SOURCE-COMPUTER. IBM-3090.<br /> OBJECT-COMPUTER. IBM-3090.<br /> DATA DIVISION.<br /> WORKING-STORAGE SECTION.<br /> 01 FILLER   PIC X(32) VALUE &#39;SAMPLE COBOL CICS CLIENT PROGRAM&#39;.<br /> 01 MSG-AREA.<br />    05 M-DATA          PIC X(42) VALUE SPACES.<br />    05 M-RCDE          PIC Z(05) VALUE ZEROS.<br /> 01 WS-COMMAREA.<br />    05  WC-DATALEN     PIC S9(9) COMP-4.<br />    05  WC-SVCNAME     PIC X(16).<br />    05  WC-REQUESTCD   PIC S9(9) COMP-4.<br />    05  WC-RETURNCD    PIC S9(9) COMP-4.<br />    05  WC-REQRETURNCD PIC S9(9) COMP-4.<br />    05  WC-REQDATA     PIC X(14).<br /> LINKAGE SECTION.<br /> 01 DFHCOMMAREA        PIC X(14).<br /> PROCEDURE DIVISION.<br /> A100-ENTRY.<br />     MOVE +14              TO WC-DATALEN.<br />     MOVE &#39;TOLOWER&#39;        TO WC-SVCNAME.<br />     MOVE +5               TO WC-REQUESTCD.<br />     MOVE &#39;THIS IS A TEST&#39; TO WC-REQDATA.<br />     EXEC CICS LINK PROGRAM(&#39;BEAPRERQ&#39;)<br />               COMMAREA(WS-COMMAREA)<br />               LENGTH(LENGTH OF WS-COMMAREA)<br />     END-EXEC.<br />     IF RETURNCD = 0<br />        MOVE &#39;SUCCESSFUL CALL, RETURN DATA IS IN WC-DATA&#39;<br />          TO MSG-DATA<br />     ELSE<br />        MOVE &#39;PROCESS ERROR OCCURRED, RETURN CODE EQUAL &#39;<br />          TO MSG-DATA<br />        MOVE RETURNCD TO M-RCDE<br />     END-IF.<br />     EXEC CICS SEND TEXT FROM(MSG-AREA) LENGTH(47)<br />               ERASE TERMINAL FREEKB CURSOR(0)<br />     END-EXEC.<br /> A200-EXIT.<br />     EXEC CICS RETURN END-EXEC.</pre></div><p class="pBody"><a name="wp1024431"> </a>
The following is an example of a C CICS client program.
</p>
<div class="pCodeTitle"><a name="wp1024432"> </a>
Listing&#160;5-4	   C CICS Client Program Example
</div> <a name="wp1024433"> </a><div class="pPreformatted"><pre><code class="cCode">long resp, resp2;<br />unsigned short int lmsg;<br />struct CMAREA carea;<br /></code></pre></div><a name="wp1024434"> </a><div class="pPreformatted"><pre><code class="cCode">carea.CltHdr.DataLen = strlen(sendbuf);<br />memcpy(carea.CltHdr.SvcName, &#8220;ECHO&#8221;, 4);<br />carea.CltHdr.RequestCd = BEA_REQUEST_RESPONSE;<br />memcpy(carea.Request_data, &#8220;This is a test&#8221;, 14);<br />lmsg=sizeof(carea);<br />/* Use the name defined during installation */<br />EXEC CICS LINK PROGRAM(&quot;PREREQ&quot;) <br />                           COMMAREA(&amp;carea)<br />                           LENGTH(lmsg) RESP(resp) RESP2(resp2);<br /></code></pre></div><a name="wp1024435"> </a><div class="pPreformatted"><pre><code class="cCode">if(carea.CltHdr.ReturnCd || carea.CltHdr.ReqReturnCd)<br />           process error;<br />else<br />           successful call, returned data is in Request_data;</code></pre></div><a name="wp1024437"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>C Programmers, do not include the NULL terminator on any strings. In the previous example, the <code class="cCode">memxxx</code> calls were used instead of the <code class="cCode">strxxx</code> calls. This example is typical when using C and CICS together. For more information see your <em class="cEmphasis">C for CICS</em> documentation.</td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1024439"> </a>
Error Handling
</h3>
<p class="pBody"><a name="wp1024443"> </a>
You may encounter the following three types of errors while using TMA TCP for CICS:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1024444"> </a>Gateway errors (communications problems)</li>
<li><a name="wp1024445"> </a>MVS or CICS errors</li>
<li><a name="wp1024446"> </a>Application errors</li>
</ul></div>
<p class="pBody"><a name="wp1024450"> </a>
The following subsections explain how TMA TCP handles these different kinds of errors.
</p>
<h4 class="pHeading3"><a name="wp1024452"> </a>
Gateway Errors
</h4>
<p class="pBody"><a name="wp1024456"> </a>
When local or remote gateway errors occur they are logged in the Oracle Tuxedo <code class="cCode">ULOG</code> file on the remote Oracle Tuxedo node and in the <code class="cCode">BEALOG</code> file (a TD Queue defined during installation) within the CICS region. All associated service requests fail and if the TMA gateways are able to communicate with each other, error messages are communicated between them.
</p>
<h4 class="pHeading3"><a name="wp1024464"> </a>
MVS or CICS Errors
</h4>
<p class="pBody"><a name="wp1024468"> </a>
For requests originating in the Oracle Tuxedo domain, if the remote target system does not make it possible for TMA TCP for CICS to detect particular types of failure, the TMA TCP gateway (the Oracle Tuxedo domain) blocking time-out parameter can be tuned to provide timely detection of problems. This configuration parameter is set in the remote TMA TCP gateway system; discuss any changes you want to make with the administrator of that system. 
</p>
<p class="pBody"><a name="wp1024481"> </a>
Problems with requests that originate in the CICS region are also logged to the <code class="cCode">BEALOG</code> file. Additionally, time-out periods for these requests can be tuned using the TMA TCP for CICS administration tool. 
</p>
<p class="pBody"><a name="wp1024487"> </a>
For more information about the blocking time-out parameter, refer to the<span style="font-style: italic"> Oracle </span>TMA TCP gateway<span style="font-style: italic"> User Guide</span>.
</p>
<h4 class="pHeading3"><a name="wp1024490"> </a>
Application Errors
</h4>
<p class="pBody"><a name="wp1024491"> </a>
If an error occurs that makes the Handler unable to execute a certain program (such as, the program does not exist or is disabled) the Handler sends a message back to the TMA TCP gateway gateway. If any other type of error occurs within an application program and the Handler is not notified of the problem, a time-out message is sent from the Handler back to the remote gateway.
</p>
<p class="pBody"><a name="wp1024498"> </a>
For requests originating with CICS, Oracle Tuxedo returns information about specific problems, if possible. If there are network problems that prohibit the transmission of data, the request receives a timeout error.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024500"> </a>
Server Application Considerations
</h2><p class="pBody"><a name="wp1024501"> </a>
The following subsections identify issues that CICS programmers should be aware of when they develop or modify application programs that interoperate with TMA TCP for CICS as servers.
</p>
<p class="pBody"><a name="wp1025062"> </a>
A CICS application program that processes requests originating from a remote Oracle Tuxedo domain is written like a CICS application program that is invoked with the <code class="cCode">CICS LINK</code> command.
</p>
<p class="pBody"><a name="wp1025067"> </a>
The CICS programs that work best for satisfying Oracle Tuxedo requests are the ones that perform a certain operation and return information to the caller. The CICS services requested by a Oracle Tuxedo client program must entail a single request/response scenario.
</p>
<p class="pBody"><a name="wp1025074"> </a>
CICS service programs that are called from Oracle Tuxedo clients must be careful if they give up control, as when performing an <code class="cCode">EXEC CICS XCTL</code> operation. To ensure that the response data is returned to the client, chaining programs must pass the original <code class="cCode">COMMAREA</code> during the XCTL so that it may be <code class="cCode">RETURN</code>ed to the TMA TCP for CICS Handler by the final program in the chain.
</p>
<h3 class="pHeading2"><a name="wp1024505"> </a>
Programming Services with a Response
</h3>
<p class="pBody"><a name="wp1024506"> </a>
Service programs expected to send a response to the client use the <code class="cCode">EXEC CICS LINK</code> command to execute. The <code class="cCode">COMMAREA</code> option contains a pointer to the raw data; therefore, no header is sent. As a result, the request data is available to the service programs in the <code class="cCode">COMMAREA</code>.
</p>
<h3 class="pHeading2"><a name="wp1024508"> </a>
Programming Services without a Response
</h3>
<p class="pBody"><a name="wp1024509"> </a>
Service programs that do not send replies back to the requester execute using transactions started by the <code class="cCode">EXEC CICS START</code> command. The <code class="cCode">FROM</code> option of this command contains a pointer to the raw data; therefore, no header is sent. As a result, such service programs must use an <code class="cCode">EXEC CICS RETRIEVE</code> command with the <code class="cCode">SET</code> option containing a pointer to the raw data.
</p>
<a name="wp1024510"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Define a unique transaction for each service that does not send a reply and enter the name of that transaction in the <code class="cCode">TRANSACTION NAME</code> field of the Inbound Service Information screen for the corresponding service.</td>
</tr>
</table>

<p class="pBody"><a name="wp1024511"> </a>
An example of a service sending no reply is one requested by a client using a tpacall with the <code class="cCode">TPNOREPLY</code> flag set. 
</p>
<h3 class="pHeading2"><a name="wp1024512"> </a>
Modifying the Length of the Return Message
</h3>
<p class="pBody"><a name="wp1024513"> </a>
You can manage the actual size of the return message the system sends over the gateway on a per request basis. This is different than simply limiting the message size for a particular service using the <code class="cCode">MAX MESSAGE</code> field of the Inbound Service Information screen. To limit the size of the return message per request, the service program must <code class="cCode">ADDRESS</code> the TWA using the copybook or the include file delivered in the &quot;YOURHLQ&quot;.BEATCPC.INCLUDE file.
</p>
<h4 class="pHeading3"><a name="wp1024514"> </a>
Modifying Return Message Lengths for C Programs
</h4>
<p class="pBody"><a name="wp1024515"> </a>
To modify the return message length on a per request basis, specify the message length in the <code class="cCode">rtnMsgSize</code> field in a <code class="cCode">TWA_CONNECT</code> structure defined in the <code class="cCode">TWAINCL</code> file.
</p>
<h4 class="pHeading3"><a name="wp1024516"> </a>
Modifying Return Message Lengths for COBOL Programs
</h4>
<p class="pBody"><a name="wp1024517"> </a>
To modify the return message length on a per request basis, specify the message length in the <code class="cCode">RTN-MSG-SIZE</code> field in a <code class="cCode">TWA_CONNECT</code> record layout in the copybook <code class="cCode">TWACOPY</code>.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="cicsprog.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="cicsconf.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="cicsaper.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
