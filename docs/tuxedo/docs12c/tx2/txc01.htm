<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<title>Introducing TxRPC</title>
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1 Build 128" />
<meta name="date" content="2008-12-09T7:52:54Z" />
<meta name="robots" content="noarchive" />
<meta name="doctitle" content="Introducing TxRPC" />
<meta name="relnum" content="Release 5.1" />
<meta name="partnum" content="A12345-01" />
<link rel="copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="stylesheet" href="../../dcommon/css/blafdoc.css" title="Oracle BLAFDoc" type="text/css" />
<link rel="contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="prev" href="preface.htm" title="Previous" type="text/html" />
<link rel="next" href="txc02.htm" title="Next" type="text/html" />
</head>
<body>
<div class="header"><a id="top" name="top"></a>
<div class="zz-skip-header"><a href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Programming an Oracle Tuxedo Application Using TxRPC</b><b></b></td>
<td valign="bottom" align="right">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="225">
<tr>
<td>&nbsp;</td>
<td align="center" valign="top"><a href="toc.htm"><img src="../../dcommon/gifs/toc.gif" alt="Go To Table Of Contents" /><br />
<span class="icon">Contents</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100">
<tr>
<td align="center"><a href="preface.htm"><img src="../../dcommon/gifs/leftnav.gif" alt="Previous" /><br />
<span class="icon">Previous</span></a>&nbsp;</td>
<td align="center"><a href="txc02.htm"><img src="../../dcommon/gifs/rightnav.gif" alt="Next" /><br />
<span class="icon">Next</span></a></td>
<td>&nbsp;</td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<!-- class="header" -->
<div class="ind"><!-- End Header --><a id="i1000012" name="i1000012"></a>
  <h1 class="chapter"><span class="secnum">1</span> Introducing TxRPC</h1>
<p>This topic includes the following section:</p>
<ul>
<li>
<p><a href="#i999890">What Is TxRPC?</a></p>
</li>
</ul>
<a id="i999890" name="i999890"></a>
<div class="sect1">
<h2 class="sect1">What Is TxRPC?</h2>
<p>The TxRPC feature allows programmers to use a remote procedure call (RPC) interface, such that a client process can call a remote function (that is, a remote service) in another process using a local function call. The application writer must specify the operations (that is, procedures) and data types that are used as parameters to those operations via an Interface Definition Language (IDL). <span class="italic">Operations</span> are grouped together in an <span class="italic">interface</span>. An IDL compiler is used to generate substitute procedures called <span class="italic">stubs</span> which allow the operation to be remote. An important concept to understand from the beginning is that there are two fundamental levels of naming: the interface has a name and within an interface, one or more operations are named. At run time, the interface is made available, which means that any of the operations in the interface can be called; an individual operation within an interface cannot be made available (if you need this, define the operation in its own interface).</p>
<p>The following illustrates how an RPC is made to look like a local procedure call.</p>
<div class="figure"><a id="sthref10" name="sthref10"></a>
<p class="titleinfigure">Figure 1-1 RPC Communication</p>
<img src="img/tx_1.gif" alt="Description of Figure 1-1 follows" title="Description of Figure 1-1 follows" longdesc="img_text/tx_1.htm" /><br />
<br /></div>
<!-- class="figure" -->
<p>The client application code calls one of the operations (functions) defined in the IDL file. Instead of calling the actual function, which resides on the server side, the client stub is called. The client stub is generated by the IDL compiler based on the IDL input file, which defines the data types and operations. For each operation, the input parameters, return type, and output parameters are defined. The client stub takes the input parameters and converts them into a single buffer of data, sends the data to the server and waits for a response, and unpacks the buffer of data sent back from the server (the return value and output parameters). The communication between the client and server processes, whether intra-machine or inter-machine is handled by the Oracle Tuxedo ATMI run time.</p>
<p>On the server side, the run time calls the server stub for the interface, also generated by the IDL compiler. This stub unpacks the data buffer that contains the input parameters, in some cases it allocates space needed for output parameters of the operation, calls the operation and waits for it to return, packs the return value and output parameters into a buffer and sends the response back to the client.</p>
<p>From the application perspective, it appears that a simple local procedure call is done. The stubs and the run time hide the calling of a remote procedure in a non-local address space (process).</p>
<p>The steps for building an application using remote procedure calls is very similar to building one without these calls. Most of the time will be spent writing the application code for the client and the server (where the real application work is done). The Oracle Tuxedo ATMI run time frees the application programmer from worrying about communications, translation of the data from the format used on the client machine to the format used on the server machine, and so forth. TxRPC may also be used to communicate between servers.</p>
<p>In addition to the steps needed for building a monolithic application, it is necessary to completely define the interface between the client and server. As stated earlier, the interface contains the definition of data types and operations used for the remote procedure calls. Normally, the name of the file containing the definition has an "<code>.idl</code>" suffix; using this convention makes the file type self-documenting.</p>
<p>Every interface must have its own unique identifier. This Universal Unique Identifier (UUID) consists of 128-bits that uniquely identify the interface among all interfaces. The job of generating a UUID is done for the application programmer by the <code>uuidgen</code> program. By running the <code>uuidgen</code> program with the <code>-i</code> option, it generates an interface template that contains a new UUID. Refer to <a href="txxa.htm#g1027039">Appendix A, "A Sample Application,"</a> for a complete example (including code) for the development of a simple RPC application; the first step illustrates how to run the <code>uuidgen</code> command and the resulting output. More information about other options of this command are given in the <code>uuidgen(1)</code> manual page.</p>
<p>The UUID is used at run time to ensure that the client stub matches the server stub on the receiving side. That is, the UUID is sent from the client to the server for validation by the Oracle Tuxedo ATMI run time, transparent to the application programmer.</p>
<p>Besides matching on the UUID, each interface also has a version number associated with it. The version consists of a major and minor number. If a version number is not specified as part of the interface definition, it defaults to 0.0. Thus, there may be multiple versions of the same interface available. The client requests a particular version of an interface by invoking the RPC in the stub generated from a particular interface version. Different versions imply that data types or operation parameters or returns have changed, or operations have been added to or deleted from the interface. Thus, the client and server UUID's and versions must match for a successful RPC. The application programmer must ensure that versions of the interface that have the same version numbers do provide the same (or a compatible) interface.</p>
<p>Once the template IDL is generated by <code>uuidgen</code>, the application program must provide a definition of all data types and operations in the interface. The language looks very much like the declarative parts of C or C++ (without the procedural statements). Data types are declared via <code>typedef</code> statements, and the operations are declared via function prototypes. Additional information is provided via IDL <span class="italic">attributes</span>. Attributes appear in the language within square brackets, for example, [in]. These provide information about such things as pointer types (for example, whether or not a pointer can be NULL at run time), about parameters (for example, whether a parameter is for input, output, or both), and much more. The IDL language and the associated compiler are discussed further in <a href="txc02.htm#g1011886">Chapter 2, "Using the Interface Definition Language (IDL)."</a></p>
<p>In addition to the IDL file, an optional Attribute Configuration File (ACF) may also be provided to give additional attributes of the interface. Most important is the definition of status variables in the operations for returning the status of each RPC operation. The use of status variables will be discussed further in <a href="txc03.htm#g1016763">Chapter 3, "Writing RPC Client and Server Programs."</a> Attributes in the ACF file do not affect the communications between the client and server (as do attributes in the IDL file), but generally have an impact on the interface between the application code and the generated stubs.</p>
<p>When using the Oracle Tuxedo ATMI run time, the management of the binding (connection) between the client and server is done transparently. There is no information provided by the client or server application code to manage the client/server binding. (In contrast, when using the OSF DCE run time, considerable effort by the programmer must be given to binding management. Oracle Tuxedo ATMI runtime does not support the OSF DCE run time functions and ignores binding attributes in IDL and ACF files.)</p>
<p>The IDL and optional ACF files are compiled using the IDL compiler. The compiler first generates a header file that contains all of the type definitions and function prototypes for the operations defined in the IDL file. This header file can be included in application code that makes RPC calls defined in the interface. If the input files are <code><span class="codeinlineitalic">file</span></code><code>.idl</code> and <code><span class="codeinlineitalic">file</span></code><code>.acf</code>, then the default header file name is <code><span class="codeinlineitalic">file</span></code><code>.h</code>. The compiler generates stub code for both the client and server (for example, <code><span class="codeinlineitalic">file</span></code><code>_cstub.c</code> and <code><span class="codeinlineitalic">file</span></code><code>_sstub.c</code>). These stub files were described earlier and contain the data packaging and communications for the RPC. By default, the IDL compiler invokes the C compiler to generate client and server stub object files (for example, <code><span class="codeinlineitalic">file</span></code><code>_cstub.o</code> and <code><span class="codeinlineitalic">file</span></code><code>_sstub.o</code>) and the stub source files are removed. There are various IDL compiler options to request, limit generation of, and keep source and object files, and change the output filenames and directories. See the <code>tidl(1)</code> reference page for further details.</p>
<p>After completing the interface definition, the major portion of work is writing the application code. The client code will call the operations defined in the interface, and the server code must implement the operations (note that a server can also act as a client by calling an RPC). Further considerations regarding writing the application are discussed in <a href="txc02.htm#g1011886">Chapter 2, "Using the Interface Definition Language (IDL)."</a></p>
<p>When the application code is completed, it's time to compile and link it together with the Oracle Tuxedo ATMI run time. Two programs are provided to simplify this process: <code>buildserver</code> for the server, and <code>buildclient</code> for the client. These programs compile any source files and link the object and library files with the Oracle Tuxedo ATMI run time to produce the executable files. These programs allow for alternate compilers and compilation options to be specified. See the <code>buildserver(1)</code> and <code>buildclient(1)</code> reference pages for further details.</p>
<p>The complete process for building a server and client are shown in <a href="#i999990">Figure 1-2</a> and <a href="#i999997">Figure 1-3</a>. More details about building client and server programs on different platforms are provided in <a href="txc04.htm#g1023232">Chapter 4, "Building RPC Client and Server Programs."</a></p>
<div class="figure"><a id="i999990" name="i999990"></a>
<p class="titleinfigure">Figure 1-2 Building an RPC Server</p>
<img src="img/tx_2.gif" alt="Surrounding text describes Figure 1-2 ." title="Surrounding text describes Figure 1-2 ." /><br /></div>
<!-- class="figure" -->
<p><a href="#i999990">Figure 1-2</a> illustrates the following steps in the process for building a server:</p>
<ol>
<li>
<p>Run <code>uuidgen</code> to generate a skeleton IDL file (<code>simp.idl</code>) with a <code>UUID</code>. Edit the template IDL file to define the interface between the client and server using the interface definition language.</p>
</li>
<li>
<p>Run the IDL compiler (<code>tidl</code>) using <code>simp.idl</code> and optional <code>simp.acf</code> to generate the interface header file and the server stub object file.</p>
</li>
<li>
<p>After writing the server application code (<code>server.c</code>), run <code>buildserver</code> to compile it and link it with the server stub, Oracle Tuxedo ATMI run time, and TxRPC run time to generate an executable server.</p>
</li>
</ol>
<div class="figure"><a id="i999997" name="i999997"></a>
<p class="titleinfigure">Figure 1-3 Building an RPC Client</p>
<img src="img/tx_3.gif" alt="Surrounding text describes Figure 1-3 ." title="Surrounding text describes Figure 1-3 ." /><br /></div>
<!-- class="figure" -->
<p>The preceding figure illustrates the process for building a client.</p>
<ol>
<li>
<p>Using the IDL file created in Step 1, run the IDL compiler (<code>tidl</code>) to generate the interface header file and the client stub object file.</p>
</li>
<li>
<p>After writing the client application code (<code>client.c</code>), run <code>buildclient</code> to compile it and link it with the client stub, Oracle Tuxedo ATMI run time, and TxRPC run time to generate an executable client.</p>
</li>
</ol>
<p>After building the application client and server, the application can be configured and booted, and the client run. This is discussed in <a href="txc05.htm#g1005205">Chapter 5, "Running the Application."</a></p>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<!-- Start Footer -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td valign="bottom">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100">
<col width="*" />
<col width="48%" />
<col width="48%" />
<tr>
<td>&nbsp;</td>
<td align="center"><a href="preface.htm"><img src="../../dcommon/gifs/leftnav.gif" alt="Previous" /><br />
<span class="icon">Previous</span></a>&nbsp;</td>
<td align="center"><a href="txc02.htm"><img src="../../dcommon/gifs/rightnav.gif" alt="Next" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="copyrightlogo"><img class="copyrightlogo" src="../../dcommon/gifs/oracle.gif" alt="Oracle Logo" /><br />
<span class="copyrightlogo">Copyright&nbsp;&copy;&nbsp;1996, 2009,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.</span> <a href="../../dcommon/html/cpyr.htm"><br />
<span class="copyrightlogo">Legal Notices</span></a></td>
<td valign="bottom" align="right">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="225">
<tr>
<td>&nbsp;</td>
<td align="center" valign="top"><a href="toc.htm"><img src="../../dcommon/gifs/toc.gif" alt="Go To Table Of Contents" /><br />
<span class="icon">Contents</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<!-- class="footer" -->
</body>
</html>
