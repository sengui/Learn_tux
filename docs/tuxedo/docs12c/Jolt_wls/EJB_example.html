<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/Jolt_wls/fm/EJB_example.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:15:51" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Servlet with Enterprise JavaBean Example</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Using Oracle Jolt with Oracle WebLogic Server
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="EXsimpapp.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/Jolt_wls.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1008698"> </a>
Servlet with Enterprise JavaBean Example
</h1>
<p class="pBody"><a name="wp1006654"> </a>
To use the Servlet with Enterprise JavaBean example, see the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1007145"> </a><a href="EJB_example.html#wp1006035">About the Servlet with JavaBean Example</a></li>
<li><a name="wp1007154"> </a><a href="EJB_example.html#wp1006057">Preparing to Use the Servlet with JavaBean Example</a></li>
<li><a name="wp1007167"> </a><a href="EJB_example.html#wp1007110">Run the Servlet with JavaBean Example</a></li>
</ul></div>
<p class="pBody"><a name="wp1007140"> </a>
This Enterprise JavaBean (EJBean) example package contains the classes and other files necessary to set up and run an EJBean stateful session to a Tuxedo Server using Jolt. The package contents are as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1006022"> </a>Client application (client application documentation and source)</li>
<li><a name="wp1006024"> </a>				Deployment</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1006025"> </a><code class="cCode">DeploymentDescriptor.txt</code></li>
<li><a name="wp1006026"> </a><code class="cCode">manifest</code></li>
</ul></div>
<li><a name="wp1006027"> </a>Interfaces</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1006028"> </a><code class="cCode">Teller</code> (remote interface documentation and source)</li>
<li><a name="wp1006029"> </a><code class="cCode">TellerHome</code> (home interface documentation and source)</li>
<li><a name="wp1006030"> </a><code class="cCode">TellerResult</code> (application-specific utility documentation and source)</li>
<li><a name="wp1006031"> </a><code class="cCode">ProcessingErrorException</code> (application-specific exception documentation and source)</li>
<li><a name="wp1006032"> </a><code class="cCode">TransactionErrorException</code> (application-specific exception documentation and source)</li>
</ul></div>
<li><a name="wp1006033"> </a>Server (EJBean)</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1006034"> </a><code class="cCode">TellerBean</code> (EJBean documentation and source)</li>
</ul></div>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1006035"> </a>
About the Servlet with JavaBean Example
</h2><p class="pBody"><a name="wp1006036"> </a>
This example demonstrates an Enterprise JavaBean (EJBean), and provides an example of a simple interface for accessing the Tuxedo Server. You can find the source code for this example in the <code class="cCode">/samples/jolt/wls/ejb/bankapp</code> directory included in the Oracle Tuxedo distribution. 
</p>
<p class="pBody"><a name="wp1007005"> </a>
Running this example before attempting to create your own EJBeans will show you the different steps involved. The example is a stateful session EJBean called <code class="cCode">TellerBean</code> that contacts a Tuxedo Server using Jolt for WebLogic, and conducts transactions as follows: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1006038"> </a>Contacts and calls a Tuxedo Server, and retrieves the returned results</li>
<li><a name="wp1006039"> </a>Uses a session EJBean</li>
<li><a name="wp1006202"> </a>Uses stateful persistence</li>
<li><a name="wp1006201"> </a>Uses application-defined exceptions and utilities</li>
<li><a name="wp1006042"> </a>Uses a client browser application</li>
</ul></div>
<p class="pBody"><a name="wp1006582"> </a>
The client browser application performs these steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1006583"> </a>	Contacts the teller home (&quot;TellerHome&quot;) through JNDI to find the EJBean.</li>
<li><a name="wp1006584"> </a>	Creates a teller (&quot;Terry&quot;).</li>
<li><a name="wp1006585"> </a>The application then performs a series of transactions for the Teller that has just been created: </li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1006210"> </a>Gets the current balance for account 10000.</li>
<li><a name="wp1006213"> </a>Performs Transaction 1: Deposits $100 into the account, and displays the balance.</li>
<li><a name="wp1006049"> </a>Performs Transaction 2: Deposits $200 (more than the transaction limit of $300).</li>
<a name="wp1007090"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In Transaction 1, a single call is made, and is automatically committed. In Transaction 2, a <code class="cCode">begin()</code> and <code class="cCode">commit()</code> bracket two separate requests (a deposit and a withdrawal). </td>
</tr>
</table>

<li><a name="wp1006050"> </a>Attempts to withdraw $100 more than the balance of the account.</li>
<li><a name="wp1006051"> </a>Catches an ApplicationException, retrieves the status messages embedded in the exception, and rolls back Transaction 2.</li>
<li><a name="wp1006052"> </a>Gets the final balance for the account.</li>
<li><a name="wp1006053"> </a>Removes the teller.</li>
<p class="pBodyRelative"><a name="wp1006054"> </a>
You can see in Transaction 2 how the balance is successfully rolled back to what it was at the end of Transaction 1. 
</p>
</ul></div>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1006057"> </a>
Preparing to Use the Servlet with JavaBean Example 
</h2><p class="pBody"><a name="wp1006058"> </a>
To get the most out of this example, first read through the source code files to see what is happening. Start with <code class="cCode">DeploymentDescriptor.txt</code> to find the general structure of the EJBean and which classes are used for the different objects and interfaces, and then look at <code class="cCode">Client.java</code> to see how the application works.
</p>
<p class="pBody"><a name="wp1006059"> </a>
The following sections provide details for using this example:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1006061"> </a><a href="EJB_example.html#wp1007232">Set Up Your Environment</a></li>
<li><a name="wp1007174"> </a><a href="EJB_example.html#wp1007922">Build the Example</a></li>
<li><a name="wp1006063"> </a><a href="EJB_example.html#wp1007110">Run the Servlet with JavaBean Example</a></li>
</ul></div>
<h3 class="pHeading2"><a name="wp1007232"> </a>
Set Up Your Environment
</h3>
<p class="pBody"><a name="wp1007236"> </a>
You need to add a Jolt connection pool that connects to the public Tuxedo Server at Oracle, as described in &#8220;<a href="EXsimpapp.html#wp2560">Step 3. Configure the Servlet in WebLogic Server</a>,&#8221; in <em class="cEmphasis">Appendix B, Simple Servlet Example</em>. When you&#8217;re finished, the <code class="cCode">config.xml</code> configuration file will contain the following sections:
</p>
<a name="wp1007755"> </a><div class="pPreformatted"><pre>&lt;StartupClass<br />  ClassName=&quot;bea.jolt.pool.servlet.weblogic.PoolManagerStartUp&quot;<br />  FailureIsFatal=&quot;false&quot;<br />  Name=&quot;MyStartup Class&quot;<br />  Targets=&quot;myserver&quot;<br />/&gt;<br /><code class="cCode">&lt;JoltConnectionPool<br />   ApplicationPassword=&quot;tuxedo&quot;<br />   MaximumPoolSize=&quot;5&quot;<br />   MinimumPoolSize=&quot;3&quot;<br />   Name=&quot;MyJolt Connection Pool&quot;<br />   PrimaryAddresses=&quot;//TUXSERVER:6309&quot;<br />   RecvTimeout=&quot;300&quot;<br />   SecurityContextEnabled=&quot;true&quot;<br />   Targets=&quot;myserver&quot;<br />   UserName=&quot;joltuser&quot;<br />   UserPassword=&quot;jolttest&quot;<br />   UserRole=&quot;clt&quot;<br />/&gt;|<br />&lt;ShutdownClass<br />  ClassName=&#8221;bea.jolt.pool.servlet.weblogic.PoolManager<br />  ShutDown.&#8221;<br />/&gt;</code></pre></div><p class="pBody"><a name="wp1007918"> </a>
 
</p>
<h3 class="pHeading2"><a name="wp1007922"> </a>
Build the Example
</h3>
<p class="pBody"><a name="wp1006066"> </a>
After configuring your WebLogic Server development environment, you need to build the example. Oracle Jolt provides separate build scripts for Windows 2003 and UNIX, as follows: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1006068"> </a>Windows 2003: <code class="cCode">%TUXDIR%\samples\jolt\wls\ejb\	bankapp\build.cmd</code></li>
<li><a name="wp1006069"> </a>UNIX: <code class="cCode">$TUXDIR/samples/jolt/wls/ejb/bankapp/build.sh</code></li>
</ul></div>
<p class="pBody"><a name="wp1006070"> </a>
The scripts build individual examples, such as this entry for Windows 2003: 
</p>
<a name="wp1006071"> </a><div class="pPreformatted"><pre>$ build</pre></div><p class="pBody"><a name="wp1006072"> </a>
To build under Microsoft&#8217;s JDK for Java, use: 
</p>
<a name="wp1006073"> </a><div class="pPreformatted"><pre>$ build -ms</pre></div><p class="pBody"><a name="wp1006074"> </a>
The scripts will build the example and place the files in the following default WebLogic Server directories on a Windows 2003 system: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1006075"> </a>Client files in:<code class="cCode"> d:\bea\wlserver6.1\config\examples</code></li>
<li><a name="wp1006076"> </a>EJBean in: <code class="cCode">d:\bea\wlserver6.1\config\mydomain\applications</code></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1007110"> </a>
Run the Servlet with JavaBean Example
</h2><p class="pBody"><a name="wp1008201"> </a>
When WebLogic Server is started in the default <code class="cCode">\config\mydomain</code> directory, the EJBean example is automatically deployed in the <code class="cCode">\applications</code> directory.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1006100"> </a>Start the WebLogic Server in the <code class="cCode">\config\mydomain</code> directory. You can check that the EJBean has been deployed correctly either by checking the server command-line window, or by opening the Console and examining EJB under Deployments. You should see <code class="cCode">ejb.jolt.bankapp</code> deployed and should be able to monitor its activity. </li>
<li><a name="wp1006101"> </a>Open a separate command-line window, and then run the client by entering the following command: </li>
<a name="wp1006102"> </a><div class="pPreformattedRelative"><pre>$ java examples.jolt.ejb.bankapp.Client</pre></div><p class="pBodyRelative"><a name="wp1006103"> </a>
If you are not running the WebLogic Server with its default settings, you will have to use the following command line: 
</p>
<a name="wp1006104"> </a><div class="pPreformattedRelative"><pre>$ java examples.jolt.ejb.bankapp.Client &quot;t3://<span style="font-style: italic">WebLogicURL:Port</span>&quot;</pre></div><p class="pBodyRelative"><a name="wp1006105"> </a>
where the following parameters are defined as follows:
</p>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1006106"> </a>WebLogicURL&#8212;the domain address of the WebLogic Server</li>
<li><a name="wp1006108"> </a>Port&#8212;the port listening for connections (<code class="cCode">weblogic.system.ListenPort</code>)</li>
<p class="pBodyRelative"><a name="wp1006110"> </a>
The following optional parameters are interpreted by the client in the order in which they are listed:
</p>
<li><a name="wp1006112"> </a>url&#8212;unique resource location of Server, such as <code class="cCode">t3://localhost:7001</code></li>
<li><a name="wp1006113"> </a>user&#8212;username, default null </li>
<li><a name="wp1006114"> </a>password&#8212;user password, default null </li>
</ul></div>
<li><a name="wp1006115"> </a>	If you are running the Client example, you should get output that is similar to the following from the client application: </li>
<a name="wp1006116"> </a><div class="pPreformattedRelative"><pre>4.	Beginning jolt.bankapp.Client...<br />5.	<br />6.	Created teller Terry<br />7.	<br />8.	Getting current balance of Account 10000 for Erin<br />9.	Balance: 27924.02<br />10.	<br />11.	Start Transaction 1 for Erin<br />12.	<br />13.	  Depositing 100.0 for Erin<br />14.	  Balance: 28024.02<br />15.	<br />16.	End Transaction 1 for Erin<br />17.	<br />18.	Start Transaction 2 for Erin<br />19.	<br />20.	  Depositing 200.0 for Erin<br />21.	  Balance: 28224.02<br />22.	<br />23.	  Withdrawing 28324.02 for Erin<br />24.	  Transaction error:<br />25.	  examples.jolt.ejb.bankapp.TransactionErrorException: Teller error: application<br />26.	 exception:<br />27.	Account Overdraft<br />28.	<br />29.	  Rolling back transaction for Erin<br />30.	<br />31.	End Transaction 2 for Erin<br />32.	<br />33.	Getting final balance of Account 10000 for Erin<br />34.	Balance: 28024.02<br />35.	<br />36.	Removing teller Terry<br />37.	<br />End jolt.bankapp.Client...</pre></div><a name="wp1006151"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Note how the final balance shows that <span style="font-style: italic">Transaction 2</span> was rolled back to the balance at the end of <span style="font-style: italic">Transaction 1</span>. </td>
</tr>
</table>

</ol></div>
<p class="pBody"><a name="wp1006153"> </a>
You can read more about EJBs in the <em class="cEmphasis">Programming WebLogic Enterprise JavaBeans</em> guide. To learn more about using Oracle Jolt, refer to the <em class="cEmphasis">Using Oracle Jolt</em> guide.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="EJB_example.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="EXsimpapp.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq9" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
