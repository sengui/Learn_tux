<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="2" />
<meta name="LOC_US_CHANGE" content="41905" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux12c/add/fm/addoma.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="06/26/12 10:28:51" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Administering Domains</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Using the Oracle Tuxedo Domains Component
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="adcorb.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/add.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1104945"> </a>
Administering Domains
</h1>
<p class="pBody"><a name="wp1099801"> </a>
The following sections explain how to administer an Oracle Tuxedo Domains environment:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1099794"> </a><a href="addoma.html#wp1089403">Using Domains Run-Time Administrative Commands</a></li>
<li><a name="wp1098137"> </a><a href="addoma.html#wp1089105">Using the Administrative Interface, dmadmin(1)</a></li>
<li><a name="wp1089623"> </a><a href="addoma.html#wp1089115">Using the Domains Administrative Server, DMADM(5)</a></li>
<li><a name="wp1089468"> </a><a href="addoma.html#wp1089129">Using the Gateway Administrative Server, GWADM(5)</a></li>
<li><a name="wp1089473"> </a><a href="addoma.html#wp1089146">Using the Domain Gateway Server</a></li>
<li><a name="wp1089652"> </a><a href="addoma.html#wp1089149">Managing Transactions in a Domains Environment</a></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089403"> </a>
Using Domains Run-Time Administrative Commands
</h2><p class="pBody"><a name="wp1089063"> </a>
To integrate the Domains component with an existing Oracle Tuxedo application, you add entries for domain gateway groups and gateway servers to the <code class="cCode">TUXCONFIG</code> file. You can use either the <code class="cCode">tmconfig(1)</code> or <code class="cCode">tmadmin(1)</code> command to add a Domains configuration to a running Oracle Tuxedo application. You can also use <code class="cCode">tmadmin</code> to list the information available in the bulletin board for domain gateway groups and individual domain gateways.
</p>
<p class="pBody"><a name="wp1091659"> </a>
Once your Domains environment is configured and integrated, you can administer it dynamically using a set of administrative tools provided by the Domains component. For example, you can specify and modify the list of services that are accessible across applications. The Domains software preserves the characteristics of the Oracle Tuxedo programming interface (ATMI) and extends the scope of the ATMI so that clients can invoke services across domains. This functionality allows programmers to expand or partition applications without changing any application code.
</p>
<p class="pBody"><a name="wp1093347"> </a>
<a href="addoma.html#wp1089069">Figure&#160;4-1</a> shows the relationship between administrative commands and servers in the Domains administrative subsystem. 
</p>
<div class="pFigureTitle"><a name="wp1089069"> </a>
Figure&#160;4-1  Domains Run-Time Administration
</div>

 
 <p class="pGraphic"><a name="wp1089073"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/new7.gif" alt="Domains Run-Time Administration" id="wp1089071"/></div><p class="pGraphic">

</p>
<p class="pBody"><a name="wp1092015"> </a>
The Oracle Tuxedo Domains component offers the following administrative commands:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1090543"> </a><a href="../rfcm/rfcmd.html">dmadmin(1)</a> command, a generic administrative service&#8212;Enables administrators to configure, monitor, and tune domain gateway groups dynamically, and to update the Domains configuration file (<code class="cCode">BDMCONFIG</code>) while the Oracle Tuxedo application is running. The command acts as a front-end process that translates administrative commands and sends service requests to the <code class="cCode">DMADMIN</code> service, a generic administrative service advertised by the <code class="cCode">DMADM</code> server. The <code class="cCode">DMADMIN</code> service invokes the validation, retrieval, or update of functions provided in the <code class="cCode">DMADM</code> server to maintain the <code class="cCode">BDMCONFIG</code> file.</li>
<li><a name="wp1090544"> </a><a href="../rf5/rf5.html">DMADM(5)</a>, the Domains administrative server&#8212;Provides the administrative processing required for updating the Domains configuration. This server acts as a back-end to the <code class="cCode">dmadmin</code> command. It provides a registration service to domain gateway groups. This registration service is requested by <code class="cCode">GWADM</code> servers as part of their initialization procedure. The registration service downloads the configuration information required by the requesting domain gateway group. The <code class="cCode">DMADM</code> server maintains a list of registered domain gateway groups, and propagates to these groups any changes made to the configuration.</li>
<li><a name="wp1090545"> </a><a href="../rf5/rf5.html">GWADM(5)</a>, the gateway administrative server&#8212;Registers with the <code class="cCode">DMADM</code> server to obtain the configuration information used by the corresponding domain gateway group. The <code class="cCode">GWADM</code> accepts queries from <code class="cCode">DMADM</code> to obtain run-time statistics or to change the run-time options of the corresponding domain gateway group. Periodically, the <code class="cCode">GWADM</code> server sends an &#8220;I-am-alive&#8221; message to the <code class="cCode">DMADM</code> server. If no reply is received from the <code class="cCode">DMADM</code> server, the <code class="cCode">GWADM</code> server registers again. This mechanism makes sure the <code class="cCode">GWADM</code> server always has the latest copy of the Domains configuration for its group.</li>
<li><a name="wp1090546"> </a><a href="../rf5/rf5.html">GWTDOMAIN(5)</a>, the TDomain gateway server&#8212;Provides interoperability between two or more Oracle Tuxedo domains. Working with the WebLogic Tuxedo Connector (WTC) gateway, an Oracle WebLogic Server component, the Oracle Tuxedo TDomain gateway can also provide interoperability between Tuxedo domains and WebLogic Server applications.</li>
<a name="wp1092698"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>For information about domain gateway types other than <code class="cCode">GWTDOMAIN</code>, see <a href="http://download.oracle.com/docs/cd/E13161_01/tuxedo/tux100/interm/mainfrm.html">http://download.oracle.com/docs/cd/E13161_01/tuxedo/tux100/interm/mainfrm.html</a>.</td>
</tr>
</table>

<li><a name="wp1101969"> </a><code class="cCode">BDMCONFIG</code>&#8212;the binary version of the Domains configuration file, which together with the <code class="cCode">TUXCONFIG</code> file and <code class="cCode">factory_finder.ini</code> file (CORBA only) contain all the configuration parameters that the Oracle Tuxedo software needs to create a Domains configuration.</li>
</ul></div>
<a name="wp1091131"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You can also specify gateway parameters when a domain gateway group is booted using the <code class="cCode">CLOPT</code> parameter, when the <code class="cCode">GWADM</code> server is defined in the <code class="cCode">SERVERS</code> section of the <code class="cCode">TUXCONFIG</code> file.</td>
</tr>
</table>

<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089105"> </a>
Using the Administrative Interface, dmadmin(1)
</h2><p class="pBody"><a name="wp1089106"> </a>
<code class="cCode">dmadmin</code> is an administrative interface to the <code class="cCode">DMADM</code> and <code class="cCode">GWADM</code> servers. The communication between the two servers is done via FML typed buffers. Administrators can use the <code class="cCode">dmadmin</code> command in the following ways:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1092206"> </a>For the interactive administration of the information stored in the <code class="cCode">BDMCONFIG</code> file and the different domain gateway groups running within a particular Oracle Tuxedo application.</li>
<li><a name="wp1092212"> </a>To obtain statistics or other information gathered by domain gateway groups.</li>
<li><a name="wp1092223"> </a>To change domain gateway group parameters.</li>
<li><a name="wp1092224"> </a>To add (or update) information in the <code class="cCode">BDMCONFIG</code> file.</li>
</ul></div>
<a name="wp1089114"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You can delete information from the <code class="cCode">BDMCONFIG</code> file at run time only if the deletions do not involve an active domain gateway group.</td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1093909"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1093918"> </a><a href="../rfcm/rfcmd.html">dmadmin(1)</a> in <em class="cEmphasis">Oracle Tuxedo Command Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089115"> </a>
Using the Domains Administrative Server, DMADM(5)
</h2><p class="pBody"><a name="wp1089116"> </a>
The Domains administrative server, <a href="../rf5/rf5.html">DMADM(5)</a>, is an Oracle Tuxedo-supplied server that performs the following functions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1092292"> </a>Supports run-time administration of the <code class="cCode">BDMCONFIG</code> file</li>
<li><a name="wp1092309"> </a>Maintains the <code class="cCode">BDMCONFIG</code> file</li>
<li><a name="wp1092318"> </a>Supports a list of registered domain gateway groups</li>
<li><a name="wp1092323"> </a>Propagates run-time configuration changes to the registered domain gateway groups</li>
</ul></div>
<p class="pBody"><a name="wp1094531"> </a>
The <code class="cCode">DMADM</code> server advertises two services: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1094532"> </a><code class="cCode">DMADMIN</code>, which is used by the <code class="cCode">dmadmin</code> command and the <code class="cCode">GWADM</code> server.</li>
<li><a name="wp1094533"> </a>A service called <code class="cCode">DMADM_</code><code class="cCodeEmphasis">svrid</code>, where <code class="cCodeEmphasis">srvid</code> is the appropriate server ID for the service. Registered <code class="cCode">GWADM</code> servers use <code class="cCode">DMADM_</code><code class="cCodeEmphasis">svrid</code> for specific administrative functions (for example, to refresh the domain gateway group configuration information or to signal that a <code class="cCode">GWADM</code> is still registered).</li>
</ul></div>
<p class="pBody"><a name="wp1089127"> </a>
The <code class="cCode">DMADM</code> server must be defined in the <code class="cCode">SERVERS</code> section of the <code class="cCode">TUXCONFIG</code> file as a server running within a group (for example, <code class="cCode">DMADMGRP</code>). There should be only one instance of the <code class="cCode">DMADM</code> server in this group.
</p>
<h3 class="pHeading2"><a name="wp1093805"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1093810"> </a><a href="../rf5/rf5.html">DMADM(5)</a> in <em class="cEmphasis">Oracle Tuxedo File Formats, Data Descriptions, MIBs, and System Processes Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089129"> </a>
Using the Gateway Administrative Server, GWADM(5)
</h2><p class="pBody"><a name="wp1089130"> </a>
The gateway administrative server, <a href="../rf5/rf5.html">GWADM(5)</a>, is an Oracle Tuxedo-supplied server that provides administrative functions for a domain gateway group. The main functions of the <code class="cCode">GWADM</code> server include:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089132"> </a>Getting Domains configuration information from the <code class="cCode">DMADM</code> server, and accepting queries from <code class="cCode">dmadmin</code>. The <code class="cCode">GWADM</code> server gets the domain gateway group configuration information by registering with the <code class="cCode">DMADM</code> server. The <code class="cCode">GWADM</code> server then makes the configuration available to gateways by storing the information in shared memory.</li>
<li><a name="wp1089133"> </a>Providing administrative functionality for a domain gateway group, for example, by accepting queries from <code class="cCode">dmadmin</code> for run-time statistics or by changing the run-time parameters of the domain gateway group.</li>
<li><a name="wp1089134"> </a>Providing transaction logging functionality for a domain gateway group. The <code class="cCode">GWADM</code> server determines which transactions need to be logged by reading information stored in shared memory. When the <code class="cCode">GWADM</code> server is booted, it scans the log to see whether any transactions need to be recovered, and then reconstructs the transaction information in shared memory. The gateway server scans the information in shared memory and performs recovery for the corresponding transactions. The recovery procedure is performed asynchronously with new incoming or outgoing requests received by the domain gateway group.</li>
</ul></div>
<p class="pBody"><a name="wp1089135"> </a>
The <code class="cCode">GWADM</code> server advertises a service name based on the local domain access point name (as specified in the <code class="cCode">DM_LOCAL</code> section of the <code class="cCode">BDMCONFIG</code> file) associated with the domain gateway group to which the <code class="cCode">GWADM</code> server belongs. The <code class="cCode">dmadmin</code> command uses this service to retrieve information from all active domain gateway groups or from a specific domain gateway group.
</p>
<p class="pBody"><a name="wp1089142"> </a>
The <code class="cCode">GWADM</code> server must be defined in the <code class="cCode">SERVERS</code> section of the <code class="cCode">TUXCONFIG</code> file. It should not be part of the <code class="cCode">MSSQ</code> used by the gateways associated with the group. It must be the first server booted within the domain gateway group; that is, either (a) it must have a <code class="cCode">SEQUENCE</code> number, or (b) it must be defined ahead of the gateway servers.
</p>
<p class="pBody"><a name="wp1089143"> </a>
The <code class="cCode">GWADM</code> server requires the existence of a <code class="cCode">DMADM</code> server. Specifically, a <code class="cCode">DMADM</code> server must be booted before that <code class="cCode">GWADM</code> is booted.
</p>
<p class="pBody"><a name="wp1089145"> </a>
The <code class="cCode">GWADM</code> server must create the shared memory required by the domain gateway group to populate the configuration tables with information received from the <code class="cCode">DMADM</code> server. The <code class="cCode">GWADM</code> server uses <code class="cCode">IPC_PRIVATE</code> with <code class="cCode">shmget</code> and stores the <code class="cCode">ipckey</code> returned in the <code class="cCode">shmid</code> field of its registry entry in the bulletin board. Gateways can obtain the <code class="cCode">ipckey</code> by retrieving the <code class="cCode">GWADM</code> registry entry and checking the <code class="cCode">shmid</code> field.
</p>
<h3 class="pHeading2"><a name="wp1092570"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1093844"> </a><a href="../rf5/rf5.html">GWADM(5)</a> in <em class="cEmphasis">Oracle Tuxedo File Formats, Data Descriptions, MIBs, and System Processes Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089146"> </a>
Using the Domain Gateway Server
</h2><p class="pBody"><a name="wp1092578"> </a>
A domain gateway server provides connectivity to remote domain gateway servers, and can communicate with one or more remote gateways simultaneously. A gateway advertises the services imported to an Oracle Tuxedo application and controls access to the local services exported by the application. You define your application&#8217;s exported and imported services in the Domains configuration file (<code class="cCode">DMCONFIG</code>). Use <code class="cCode">dmadmin</code> to dynamically configure, monitor, and tune domain gateway groups.
</p>
<h3 class="pHeading2"><a name="wp1093654"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1094965"> </a><a href="addom.html#wp1257045">Types of Domain Gateways</a></li>
</ul></div>
<h3 class="pHeading2"><a name="wp1105205"> </a>
Tuning the Performance of the Domain Gateway
</h3>
<p class="pBody"><a name="wp1105206"> </a>
Oracle Tuxedo 9.x improves the GWTDOMAIN gateway performance while also keeping compatibility with other types of /Domain gateways. It limits most of the performance to the threaded platforms. It also allows other types of /Domain gateways to take advantage of this feature in the enhanced Common Gateway Architecture with simple program changes.
</p>
<p class="pBody"><a name="wp1105209"> </a>
Many factors may affect performance of applications across multiple domains. For example:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1105210"> </a>Service processing time</li>
<li><a name="wp1105211"> </a>Database transactions</li>
<li><a name="wp1105212"> </a>Message buffer size</li>
<li><a name="wp1105213"> </a>Security facilities, such as Link Level Encryption</li>
<li><a name="wp1105214"> </a>Network transmission speed</li>
</ul></div>
<p class="pBody"><a name="wp1105215"> </a>
Therefore, in order to observe achieved Domain Gateway performance improvement, the application has to minimize the above-mentioned factors. Otherwise the performance improvement for the gateway may not be significant.
</p>
<p class="pBody"><a name="wp1105216"> </a>
Some suggestions for performance testing this feature are listed below: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1105217"> </a>Many clients send a request to a single remote service. The size of the message is small (less than a few K bytes.)</li>
<li><a name="wp1105218"> </a>Many clients send a request to different remote services or use load balancing to distribute service requests. In this case, the message size can be larger.</li>
</ul></div>
<a name="wp1105219"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>As a prerequisite, service processing time on the server side should <em class="cEmphasis">not</em> be time-consuming. The total response time contains both gateway processing time and service processing time. If service processing time is quite long, the performance improvement for the gateway is submerged. </td>
</tr>
</table>

<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1089149"> </a>
Managing Transactions in a Domains Environment
</h2><p class="pBody"><a name="wp1089150"> </a>
Application programmers can request the execution of remote services within a transaction. Also, users of remote domains can request local services to be executed within a transaction. Domains, therefore, coordinates the mapping of remote transactions to local transactions, and the sane termination (commitment or rollback) of these transactions.
</p>
<p class="pBody"><a name="wp1089151"> </a>
The Oracle Tuxedo system architecture uses a separate process, the Transaction Manager Server (<code class="cCode">TMS</code>), to coordinate the commitment and recovery of transaction branches accessing a particular group. In a Domains environment, however, this architecture would require extra messages from the gateway to the <code class="cCode">TMS</code> server to process a commitment for an incoming transaction. To simplify the Domains architecture and to reduce the number of messages, the <code class="cCode">TMS</code> code is integrated with the gateway code. Thus, domain gateways can process the transaction protocol used by the Oracle Tuxedo system. The Oracle Tuxedo transaction protocol requires that the domain gateway group advertise the <code class="cCode">TMS</code> service, which is done when the first gateway is booted. Once the <code class="cCode">TMS</code> service is advertised, any transaction control messages directed to the domain gateway group are placed on the gateway&#8217;s queue.
</p>
<p class="pBody"><a name="wp1089153"> </a>
Domain gateway groups should be defined in the <code class="cCode">TUXCONFIG</code> file without the <code class="cCode">TMSNAME</code>, <code class="cCode">TMSCOUNT</code>, <code class="cCode">OPENINFO</code>, and <code class="cCode">CLOSEINFO</code> parameters. These four parameters apply only to groups that use an XA-compliant resource manager, which domain gateways do not use.
</p>
<p class="pBody"><a name="wp1089154"> </a>
The commitment protocol across domains is strictly hierarchical. It is not possible to flatten the transaction tree because the structure of the transaction tree is not fully known by every domain; a superior knows only its immediately subordinate domains. Flattening the tree would also require the root domain to be fully connected to all domains participating in the transaction.
</p>
<p class="pBody"><a name="wp1089155"> </a>
Domain gateways provide four capabilities that you can use to manage transactions. These capabilities are described in the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089156"> </a><a href="addoma.html#wp1089160">Using the TMS Capability Across Domains</a></li>
<li><a name="wp1097020"> </a><a href="addoma.html#wp1089191">Using GTRID Mapping in Transactions</a></li>
<li><a name="wp1097021"> </a><a href="addoma.html#wp1092747">Using Logging to Track Transactions</a></li>
<li><a name="wp1097022"> </a><a href="addoma.html#wp1089269">Recovering Failed Transactions</a></li>
</ul></div>
<h3 class="pHeading2"><a name="wp1089160"> </a>
Using the TMS Capability Across Domains
</h3>
<p class="pBody"><a name="wp1089161"> </a>
In the Oracle Tuxedo system, the <code class="cCode">TMS</code> is a special server that is implicitly associated with server groups that use X/Open XA-compliant resource managers. The <code class="cCode">TMS</code> server releases application servers from the delays associated with the distributed 2-phase commitment protocol. <code class="cCode">TMS</code> servers coordinate the commitment of a transaction via special service requests to the <code class="cCode">TMS</code> service, which is offered by all <code class="cCode">TMS</code> servers.
</p>
<p class="pBody"><a name="wp1089162"> </a>
In a Domains environment, <code class="cCode">GWTDOMAIN</code> gateways are not associated with an XA-compliant resource manager. The Transaction Processing Working Group (<code class="cCode">TPWG</code>) of X/Open has proposed an advanced XA interface. This interface is not used in the Oracle Tuxedo system because the interface does not match the highly asynchronous and non-blocking model required by the gateway. While domain gateways do not use a separate <code class="cCode">TMS</code> server, they do offer the Transaction Manager Servers capability, which allows gateways to coordinate the 2-phase commitment of transactions executed across domains. 
</p>
<p class="pBody"><a name="wp1092892"> </a>
Domain gateways coordinate transactions across domains in the following manner:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1089163"> </a>Domain gateways advertise the <code class="cCode">TMS</code> service and perform all operations associated with that service. Messages sent to this service are placed on the queue used by the appropriate domain gateway group, and the gateways manage the transactions associated with the group.</li>
<li><a name="wp1092870"> </a>A gateway can act as a subordinate of transactions coordinated by another group within the domain. In this case, the gateway is a superior of the transaction branches executed in other remote domains. When acting as a subordinate of a transaction coordinated by a remote domain, the gateway also acts as the coordinator for all groups in the local domain accessed by the transaction. The gateway, acting as both subordinate and coordinator, is illustrated in <a href="addoma.html#wp1089173">Figure&#160;4-2</a>.</li>
<div class="pFigureTitle"><a name="wp1089173"> </a>
Figure&#160;4-2  The Domain Gateway as Subordinate/Coordinator of Another Domain Gateway Group
</div>

 
 <p class="pGraphic"><a name="wp1089177"> </a>
<br />
<img src="wwimages/8.gif" alt="The Domain Gateway as Subordinate/Coordinator of Another Domain Gateway Group" id="wp1089175"/><br />

</p>
<li><a name="wp1089178"> </a>As a coordinator of transactions within the domain, the gateway manages the commitment of a transaction for a particular client. This is illustrated in <a href="addoma.html#wp1089183">Figure&#160;4-3</a>.</li>
<div class="pFigureTitle"><a name="wp1089183"> </a>
Figure&#160;4-3  Client Commit Managed by a Domain Gateway
</div>

 
 <p class="pGraphic"><a name="wp1089187"> </a>
<br />
<img src="wwimages/9.gif" alt="Client Commit Managed by a Domain Gateway" id="wp1089185"/><br />

</p>
<li><a name="wp1089188"> </a>Gateways manage transaction commitment for a particular client or for a server that uses the forwarding service with the <code class="cCode">AUTOTRAN</code> capability. When this combination is used, the last server in the forward chain (the domain gateway) issues the commit and becomes the coordinator of the transaction. (A domain gateway always acts as the last server in a forward chain.)</li>
<li><a name="wp1092888"> </a>Gateways automatically start and terminate transactions for remote services specified with the <code class="cCode">AUTOTRAN</code> capability. This capability is required when an the application administrator wants to enforce reliable network communication with remote services. Administrators can specify this capability by setting the <code class="cCode">AUTOTRAN</code> parameter to <code class="cCode">Y</code> in the corresponding remote service definition. </li>
<p class="pBodyRelative"><a name="wp1098488"> </a>
For more information, see the <code class="cCode">DM_IMPORT</code> section of <a href="../rf5/rf5.html">DMCONFIG(5)</a> in <em class="cEmphasis">Oracle Tuxedo File Formats, Data Descriptions, MIBs, and System Processes Reference</em>.
</p>
<li><a name="wp1092891"> </a>Gateways map the Oracle Tuxedo system transaction protocol to the networking transaction protocol used for interoperation with remote domains. How this mapping is done depends on which instantiation of domain gateway you are using: TDomain, SNA, or OSI TP.</li>
</ol></div>
<h3 class="pHeading2"><a name="wp1089191"> </a>
Using GTRID Mapping in Transactions
</h3>
<p class="pBody"><a name="wp1089193"> </a>
In the Oracle Tuxedo system, a transaction tree is a 2-level tree where the root is the domain gateway group coordinating a global transaction and branches are involved in the transaction. Each group performs its part of the global transaction independently from the parts performed by other groups. Each group, therefore, implicitly defines a transaction branch. The Oracle Tuxedo system, through <code class="cCode">TMS</code> servers, coordinates the completion of the global transaction, making sure each branch is completed.
</p>
<p class="pBody"><a name="wp1102617"> </a>
A <code class="cCode">GTRID</code> is a <code class="cCode">G</code>lobal <code class="cCode">T</code>ransaction <code class="cCode">Id</code>entifier. <code class="cCode">GTRID</code> mapping defines how to construct a transaction tree that crosses domain boundaries. You specify <code class="cCode">GTRIDs</code> using the <code class="cCode">MAXGTT</code> parameter in the <code class="cCode">RESOURCES</code> section of the Oracle Tuxedo configuration file.
</p>
<h4 class="pHeading3"><a name="wp1102621"> </a>
Defining Tightly-coupled and Loosely-coupled Relationships
</h4>
<p class="pBody"><a name="wp1089195"> </a>
In the X/Open DTP Model, a Transaction Manager Server can construct transaction trees by defining either <em class="cEmphasis">tightly-coupled</em> or <em class="cEmphasis">loosely-coupled</em> relationships with a resource manager (RM) by the way it interprets the transaction identifiers (<code class="cCode">XIDs</code>) used by the XA interface.
</p>
<p class="pBody"><a name="wp1089196"> </a>
A <em class="cEmphasis">tightly-coupled relationship</em> is one in which a single transaction identifier, <code class="cCode">XID</code>, is used by all processes participating in a single global transaction, accessing a single RM. This relationship maximizes data sharing between processes; XA-compliant RMs expect to share locks for resources used by processes having the same <code class="cCode">XID</code>. The Oracle Tuxedo system achieves the tightly-coupled relationship via the group concept; that is, all work done by a group on behalf of a given global transaction belongs to the same transaction branch; all the processes executed by the group are given the same <code class="cCode">XID</code>.
</p>
<p class="pBody"><a name="wp1089197"> </a>
In a<em class="cEmphasis"> loosely-coupled relationship</em>, the <code class="cCode">TMS</code> generates a transaction branch for each part of the work in support of the global transaction. The RM handles each transaction branch separately; there is no sharing of data or of locks between the transaction branches. Deadlocks between transaction branches can occur and result in the rollback of a global transaction. In the Oracle Tuxedo application, when different groups participate in a single global transaction, each group defines a separate transaction branch, which results in a loosely-coupled relationship.
</p>
<h4 class="pHeading3"><a name="wp1089198"> </a>
Global Transactions Across Domains
</h4>
<p class="pBody"><a name="wp1089199"> </a>
There are several differences between global transactions in a single Oracle Tuxedo application and global transactions across domains. The first difference is that in the Domains framework, the transaction tree cannot be flattened to a 2-level tree. There are two reasons for this: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089200"> </a>The transaction may involve more domains than can be known from the root domain (where the transaction is controlled), so the structure of the transaction tree cannot be fully known.</li>
<li><a name="wp1089201"> </a>If a transaction tree is flattened to two levels, the root domain must be connected directly to all domains in the transaction.</li>
</ul></div>
<p class="pBody"><a name="wp1089202"> </a>
This means that the commitment protocol across domains must be hierarchical. Even a loopback service request defines a new branch in the transaction tree.
</p>
<a name="wp1089203"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>A loopback request goes to another domain and then comes back to be processed in the original domain. For example, Domain A requests a service of Domain B. The service in Domain B requests another service in Domain A. The transaction tree has two branches at the network level: a branch b1 from A to B and a branch b2 from B to A. Domain A cannot commit the work done on branch b2 before receiving commit instructions from B.</td>
</tr>
</table>

<p class="pBody"><a name="wp1089204"> </a>
The structure of a transaction tree for global transactions across domains also depends on the distributed transaction processing protocol used by a relevant domain gateway instantiation. For example, in the OSI TP protocol each <em class="cEmphasis">dialogue</em> (the OSI TP word for a service request) is associated with a different transaction branch. In the Oracle Tuxedo system, the OSI TP instantiation uses a dialogue for each service request, so each service request is mapped to a separate transaction branch. The XAP-TP interface hides this mapping and provides a mechanism by which an entire OSI TP subtree can be referenced by a user-defined identifier. (In the Oracle Tuxedo implementation, this identifier is the <code class="cCode">GTRID</code>.) The <code class="cCode">GTRID</code> is used to instruct XAP-TP how a transaction tree must be constructed, that is, which dialogues must be included within a given OSI TP transaction. Therefore, from the Oracle Tuxedo perspective, a whole OSI TP subtree can be managed as a single transaction branch.
</p>
<p class="pBody"><a name="wp1089205"> </a>
This property, however, applies only to outgoing service requests (that is, service requests sent from the root domain to subordinate domains). It cannot be applied to incoming service requests. The OSI TP instantiation consequently implements a loosely-coupled relationship; each incoming service request is mapped to a new Oracle Tuxedo global transaction.
</p>
<p class="pBody"><a name="wp1089206"> </a>
The TDomain instantiation tries to optimize <code class="cCode">GTRID</code> mapping by implementing a tightly-coupled relationship. In TDomain, multiple service requests issued on behalf of the same global transaction are mapped to the same network transaction branch. Therefore, incoming service requests can be mapped to a single Oracle Tuxedo transaction. However, the hierarchical structure of interdomain communication and the interdomain transaction tree must still be maintained.
</p>
<p class="pBody"><a name="wp1089207"> </a>
The optimization that TDomain introduces applies only to a single domain. When two or more domains are involved in a transaction, the network transaction tree contains at least one branch per domain interaction. Hence, across domains, the network transaction tree remains loosely-coupled. There are as many branches as there are domains involved in the transaction (even if all the branches access the same resource manager instance).
</p>
<p class="pBody"><a name="wp1089208"> </a>
Domain gateway groups implement a loosely-coupled relationship because they generate different transaction branches for interdomain transactions.
</p>
<h4 class="pHeading3"><a name="wp1089212"> </a>
Example of a Service Request Graph Generating Local and Remote Requests
</h4>
<p class="pBody"><a name="wp1093055"> </a>
<a href="addoma.html#wp1089214">Figure&#160;4-4</a> shows the service request graph for a client that generates three service requests: one local request (<code class="cCode">r0</code>) and two remote requests (<code class="cCode">r2</code> and <code class="cCode">r3</code>). Request <code class="cCode">r0</code> goes to a local service (<code class="cCode">Svc0</code>), which generates another remote service request (<code class="cCode">r1</code>). Request <code class="cCode">r1</code> goes to remote service <code class="cCode">Rsvc1</code>, which issues a loopback service request <code class="cCode">r4</code> to local service <code class="cCode">Svc4</code>. <code class="cCode">Svc0</code> and <code class="cCode">Svc4</code> are executed in different groups (<code class="cCode">G0</code> and <code class="cCode">G4</code>). The domain gateway is executed within another group (<code class="cCode">GW</code>), and the remote services <code class="cCode">Rscv1</code>, <code class="cCode">Rsvc2</code>, and <code class="cCode">Rsvc3</code> are executed in another domain (Domain B).
</p>
<div class="pFigureTitle"><a name="wp1089214"> </a>
Figure&#160;4-4  Service Request Graph
</div>

 
 <p class="pGraphic"><a name="wp1089218"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/10.gif" alt="Service Request Graph" id="wp1089216"/></div><p class="pGraphic">

</p>
<h4 class="pHeading3"><a name="wp1089225"> </a>
Transaction Trees for Oracle eLink OSI TP and Oracle Tuxedo Domains
</h4>
<p class="pBody"><a name="wp1102713"> </a>
The following two figures show the transaction tree for Oracle eLink OSI TP and the transaction tree for Oracle Tuxedo domains. It is assumed, in these figures, that both Domain A and Domain B are Oracle Tuxedo system applications.
</p>
<p class="pBody"><a name="wp1102720"> </a>
Oracle eLink OSI TP is loosely-coupled because of the OSI TP protocol. The transaction tree for this instantiation shows group G0 in Domain A coordinating the global transaction started by the client. Group <code class="cCode">G0</code> coordinates group <code class="cCode">GW</code>. Requests <code class="cCode">r1</code>, <code class="cCode">r2</code>, and <code class="cCode">r4</code> are mapped each to an OSI TP dialogue and therefore to an OSI TP transaction branch. However, OSI TP uses the XAP-TP feature that allows an entire OSI TP transaction to be referred by a unique identifier (<code class="cCode">T1</code>) and uses this identifier for requests <code class="cCode">r1</code>, <code class="cCode">r2</code>, and <code class="cCode">r3</code>. It is up to XAP-TP to generate OSI TP transaction identifiers and to construct the corresponding OSI TP transaction tree. The only function that must be performed by the generic Domains software is the mapping of service requests r1, r2, and r3 to the <code class="cCode">T1</code> identifier.
</p>
<p class="pBody"><a name="wp1093175"> </a>
In Domain B, OSI TP uses the rule that new transaction branches must be mapped to a new Oracle Tuxedo transaction. Therefore, OSI TP transaction branches <code class="cCode">r1</code>, <code class="cCode">r2</code>, and <code class="cCode">r3</code> get mapped to three different Oracle Tuxedo transactions (the corresponding mapping is represented by identifiers <code class="cCode">T2</code>, <code class="cCode">T3</code>, and <code class="cCode">T4</code>). The graph shows the domain gateway group <code class="cCode">GW</code> in Domain B coordinating three Oracle Tuxedo transactions on group <code class="cCode">G1</code>.
</p>
<p class="pBody"><a name="wp1093184"> </a>
Finally, there is the loopback service request <code class="cCode">r4</code> that generates another branch in the transaction tree. OSI TP maps this request to identifier <code class="cCode">T2</code>, but XAP-TP generates a new branch in its transaction tree (<code class="cCode">r4</code>: B to A&#39;). This is a new transaction branch on Domain A, and therefore, the gateway generates a new mapping <code class="cCode">T5</code> to a new Oracle Tuxedo transaction. Therefore, the transaction graph shows that domain gateway group GW on Domain A coordinates group <code class="cCode">G4</code>.
</p>
<p class="pBody"><a name="wp1089229"> </a>
Notice that the hierarchical nature of the OSI TP protocol is fully enforced by these mappings. However, because these mappings introduce a loosely-coupled relationship, the probability of intratransaction deadlock is increased (for example, there are three Oracle Tuxedo transactions accessing the RM represented by group <code class="cCode">G1</code>).
</p>
<p class="pBody"><a name="wp1105993"> </a>
The transaction tree for Oracle eLink OSI IP environment is shown in <a href="addoma.html#wp1089231">Figure&#160;4-5</a>.
</p>
<div class="pFigureTitle"><a name="wp1089231"> </a>
Figure&#160;4-5  Transaction Tree for Oracle eLink OSI TP Environment
</div>

 
 <p class="pGraphic"><a name="wp1089235"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/new11.gif" alt="Transaction Tree for Oracle eLink OSI TP Environment" id="wp1089233"/></div><p class="pGraphic">

</p>
<p class="pBody"><a name="wp1089236"> </a>
The TDomain instantiation provides a tightly-coupled integration that solves this deadlock problem by minimizing the number of transaction branches required in the interoperation between two domains. The corresponding transaction tree is shown in <a href="addoma.html#wp1089241">Figure&#160;4-6</a>. 
</p>
<div class="pFigureTitle"><a name="wp1089241"> </a>
Figure&#160;4-6  Transaction Tree for TDomain Environment
</div>

 
 <p class="pGraphic"><a name="wp1089245"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/dom36new.gif" alt="Transaction Tree for TDomain Environment" id="wp1089243"/></div><p class="pGraphic">

</p>
<p class="pBody"><a name="wp1089246"> </a>
Notice that the gateway still must perform mappings between an Oracle Tuxedo system transaction and a network transaction, and that the hierarchical nature of the communication between domains must be strictly enforced. The diagram shows that requests <code class="cCode">r1</code>, <code class="cCode">r2</code>, and <code class="cCode">r3</code> are mapped to a single TDomain transaction branch. Therefore, on Domain B only one Oracle Tuxedo system transaction needs to be generated; <code class="cCode">T2</code> represents this mapping and the graph shows domain gateway group <code class="cCode">GW</code> on Domain B coordinating group <code class="cCode">G1</code>. Request <code class="cCode">r4</code> is mapped to identifier <code class="cCode">T2</code> on Domain B, but TDomain will generate a new branch in its transaction tree (<code class="cCode">r4</code>: B to A&#39;). Because this is a new transaction branch on Domain A, the gateway generates a new mapping, <code class="cCode">T3</code>, to a new Oracle Tuxedo system transaction. The graph shows that domain gateway group <code class="cCode">GW</code> on Domain A also coordinates group <code class="cCode">G4</code>. Hence, the hierarchical nature of interdomain communication is fully enforced with this mapping: group <code class="cCode">G4</code> cannot commit before group <code class="cCode">G1</code>.
</p>
<h4 class="pHeading3"><a name="wp1089247"> </a>
Summary of Domains Transaction Management
</h4>
<p class="pBody"><a name="wp1089248"> </a>
Domains transaction management can be summarized as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089249"> </a>Gateways generate mappings from an Oracle Tuxedo system transaction to a network transaction. A new mapping is generated for each Oracle Tuxedo system transaction and each incoming network transaction branch.</li>
<li><a name="wp1092745"> </a>Each instantiation of domain gateway (TDomain, SNA, or OSI TP) handles its own representation of the network transaction tree. All instantiations observe the hierarchical nature of the interdomain communication.</li>
</ul></div>
<h3 class="pHeading2"><a name="wp1092747"> </a>
Using Logging to Track Transactions
</h3>
<p class="pBody"><a name="wp1092748"> </a>
Logging is used to keep track of the progress of a 2-phase commit protocol. The information stored in the log is used to make sure a transaction is completed in the event of a network failure or machine crash.
</p>
<p class="pBody"><a name="wp1089253"> </a>
To ensure completion of transactions across domains, domain gateways log the mapping between local and remote identifiers. Along with this information, the Domains transaction management facility records the decisions made during different phases of the commitment protocol, and any information available about the remote domains involved in the transaction. In the OSI TP case, the XAP-TP interface logs the information required for the recovery of the OSI TP protocol machine. The information is referred to as a <em class="cEmphasis">blob</em> (binary large object) and is kept in the same log record as the commit information to make recovery easier.
</p>
<p class="pBody"><a name="wp1089254"> </a>
Domains log records have a different structure from the log records stored in the Oracle Tuxedo system <code class="cCode">TLOG</code>. <code class="cCode">TLOG</code> records are fixed in size and are stored in a single page. Domains log records vary in size; more than one page may be required to store the record. The Domains logging mechanism, <code class="cCode">DMTLOG</code>, has the capability of storing variable-size log records.
</p>
<p class="pBody"><a name="wp1089255"> </a>
When a <code class="cCode">TMS</code> is the superior of a domain gateway group, the Oracle Tuxedo <code class="cCode">TLOG</code> is still required to coordinate the commitment.
</p>
<p class="pBody"><a name="wp1089257"> </a>
Logging is performed by the <code class="cCode">GWADM</code> administrative server. The request for a log write is made by the <code class="cCode">GWTDOMAIN</code> process, but the actual log write is performed by the <code class="cCode">GWADM</code> process.
</p>
<p class="pBody"><a name="wp1094777"> </a>
You must create a log called <code class="cCode">DMTLOG</code> for each domain gateway group. The <code class="cCode">DMTLOG</code> files are defined in the <code class="cCode">DM_LOCAL</code> section of the <code class="cCode">DMCONFIG</code> file. To create a <code class="cCode">DMTLOG</code> file, add an entry for the <code class="cCode">DMTLOGDEV</code> parameter:
</p>
<a name="wp1094787"> </a><div class="pPreformatted"><pre><code class="cCode">DMTLOGDEV=</code><code class="cCodeEmphasis">string</code></pre></div><p class="pBody"><a name="wp1094786"> </a>
where <code class="cCodeEmphasis">string</code> is the name of the log file. In addition, you cam set one or both of the two optional parameters:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1094796"> </a><code class="cCode">DMTLOGNAME=</code><code class="cCodeEmphasis">identifier</code></li>
<li><a name="wp1094823"> </a><code class="cCode">DMTLOGSIZE=</code><code class="cCodeEmphasis">numeric</code></li>
</ul></div>
<p class="pBody"><a name="wp1094812"> </a>
For more information, see <a href="../rf5/rf5.html">DMCONFIG(5)</a> in <em class="cEmphasis">Oracle Tuxedo File Formats, Data Descriptions, MIBs, and System Processes Reference</em>.
</p>
<p class="pBody"><a name="wp1094844"> </a>
Administrators also have the option of using the run-time administration utility (<code class="cCode">dmadmin</code>) to create a <code class="cCode">DMTLOG</code>. For more information, see <a href="../rfcm/rfcmd.html">dmadmin(1)</a> in <em class="cEmphasis">Oracle Tuxedo Command Reference</em>.
</p>
<p class="pBody"><a name="wp1094846"> </a>
If a <code class="cCode">DMTLOG</code> has not been created when a domain gateway group is booted, the gateway server automatically creates the log, based on information in the <code class="cCode">BDMCONFIG</code> file.
</p>
<p class="pBody"><a name="wp1094847"> </a>
Until a logging device is specified in the <code class="cCode">BDMCONFIG</code> file, a domain gateway group cannot process requests in transaction mode and the domain gateway group cannot offer the <code class="cCode">TMS</code> service.
</p>
<p class="pBody"><a name="wp1094848"> </a>
To coordinate the commit protocol, domain gateways require the following two log records: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089261"> </a><em class="cEmphasis">Ready record</em>&#8212;a ready record is a file created by a gateway acting as a leaf or intermediate machine in a transaction tree. It records information about the superior and subordinate remote domains involved in the transaction. A ready record indicates that all subordinates of the domain gateway group logging the record have been prepared.</li>
<li><a name="wp1089262"> </a><em class="cEmphasis">Commit record</em>&#8212;a commit record documents that a transaction has been committed. A domain gateway creates a commit record as the coordinator of a particular transaction tree.</li>
</ul></div>
<p class="pBody"><a name="wp1089263"> </a>
When a transaction has been committed on all machines, these logs for the transaction are removed.
</p>
<p class="pBody"><a name="wp1089264"> </a>
When the OSI TP protocol is being used, two types of heuristic records are logged: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089265"> </a><em class="cEmphasis">Log Heuristic record</em>&#8212;this record holds the details of a heuristic decision in the domain until the outcome of the relevant transaction is known by the superior.</li>
<li><a name="wp1089266"> </a><em class="cEmphasis">Log Damage record</em>&#8212;this record is created to indicate one of two conditions for a transaction branch: (run with <a href="../rfcm/rfcmd.html">tmadmin(1)</a>) a <em class="cEmphasis">heuristic hazard</em> (when the outcome of the transaction branch for a subordinate is unknown) or a <em class="cEmphasis">heuristic mix</em> (when the transaction subtree has a mixed outcome).</li>
</ul></div>
<p class="pBody"><a name="wp1089267"> </a>
Heuristic log records persist until they are explicitly removed by the administrator. This persistence is required to provide the correct information during recovery after a crash, and to provide diagnostic information for administrators.
</p>
<p class="pBody"><a name="wp1089268"> </a>
The administrator uses the <code class="cCode">forgettran</code> command (run with <a href="../rfcm/rfcmd.html">tmadmin(1)</a>) to remove heuristic records when they are no longer needed.
</p>
<h3 class="pHeading2"><a name="wp1089269"> </a>
Recovering Failed Transactions
</h3>
<p class="pBody"><a name="wp1089270"> </a>
When a domain gateway group is booted, the gateway server performs an automatic <em class="cEmphasis">warm-start</em> of the <code class="cCode">DMTLOG</code>. The warm-start includes scanning the log to see if any transactions were not completed. If incomplete transactions are found, action is taken to complete them.
</p>
<p class="pBody"><a name="wp1089271"> </a>
In OSI TP, any <em class="cEmphasis">blobs</em> stored in the <code class="cCode">DMTLOG</code> with a transaction record are passed to the network access module, which uses the blobs to reconstruct its internal state and to recover any failed connections
</p>
<p class="pBody"><a name="wp1089272"> </a>
In the case of heuristic decisions, if a domain gateway group is a subordinate of a local <code class="cCode">TMS</code> and a heuristic decision has been indicated, the <code class="cCode">TMS</code> generates a <code class="cCode">TMS_STATUS</code> message to learn the final decision: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1089273"> </a>If a gateway fails, then it cleans up after itself when it is restarted (this is called a <em class="cEmphasis">hot-start</em>). The gateway rolls back all undecided transactions in which it was involved.</li>
<li><a name="wp1089274"> </a>If a communication line failure occurs and the first phase of the commit has not been completed, the gateway rolls back the transactions associated with that connection.</li>
<li><a name="wp1089275"> </a>If OSI TP Domains is being used and a transaction fails in the second phase of the commit, recovery is managed by XAP-TP.</li>
</ul></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="addoma.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="adcorb.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq10" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
