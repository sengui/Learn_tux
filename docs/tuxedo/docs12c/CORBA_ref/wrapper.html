<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="2" />
<meta name="LOC_US_CHANGE" content="41908" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux12c/CORBA_ref/fm/wrapper.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="06/26/12 11:01:23" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Joint Client/Servers</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">CORBA Programming Reference
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="intfc_re.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="command.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/CORBA_ref.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1045579"> </a>
Joint Client/Servers
</h1>
<p class="pBody"><a name="wp1049362"> </a>
This chapter describes programming requirements for CORBA joint client/servers and the C++ OracleWrapper Callbacks API.
</p>
<a name="wp1049399"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB were deprecated in Tuxedo 8.1 and are no longer supported in Tuxedo 9.x. All Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB text references, associated code samples, etc. should only be used:</td>
</tr>
</table>

<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp1049400"> </a>to help implement/run third party Java ORB libraries, and </li>
<li><a name="wp1049401"> </a>for programmer reference only.</li>
</ul></div>
<a name="wp1049402"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>Technical support for third party CORBA Java ORBs should be provided by their respective vendors. Oracle Tuxedo does not provide any technical support or documentation for third party CORBA Java ORBs.</td>
</tr>
</table>
<p class="pBody"><a name="wp1024359"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1038110"> </a><a href="wrapper.html#wp1049287">Introduction</a>. This section describes:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1038115"> </a><a href="wrapper.html#wp1021390">Main Program and Server Initialization</a></li>
<li><a name="wp1038120"> </a><a href="wrapper.html#wp1021395">Servants</a></li>
<li><a name="wp1038125"> </a><a href="wrapper.html#wp1049456">Servant Inheritance from Skeletons</a></li>
<li><a name="wp1038130"> </a><a href="wrapper.html#wp1025616">Callback Object Models Supported</a></li>
<li><a name="wp1043009"> </a><a href="wrapper.html#wp1042678">Configuring Servers to Call Remote Joint Client/Server Objects</a></li>
<li><a name="wp1038142"> </a><a href="wrapper.html#wp1021422">Preparing Callback Objects Using CORBA (C++ Joint Client/Servers Only)</a></li>
<li><a name="wp1038147"> </a><a href="wrapper.html#wp1051926">Preparing Callback Objects Using OracleWrapper Callbacks</a></li>
</ul></div>
<li><a name="wp1038159"> </a><a href="wrapper.html#wp1039042">C++ OracleWrapper Callbacks Interface API</a></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1049287"> </a>
Introduction
</h2><p class="pBody"><a name="wp1024360"> </a>
For either an Oracle Tuxedo CORBA client or joint client/server (that is, a client that can receive and process object invocations), the programmer writes the client main(). The <code class="cCode">main()</code> uses Oracle Tuxedo CORBA environmental objects to establish connections, set up security, and start transactions. 
</p>
<p class="pBody"><a name="wp1024147"> </a>
Oracle Tuxedo clients invoke operations on objects. In the case of DII, client code creates the DII Request object and then invokes one of two operations on the DII Request. In the case of static invocation, client code performs the invocation by performing what looks like an ordinary invocation (which ends up calling code in the generated client stub). Additionally, the client programmer uses ORB interfaces defined by OMG, and Oracle Tuxedo CORBA environmental objects that are supplied with the Oracle Tuxedo software, to perform functions unique to Oracle Tuxedo.
</p>
<p class="pBody"><a name="wp1024974"> </a>
For Oracle Tuxedo joint client/server applications, the client code must be structured so that it can act as a server for callback Oracle Tuxedo objects. Such clients do not use the TP Framework and are not subject to Oracle Tuxedo system administration. Besides the programming implications, this means that CORBA joint client/servers do not have the same scalability and reliability as Oracle Tuxedo CORBA servers, nor do they have the state management and transaction behavior available in the TP Framework. If a user wants to have those characteristics, the application must be structured in such a way that the object implementations are in an Oracle Tuxedo CORBA server, rather than in a client.
</p>
<p class="pBody"><a name="wp1021250"> </a>
The following sections describe the mechanisms you use to add callback support to an Oracle Tuxedo client. In some cases, the mechanisms are contrasted with the Oracle Tuxedo server mechanisms that use the TP Framework.
</p>
<h3 class="pHeading2"><a name="wp1021390"> </a>
Main Program and Server Initialization
</h3>
<p class="pBody"><a name="wp1038395"> </a>
In an Oracle Tuxedo server, you use the <code class="cCode">buildobjserver</code> command to create the main program for the C++ server. (Java servers are not supported in release 8.0 and later of Oracle Tuxedo.) Server main program takes care of all Oracle Tuxedo- and CORBA-related initialization of the server functions. However, since you implement the Server object, you have an opportunity to customize the way in which the server application is initialized and shut down. The server main program automatically invokes methods on the Server object at the appropriate times.
</p>
<p class="pBody"><a name="wp1021392"> </a>
In contrast, for an Oracle Tuxedo CORBA joint client/server (as for an Oracle Tuxedo CORBA client), you create the main program and are responsible for all initialization. You do not need to provide a Server object because you have complete control over the main program and you can provide initialization and shutdown code in any way that is convenient.
</p>
<p class="pBody"><a name="wp1021393"> </a>
The specific initialization needed for a joint client/server is discussed in the section <a href="wrapper.html#wp1021395">Servants</a>. 
</p>
<h3 class="pHeading2"><a name="wp1021395"> </a>
Servants 
</h3>
<p class="pBody"><a name="wp1021396"> </a>
Servants (method code) for joint client/servers are very similar to servants for servers. All business logic is written the same way. The differences result from not using the TP Framework. Therefore, the main difference is that you use CORBA functions directly instead of indirectly through the TP Framework.
</p>
<p class="pBody"><a name="wp1021397"> </a>
The <code class="cCode">Server</code> interface is used in Oracle Tuxedo CORBA servers to allow the TP Framework to ask the user to create a servant for an object when the ORB receives a request for that object. However, in joint client/servers, the user program is responsible for creating a servant before any requests arrive; thus, the <code class="cCode">Server</code> interface is not needed. Typically, the program creates a servant and then activates the object (using the servant and an <code class="cCode">ObjectId</code>; the <code class="cCode">ObjectId</code> is possibly system generated) before handing a reference to the object. Such an object might be used to handle callbacks. Thus, the servant already exists and the object is activated before a request for the object arrives.
</p>
<p class="pBody"><a name="wp1049448"> </a>
For C++ joint client/servers, instead of invoking the <code class="cCode">TP</code> interface to perform certain operations, client servants directly invoke the ORB and POA (which is what the <code class="cCode">TP</code> interface does internally). Alternately, since much of the interaction with the ORB and POA is the same for all applications, for ease of use, the client library provides a convenience wrapper object that does the same things, using a single operation. For a discussion of how to use the convenience wrapper object, see <a href="wrapper.html#wp1025616">Callback Object Models Supported</a> and <a href="wrapper.html#wp1051926">Preparing Callback Objects Using OracleWrapper Callbacks</a>.
</p>
<h3 class="pHeading2"><a name="wp1049456"> </a>
Servant Inheritance from Skeletons
</h3>
<p class="pBody"><a name="wp1021402"> </a>
In a client that supports callbacks, as well as in a server, you write a implementation class that inherits from the same skeleton class name generated by the IDL compiler (the <code class="cCode">idl</code> command). 
</p>
<h4 class="pHeading3"><a name="wp1038493"> </a>
C++ Example of Inheritance from Skeletons
</h4>
<p class="pBody"><a name="wp1038494"> </a>
The following is a C++ example, given the IDL:
</p>
<a name="wp1021403"> </a><div class="pPreformatted"><pre><code class="cCode">interface Hospital{ … };</code></pre></div><p class="pBody"><a name="wp1021404"> </a>
The skeleton generated by the <code class="cCode">idl</code> command contains a &#8220;skeleton&#8221; class, <code class="cCode">POA_Hospital</code>, that the user-written class inherits from, as in:
</p>
<a name="wp1021405"> </a><div class="pPreformatted"><pre>class Hospital_i : public POA_Hospital { ... };</pre></div><p class="pBody"><a name="wp1021406"> </a>
In a server, the skeleton class inherits from the TP Framework class <code class="cCode">Tobj_ServantBase</code>, which in turn inherits from the predefined <code class="cCode">PortableServer::ServantBase</code>.
</p>
<p class="pBody"><a name="wp1021407"> </a>
The inheritance tree for a callback object implementation in a joint client/server is different than that in a server. The skeleton class does not inherit from the TP Framework class <code class="cCode">Tobj_ServantBase</code>, but instead inherits directly from <code class="cCode">PortableServer::ServantBase</code>. This behavior is achieved by specifying the <code class="cCode">-P</code> option in the <code class="cCode">idl</code> command.
</p>
<p class="pBody"><a name="wp1021408"> </a>
Not having the <code class="cCode">Tobj_ServantBase</code> class in the inheritance tree for a servant means that the servant does not have <code class="cCode">activate_object</code> and <code class="cCode">deactivate_object</code> methods. In a server, these methods are called by the TP Framework to dynamically initialize and save a servant&#8217;s state before invoking a method on the servant. For a client that supports callbacks, you must write code that explicitly creates a servant and initializes a servant&#8217;s state.
</p>
<h3 class="pHeading2"><a name="wp1025616"> </a>
Callback Object Models Supported
</h3>
<p class="pBody"><a name="wp1021414"> </a>
Oracle Tuxedo CORBA supports four kinds of callback objects and provides wrappers for the three that are most common. These objects correspond to three combinations of POA policies. The POA policies control both the types of objects and the types of object references that are possible.
</p>
<p class="pBody"><a name="wp1030791"> </a>
The POA policies that are applicable are:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1030796"> </a>The LifeSpanPolicy, which controls how long an object reference is valid.</li>
<li><a name="wp1030799"> </a>The IdAssignmentPolicy, which controls who assigns the <code class="cCode">ObjectId</code>&#8212;the user or the system.</li>
</ul></div>
<p class="pBody"><a name="wp1021415"> </a>
These objects are explained primarily in terms of their behavioral characteristics rather than in details about how the ORB and the POA handle them. Those details are discussed in the next sections, using either direct ORB and POA calls (which requires a little extra knowledge of CORBA servers) or using the OracleWrapper Callbacks interface, which hides the ORB and POA calls (for users who do not care about the details).
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1021416"> </a>Transient/SystemId&#8212;object references are valid only for the life of the client process. The <code class="cCode">ObjectId</code> is not assigned by the client application, but is a unique value assigned by the system. This type of object is useful for invocations that a client wants to receive only until the client terminates. (The corresponding POA LifeSpanPolicy value is <code class="cCode">TRANSIENT</code> and the IdAssignmentPolicy is <code class="cCode">SYSTEM_ID</code>.) </li>
<li><a name="wp1021417"> </a>Persistent/SystemId<span style="font-weight: bold">&#8212;</span>object references are valid across multiple activations. The <code class="cCode">ObjectId</code> is not assigned by the client application, but is a unique value assigned by the system. This type of object and object reference is useful when the client goes up and down over a period of time. When the client is up, it can receive callback objects on that particular object reference. <br /><br />Typically, the client will create the object reference once, save it in its own permanent storage area, and reactivate the servant for that object every time it comes up. If used with an Oracle Tuxedo CORBA Notification Service application, for example, these are callbacks that correspond to the concept of a persistent subscription; that is, the Notification Service remembers the callback reference and delivers events any time the client is up and declares that it is again ready to receive events. This allows notification service subscriptions to survive client failures or offline-time. (The corresponding POA policy values are <code class="cCode">PERSISTENT</code> and <code class="cCode">SYSTEM_ID</code>.)</li>
<li><a name="wp1021418"> </a>Persistent/UserId&#8212;this is the same as Persistent/SystemId with the exception that the <code class="cCode">ObjectId</code> has to be assigned by the client application. Such an <code class="cCode">ObjectId</code> might be, for example, a database key meaningful only to the client. (The corresponding POA policy values are <code class="cCode">PERSISTENT</code> and <code class="cCode">USER_ID</code>.)</li>
</ul></div>
<a name="wp1021419"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>The Transient/UserId<span style="font-weight: bold"> </span>policy<span style="font-weight: bold"> </span>combination<span style="font-weight: bold"> </span>is not considered particularly important. It is possible for users to provide for themselves by using the POA in a manner analogous to either of the persistent cases, but the Oracle Tuxedo wrappers do not provide special help to do so.</td></tr>
</table>

<a name="wp1021420"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>For Oracle Tuxedo CORBA native joint client/servers, neither of the Persistent policies is supported, only the Transient policy.</td>
</tr>
</table>
<h3 class="pHeading2"><a name="wp1042678"> </a>
Configuring Servers to Call Remote Joint Client/Server Objects
</h3>
<p class="pBody"><a name="wp1042699"> </a>
In order for an Oracle Tuxedo server to call remote joint client/server objects, that is, joint client/server objects located outside the Oracle Tuxedo domain, the server must be configured to enable outbound IIOP. This capability is enabled by specifying the <code class="cCode">-O</code> (uppercase letter O) option in the IIOP Server Listener (ISL) server command. Setting the <code class="cCode">-O</code> option enables outbound invokes (outbound IIOP) on joint client/server objects that are not connected to an IIOP Listener Handler (ISH).
</p>
<p class="pBody"><a name="wp1042964"> </a>
You set ISL command options in the <code class="cCode">SERVERS</code> section of the server&#8217;s <code class="cCode">UBBCONFIG</code> file. Because support for outbound IIOP requires a small amount of extra resources, the default is outbound IIOP disabled. For more information, see &#8220;Using the ISL Command to Configure Outbound IIOP&#8221; in <a href="../ads/index.html">Setting Up an Oracle Tuxedo Application</a> and &#8220;<code class="cCode">ISL(1)</code>&#8221; in the </a>BEA Tuxedo Command Reference</a>.
</p>
<h3 class="pHeading2"><a name="wp1021422"> </a>
Preparing Callback Objects Using CORBA (C++ Joint Client/Servers Only)
</h3>
<p class="pBody"><a name="wp1021423"> </a>
To set up Oracle Tuxedo C++ callback objects using CORBA, the client must do the following:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1021424"> </a>Establish a connection with a POA with the appropriate policies for the callback object model. (This can be the root POA, available by default, or it may require creating a new POA.)</li>
<li><a name="wp1021425"> </a>Create a servant (that is, an instance of the C++ implementation class for the interface).</li>
<li><a name="wp1021426"> </a>Inform the POA that the servant is ready to accept requests on the callback object. Technically, this means the client <code class="cCode">activates</code> the object in the POA (that is, puts the servant and the <code class="cCode">ObjectId</code> into the POA&#8217;s Active Object Map).</li>
<li><a name="wp1021427"> </a>Tell the POA to start accepting requests from the network (that is, activate the POA itself).</li>
<li><a name="wp1021428"> </a>Create an object reference for the callback object.</li>
<li><a name="wp1021429"> </a>Give out the object reference. This usually happens by making an invocation on another object with the callback object reference as a parameter (that is, the parameter is a callback object). That other object will then invoke the callback object (perform a callback invocation) at some later time.</li>
</ol></div>
<p class="pBody"><a name="wp1021430"> </a>
Assuming that the client already has obtained a reference to the ORB, performing this task takes four interactions with the ORB and the POA. It might look like the model show in <a href="wrapper.html#wp1039779">Listing&#160;11-1</a>. In this model, only the Root POA is needed.
</p>
<div class="pCodeTitle"><a name="wp1039779"> </a>
Listing&#160;11-1	   Transient/SystemId Model
</div> <a name="wp1021431"> </a><div class="pPreformatted"><pre>// Create a servant for the callback Object <br />Catcher_i* my_catcher_i = new Catcher_i();    </pre></div><a name="wp1027751"> </a><div class="pPreformatted"><pre>// Get root POA reference and activate the POA<br />1   CORBA::Object_var oref =<br />              orb-&gt;resolve_initial_references(&quot;RootPOA&quot;);<br />2   PortableServer::POA_var root_poa =<br />              PortableServer::POA::_narrow(oref);<br />3   root_poa -&gt; the_POAManager() -&gt; activate();<br />4   PortableServer::objectId_var temp_Oid =<br />              root_poa -&gt;activate_object ( my_catcher_i );<br />5   oref = root_poa-&gt;create_reference_with_id(<br />                                  temp_Oid, _tc_Catcher-&gt;id() );<br />6   Catcher_var my_catcher_ref = Catcher::_narrow( oref );</pre></div><p class="pBody"><a name="wp1021442"> </a>
To use the Persistent/UserId model, there are some additional steps required when creating a POA. Further, the <code class="cCode">ObjectId</code> is specified by the client, and this requires more steps. It might look like the model shown in <a href="wrapper.html#wp1039819">Listing&#160;11-2</a>.
</p>
<div class="pCodeTitle"><a name="wp1039819"> </a>
Listing&#160;11-2	   Persistent/UserId Model
</div> <a name="wp1021443"> </a><div class="pPreformatted"><pre>    Catcher_i* my_catcher_i = new Catcher_i();<br />    const char* oid_str = &quot;783&quot;;<br />1   PortableServer::objectId_var oid =<br />             PortableServer::string_to_objectId(oid_str);<br />// Find root POA <br />2   CORBA::Object_var oref =<br />             orb-&gt;resolve_initial_references(&quot;RootPOA&quot;);<br />3   PortableServer::POA_var root_poa =<br />             PortableServer::POA::_narrow(oref);<br />// Create and activate a Persistent/UserId POA<br />4   CORBA::PolicyList policies(2); <br />5   policies.length(2);<br />6   policies[0] = root_poa-&gt;create_lifespan_policy(<br />                                    PortableServer::PERSISTENT);<br />7   policies[1] = root_poa-&gt;create_id_assignment_policy(<br />                                     PortableServer::USER_ID );<br />8   PortableServer::POA_var my_poa_ref =<br />             root_poa-&gt;create_POA(<br />                   &quot;my_poa_ref&quot;, root_poa-&gt;the_POAManager(), policies);<br />9   root_poa-&gt;the_POAmanager()-&gt;activate();<br />// Create object reference for callback Object<br />10 oref =  my_poa_ref -&gt; create_reference_with_id( <br />                                           oid, _tc_Catcher-&gt;id());<br />11 Catcher_var my_catcher_ref = Catcher::_narrow( oref );<br />// activate object<br />12 my_poa_ref -&gt; activate_object_with_id( oid, my_catcher_i );<br />// Make the call passing the callback ref<br />    foo -&gt; register_callback ( my_catcher_ref );</pre></div><p class="pBody"><a name="wp1051924"> </a>
All the interfaces and operations described here are standard CORBA interfaces and operations.
</p>
<h3 class="pHeading2"><a name="wp1051926"> </a>
Preparing Callback Objects Using OracleWrapper Callbacks
</h3>
<p class="pBody"><a name="wp1039482"> </a>
You can use the OracleWrapper callbacks API with to write either C++ joint client/servers. 
</p>
<h4 class="pHeading3"><a name="wp1039433"> </a>
Using OracleWrapper Callbacks With C++
</h4>
<p class="pBody"><a name="wp1021653"> </a>
Because the code required for callback objects is nearly identical for every client that supports callbacks, you may find it convenient to use the OracleWrappers provided in the library provided for joint client/servers. 
</p>
<p class="pBody"><a name="wp1028456"> </a>
The OracleWrappers are described in IDL, as shown in <a href="wrapper.html#wp1039882">Listing&#160;11-3</a>. 
</p>
<div class="pCodeTitle"><a name="wp1039882"> </a>
Listing&#160;11-3	   OracleWrapper IDL
</div> <a name="wp1018760"> </a><div class="pPreformatted"><pre>// File: BEAWrapper<br />#ifndef _BEA_WRAPPER _IDL_<br />#define _BEA_WRAPPER _IDL_<br />#include &lt;orb.idl&gt;<br />#include &lt;PortableServer.idll&gt;</pre></div><a name="wp1018766"> </a><div class="pPreformatted"><pre>#pragma prefix &#8220;beasys.com&#8221;</pre></div><a name="wp1019281"> </a><div class="pPreformatted"><pre>module <code class="cCode">BEAWrapper</code> {<br />   interface <code class="cCode">Callbacks</code> <br />   {<br />       <code class="cCode">exception ServantAlreadyActive{ };<br />       exception ObjectAlreadyActive { };<br />       exception NotInRequest{ };<br /></code><br />       <code class="cCode">// set up transient callback Object <br />       // -- prepare POA, activate object, return objref<br />          Object start_transient( <br />                        in PortableServer::Servant      Servant, <br />                        in CORBA::RepositoryId          rep_id)<br /></code>           raises (ServantAlreadyActive);</pre></div><a name="wp1018781"> </a><div class="pPreformatted"><pre>       // set up persistent/systemid callback Object <br />       <code class="cCode">Object start_persistent_systemid( <br />               in PortableServer::Servant      servant, <br />               in CORBA::Repository            rep_id,<br />               out string                      stroid) <br />          raises (ServantAlreadyActive);</code></pre></div><a name="wp1018787"> </a><div class="pPreformatted"><pre><code class="cCode">       // reinstate set up for persistent/systemid <br />       // callback object <br />       Object restart_persistent_systemid( <br />               in PortableServer::Servant     servant, <br />               in CORBA::RepositoryId         rep_id,<br />               in string                      stroid)<br />          raises (ServantAlreadyActive, ObjectAlreadyActive);</code></pre></div><a name="wp1018793"> </a><div class="pPreformatted"><pre><code class="cCode">       // set up persistent/userid callback Object<br />       Object start_persistent_userid( <br />                in PortableServer::Servant        servant,    <br />                in CORBA::RepositoryId            rep_id,<br />                in string                       stroid)<br />          raises (ServantAlreadyActive, ObjectAlreadyActive);</code></pre></div><a name="wp1018799"> </a><div class="pPreformatted"><pre><code class="cCode">       // stop servicing a particular callback Object<br />       // with the given servant<br />       void stop_object( in PortableServer::Servant servant);</code></pre></div><a name="wp1018802"> </a><div class="pPreformatted"><pre><code class="cCode">       //Stop all callback Object processing<br />       void stop_all_objects();</code></pre></div><a name="wp1018805"> </a><div class="pPreformatted"><pre><code class="cCode">      // get oid string for the current request<br />      string get_string_oid() raises (NotInRequest)</code>; <br />   };<br />}<br />#endif /* _BEA_WRAPPER _IDL_ */</pre></div><p class="pBody"><a name="wp1039950"> </a>
The OracleWrappers are described in C++ as shown in <a href="wrapper.html#wp1039952">Listing&#160;11-4</a>.
</p>
<div class="pCodeTitle"><a name="wp1039952"> </a>
Listing&#160;11-4	   C++ Declarations (in beawrapper.h)
</div> <a name="wp1028465"> </a><div class="pPreformatted"><pre><code class="cCode">#ifndef _BEAWRAPPER_H_<br />#define _BEAWRAPPER_H_</code></pre></div><a name="wp1028468"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;PortableServer.h&gt;<br />class BEAWrapper{<br />class Callbacks{<br />      public:<br />            Callbacks (CORBA::ORB_ptr init_orb);</code></pre></div><a name="wp1028687"> </a><div class="pPreformatted"><pre><code class="cCode">            CORBA::Object_ptr start_transient ( <br />                        PortableServer::Servant servant,<br />                         const char *     rep_id);</code></pre></div><a name="wp1028477"> </a><div class="pPreformatted"><pre><code class="cCode">            CORBA::Object_ptr start_persistent_systemid (<br />                          PortableServer::Servant servant,<br />                          const char *     rep_id,<br />                           char * &amp; stroid);</code></pre></div><a name="wp1028483"> </a><div class="pPreformatted"><pre><code class="cCode">            CORBA::Object_ptr restart_persistent_systemid (<br />                           PortableServer::Servant servant,<br />                           const char *     rep_id,<br />                            const char *     stroid);</code></pre></div><a name="wp1028489"> </a><div class="pPreformatted"><pre><code class="cCode">            CORBA::Object_ptr start_persistent_userid (<br />                           PortableServer::Servant servant,<br />                           const char *     rep_id,<br />                            const char *     stroid);</code></pre></div><a name="wp1040063"> </a><div class="pPreformatted"><pre><code class="cCode">              void stop_object(PortableServer::Servant servant);</code></pre></div><a name="wp1040103"> </a><div class="pPreformatted"><pre><code class="cCode">              char* get_string_oid ();</code></pre></div><a name="wp1040119"> </a><div class="pPreformatted"><pre><code class="cCode">              void stop_all_objects();</code></pre></div><a name="wp1040128"> </a><div class="pPreformatted"><pre><code class="cCode">             ~Callbacks();<br />        private:</code></pre></div><a name="wp1028505"> </a><div class="pPreformatted"><pre><code class="cCode">              static CORBA::ORB_var orb_ptr;</code></pre></div><a name="wp1028507"> </a><div class="pPreformatted"><pre><code class="cCode">              static PortableServer::POA_var root_poa;<br />              static PortableServer::POA_var trasys_poa;<br />              static PortableServer::POA_var persys_poa;<br />              static PortableServer::POA_var peruser_poa;<br />     };<br />};<br />#endif // _BEAWRAPPER_H_</code></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1039042"> </a>
C++ OracleWrapper Callbacks Interface API
</h2><p class="pBody"><a name="wp1035076"> </a>
This C++ OracleWrapper Callbacks interface API is described in the following sections.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1033616"> </a>
Callbacks
</h3>
<h4 class="pHeading3"><a name="wp1018813"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025803"> </a>
Returns a reference to the Callbacks interface.
</p>
<h4 class="pHeading3"><a name="wp1025802"> </a>
C++ Binding
</h4>
<a name="wp1019302"> </a><div class="pPreformatted"><pre><code class="cCode">BEAWrapper::Callbacks( CORBA::ORB_ptr init_orb);</code></pre></div><h4 class="pHeading3"><a name="wp1018819"> </a>
Argument
</h4>
<h4 class="pDefTerm"><a name="wp1019323"> </a>
<code class="cCode">init_orb</code>
</h4><div class="pDefPara"><a name="wp1019332"> </a>
The ORB to be used for all further operations.
</div>
<h4 class="pHeading3"><a name="wp1040426"> </a>
Exception
</h4>
<h4 class="pDefTerm"><a name="wp1040427"> </a>
<code class="cCode">CORBA::IMP_LIMIT</code>
</h4><div class="pDefPara"><a name="wp1040428"> </a>
The <code class="cCode">BEAWrapper::Callbacks</code> class has already be instantiated with an ORB pointer. Only one instance of this class can be used in a process. Users who need additional flexibility should use the POA directly.
</div>
<h4 class="pHeading3"><a name="wp1030831"> </a>
Description
</h4>
<p class="pBody"><a name="wp1030832"> </a>
The constructor returns a reference to the Callbacks interface. Only one such object should be created for the process, even if multiple threads are used. Using more than one such object will result in undefined behavior.
</p>
<h4 class="pHeading3"><a name="wp1040438"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1040439"> </a>
A reference to the Callbacks object.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1018827"> </a>
start_transient
</h3>
<h4 class="pHeading3"><a name="wp1018828"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025813"> </a>
Activates an object, sets the ORB and the POA to the proper state, and returns an object reference to the activated object.
</p>
<h4 class="pHeading3"><a name="wp1025806"> </a>
IDL
</h4>
<a name="wp1019379"> </a><div class="pPreformatted"><pre>Object start_transient( in PortableServer::Servant   servant, <br />                        in CORBA::RepositoryId       rep_id) <br />          raises ( ServantAlreadyActive );</pre></div><h4 class="pHeading3"><a name="wp1018832"> </a>
C++ Binding
</h4>
<a name="wp1019452"> </a><div class="pPreformatted"><pre>CORBA::Object_ptr start_transient( <br />                    PortableServer::Servant         servant, <br />                    const char*                     rep_id);<br /></pre></div><h4 class="pHeading3"><a name="wp1031655"> </a>
Arguments
</h4>
<h4 class="pDefTerm"><a name="wp1018846"> </a>
<code class="cCode">servant</code>
</h4><div class="pDefPara"><a name="wp1019485"> </a>
An instance of the C++ implementation class for the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018848"> </a>
<code class="cCode">rep_id</code>
</h4><div class="pDefPara"><a name="wp1019494"> </a>
The repository <code class="cCode">id</code> of the interface.
</div>
<h4 class="pHeading3"><a name="wp1040934"> </a>
Exceptions
</h4>
<h4 class="pDefTerm"><a name="wp1040935"> </a>
<code class="cCode">ServantAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1040936"> </a>
The servant is already being used for a callback. A servant can be used only for a callback with a single <code class="cCode">ObjectId</code>. To receive callbacks on objects containing different <code class="cCode">ObjectId</code>s, you must create different servants and activate them separately. The same servant can be reused only if a <code class="cCode">stop_object</code> operation tells the system to stop using the servant for its original <code class="cCode">ObjectId</code>.
</div>
<h4 class="pDefTerm"><a name="wp1040937"> </a>
<code class="cCode">CORBA::BAD_PARAM</code>
</h4><div class="pDefPara"><a name="wp1040938"> </a>
The repository ID was a NULL string or the servant was a NULL pointer.
</div>
<h4 class="pHeading3"><a name="wp1031234"> </a>
Description
</h4>
<p class="pBody"><a name="wp1031235"> </a>
This operation performs the following actions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1031236"> </a>Activates an object using the <code class="cCode">Servant</code> supplied to service objects of the type <code class="cCode">rep_id</code>, using an <code class="cCode">ObjectId</code> generated by the system. </li>
<li><a name="wp1031237"> </a>Sets the ORB and the POA into the state in which they will accept requests on that object. </li>
<li><a name="wp1031238"> </a>Returns an object reference to the activated object. The returned object reference will be valid only until the termination of the client or until the callback servant is halted by the user via the <code class="cCode">stop_object</code> operation; after that, invocations on that object reference are no longer valid and can never be made valid.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1040449"> </a>
Return Value
</h4>
<h4 class="pDefTerm"><a name="wp1040450"> </a>
<code class="cCode">CORBA::Object_ptr</code>
</h4><div class="pDefPara"><a name="wp1040451"> </a>
A reference to the object that was created with the <code class="cCode">ObjectId</code> generated by the system and the <code class="cCode">rep_id</code> provided by the user. The object reference will need to be converted to a specific object type by invoking the <code class="cCode">_narrow()</code> operation defined for the specific object. The caller is responsible for releasing the object when the conversion is done.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1031445"> </a>
start_persistent_systemid
</h3>
<h4 class="pHeading3"><a name="wp1025843"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025844"> </a>
Activates an object, sets the ORB and the POA to the proper state, sets the output parameter <code style="font-weight: normal" class="cCode">stroid</code><span style="font-weight: bold">, </span>and returns an object reference to the activated object.
</p>
<h4 class="pHeading3"><a name="wp1025838"> </a>
IDL
</h4>
<a name="wp1018860"> </a><div class="pPreformatted"><pre>Object <code class="cCode">start_persistent_systemid</code>( <br />                      in PortableServer::Servant      servant, <br />                      in CORBA::RepositoryId          rep_id,<br />                      out string                      stroid) <br />    raises ( ServantAlreadyActive );</pre></div><h4 class="pHeading3"><a name="wp1018864"> </a>
C++ Binding
</h4>
<a name="wp1018865"> </a><div class="pPreformatted"><pre>CORBA::Object_ptr <code class="cCode">start_persistent_systemid</code>(<br />                       PortableServer::Servant          servant,<br />                       const char*                      rep_id,<br />                       char*&amp;                            stroid);<br /> </pre></div><h4 class="pHeading3"><a name="wp1018880"> </a>
JArguments
</h4>
<h4 class="pDefTerm"><a name="wp1018881"> </a>
<code class="cCode">servant</code>
</h4><div class="pDefPara"><a name="wp1019670"> </a>
An instance of the C++ implementation class for the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018883"> </a>
<code class="cCode">rep_id</code>
</h4><div class="pDefPara"><a name="wp1019676"> </a>
The repository ID of the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018885"> </a>
<code class="cCode">stroid</code>
</h4><div class="pDefPara"><a name="wp1019682"> </a>
This argument is set by the system and is opaque to the user. The client will use it when it reactivates the object at a later time (using <code class="cCode">restart_persistent_systemid</code>), most likely after the client process has terminated and restarted.
</div>
<h4 class="pHeading3"><a name="wp1041069"> </a>
Exceptions
</h4>
<h4 class="pDefTerm"><a name="wp1041070"> </a>
<code class="cCode">ServantAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1041071"> </a>
The servant is already being used for a callback. A servant can be used only for a callback with a single <code class="cCode">ObjectId</code>. To receive callbacks on objects containing different <code class="cCode">ObjectIds</code>, you must create different servants and activate them separately. The same servant can be reused only if a <code class="cCode">stop</code> operation tells the system to stop using the servant for its original <code class="cCode">ObjectId</code>.
</div>
<h4 class="pDefTerm"><a name="wp1041072"> </a>
<code class="cCode">CORBA::BAD_PARAMETER</code>
</h4><div class="pDefPara"><a name="wp1041073"> </a>
The repository ID was a NULL string or the servant was a NULL pointer.
</div>
<h4 class="pDefTerm"><a name="wp1041074"> </a>
<code class="cCode">CORBA::IMP_LIMIT</code>
</h4><div class="pDefPara"><a name="wp1041075"> </a>
In addition to other system reasons for this exception, a reason unique to this situation is that the joint client/server was not initialized with a port number; therefore, a persistent object reference cannot be created.
</div>
<h4 class="pHeading3"><a name="wp1031376"> </a>
Description 
</h4>
<p class="pBody"><a name="wp1031377"> </a>
This operation performs the following actions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1031378"> </a>Activates an object using the <code class="cCode">Servant</code> supplied to service objects of the type <code class="cCode">rep_id</code>, using an <code class="cCode">ObjectId</code> generated by the system. </li>
<li><a name="wp1031379"> </a>Sets the ORB and the POA into the state in which they will accept requests on that object. </li>
<li><a name="wp1031380"> </a>Sets the output parameter <code class="cCode">stroid</code> to the stringified version of an <code class="cCode">ObjectId</code> assigned by the system. </li>
<li><a name="wp1031381"> </a>Returns an object reference to the activated object. The returned object reference will be valid even after termination of the client. That is, if the client terminates, restarts again, and then activates a servant with the same <code style="font-weight: normal" class="cCode">rep_id</code><span style="font-weight: bold"> </span>and for the same <code class="cCode">ObjectId</code>, the servant will accept requests made on that same object reference. Since the <code class="cCode">ObjectId</code> was generated by the system, the application has to save that <code class="cCode">ObjectId</code>.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1041057"> </a>
Return Value
</h4>
<h4 class="pDefTerm"><a name="wp1041058"> </a>
<code class="cCode">CORBA::Object_ptr</code>
</h4><div class="pDefPara"><a name="wp1041059"> </a>
An object reference created with the <code class="cCode">ObjectId</code> generated by the system and the <code class="cCode">rep_id</code> provided by the user. The object reference will need to be converted to a specific object type by invoking the<code class="cCode"> _narrow()</code> operation defined for the specific object. The caller is responsible for releasing the object when the conversion is done.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1025890"> </a>
restart_persistent_systemid
</h3>
<h4 class="pHeading3"><a name="wp1025904"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025905"> </a>
Activates an object, sets the ORB and the POA to the proper state, and returns an object reference to the activated object.
</p>
<h4 class="pHeading3"><a name="wp1025892"> </a>
IDL
</h4>
<a name="wp1018899"> </a><div class="pPreformatted"><pre>Object <code class="cCode">restart_persistent_systemid</code>( <br />                in PortableServer::Servant   servant, <br />                in CORBA::RepositoryId       rep_id,<br />                in string                    stroid) <br />    raises (ServantAlreadyActive, ObjectAlreadyActive);</pre></div><h4 class="pHeading3"><a name="wp1018904"> </a>
C++ Binding
</h4>
<a name="wp1018905"> </a><div class="pPreformatted"><pre>CORBA::Object_ptr<code class="cCode"> restart_persistent_systemid(<br /></code>                PortableServer::Servant   servant,<br />                const char*               rep_id<br />                const char*               stroid);<br /> </pre></div><h4 class="pHeading3"><a name="wp1018919"> </a>
Arguments
</h4>
<h4 class="pDefTerm"><a name="wp1018920"> </a>
<code class="cCode">servant</code>
</h4><div class="pDefPara"><a name="wp1019953"> </a>
An instance of the C++ implementation class for the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018922"> </a>
<code class="cCode">rep_id</code>
</h4><div class="pDefPara"><a name="wp1019956"> </a>
The repository ID of the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018924"> </a>
<code class="cCode">stroid</code>
</h4><div class="pDefPara"><a name="wp1019959"> </a>
The stringified version of the <code class="cCode">ObjectId</code> provided by the user to be set in the object reference being created. It must have been returned from a previous call on <code class="cCode">start_persistent_systemid</code>. 
</div>
<h4 class="pHeading3"><a name="wp1041607"> </a>
Exceptions
</h4>
<h4 class="pDefTerm"><a name="wp1041608"> </a>
<code class="cCode">ServantAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1041609"> </a>
The servant is already being used for a callback. A servant can be used only for a callback with a single <code class="cCode">ObjectId</code>. To receive callbacks on objects containing different <code class="cCode">ObjectId</code>s, you must create different servants and activate them separately. The same servant can be reused only if a <code class="cCode">stop_object</code> operation tells the system to stop using the servant for its original <code class="cCode">ObjectId</code>.
</div>
<h4 class="pDefTerm"><a name="wp1041610"> </a>
<code class="cCode">ObjectAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1041611"> </a>
The stringified <code class="cCode">ObjectId</code> is already being used for a callback. A given <code class="cCode">ObjectId</code> can have only one servant associated with it. If you wish to change to a different servant, you must first invoke <code class="cCode">stop_object</code> with the servant currently in use.
</div>
<h4 class="pDefTerm"><a name="wp1041612"> </a>
<code class="cCode">CORBA::BAD_PARAM</code>
</h4><div class="pDefPara"><a name="wp1041613"> </a>
The repository ID was a NULL string or the servant was a NULL pointer or the <code class="cCode">ObjectId</code> supplied was not previously assigned by the system.
</div>
<h4 class="pDefTerm"><a name="wp1041614"> </a>
<code class="cCode">CORBA::IMP_LIMIT</code>
</h4><div class="pDefPara"><a name="wp1041615"> </a>
In addition to other system reasons for this exception, a reason unique to this situation is that the joint client/server was not initialized with a port number; therefore, a persistent object reference cannot be created.
</div>
<h4 class="pHeading3"><a name="wp1031404"> </a>
Description 
</h4>
<p class="pBody"><a name="wp1031405"> </a>
This operation performs the following actions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1031406"> </a>Activates an object using the <code class="cCode">Servant</code> supplied to service objects of the type <code class="cCode">rep_id</code>, using the supplied <code class="cCode">stroid</code> (a stringified <code class="cCode">ObjectId</code>), which must have been obtained by a previous call on <code class="cCode">start_persistent_systemid</code>. </li>
<li><a name="wp1031407"> </a>Sets the ORB and the POA into the state in which they will accept requests on that object. </li>
<li><a name="wp1033448"> </a>Returns an object reference to the object activated.</li>
<li><a name="wp1031408"> </a>The reactivation would be done using the <code class="cCode">restart_persistent_systemid</code> method.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1041587"> </a>
Return Value
</h4>
<h4 class="pDefTerm"><a name="wp1041588"> </a>
<code class="cCode">CORBA::Object_ptr</code>
</h4><div class="pDefPara"><a name="wp1041589"> </a>
An object reference created with the stringified <code class="cCode">ObjectId</code> <code class="cCode">stroid</code> and the <code class="cCode">rep_id</code> provided by the user. The object reference will need to be converted to a specific object type by invoking the <code class="cCode">_narrow()</code> operation defined for the specific object. The caller is responsible for releasing the object when done.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1018938"> </a>
start_persistent_userid
</h3>
<h4 class="pHeading3"><a name="wp1025954"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025955"> </a>
Activates an object, sets the ORB and the POA to the proper state, and returns an object reference to the activated object.
</p>
<h4 class="pHeading3"><a name="wp1025947"> </a>
IDL
</h4>
<a name="wp1018940"> </a><div class="pPreformatted"><pre>Object <code class="cCode">start_persistent_userid(<br /></code>              portableServer::Servant     a_servant,<br />              in CORBA::RepositoryId      rep_id,<br />              in string                   stroid) <br />    raises ( ServantAlreadyActive, ObjectAlreadyActive );<br /></pre></div><h4 class="pHeading3"><a name="wp1018944"> </a>
C++ Binding
</h4>
<a name="wp1018945"> </a><div class="pPreformatted"><pre><code class="cCode">CORBA::Object_ptr start_persistent_userid (<br />               PortableServer::Servant    servant, <br />               const char*                rep_id,<br />               const char*                stroid); <br /></code></pre></div><h4 class="pHeading3"><a name="wp1018959"> </a>
Arguments
</h4>
<h4 class="pDefTerm"><a name="wp1018960"> </a>
<code class="cCode">servant</code>
</h4><div class="pDefPara"><a name="wp1020183"> </a>
An instance of the C++ implementation class for the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018962"> </a>
<code class="cCode">rep_id</code>
</h4><div class="pDefPara"><a name="wp1020186"> </a>
The repository ID of the interface.
</div>
<h4 class="pDefTerm"><a name="wp1018964"> </a>
<code class="cCode">stroid</code>
</h4><div class="pDefPara"><a name="wp1020189"> </a>
The stringified version of an <code class="cCode">ObjectId</code> provided by the user to be set in the object reference being created. The <code class="cCode">stroid</code> holds application-specific data and is opaque to the ORB.
</div>
<h4 class="pHeading3"><a name="wp1041628"> </a>
Exceptions
</h4>
<h4 class="pDefTerm"><a name="wp1041629"> </a>
<code class="cCode">ServantAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1041630"> </a>
The servant is already being used for a callback. A servant can be used only for a callback with a single <code class="cCode">ObjectId</code>. To receive callbacks on objects containing different <code class="cCode">ObjectId</code>s, you must create different servants and activate them separately. The same servant can be reused only if a <code class="cCode">stop_object</code> operation tells the system to stop using the servant for its original <code class="cCode">ObjectId</code>.
</div>
<h4 class="pDefTerm"><a name="wp1041631"> </a>
<code class="cCode">ObjectAlreadyActive</code>
</h4><div class="pDefPara"><a name="wp1041632"> </a>
The stringified <code class="cCode">ObjectId</code> is already being used for a callback. A given <code class="cCode">ObjectId</code> can have only one servant associated with it. If you wish to change to a different servant, you must first invoke <code class="cCode">stop_object</code> with the servant currently in use.
</div>
<h4 class="pDefTerm"><a name="wp1041633"> </a>
<code class="cCode">CORBA::BAD_PARAM</code>
</h4><div class="pDefPara"><a name="wp1041634"> </a>
The repository ID was a NULL string or the servant was a NULL pointer.
</div>
<h4 class="pDefTerm"><a name="wp1041635"> </a>
<code class="cCode">CORBA::IMP_LIMIT</code>
</h4><div class="pDefPara"><a name="wp1041636"> </a>
In addition to other system reasons for this exception, a reason unique to this situation is that the joint client/server was not initialized with a port number; therefore, a persistent object reference cannot be created.
</div>
<h4 class="pHeading3"><a name="wp1031555"> </a>
Description 
</h4>
<p class="pBody"><a name="wp1031556"> </a>
This operation performs the following actions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1031557"> </a>Activates an object using the <code class="cCode">Servant</code> supplied to service objects of the type <code class="cCode">rep_id</code>, using the object Id <code class="cCode">stroid</code>. </li>
<li><a name="wp1031558"> </a>Sets the ORB and the POA into the state in which they will accept requests on that object. </li>
<li><a name="wp1031559"> </a>Returns an object reference to the activated object. The returned object reference will be valid even after termination of the client. That is, if the client terminates, and restarts again, and then activates a servant with the same <code class="cCode">rep_id</code> and for the same <code class="cCode">ObjectId</code>, the servant will accept requests made on that same object reference.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1041689"> </a>
Return Value
</h4>
<h4 class="pDefTerm"><a name="wp1041690"> </a>
<code class="cCode">CORBA::Object_ptr</code>
</h4><div class="pDefPara"><a name="wp1041691"> </a>
An object reference created with the stringified <code class="cCode">ObjectId</code> <code class="cCode">stroid</code> and the <code class="cCode">rep_id</code> provided by the user. The object reference will need to be converted to a specific object type by invoking the <code class="cCode">_narrow()</code> operation defined for the specific object. The caller is responsible for releasing the object when the conversion is done.
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1018978"> </a>
stop_object
</h3>
<h4 class="pHeading3"><a name="wp1025991"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1025992"> </a>
Tells the ORB to stop accepting requests on the object that is using the given servant.
</p>
<h4 class="pHeading3"><a name="wp1025994"> </a>
IDL
</h4>
<a name="wp1020353"> </a><div class="pPreformatted"><pre>void stop_object( in PortableServer::Servant servant);</pre></div><h4 class="pHeading3"><a name="wp1018981"> </a>
C++ Binding
</h4>
<a name="wp1018982"> </a><div class="pPreformatted"><pre>void <code class="cCode">stop_object</code>(PortableServer::Servant servant);</pre></div><h4 class="pHeading3"><a name="wp1018987"> </a>
Argument
</h4>
<h4 class="pDefTerm"><a name="wp1018988"> </a>
<code class="cCode">servant</code>
</h4><div class="pDefPara"><a name="wp1020392"> </a>
An instance of the C++ implementation class for the interface. The association between this servant and its <code class="cCode">ObjectId</code> will be removed from the Active Object Map.
</div>
<h4 class="pHeading3"><a name="wp1041972"> </a>
Exceptions		       
</h4>
<p class="pBody"><a name="wp1041973"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp1031586"> </a>
Description 
</h4>
<p class="pBody"><a name="wp1031587"> </a>
This operation tells the ORB to stop accepting requests on the given servant. It does not matter what state the servant is in, activated or deactivated; no error is reported.
</p>
<a name="wp1035250"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If you do an invocation on a callback object after you call the <code class="cCode">stop_object</code> operation, the <code class="cCode">OBJECT_NOT_EXIST</code> exception is returned to the caller. This is because the <code class="cCode">stop_object</code> operation, in effect, deletes the object.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1018990"> </a>
Return Value		
</h4>
<p class="pBody"><a name="wp1020331"> </a>
None.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1018992"> </a>
stop_all_objects
</h3>
<h4 class="pHeading3"><a name="wp1026016"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1018993"> </a>
Tells the ORB to stop accepting requests on all servants. 
</p>
<h4 class="pHeading3"><a name="wp1026007"> </a>
IDL
</h4>
<a name="wp1018994"> </a><div class="pPreformatted"><pre><code class="cCode">void stop_all_objects ();</code></pre></div><h4 class="pHeading3"><a name="wp1018995"> </a>
C++ Binding
</h4>
<a name="wp1018996"> </a><div class="pPreformatted"><pre><code class="cCode">void stop_all_objects ();</code></pre></div><h4 class="pHeading3"><a name="wp1041983"> </a>
Exceptions
</h4>
<p class="pBody"><a name="wp1041984"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp1018999"> </a>
Description
</h4>
<p class="pBody"><a name="wp1019000"> </a>
This operation tells the ORB to stop accepting requests on all servants that have been set up in this process. 
</p>
<h4 class="pHeading3"><a name="wp1031901"> </a>
Usage Note
</h4>
<p class="pBody"><a name="wp1031902"> </a>
If a client calls the <code class="cCode">ORB::shutdown </code>method, then it must not subsequently call <code class="cCode">stop_all_objects</code>.
</p>
<h4 class="pHeading3"><a name="wp1041995"> </a>
Return Value	
</h4>
<p class="pBody"><a name="wp1041996"> </a>
None.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1019004"> </a>
get_string_oid
</h3>
<h4 class="pHeading3"><a name="wp1026027"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1026040"> </a>
Requests the string version of the <code class="cCode">ObjectId</code> of the current request.
</p>
<h4 class="pHeading3"><a name="wp1026025"> </a>
IDL
</h4>
<a name="wp1019006"> </a><div class="pPreformatted"><pre><code class="cCode">string get_string_oid() raises (NotInRequest);</code> </pre></div><h4 class="pHeading3"><a name="wp1019007"> </a>
C++ Binding
</h4>
<a name="wp1019008"> </a><div class="pPreformatted"><pre><code class="cCode">char* get_string_oid(); </code></pre></div><h4 class="pHeading3"><a name="wp1042020"> </a>
JExceptions
</h4>
<h4 class="pDefTerm"><a name="wp1042021"> </a>
<code class="cCode">NotInRequest</code>
</h4><div class="pDefPara"><a name="wp1042022"> </a>
The function was called when the ORB was not in the context of a request (that is, not while the ORB was servicing a request in method code). Do not call this function from client code. It is legal only during the execution of a method of the callback object (that is, the servant). 
</div>
<h4 class="pHeading3"><a name="wp1031617"> </a>
Description 
</h4>
<p class="pBody"><a name="wp1031618"> </a>
This operation returns the string version of the <code class="cCode">ObjectId</code> of the current request. 
</p>
<h4 class="pHeading3"><a name="wp1042008"> </a>
Return Value	 
</h4>
<h4 class="pDefTerm"><a name="wp1042009"> </a>
<code class="cCode">char*</code>
</h4><div class="pDefPara"><a name="wp1042010"> </a>
The string version of the <code class="cCode">ObjectId</code> of the current request. This is the string that was supplied when the object reference was created. The string is meaningful to users only in the case when the object reference was created by the start_persistent_userid function. (That is, the <code class="cCode">ObjectId</code> created by start_transient and start_persistent_systemid were created by the ORB and has no relationship to the user application.)
</div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1032550"> </a>
~Callbacks
</h3>
<h4 class="pHeading3"><a name="wp1032551"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1032552"> </a>
Destroys the callback object.
</p>
<h4 class="pHeading3"><a name="wp1032553"> </a>
C++ Binding
</h4>
<a name="wp1032554"> </a><div class="pPreformatted"><pre><code class="cCode">BEAWrapper::~Callbacks( );</code></pre></div><h4 class="pHeading3"><a name="wp1032557"> </a>
JArguments
</h4>
<p class="pBody"><a name="wp1032558"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp1042036"> </a>
Exceptions
</h4>
<p class="pBody"><a name="wp1042037"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp1032561"> </a>
Description
</h4>
<p class="pBody"><a name="wp1032562"> </a>
This destructor destroys the callback object. 
</p>
<h4 class="pHeading3"><a name="wp1032563"> </a>
Usage Note
</h4>
<p class="pBody"><a name="wp1032564"> </a>
If a client wants to get rid of the wrapper, but not shut down the ORB, then the client must call the <code class="cCode">stop_all_objects</code> method.
</p>
<h4 class="pHeading3"><a name="wp1042052"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1042053"> </a>
None.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="wrapper.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="intfc_re.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="command.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
