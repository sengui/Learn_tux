<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/rli/fm/pqint.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:36:18" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>InterceptorData Sample Interceptors</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Using CORBA Request-Level Interceptors
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="isec.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="api.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/rli.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1026349"> </a>
InterceptorData Sample Interceptors
</h1>
<p class="pBody"><a name="wp1024704"> </a>
This chapter describes the following two sample interceptors that are designed to be used with the PersonQuery sample application:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1024705"> </a><a href="pqint.html#wp1024709">InterceptorDataClient Interceptor</a>, which is installed on the machine hosting the PersonQuery client component.</li>
<li><a name="wp1024706"> </a><a href="pqint.html#wp1024723">InterceptorDataTarget Interceptor</a>, which is installed on the machine hosting the PersonQuery server component.</li>
</ul></div>
<p class="pBody"><a name="wp1024707"> </a>
This chapter explains how each interceptor works, then shows how to build and run them with the PersonQuery sample application.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024709"> </a>
InterceptorDataClient Interceptor
</h2><p class="pBody"><a name="wp1024710"> </a>
The InterceptorDataClient interceptor intercepts and logs each client application request and reply parameters. This interceptor also allows certain operations on the PersonQuery server application to be invoked by users of the client application who meet specific criteria. The InterceptorDataClient interceptor implements the <code class="cCode">InterceptorDataClient</code> interface, which inherits from the <code class="cCode">ClientRequestInterceptor</code> class.
</p>
<p class="pBody"><a name="wp1024711"> </a>
The InterceptorDataClient class implements the methods as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1024712"> </a><code class="cCode">id()</code></li>
<p class="pBodyRelative"><a name="wp1024713"> </a>
This method returns the string <code class="cCode">InterceptorDataClient</code>.
</p>
<li><a name="wp1024714"> </a><code class="cCode">shutdown()</code></li>
<p class="pBodyRelative"><a name="wp1024715"> </a>
This method removes the request from the <code class="cCode">tracker</code> object.
</p>
<li><a name="wp1024716"> </a><code class="cCode">exception_occurred()</code></li>
<p class="pBodyRelative"><a name="wp1024717"> </a>
When invoked by the ORB, this method removes the request from the <code class="cCode">tracker</code> object.
</p>
<li><a name="wp1024718"> </a><code class="cCode">client_invoke()</code></li>
<p class="pBodyRelative"><a name="wp1024719"> </a>
This method determines if the interface and operation are &#8220;of interest.&#8221; If the client request is &#8220;of interest,&#8221; this method parses the request parameters and outputs the parameters to the log file. If the client request is not &#8220;of interest,&#8221; this method simply returns.
</p>
<li><a name="wp1024720"> </a><code class="cCode">client_response()</code></li>
<p class="pBodyRelative"><a name="wp1024721"> </a>
This method determines if the interface and operation in the request are &#8220;of interest.&#8221; If the interface and operation are &#8220;of interest,&#8221; this method walks through the CORBA <code class="cCode">DataInputStream</code> parameter to obtain the reply parameters and write them to the log file. If the interface and operation in the request are not &#8220;of interest,&#8221; this method simply returns. 
</p>
</ul></div>
<p class="pBody"><a name="wp1024722"> </a>
In addition, the data interceptor provides the <code class="cCode">InterceptorDataClientInit</code> method to initialize the client interceptor class.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024723"> </a>
InterceptorDataTarget Interceptor
</h2><p class="pBody"><a name="wp1024724"> </a>
The InterceptorDataTarget interceptor intercepts and logs request and reply data parameters. This interceptor also removes sensitive data from specific reply parameters by masking the data with <code class="cCode">x</code> characters. The InterceptorDataTarget interceptor implements the <code class="cCode">InterceptorDataTarget</code> interface, which inherits from the <code class="cCode">TargetRequestInterceptor</code> class.
</p>
<p class="pBody"><a name="wp1024725"> </a>
The <code class="cCode">InterceptorDataTarget</code> class implements the methods as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1024726"> </a><code class="cCode">id()</code></li>
<p class="pBodyRelative"><a name="wp1024727"> </a>
This method returns the string <code class="cCode">InterceptorDataTarget</code>.
</p>
<li><a name="wp1024728"> </a><code class="cCode">shutdown()</code></li>
<p class="pBodyRelative"><a name="wp1024729"> </a>
This method simply returns.
</p>
<li><a name="wp1024730"> </a><code class="cCode">exception_occurred()</code></li>
<p class="pBodyRelative"><a name="wp1024731"> </a>
This method removes the request from the <code class="cCode">tracker</code> object.
</p>
<li><a name="wp1024732"> </a><code class="cCode">target_invoke()</code></li>
<p class="pBodyRelative"><a name="wp1024733"> </a>
This method determines if the interface and operation are &#8220;of interest.&#8221; If so, this method parses the request parameters and outputs that data to the log file. If the interface and operation in the request are not &#8220;of interest,&#8221; this method simply returns. If the operation in the request is <code class="cCode">exit</code>, this method returns the status value <code class="cCode">INVOKE_NO_EXCEPTION</code>. 
</p>
<li><a name="wp1024734"> </a><code class="cCode">target_response()</code></li>
<p class="pBodyRelative"><a name="wp1024735"> </a>
This method determines if the interface and operation are &#8220;of interest.&#8221; If so, this method walks through the <code class="cCode">DataInputStream</code> parameter to obtain the response parameters and output to the log file. Sensitive data items are substituted in the log. For example, a person&#8217;s social security number will not be output to the log. If the interface and operation in the request are not &#8220;of interest,&#8221; this method simply returns.
</p>
</ul></div>
<p class="pBody"><a name="wp1024736"> </a>
In addition, the data interceptor provides the <code class="cCode">InterceptorDataTargetInit</code> method to initialize the target interceptor class.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024737"> </a>
Implementing the InterceptorData Interceptors
</h2><p class="pBody"><a name="wp1024738"> </a>
Information about the code used to implement the InterceptorData interceptors is provided in <a href="cppdevproc.html">Developing CORBA Request-Level Interceptors.</a> Refer to that chapter for information about how to do the following:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1025476"> </a><a href="cppdevproc.html#wp1022719"><span class="cHyperlink">
Starting the Implementation File on page&#160;2-3</span></a>.</li>
<li><a name="wp1025477"> </a><a href="cppdevproc.html#wp1022741"><span class="cHyperlink">
Initializing the Interceptor at Run Time on page&#160;2-3</span></a>.</li>
<li><a name="wp1025487"> </a><a href="cppdevproc.html#wp1022753"><span class="cHyperlink">
Obtaining the Interface Name from a Request on page&#160;2-4</span></a>.</li>
<li><a name="wp1025506"> </a><a href="cppdevproc.html#wp1022758"><span class="cHyperlink">
Identifying Operations in the Request on page&#160;2-5</span></a>.</li>
<li><a name="wp1025516"> </a><a href="cppdevproc.html#wp1022763"><span class="cHyperlink">
Implementing the Interceptor&#8217;s Response Operation on page&#160;2-5</span></a>.</li>
<li><a name="wp1025526"> </a><a href="cppdevproc.html#wp1022771"><span class="cHyperlink">
Reading Parameters Out of a Data Input Stream on page&#160;2-6</span></a>.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024811"> </a>
Registering and Running the InterceptorData Interceptors
</h2><p class="pBody"><a name="wp1024812"> </a>
When you run the makefile that builds the PersonQuery sample application in <a href="pquery.html">PersonQuery Sample Application,</a> the entire set of sample interceptors are built as well, including the InterceptorData interceptors. This section describes how to register the InterceptorData interceptor so that it works with PersonQuery application at run time.
</p>
<p class="pBody"><a name="wp1024818"> </a>
To register and run the InterceptorData client and server interceptors:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1024819"> </a>Change directory to the InterceptorData sample directory, where <code class="cCodeEmphasis">workdirectory</code> represents the name of the directory into which you copied the interceptor sample applications in <a href="pquery.html">Chapter&#160;, &quot;PersonQuery Sample Application:&quot;</a></li>
<p class="pBodyRelative"><a name="wp1024823"> </a>
<b class="cBold">Windows 2003</b>
</p>
<a name="wp1024824"> </a><div class="pPreformattedRelative"><pre>&gt; cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;\cxx\data_cxx</pre></div><p class="pBodyRelative"><a name="wp1024825"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1024826"> </a><div class="pPreformattedRelative"><pre>$ cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;/cxx/data_cxx</pre></div><li><a name="wp1024827"> </a>Register the interceptor:</li>
<p class="pBodyRelative"><a name="wp1024828"> </a>
<b class="cBold">Windows 2003</b>
</p>
<a name="wp1024829"> </a><div class="pPreformattedRelative"><pre>&gt; nmake -f makefile.nt config</pre></div><p class="pBodyRelative"><a name="wp1024830"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1024831"> </a><div class="pPreformattedRelative"><pre>$ make -f makefile.mk config</pre></div><li><a name="wp1024832"> </a>Boot the CORBA server and run the CORBA client:</li>
<p class="pBodyRelative"><a name="wp1024833"> </a>
<b class="cBold">Windows 2003</b>
</p>
<a name="wp1024834"> </a><div class="pPreformattedRelative"><pre>&gt; cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;\cxx\app_cxx<br />&gt; tmboot -y<br />&gt; PersonQueryClient</pre></div><p class="pBodyRelative"><a name="wp1024835"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1024836"> </a><div class="pPreformattedRelative"><pre>&gt; cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;/cxx/app_cxx<br />&gt; tmboot -y<br />&gt; PersonQueryClient</pre></div><li><a name="wp1024837"> </a>Perform any number of invocations using the PersonQuery client application, using the command syntax described in <a href="pquery.html">PersonQuery Sample Application.</a></li>
<li><a name="wp1024841"> </a>Stop the PersonQuery application:</li>
<a name="wp1024842"> </a><div class="pPreformattedRelative"><pre>&gt; tmshutdown -y</pre></div></ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024869"> </a>
Examining the Interceptor Output
</h2><p class="pBody"><a name="wp1024872"> </a>
The InterceptorData client and target interceptors log each invocation.  For each PersonQuery application session, the client interceptor creates a log file named <code class="cCode">InterceptorDataClient</code><code class="cCodeEmphasis">xxx</code><code class="cCode">.out</code>, and the target interceptor creates a log file named <code class="cCode">InterceptorDataTarget</code><code class="cCodeEmphasis">xxx</code><code class="cCode">.out</code>.  This section shows sample log file data for each interceptor.
</p>
<p class="pBody"><a name="wp1024873"> </a>
<b class="cBold">Sample Client Interceptor Log Output</b>
</p>
<a name="wp1024874"> </a><div class="pPreformatted"><pre>InterceptorDataClientInit called<br />ClientInterceptorData::id called<br /><br />ClientInterceptorData::client_invoke called<br />ClientInterceptorData::client_response called<br />   Request Id:     1<br />   unable to find request for this reply (must not be one we care about)<br /><br />ClientInterceptorData::client_invoke called<br />   Request Id:     2<br />   Interface:      IDL:beasys.com/PersonQuery:1.0<br />   Operation:      findPerson<br />   Parameters:<br />                            name:           ALISTER LANCASHIRE<br />                            address:        3 PENNY LANE<br />                                            LONDON GB UK<br />                            ss:             999-99-9999<br />                            sex:            can&#39;t tell<br />                            age(yrs.):      85<br />                            marital status: single<br />                            hobby:          stamp collecting<br />                            date-of-birth:  11/25/1913<br />                            height(in.):    32<br />                            weight(lbs.):   57<br />                            hair color:     unknown<br />                            eye color:      blue<br />                            skin color:     white<br />                            other markings: missing limb</pre></div><p class="pBody"><a name="wp1024875"> </a>
<b class="cBold">Sample Target Interceptor Log Output</b>
</p>
<a name="wp1024876"> </a><div class="pPreformatted"><pre>InterceptorDataTargetInit called<br />TargetInterceptorData::id called<br /><br />TargetInterceptorData::target_response called<br />   Request Id:     2<br />   ReplyStatus:    GIOP::NO_EXCEPTION<br />   Interface:      IDL:beasys.com/PersonQuery:1.0<br />   Operation:      findPerson<br />   Method Result:  TRUE<br />   Parameters:<br />                   Maximum: 8<br />                   Length:  8<br /><br />                   Item 0<br />                            name:           ALISTER LANCASHIRE<br />                            address:        3 PENNY LANE<br />                                            LONDON GB UK<br />                            ss:             NO PRIVILEDGE<br />                            sex:            NO PRIVILEDGE<br />                            age (years):    NO PRIVILEDGE<br />                            marital status: NO PRIVILEDGE<br />                            hobby:          stamp collecting<br />                            date-of-birth:  NO PRIVILEDGE<br />                            height (in.):   32<br />                            weight (lbs.):  57<br />                            hair color:     unknown<br />                            eye color:      blue</pre></div><a name="wp1024877"> </a><div class="pPreformatted"><pre>                            skin color:     NO PRIVILEDGE<br />                            other markings: missing limb</pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1024882"> </a>
Unregistering the Interceptors
</h2><p class="pBody"><a name="wp1024883"> </a>
After you have run the PersonQuery sample application with the InterceptorData sample interceptors, you can unregister those interceptors using the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1024884"> </a>Shut down all running CORBA  applications by entering the following command:</li>
<a name="wp1024885"> </a><div class="pPreformattedRelative"><pre>&gt; tmshutdown -y</pre></div><li><a name="wp1024889"> </a>Change directory to the InterceptorData sample directory, where <code class="cCodeEmphasis">workdirectory</code> represents the name of the directory into which you copied the interceptor sample applications in <a href="pquery.html">Chapter&#160;, &quot;PersonQuery Sample Application:&quot;</a></li>
<p class="pBodyRelative"><a name="wp1024893"> </a>
<b class="cBold">Windows 2003</b>
</p>
<a name="wp1024894"> </a><div class="pPreformattedRelative"><pre>&gt; cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;\cxx\data_cxx</pre></div><p class="pBodyRelative"><a name="wp1024895"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1024896"> </a><div class="pPreformattedRelative"><pre>$ cd &lt;<code class="cCodeEmphasis">workdirectory</code>&gt;/cxx/data_cxx</pre></div><li><a name="wp1024897"> </a>Unregister the interceptors:</li>
<p class="pBodyRelative"><a name="wp1024898"> </a>
<b class="cBold">Windows 2003</b>
</p>
<a name="wp1024899"> </a><div class="pPreformattedRelative"><pre>&gt; nmake -f makefile.nt unconfig</pre></div><p class="pBodyRelative"><a name="wp1024900"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1024901"> </a><div class="pPreformattedRelative"><pre>$ make -f makefile.mk unconfig</pre></div></ol></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="pqint.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="isec.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="api.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
