<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="2" />
<meta name="LOC_US_CHANGE" content="41845" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux12c/mq/fm/run.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="06/26/12 11:27:28" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Running the Tuxedo MQ Adapter</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">MQ Adapter
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="config.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/mq.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1075307"> </a>
Running the Tuxedo MQ Adapter
</h1>
<p class="pBody"><a name="wp1076323"> </a>
This chapter contains the following topics:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1076011"> </a><a href="run.html#wp1075327">Booting the Servers</a></li>
<li><a name="wp1076031"> </a><a href="run.html#wp1075342">Initiating a TUXEDO-to-WebSphere MQ Request</a>t</li>
<li><a name="wp1076032"> </a><a href="run.html#wp1075351">Initiating a WebSphere MQ-to-TUXEDO Request</a></li>
<li><a name="wp1076033"> </a><a href="run.html#wp1075416">Sending and Receiving Queued Messages to and from WebSphere MQ</a></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1075327"> </a>
Booting the Servers
</h2><p class="pBody"><a name="wp1075336"> </a>
The MQ Adapter servers boot as part of the TUXEDO application using standard TUXEDO utilities, such as <code class="cCode">tmboot</code>. The MQ Adapter reads the server configuration files and attempts to connect to the specified queue manager. Once the MQ Adapter establishes a connection with the queue manager, the Tuxedo to WebSphere MQ server (TM_MQO) advertises the services associated with that queue manager.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1075342"> </a>
Initiating a TUXEDO-to-WebSphere MQ Request
</h2><p class="pBody"><a name="wp1075354"> </a>
TUXEDO clients can call services advertised by the Tuxedo to MQ server (TM_MQO). A TUXEDO-to-WebSphere MQ request consists of the following actions.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1075355"> </a>The TUXEDO client initiates a request for a service advertised by TM_MQO.</li>
<li><a name="wp1075356"> </a>The MQ Adapter uses the WebSphere MQ Message Queue Interface (MQI) to forward these requests to the appropriate WebSphere MQ queue.</li>
<li><a name="wp1075357"> </a>The MQ Adapter retrieves response data (if any) from the designated reply queue and returns this data to the TUXEDO client.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1075351"> </a>
Initiating a WebSphere MQ-to-TUXEDO Request
</h2><p class="pBody"><a name="wp1075386"> </a>
WebSphere MQ applications can request TUXEDO services via the WebSphere MQ to Tuxedo server TM_MQI. An WebSphere MQ-to-TUXEDO request consists of the following actions.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1075387"> </a>The WebSphere MQ application queues a message requesting the service to a designated queue.</li>
<li><a name="wp1075388"> </a>The MQ Adapter retrieves the message from the incoming queue.</li>
<li><a name="wp1075389"> </a>The MQ Adapter forwards the message data to the appropriate service.</li>
<li><a name="wp1075390"> </a>The MQ Adapter places response data (if any) on the specified reply queue.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1075416"> </a>
Sending and Receiving Queued Messages to and from WebSphere MQ
</h2><p class="pBody"><a name="wp1075425"> </a>
The TMQUEUE_MQM server processes <code class="cCode">tpenqueue</code> and <code class="cCode">tpdequeue</code> requests from TUXEDO client and server processes.
</p>
<h3 class="pHeading2"><a name="wp1075431"> </a>
Processing a tpenqueue Request
</h3>
<p class="pBody"><a name="wp1075439"> </a>
The syntax for a <code class="cCode">tpenqueue</code> request is as follows:
</p>
<a name="wp1075444"> </a><div class="pPreformatted"><pre>tpenqueue (qspace, qname, qctl, data, len, flags)</pre></div><p class="pBody"><a name="wp1075452"> </a>
A <code class="cCode">tpenqueue</code> request requires all parameters shown previously. Following are brief descriptions of these parameters. For more information, refer to the Oracle TUXEDO Programmer&#39;s Guide.
</p>
<h4 class="pDefTerm"><a name="wp1075462"> </a>
<code class="cCode">QSPACE</code>
</h4><div class="pDefPara"><a name="wp1075463"> </a>
The name of the service advertised by TMQUEUE_MQM. This value can be overwritten in the TUXEDO UBBCONFIG file using the - s option. For example:
</div>
<div class="pDefParaCont"><a name="wp1075464"> </a>
<code class="cCode">-s myname :MQMQUEUE</code>
<a name="wp1075465"> </a>
Default is MQMQUEUE.
</div>
<h4 class="pDefTerm"><a name="wp1075466"> </a>
<code class="cCode">QNAME</code>
</h4><div class="pDefPara"><a name="wp1075467"> </a>
The name of the queue where you want the adapter to place or retrieve messages. Can contain up to 127 characters. Corresponds to a WebSphere MQ queue mapped from the TUXNAME parameter in the QUEUE section of the TMQUEUE_MQM configuration file.
</div>
<h4 class="pDefTerm"><a name="wp1075468"> </a>
<code class="cCode">QCTL</code>
</h4><div class="pDefPara"><a name="wp1075469"> </a>
Provides additional information about the message. The supported options you can define for <code class="cCode">tpenqueue</code> requests are as follows:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075472"> </a>
<code class="cCode">TPNOFLAGS</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075473"> </a>
No options apply to this message
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075474"> </a>
<code class="cCode">TPQPRIORITY</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075475"> </a>
Message priority. TUXEDO values for this field can be from 1-100. The MQ values can be 0-9 and are mapped to TUXEDO values as follows: 0=TUXEDO 1-10, 1=TUXEDO 11-20, etc.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075476"> </a>
<code class="cCode">TPQCORRID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075477"> </a>
Correlation ID. Identifies the response to a request. TUXEDO supports up to 32 bytes. The MQ Adapter supports up to 24 bytes, so TUXEDO values are truncated on <code class="cCode">tpenqueue</code> requests.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075478"> </a>
<code class="cCode">TPQREPLYQ</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075479"> </a>
Name of the queue where you want to place reply messages. Can contain up to 127 characters.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075480"> </a>
<code class="cCode">TPQMSGID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075481"> </a>
Return the message ID generated when the message is placed on the queue. TUXEDO supports up to 32 bytes. The MQ Adapter supports up to 24 bytes and pads the ID with nulls.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075493"> </a>
<code class="cCode">TPQDELIVERYQOS</code>
</h4></div>
<div class="pDefPara2"><a name="wp1076518"> </a>
Specifies the delivery quality of service. If a value of TPQQOSPERSISTENT is specified, the MQ persistence is set to MQPER_PERSISTENT. If a value of TPQQOSNONPERSISTENT is specified, the MQ persistence is set to MQPER_NOT_PERSISTENT.  If a value of TPQQOSDEFAULTPERSIST is specified or if TPQDELIVERYQOS is not specified, then MQ persistence is set to MQPER_PERSISTENT if the request was made in a transaction and is set to MQPER_PERSISTENCE_AS_Q_DEF otherwise. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1076519"> </a>
<code class="cCode">		TPQEXPTIME_NONE</code>
</h4></div>
<div class="pDefPara2"><a name="wp1076520"> </a>
Specifies that the queued message should not expire.  This corresponds to a value of  MQEI_UNLIMITED in the MQMD structure passed to WebSphere MQ.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075499"> </a>
<code class="cCode">			TPQEXPTIME_ABS</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075500"> </a>
Specifies an absolute expiration time for the queued message.  This value is converted to a format understood by WebSphere MQ and passed to MQ via the Expiry field of the WebSphere MQ MQMD structure.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075501"> </a>
<code class="cCode">TPQEXPTIME_REL</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075502"> </a>
Specifies a relative expiration time for the queued message.  This value is converted to a format understood by WebSphere MQ and passed to MQ via the Expiry field of the WebSphere MQ MQMD structure.
</div><a name="wp1075460"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The TPQFAILUREQ, TPQBEFOREMSGID, TPQTOP, TPQTIME_REL, TPQTIME_ABS, and TPQREPLYQOS options are not supported for <code class="cCode">tpenqueue</code> requests to TMQUEUE_MQM</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp1076145"> </a>
<code class="cCode">DATA</code>
</h4><div class="pDefPara"><a name="wp1076147"> </a>
Data to be placed on the queue
</div>
<h4 class="pDefTerm"><a name="wp1076149"> </a>
<code class="cCode">LEN</code>
</h4><div class="pDefPara"><a name="wp1076151"> </a>
Length of the data to be placed on the queue
</div>
<h4 class="pDefTerm"><a name="wp1076153"> </a>
<code class="cCode">FLAGS</code>
</h4><div class="pDefPara"><a name="wp1076155"> </a>
Defines the flag settings for the message. The supported flags for <code class="cCode">tpenqueue</code> requests are as follows:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1076156"> </a>
<code class="cCode">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1076157"> </a>
Messages from callers that are in transaction mode are not queued within the same transaction as the caller.
</div><h3 class="pHeading2"><a name="wp1075521"> </a>
Processing a tpdequeue Request
</h3>
<p class="pBody"><a name="wp1075652"> </a>
The syntax for a <code class="cCode">tpdequeue</code> request is as follows:
</p>
<a name="wp1075657"> </a><div class="pPreformatted"><pre>tpdequeue (qspace, qname, qctl, data, len, flags)</pre></div><p class="pBody"><a name="wp1075670"> </a>
A <code class="cCode">tpdequeue</code> request requires all parameters shown previously. Following are brief descriptions of these parameters. For more information, refer to the Oracle TUXEDO Programmer&#39;s Guide.
</p>
<h4 class="pDefTerm"><a name="wp1075671"> </a>
<code class="cCode">QSPACE</code>
</h4><div class="pDefPara"><a name="wp1075672"> </a>
The name of the service advertised by TMQUEUE_MQM. This value can be overwritten in the TUXEDO UBBCONFIG file using the - s option. For example:
</div>
<div class="pDefParaCont"><a name="wp1075673"> </a>
<code class="cCode">-s myname :MQMQUEUE</code>
<a name="wp1075674"> </a>
The default value is MQMQUEUE
</div>
<h4 class="pDefTerm"><a name="wp1075675"> </a>
<code class="cCode">QNAME</code>
</h4><div class="pDefPara"><a name="wp1075676"> </a>
The name of the queue where you want the adapter to place or retrieve messages. Can contain up to 127 characters. Corresponds to a WebSphere MQ queue mapped from the TUXNAME parameter in the QUEUE section of the TMQUEUE_MQM configuration file.
</div>
<h4 class="pDefTerm"><a name="wp1075677"> </a>
<code class="cCode">QCTL</code>
</h4><div class="pDefPara"><a name="wp1075678"> </a>
Provides additional information about the message. The supported options you can define for <code class="cCode">tpdequeue</code> requests are as follows:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075679"> </a>
<code class="cCode">TPNOFLAGS</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075680"> </a>
No options apply to this message
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075681"> </a>
<code class="cCode">TPQGETBYMSGID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075682"> </a>
Dequeues the message with the specified message ID, if available.  The specified message ID is truncated to 24 bytes and passed in the <code class="cCode">MsgId</code> field of the MQMD structure when calling the WebSphere MQ MQGET API.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075683"> </a>
<code class="cCode">TPQGETBYCORRID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075684"> </a>
Dequeues the message with the specified correlation ID.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075686"> </a>
<code class="cCode">TPQPRIORITY</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075687"> </a>
Message priority. TUXEDO values for this field can be from 1-100. The MQ values can be 0-9 and are mapped to TUXEDO values as follows: 0=TUXEDO 1-10, 1=TUXEDO 11-20, etc.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075688"> </a>
<code class="cCode">TPQCORRID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075689"> </a>
Correlation ID. Identifies the response to a request. TUXEDO supports up to 32 bytes. MQ supports up to 24 bytes, so this ID will always fit in 32 bytes supported by Tuxedo.  The remaining 8 bytes are set to null characters.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075690"> </a>
<code class="cCode">TPQREPLYQ</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075691"> </a>
Name of the queue where you want to place reply messages. Can contain up to 127 characters.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075692"> </a>
<code class="cCode">TPQMSGID</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075693"> </a>
Return the message ID generated when the message is placed on the queue. MQ supports up to 24 bytes, so this ID will always fit in 32 bytes supported by Tuxedo.  The remaining 8 bytes are set to null characters.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075694"> </a>
<code class="cCode">TPQPEEK</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075695"> </a>
If this flag is set, the specified message is read but is not removed from the queue. This flag implies the TPNOTRAN flag has been set for the <code class="cCode">tpdequeue() </code>operation. That is, non-destructive dequeuing is non-transactional. Note that it is not possible to read messages enqueued or dequeued within a transaction before the transaction completes.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1075697"> </a>
<code class="cCode">TPQDELIVERYQOS</code>
</h4></div>
<div class="pDefPara2"><a name="wp1075698"> </a>
If this flag is set, the call to<code class="cCode"> tpdequeue() </code>is successful, and the message was queued with a delivery quality of service, then the flag is stored in <code class="cCode">ctl-&gt;delivery_qo</code>s.  If the MQGET call indicates a Persistence of MQPER_NOT_PERSISTENT, ctl-&gt;delivery_qos is set to TPQQOSNONPERSISTENT.  Otherwise, it is set to TPQQOSPERSISTENT.
</div><a name="wp1075700"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The TPQWAIT option is not supported for <code class="cCode">tpdequeue</code> requests to TMQUEUE_MQM</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp1076279"> </a>
<code class="cCode">DATA</code>
</h4><div class="pDefPara"><a name="wp1076281"> </a>
Data to be placed on the queue
</div>
<h4 class="pDefTerm"><a name="wp1076283"> </a>
<code class="cCode">LEN</code>
</h4><div class="pDefPara"><a name="wp1076285"> </a>
Length of the data to be placed on the queue
</div>
<h4 class="pDefTerm"><a name="wp1076287"> </a>
<code class="cCode">FLAGS</code>
</h4><div class="pDefPara"><a name="wp1076289"> </a>
Defines the flag settings for the message. The supported flags for <code class="cCode">tpde</code>queue requests are as follows:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1076290"> </a>
<code class="cCode">TPNOTRAN</code>
</h4></div>
<div class="pDefPara2"><a name="wp1076291"> </a>
Messages from callers that are in transaction mode are not dequeued within the same transaction as the caller.
</div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="run.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="config.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq9" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
