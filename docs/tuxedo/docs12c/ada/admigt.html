<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="3" />
<meta name="LOC_US_CHANGE" content="41998" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux12c/ada/fm/admigt.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="06/28/12 11:40:34" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Migrating Your Application</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Administering an Oracle Tuxedo Application at Run Time
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="adsevt.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="adtun.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/ada.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1030338"> </a>
Migrating Your Application
</h1>
<p class="pBody"><a name="wp1029367"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1015711"> </a><a href="admigt.html#wp1025248">What Is Migration?</a></li>
<li><a name="wp1024943"> </a><a href="admigt.html#wp1022219">Migration Options</a></li>
<li><a name="wp1025140"> </a><a href="admigt.html#wp1015729">How to Switch the Master and Backup Machines</a></li>
<li><a name="wp1025185"> </a><a href="admigt.html#wp1015782">How to Migrate Server Groups</a></li>
<li><a name="wp1025190"> </a><a href="admigt.html#wp1015840">How to Migrate Server Groups from One Machine to Another</a></li>
<li><a name="wp1030917"> </a><a href="admigt.html#wp1030956">Automatic Migration</a></li>
<li><a name="wp1025194"> </a><a href="admigt.html#wp1030941">How to Cancel a Migration</a></li>
<li><a name="wp1025211"> </a><a href="admigt.html#wp1017862">How to Migrate Transaction Logs to a Backup Machine</a></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1025248"> </a>
What Is Migration?
</h2><p class="pBody"><a name="wp1021495"> </a>
Under normal circumstances, an administrator performs daily administrative tasks on the configured <code class="cCode">MASTER</code> machine. The DBBL on the <code class="cCode">MASTER</code> machine monitors other machines in a configuration, handles configuration updates, and broadcasts dynamic changes to the <code class="cCode">TMIB</code>. If the <code class="cCode">MASTER</code> machine fails, for example, due to a machine crash, database corruptions, Oracle Tuxedo system problems, network partitioning, or application faults, the application does not stop running. Clients can still join the application, servers can still service requests, and naming is still available on each local machine. However, until the <code class="cCode">MASTER</code> machine is restored, servers cannot be activated or deactivated, and an administrator cannot dynamically reconfigure the system.
</p>
<p class="pBody"><a name="wp1024725"> </a>
Similarly, application servers are configured to run on specific machines to service client requests. However, if a machine fails or must be brought down to be serviced, the servers on that machine become unavailable. In each case, you can migrate the servers to a configured <code class="cCode">BACKUP</code> or alternate machine.
</p>
<p class="pBody"><a name="wp1023205"> </a>
An administrator who performs a migration in preparation for shutting down a machine for service or upgrading, does not face the problems inherent in a machine failure. Therefore an administrator in this situation has a relatively high degree of control over migration activities.
</p>
<h3 class="pHeading2"><a name="wp1021767"> </a>
Performing a Master Migration
</h3>
<p class="pBody"><a name="wp1022634"> </a>
A master migration is the process of moving the DBBL from the configured <code class="cCode">MASTER</code> machine to the configured <code class="cCode">BACKUP</code> machine so that servers can continue to be serviced while the configured <code class="cCode">MASTER</code> machine is down. To start a migration, an administrator requests that the configured <code class="cCode">BACKUP</code> assume the role of acting <code class="cCode">MASTER</code>, and the configured <code class="cCode">MASTER</code>, the role of acting <code class="cCode">BACKUP</code>. The acting <code class="cCode">MASTER</code> then performs all administrative functions: it begins monitoring other machines in the configuration and accepts any dynamic reconfiguration changes.
</p>
<p class="pBody"><a name="wp1022796"> </a>
In<a href="admigt.html#wp1030806">Figure&#160;7-1</a>, Machine 2, the configured <code class="cCode">BACKUP</code> machine, assumes the role of <code class="cCode">MASTER</code>, while Machine 1, the configured <code class="cCode">MASTER</code>, assumes the role of acting <code class="cCode">BACKUP</code>. When the configured <code class="cCode">MASTER</code> is available again, it can be reactivated from the acting <code class="cCode">MASTER</code> (that is, the configured <code class="cCode">BACKUP</code>). The configured <code class="cCode">MASTER</code> then regains control as acting <code class="cCode">MASTER</code>.
</p>
<div class="pFigureTitle"><a name="wp1030806"> </a>
Figure&#160;7-1  Perfoming a Master Migration
</div>

 
 <p class="pGraphic"><a name="wp1022759"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/migrate.gif" alt="Perfoming a Master Migration" id="wp1022997"/></div><p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1022760"> </a>
Migrating a Server Group
</h3>
<p class="pBody"><a name="wp1022679"> </a>
For each group of servers, an administrator specifies a primary machine and an alternate machine. The process of migrating a server group involves activating the server group on the alternate machine.
</p>
<p class="pBody"><a name="wp1023063"> </a>
In <a href="admigt.html#wp1030837">Figure&#160;7-2</a>, GroupA is assigned to Machine 1 (that is, Machine 1 is configured as the primary machine); Machine 2 is configured as the alternate machine for GroupA. After migration, GroupA is activated on Machine 2, which means that all servers in this group and the services associated with them, are available on Machine 2 (the acting primary).
</p>
<div class="pFigureTitle"><a name="wp1030837"> </a>
Figure&#160;7-2  Migrating a Server Group
</div>

 
 <p class="pGraphic"><a name="wp1023164"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/migrat1.gif" alt="Migrating a Server Group" id="wp1023178"/></div><p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1023068"> </a>
Migrating Machines
</h3>
<p class="pBody"><a name="wp1024081"> </a>
While it is sometimes useful to migrate only a single server group, it is more often necessary to migrate an entire machine. This type of migration may be necessary, for example, when a computer fails. Migrating a machine involves migrating each of the server groups running on the machine. An alternate machine must be configured for each server group.
</p>
<h3 class="pHeading2"><a name="wp1024058"> </a>
Performing a Scheduled Migration
</h3>
<p class="pBody"><a name="wp1023245"> </a>
In a controlled situation, such as when a computer needs to be offline for a while, or needs to be upgraded, an administrator can preserve information about the current configuration for servers and services, and use that information when activating servers on alternate machines. Such use of configuration information is possible because server entries are retained on a primary machine, even after the servers are deactivated and become unavailable in response to a request for a migration.
</p>
<p class="pBody"><a name="wp1022315"> </a>
You can migrate an entire server group or an entire machine. Migration of an entire machine is possible when the same machine is configured as the alternate for all the server groups on a primary machine. When that is not the case (that is, when different alternate machines are configured for different server groups on a primary machine), then the servers must be migrated by group, rather than by machine.
</p>
<p class="pBody"><a name="wp1023793"> </a>
In <a href="admigt.html#wp1030852">Figure&#160;7-3</a>, Machine 1 is the configured <code class="cCode">MASTER</code> and the primary machine for GroupB; Machine 2 is the configured <code class="cCode">BACKUP</code>. Server GroupB is configured with Machine 1 as its primary machine and Machine 3 as its alternate. If Machine 1 is taken down, Machine 2 becomes the acting <code class="cCode">MASTER</code>, and Server GroupB is deactivated, migrated to its alternate (Machine 3), and reactivated. 
</p>
<div class="pFigureTitle"><a name="wp1030852"> </a>
Figure&#160;7-3  Performing a Scheduled Migration
</div>

 
 <p class="pBodyRelative"><a name="wp1023729"> </a>
<img src="wwimages/migrat2.gif" alt="Performing a Scheduled Migration" id="wp1023738"/>
</p>
<p class="pBody"><a name="wp1023613"> </a>
After deactivating all the servers in a group, you can migrate the group from the acting primary to the acting alternate. You do not need to specify which servers are running, which services are currently advertised, or which, if any, dynamic configuration changes are being made. The configured alternate machine obtains this information from the configuration information for the servers that is available on the configured primary machine, when the servers are deactivated. If data-dependant routing is being used and will continue to be used on the alternate machine, services are routed on the basis of the target group name, instead of the target machine name.
</p>
<p class="pBody"><a name="wp1022416"> </a>
Whether you need to migrate an entire application or only portions of it, be sure to make the necessary changes with minimal service disruption. The integrity of all machines, networks, databases, and other components of your application must remain intact. The Oracle Tuxedo system provides a way to migrate an application while preserving the integrity of all its components. 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1022219"> </a>
Migration Options
</h2><p class="pBody"><a name="wp1019494"> </a>
The Oracle Tuxedo system allows you to migrate:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1015723"> </a>A <code class="cCode">MASTER</code> machine to a <code class="cCode">BACKUP</code><a href="admigt.html#wp1015729"> machine, and vice-versa</a></li>
<li><a name="wp1015724"> </a><a href="admigt.html#wp1015729"></a><a href="admigt.html#wp1015729"></a><a href="admigt.html#wp1015782">A server group from its primary machine to its alternate machine</a></li>
<li><a name="wp1015725"> </a>All server groups on a primary machine to an alternate machine</li>
<li><a name="wp1015727"> </a><a href="admigt.html#wp1017862">A transaction log</a></li>
</ul></div>
<p class="pBody"><a name="wp1015728"> </a>
You can also cancel a migration.
</p>
<p class="pBody"><a name="wp1026349"> </a>
By migrating a combination of the application components listed here, and using the system utilities for recovering a partitioned network, you can migrate entire machines.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1015729"> </a>
How to Switch the Master and Backup Machines
</h2><p class="pBody"><a name="wp1026364"> </a>
When a <code class="cCode">MASTER</code> machine must be shut down for maintenance, or is no longer accessible due to an unanticipated problem (such as a partitioned network), then you must transfer the work of the <code class="cCode">MASTER</code> to a configured <code class="cCode">BACKUP</code> machine.
</p>
<a name="wp1026379"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Before you can migrate the <code class="cCode">MASTER</code>, both the <code class="cCode">MASTER</code> and <code class="cCode">BACKUP</code> machines must be running the same release of the Oracle Tuxedo system software. </td>
</tr>
</table>

<p class="pBody"><a name="wp1026431"> </a>
This type of switching is done by migrating the DBBL from the <code class="cCode">MASTER</code> to the <code class="cCode">BACKUP</code>. To migrate the DBBL, enter the following command:
</p>
<p class="pBody"><a name="wp1027281"> </a>
<code class="cCode">tmadmin master</code>
</p>
<p class="pBody"><a name="wp1020288"> </a>
In most cases, you need to migrate application servers to alternate sites, or restore the <code class="cCode">MASTER</code> machine. For more detail about the <code class="cCode">tmadmin</code> command, see the <a href="../rfcm/rfcmd.html">tmadmin(1)</a> reference page in the File Formats, Data Descriptions, MIBs, and System Processes Reference&lt;Default ? Font&gt;.
</p>
<h3 class="pHeading2"><a name="wp1015763"> </a>
Examples of Switching MASTER and BACKUP Machines
</h3>
<p class="pBody"><a name="wp1015764"> </a>
The following two sample <code class="cCode">tmadmin</code> sessions show how to switch <code class="cCode">MASTER</code> and <code class="cCode">BACKUP</code> machines regardless of whether the <code class="cCode">MASTER</code> machine is accessible from the <code class="cCode">BACKUP</code> machine. In <a href="admigt.html#wp1015766">Listing&#160;7-1</a>, the <code class="cCode">MASTER</code> machine is accessible, so the <code class="cCode">DBBL</code> process is migrated from the <code class="cCode">MASTER</code> to the <code class="cCode">BACKUP</code>.
</p>
<div class="pCodeTitle"><a name="wp1015766"> </a>
Listing&#160;7-1	   Switching MASTER and BACKUP When MASTER Is Accessible from BACKUP
</div> <a name="wp1017210"> </a><div class="pPreformatted"><pre>$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL.  All rights reserved.<br />&gt; master<br />are you sure? [y,n] y<br />Migrating active DBBL from SITE1 to SITE2, please wait...<br />DBBL has been migrated from SITE1 to SITE2<br />&gt; q<br /></pre></div><p class="pBody"><a name="wp1020444"> </a>
In <a href="admigt.html#wp1017212">Listing&#160;7-2</a>, because the <code class="cCode">MASTER</code> machine is not accessible from the <code class="cCode">BACKUP</code> machine, the <code class="cCode">DBBL</code> process is created on the <code class="cCode">BACKUP</code> machine.
</p>
<div class="pCodeTitle"><a name="wp1017212"> </a>
Listing&#160;7-2	   Switching MASTER and BACKUP When MASTER Is Not Accessible from BACKUP
</div> <a name="wp1015775"> </a><div class="pPreformatted"><pre>$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL.  All rights reserved.<br />TMADMIN_CATT:199: Cannot become administrator.  Limited set of commands available.<br />&gt; master<br />are you sure? [y,n]  y<br />Creating new DBBL on SITE2, please wait... New DBBL created on SITE2<br />&gt; q<br /></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1015782"> </a>
How to Migrate Server Groups
</h2><div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1027582"> </a>Configure an alternate location in the <code class="cCode">LMID</code> parameter (for the server group being migrated) in the <code class="cCode">GROUPS</code> section of the <code class="cCode">UBBCONFIG</code> file. Servers in the group must specify <code class="cCode">RESTART=Y</code> and the <code class="cCode">MIGRATE</code> option must be specified in the <code class="cCode">RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file.</li>
<li><a name="wp1015783"> </a>If you are planning to migrate a group of servers, shut down each server in the group by issuing the following command:</li>
<a name="wp1026476"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmshutdown -R -g</code> <code class="cCodeEmphasis">groupname</code></pre></div><li><a name="wp1027868"> </a>Start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1027877"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1027879"> </a>At the <code class="cCode">tmadmin</code> prompt, enter one of the following commands:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1026480"> </a>To migrate all the servers in a single group, enter: </li>
<a name="wp1027282"> </a><div class="pPreformattedRelative"><pre><code class="cCode">migrategroup(migg</code>)</pre></div><p class="pBodyRelative"><a name="wp1026576"> </a>
This command takes the name of a single server group as an argument.
</p>
<li><a name="wp1026486"> </a>To migrate all the server groups on a machine (as specified by an LMID), enter: </li>
<a name="wp1027283"> </a><div class="pPreformattedRelative"><pre><code class="cCode">migratemach(migm)</code></pre></div></ul></div>
<li><a name="wp1020702"> </a>If transactions are being logged for a server being migrated as part of a group, you may need to move the <code class="cCode">TLOG</code> to the <code class="cCode">BACKUP</code> machine, load it, and &#8220;warm start&#8221; it. </li>
</ol></div>
<h3 class="pHeading2"><a name="wp1015801"> </a>
How to Migrate a Server Group When the Alternate Machine Is Accessible from the Primary Machine
</h3>
<p class="pBody"><a name="wp1018055"> </a>
To migrate a server group when the alternate machine is accessible from the primary machine, complete the following procedure.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1015803"> </a>Shut down the <code class="cCode">MASTER</code> machine by entering the following command:</li>
<a name="wp1026630"> </a><div class="pPreformattedRelative"><pre>tmshutdown -R -g <code class="cCodeEmphasis">groupname</code></pre></div><li><a name="wp1026629"> </a>On the primary machine, start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1026620"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1015804"> </a>Migrate the appropriate group by entering the following command:</li>
<a name="wp1026628"> </a><div class="pPreformattedRelative"><pre>migrategroup <code class="cCodeEmphasis">groupname</code></pre></div><li><a name="wp1015805"> </a>If necessary, migrate the transaction log.</li>
<li><a name="wp1015806"> </a>If necessary, migrate the application data.</li>
</ol></div>
<h3 class="pHeading2"><a name="wp1018036"> </a>
How to Migrate a Server Group When the Alternate Machine Is Not Accessible from the Primary Machine
</h3>
<p class="pBody"><a name="wp1018078"> </a>
To migrate a server group when the alternate machine is not accessible from the primary machine, switch the <code class="cCode">MASTER</code> and <code class="cCode">BACKUP</code> machines, if necessary.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1015809"> </a>On the alternate machine, start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1027288"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1015810"> </a>Request cleanup and restart of any servers on the primary machine that require these operations by entering the following command:</li>
<a name="wp1026645"> </a><div class="pPreformattedRelative"><pre>pclean <code class="cCodeEmphasis">primary_machine</code></pre></div><li><a name="wp1015811"> </a>Transfer the appropriate server group to a configured alternate machine by entering the following command:</li>
<a name="wp1026652"> </a><div class="pPreformattedRelative"><pre>migrate <code class="cCodeEmphasis">groupname</code></pre></div><li><a name="wp1015812"> </a>Boot the newly migrated server group by entering the following command:</li>
<a name="wp1026655"> </a><div class="pPreformattedRelative"><pre>boot -g <code class="cCodeEmphasis">groupname</code></pre></div></ol></div>
<h3 class="pHeading2"><a name="wp1015813"> </a>
Examples of Migrating a Server Group
</h3>
<p class="pBody"><a name="wp1015814"> </a>
The following two sample sessions show how you can migrate a server group, regardless of whether the alternate machine is accessible from the primary machine. In <a href="admigt.html#wp1015815">Listing&#160;7-3</a>, the alternate machine is accessible from the primary machine. 
</p>
<div class="pCodeTitle"><a name="wp1015815"> </a>
Listing&#160;7-3	   Migrating a Group When the Alternate Machine Is Accessible from the Primary Machine
</div> <a name="wp1015816"> </a><div class="pPreformatted"><pre>$ tmshutdown -R -g GROUP1<br />Shutting down server processes...<br />Server ID = 1 Group ID = GROUP1 machine = SITE1: shutdown succeeded<br />1 process stopped.<br />$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL. <br />&gt; migg GROUP1<br />migg successfully completed<br />&gt; q<br /></pre></div><p class="pBody"><a name="wp1015825"> </a>
In <a href="admigt.html#wp1020784">Listing&#160;7-4</a>, the alternate machine is not accessible from the primary machine.
</p>
<div class="pCodeTitle"><a name="wp1020784"> </a>
Listing&#160;7-4	   Migrating a Group When the Alternate Machine Is Not Accessible from the Primary Machine
</div> <a name="wp1015826"> </a><div class="pPreformatted"><pre>$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL. <br />&gt; pclean SITE1<br />Cleaning the DBBL.<br />Pausing 10 seconds waiting for system to stabilize.<br />3 SITE1 servers removed from bulletin board<br />&gt; migg GROUP1<br />migg successfully completed.<br />&gt; boot -g GROUP2<br />Booting server processes ...<br />exec simpserv -A :<br />on SITE2 -&gt; process id=22699 ... Started.<br />1 process started.<br />&gt; q<br /></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1015840"> </a>
How to Migrate Server Groups from One Machine to Another
</h2><div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1027599"> </a>Use the <code class="cCode">LMID</code> parameter to name the processor on which the server group(s) have been running. The alternate location must be the same for all server groups on the <code class="cCode">LMID</code>. </li>
<li><a name="wp1027600"> </a>In the <code class="cCode">RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file, set the following parameters:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1027601"> </a>Set <code class="cCode">RESTART=Y</code> for each server on the machine indicated by the <code class="cCode">LMID</code>.</li>
<li><a name="wp1027602"> </a>Specify the <code class="cCode">MIGRATE</code> options.</li>
</ul></div>
<li><a name="wp1015841"> </a>Shut down all server groups and mark the servers in the groups as restartable by entering the following command:</li>
<a name="wp1026767"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmshutdown</code> <code class="cCode">-R</code></pre></div><li><a name="wp1020933"> </a>Use the <a href="../rfcm/rfcmd.html">tmadmin(1)</a> <code class="cCode">migratemach</code> (<code class="cCode">migm</code>) command to migrate all server groups from one machine to another when the primary machine must be shut down for maintenance or when the primary machine is no longer accessible. (The command takes one logical machine identifier as an argument.)</li>
</ol></div>
<h3 class="pHeading2"><a name="wp1015842"> </a>
How to Migrate Machines When the Alternate Machine Is Accessible from the Primary Machine
</h3>
<p class="pBody"><a name="wp1018115"> </a>
To migrate a machine when the alternate machine is accessible from the primary machine, complete the following procedure.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1026833"> </a>Shut down the <code class="cCode">MASTER</code> machine by entering the following command on that machine:</li>
<a name="wp1026834"> </a><div class="pPreformattedRelative"><pre>tmshutdown -R -1 <code class="cCodeEmphasis">primary_machine</code></pre></div><li><a name="wp1026835"> </a>On the <code class="cCode">MASTER</code> machine, start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1026836"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1026837"> </a>At the <code class="cCode">tmadmin</code> prompt, migrate the appropriate machine by entering the following command:</li>
<a name="wp1026838"> </a><div class="pPreformattedRelative"><pre>migratemach <code class="cCodeEmphasis">primary_machine</code></pre></div><li><a name="wp1026839"> </a>If necessary, migrate the transaction log.</li>
<li><a name="wp1015848"> </a>If necessary, migrate the application data.</li>
</ol></div>
<h3 class="pHeading2"><a name="wp1015849"> </a>
How to Migrate Machines When the Alternate Machine Is Not Accessible from the Primary Machine
</h3>
<p class="pBody"><a name="wp1018144"> </a>
To migrate a machine when the alternate machine is not accessible from the primary machine, switch the <code class="cCode">MASTER</code> and <code class="cCode">BACKUP</code> machines, if necessary.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1026867"> </a>On the alternate machine, start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1027295"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1026868"> </a>Request cleanup and restart of the primary machine that require these operations by entering the following command:</li>
<a name="wp1026869"> </a><div class="pPreformattedRelative"><pre>pclean <code class="cCodeEmphasis">primary_machine</code></pre></div><li><a name="wp1026870"> </a>Transfer the appropriate server group to a configured alternate machine by entering the following command:</li>
<a name="wp1026871"> </a><div class="pPreformattedRelative"><pre>migratemach <code class="cCodeEmphasis">primary_machine</code></pre></div><li><a name="wp1026872"> </a>Boot the newly migrated server group by entering the following command:</li>
<a name="wp1026873"> </a><div class="pPreformattedRelative"><pre>boot -l <code class="cCodeEmphasis">alternate_machine</code></pre></div></ol></div>
<h3 class="pHeading2"><a name="wp1015855"> </a>
Examples of Migrating a Machine
</h3>
<p class="pBody"><a name="wp1015856"> </a>
<a href="admigt.html#wp1015857">Listing&#160;7-5</a> shows how to migrate machines. In the first example, the alternate machine is accessible from the primary machine.
</p>
<div class="pCodeTitle"><a name="wp1015857"> </a>
Listing&#160;7-5	   Migrating a Machine When the Alternate Machine Is Accessible from the Primary Machine
</div> <a name="wp1015858"> </a><div class="pPreformatted"><pre>$ tmshutdown -R -l SITE1<br />Shutting down server processes...<br />Server ID = 1 Group ID = GROUP1 machine = SITE1: shutdown <br />succeeded 1 process stopped.<br />$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL. <br />&gt; migm SITE1<br />migm successfully completed<br />&gt; q<br /></pre></div><p class="pBody"><a name="wp1015867"> </a>
In <a href="admigt.html#wp1020980">Listing&#160;7-6</a>, the alternate machine is not accessible from the primary machine.
</p>
<div class="pCodeTitle"><a name="wp1020980"> </a>
Listing&#160;7-6	   Migrating a Machine When the Alternate Machine Is Not Accessible from the Primary Machine
</div> <a name="wp1015868"> </a><div class="pPreformatted"><pre>$ tmadmin<br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL.<br />&gt;pclean SITE1<br />Cleaning the DBBL.<br />Pausing 10 seconds waiting for system to stabilize.<br />3 SITE1 servers removed from bulletin board<br />&gt; migm SITE1<br />migm successfully completed.<br />&gt; boot -l SITE2<br />Booting server processes ...<br />exec simpserv -A :<br />on SITE2 -- process id=22782 ... Started.<br />1 process started.<br />&gt;q<br /></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1030956"> </a>
Automatic Migration
</h2><p class="pBody"><a name="wp1030957"> </a>
When only one logical machine fails (unreachable), the entities (DBBL and server groups) on that machine will be migrated by Automatic Migration feature if both such feature is enabled and the entity has backup machine defined in UBB. If the machine is unreachable merely due to network issue and the automatic migration is evoked, once the network issue is resolved and the &#8220;dead&#8221; machine comes back, one of the duplicate entities will be removed. 
</p>
<p class="pBody"><a name="wp1030958"> </a>
To enable the Automatic Migration feature, two threshold options are required to be configured in *RESOURCES section of UBBCONFIG.
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1030959"> </a><code class="cCode">DBBLFAILOVER </code><code class="cCodeEmphasis">numeric_value</code> (0 &lt;= <code class="cCodeEmphasis">num</code> &lt; 32768)</li>
</ul></div>
<div class="pDefPara"><a name="wp1030960"> </a>
The time threshold for migrating DBBL. If not specified, <code class="cCode">DBBLFAILOVER</code> will be set as 0 by default. The Automatic Migration for DBBL will be enabled only if <code class="cCode">DBBLFAILOVER</code> is configured greater than 0. 
</div>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1030961"> </a><code class="cCode">SGRPFAILOVER</code> <code class="cCodeEmphasis">numeric_value</code> (0 &lt;= <code class="cCodeEmphasis">num</code> &lt; 32768)</li>
</ul></div>
<div class="pDefPara"><a name="wp1030962"> </a>
The time threshold for migrating server groups. If not specified, <code class="cCode">SGRPFAILOVER</code> will be set as 0 by default. The Automatic Migration for server groups will be enabled only if <code class="cCode">SGRPFAILOVER</code> is configured greater than 0.
</div>
<p class="pBody"><a name="wp1030963"> </a>
Besides that, two related attributes TA_DBBLFAILOVER and TA_SGRPFAILOVER are defined in T_DOMAIN class for MIB operations. 
</p>
<p class="pBody"><a name="wp1015882"> </a>
See the <span class="cHyperlink">
<a href="../rf5/rf5.html">UBBCONFIG(5)</a></span> or <span class="cHyperlink">
<a href="../rf5/rf5.html">TM_MIB(5) </a></span>reference for more details.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1030941"> </a>
How to Cancel a Migration
</h2><p class="pBody"><a name="wp1015883"> </a>
If you decide, after deactivating a server group or machine, that you do not want to continue, you can cancel the migration before reactivating the server group or machine. All the information in the name server for the deactivated servers and services is deleted.
</p>
<p class="pBody"><a name="wp1027020"> </a>
To cancel a migration after a shutdown but before issuing the <code class="cCode">migrate</code> command, enter one of the following commands shown in <a href="admigt.html#wp1030888">Table&#160;7-1</a>.
</p>
<p class="pGraphic"><a name="wp1030781"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1030888table1028408"><caption><a name="wp1030888"> </a>
Table 7-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">How to Cancel a Migration</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1028542"> </a>
To Cancel . . .
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1028544"> </a>
Enter This Command . . .
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1028546"> </a>
As a Result . . .
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028549"> </a>
Server migration
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028551"> </a>
<code class="cCode">tmadmin migrategroup -cancel</code>
</div>
<div class="pCellBody"><a name="wp1028552"> </a>
or
</div>
<div class="pCellBody"><a name="wp1028553"> </a>
<code class="cCode">tmadmin migg -cancel</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028555"> </a>
Server entries are deleted from the bulletin board. You must reboot the servers once the migration procedure is canceled.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028557"> </a>
Machine migration
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028567"> </a>
<code class="cCode">tmadmin</code> <code class="cCode">migratemach</code>  -<code class="cCode">cancel</code>
</div>
<div class="pCellBody"><a name="wp1028568"> </a>
or
</div>
<div class="pCellBody"><a name="wp1028559"> </a>
<code class="cCode">tmadmin migm -cancel</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1028561"> </a>
The migration is stopped.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1015887"> </a>
Example of a Migration Cancellation
</h3>
<p class="pBody"><a name="wp1015888"> </a>
The following sample <code class="cCode">tmadmin</code> session in <a href="admigt.html#wp1015889">Listing&#160;7-7</a> shows how a server group and a machine can be migrated between their respective primary and alternate machines.
</p>
<div class="pCodeTitle"><a name="wp1015889"> </a>
Listing&#160;7-7	   Canceling a Server Group Migration for GROUP1
</div> <a name="wp1015890"> </a><div class="pPreformatted"><pre>$tmadmin  <br />tmadmin - Copyright © 1987-1990 AT&amp;T; 1991-1993 USL.  <br />&gt; psr -g GROUP1 </pre></div><a name="wp1030900"> </a><div class="pPreformatted"><pre>a.out Name  Queue Name    Grp Name   ID RqDone Ld Done Current Service<br />----------  ----------    --------   -- ------ ------- ---------------<br />simpserv     00001.00001	   GROUP1	     1    -	    -	       (DEAD MIGRATING)<br />&gt; psr -g GROUP1 <br />TMADMIN_CAT:121: No such server<br />migg -cancel GROUP1<br />&gt;boot -g GROUP1<br />Booting server processes...<br />exec simpserv -A:<br />on SITE1 -&gt;process id_27636 ... Started. 1 process started.<br />&gt; psr -g GROUP1 </pre></div><a name="wp1030901"> </a><div class="pPreformatted"><pre>a.out Name  Queue Name    Grp Name   ID RqDone Ld Done Current Service<br />----------  ----------    --------   -- ------ ------- ---------------<br />simpserv    00001.00001	    GROUP1	     1    -	    -		           ( - )<br />&gt; q<br /></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1017862"> </a>
How to Migrate Transaction Logs to a Backup Machine
</h2><p class="pBody"><a name="wp1027145"> </a>
To migrate a transaction log to a <code class="cCode">BACKUP</code> machine, complete the following procedure.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1027615"> </a>Start a <code class="cCode">tmadmin</code> session by entering the following command:</li>
<a name="wp1027622"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tmadmin</code></pre></div><li><a name="wp1018204"> </a>Shut down the servers in all the groups that write to the log, to prevent them from writing further entries.</li>
<li><a name="wp1015909"> </a>Dump the <code class="cCode">TLOG</code> into a text file by running the following command:</li>
<a name="wp1027154"> </a><div class="pPreformattedRelative"><pre><code class="cCode">dumptlog [-z </code><code class="cCodeEmphasis">config</code><code class="cCode">] [-o </code><code class="cCodeEmphasis">offset</code><code class="cCode">] [-n </code><code class="cCodeEmphasis">filename</code><code class="cCode">] [-g </code><code class="cCodeEmphasis">groupname</code><code class="cCode">]</code></pre></div><a name="wp1015910"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The <code class="cCode">TLOG</code> is specified by the <code class="cCodeEmphasis">config</code> and <code class="cCodeEmphasis">offset</code> arguments. The value of <code class="cCodeEmphasis">offset</code> defaults to <code class="cCode">0</code>; <code class="cCodeEmphasis">name</code> defaults to <code class="cCode">TLOG</code>. If the <code class="cCode">-g</code> option is chosen, only those records coordinated by the <code class="cCode">TMS</code> from <code class="cCodeEmphasis">groupname</code> are dumped.</td>
</tr>
</table>

<li><a name="wp1015911"> </a>Copy <code class="cCodeEmphasis">filename</code> to the <code class="cCode">BACKUP</code> machine.</li>
<li><a name="wp1015912"> </a>Read the file into the existing <code class="cCode">TLOG</code> for the specified machine by entering the following command:</li>
<a name="wp1027563"> </a><div class="pPreformattedRelative"><pre><code class="cCode">loadtlog -m </code><code class="cCodeEmphasis">machine filename</code></pre></div><li><a name="wp1027564"> </a>Force a warm start of the <code class="cCode">TLOG</code> by entering the following command:</li>
<a name="wp1027567"> </a><div class="pPreformattedRelative"><pre><code class="cCode">logstart</code> <code class="cCodeEmphasis">machine</code></pre></div><p class="pBodyRelative"><a name="wp1027189"> </a>
The system reads the information in the <code class="cCode">TLOG</code> and uses it to create an entry in the transaction table in shared memory.
</p>
<li><a name="wp1015914"> </a>Migrate the servers to the <code class="cCode">BACKUP</code> machine.</li>
</ol></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="admigt.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="adsevt.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="adtun.html"><img id="LongDescNotReq9" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
