<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/trans/fm/trxcrbcl.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:48:06" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Transactions in CORBA Client Applications</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Using CORBA Transactions
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="trxcrbsr.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="admtrx.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/trans.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1019562"> </a>
Transactions in CORBA Client Applications
</h1>
<p class="pBody"><a name="wp1015142"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1015146"> </a><a href="trxcrbcl.html#wp1014527">Overview of Oracle Tuxedo CORBA Transactions</a></li>
<li><a name="wp1015150"> </a><a href="trxcrbcl.html#wp1010320">Summary of the Development Process for Transactions</a></li>
<li><a name="wp1015154"> </a><a href="trxcrbcl.html#wp1017547">Step 1: Using the Bootstrap Object to Obtain the TransactionCurrent Object</a></li>
<li><a name="wp1015158"> </a><a href="trxcrbcl.html#wp1016641">JStep 2: Using the TransactionCurrent Methods</a></li>
</ul></div>
<p class="pBody"><a name="wp1009598"> </a>
This topic describes how to use transactions in CORBA C++ client applications for the Oracle Tuxedo CORBA software. Before you begin, you should read <a href="gstrx.html">Introducing Transactions.</a>
</p>
<a name="wp1019787"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>The Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB were deprecated in Tuxedo 8.1 and are no longer supported. All Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB text references, associated code samples, should only be used to help implement/run third party Java ORB libraries, and for programmer reference only.</td></tr>
</table>

<a name="wp1019788"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>Technical support for third party CORBA Java ORBs should be provided by their respective vendors. Oracle Tuxedo does not provide any technical support or documentation for third party CORBA Java ORBs.</td>
</tr>
</table>
<p class="pBody"><a name="wp1018576"> </a>
For an example of how transactions are implemented in working client applications, see the <span style="font-style: italic">The Transaction Sample Application</a></span> in the Oracle Tuxedo online documentation. For an overview of the TransactionCurrent object, see &#8220;Client Application Development Concepts&#8221; in <span style="font-style: italic"><a href="../creclient/index.html"></span><em class="cEmphasis">Creating CORBA Client Applications</em><span class="cHyperlink">
</a></span>.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1014527"> </a>
Overview of Oracle Tuxedo CORBA Transactions
</h2><p class="pBody"><a name="wp1009655"> </a>
<em class="cEmphasis">Client applications</em> use transaction processing to ensure that data remains correct, consistent, and persistent. The transactions in the Oracle Tuxedo software allow client applications to begin and terminate transactions and to get the status of transactions. The Oracle Tuxedo software uses transactions as defined in the CORBA services Object Transaction Service, with extensions for ease of use.
</p>
<p class="pBody"><a name="wp1009869"> </a>
Transactions are defined on <em class="cEmphasis">interfaces</em>. The application designer decides which interfaces within an Oracle Tuxedo client/server application will handle transactions.<span style="font-weight: bold"> </span>Transaction policies are defined in the Implementation Configuration File (ICF) for server applications. Generally, the ICF file for the available interfaces is provided to the client programmer by the application designer.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1010320"> </a>
Summary of the Development Process for Transactions 
</h2><p class="pBody"><a name="wp1016375"> </a>
To add transactions to a client application, complete the following steps:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1016376"> </a><a href="trxcrbcl.html#wp1017547">Step 1: Using the Bootstrap Object to Obtain the TransactionCurrent Object</a></li>
<li><a name="wp1016386"> </a><a href="trxcrbcl.html#wp1016641">JStep 2: Using the TransactionCurrent Methods</a></li>
</ul></div>
<p class="pBody"><a name="wp1017518"> </a>
The rest of this topic describes these steps using portions of the client applications in the Transactions University sample application. For information about the Transactions University sample application, see <em class="cEmphasis">The Trans</em><span class="cHyperlink">
actions Sample Application</a></span> in the Oracle Tuxedo online documentation.
</p>
<p class="pBody"><a name="wp1017523"> </a>
The Transactions University sample application is located in the following directory on the Oracle Tuxedo software kit:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1011777"> </a>For Microsoft Windows systems: drive:<code class="cCode">\tuxdir\samples\corba\university\transactions</code> </li>
<li><a name="wp1015307"> </a>For UNIX systems:<br />drive:<code class="cCode">/tuxdir/samples/corba/university/transactions</code></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1017547"> </a>
Step 1: Using the Bootstrap Object to Obtain the TransactionCurrent Object
</h2><p class="pBody"><a name="wp1017549"> </a>
If you are using the Oracle Tuxedo CORBA client software, you should use the Bootstrap object to obtain an object reference to the TransactionCurrent object for the specified Oracle Tuxedo domain. For more information about the TransactionCurrent object, see &#8220;Client Application Development Concepts&#8221; in <span style="font-style: italic"><a href="../creclient/index.html"></span><em class="cEmphasis">Creating CORBA Client Applications</em></a>.
</p>
<a name="wp1019091"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If you are using a third-party client ORB, you should the CORBA Interoperable Naming Service (INS) <code class="cCode">CORBA::ORB::resolve_initial_references</code> operation to obtain an object reference to the FactoryFinder object for the specified Oracle Tuxedo domain. For information on how to use INS to get initial object references for transaction clients, see &#8220;CORBA Bootstrapping Programming Reference&#8221; in the <a href="../creclient/index.html">CORBA Programming Reference</a>.</td>
</tr>
</table>

<a name="wp1019100"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>The following C++ examples illustrate how the Bootstrap object is used to return the TransactionCurrent object.</td>
</tr>
</table>
<h3 class="pHeading2"><a name="wp1017938"> </a>
C++ Example
</h3>
<a name="wp1011506"> </a><div class="pPreformatted"><pre>CORBA::Object_var var_transaction_current_oref =  <br />     Bootstrap.resolve_initial_references(&#8220;TransactionCurrent&#8221;);<br />CosTransactions::Current_var transaction_current_oref=<br />     CosTransactions::Current::_narrow(<br />              var_transaction_current_oref.in());</pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1016641"> </a>
JStep 2: Using the TransactionCurrent Methods 
</h2><p class="pBody"><a name="wp1019905"> </a>
The TransactionCurrent object has <em class="cEmphasis">methods</em> that allow a client application to manage transactions. These methods can be used to begin and end transactions and to obtain information about the current transaction.
</p>
<p class="pBody"><a name="wp1019975"> </a>
<a href="trxcrbcl.html#wp1019915">Table&#160;4-1</a> describes the methods in the TransactionCurrent object.
</p>
<p class="pGraphic"><a name="wp1019982"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1019915table1019909"><caption><a name="wp1019915"> </a>
Table 4-1  Methods in the TransactionCurrent Object&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1019919"> </a>
Method
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1019921"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019924"> </a>
<code class="cCode">begin</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019926"> </a>
Creates a new transaction. Future operations take place within the scope of this transaction. When a client application begins a transaction, the default transaction timeout is 300 seconds. You can change this default, using the <code class="cCode">set_timeout</code> method.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019929"> </a>
<code class="cCode">commit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019931"> </a>
Ends the transaction successfully. Indicates that all operations on this client application have completed successfully.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019934"> </a>
<code class="cCode">rollback</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019936"> </a>
Forces the transaction to roll back.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019939"> </a>
<code class="cCode">rollback_only</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019941"> </a>
Marks the transaction so that the only possible action is to roll back. Generally, this method is used only in server applications.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019944"> </a>
<code class="cCode">suspend</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019946"> </a>
Suspends participation in the current transaction. This method returns an object that identifies the transaction and allows the client application to resume the transaction later. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019949"> </a>
<code class="cCode">resume</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019951"> </a>
Resumes participation in the specified transaction.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019954"> </a>
<code class="cCode">get_status</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019956"> </a>
Returns the status of a transaction with a client application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019959"> </a>
<code class="cCode">get_transaction_name</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019961"> </a>
Returns a printable string describing the transaction.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019964"> </a>
<code class="cCode">set_timeout</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019966"> </a>
Modifies the timeout period associated with transactions. The default transaction timeout value is 300 seconds. If a transaction is automatically started instead of explicitly started with the <code class="cCode">begin</code> method, the timeout value is determined by the value of the <code class="cCode">TRANTIME</code> parameter in the <code class="cCode">UBBCONFIG</code> file. For more information about setting the <code class="cCode">TRANTIME</code> parameter, see <a href="admtrx.html">Chapter&#160;, &quot;Administering Transactions.&quot;</a>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019972"> </a>
<code class="cCode">get_control</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1019974"> </a>
Returns a control object that represents the transaction.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1019977"> </a>
A basic transaction works in the following way: 
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1011366"> </a>A client application begins a transaction using the <code class="cCode">Tobj::TransactionCurrent::begin</code> method. This method does not return a value.</li>
<li><a name="wp1011367"> </a>The operations on the CORBA interface execute within the scope of a transaction. If a call to any of these operations raises an exception (either explicitly or as a result of a communications failure), the exception can be caught and the transaction can be rolled back.</li>
<li><a name="wp1011368"> </a>Use the <code class="cCode">Tobj::TransactionCurrent::commit</code> method to commit the current transaction. This method ends the transaction and starts the processing of the operation. The transaction is committed only if all of the participants in the transaction agree to commit.</li>
<p class="pBodyRelative"><a name="wp1011372"> </a>
The association between the transaction and the client application ends when the client application calls the <code class="cCode">Tobj::TransactionCurrent:commit</code> method or the<code class="cCode"> Tobj::TransactionCurrent:rollback</code> method.The following C++ examples illustrate using a transaction to encapsulate the operation of a student registering for a class.
</p>
</ol></div>
<h3 class="pHeading2"><a name="wp1017826"> </a>
C++ Example
</h3>
<a name="wp1012070"> </a><div class="pPreformatted"><pre><code class="cCode">//Begin the transaction<br />transaction_current_oref-&gt;begin();<br />try {<br />//Perform the operation inside the transaction<br />&#160;&#160;&#160;pointer_Registar_ref-&gt;register_for_courses(student_id, course_number_list);<br />&#160;&#160;&#160;&#160;...<br />//If operation executes with no errors, commit the transaction:<br /></code>&#160;&#160;&#160;&#160;&#160;<code class="cCode">CORBA::Boolean report_heuristics = CORBA_TRUE;<br /></code>&#160;&#160;&#160;&#160;&#160;<code class="cCode">transaction_current_ref-&gt;commit(report_heuristics);<br />}<br />catch (CORBA::Exception &amp;) {<br />//If the operation has problems executing, rollback the <br />//transaction. Then throw the original exception again.<br />//If the rollback fails, ignore the exception and throw the<br />//original exception again.        <br />try {<br /></code>&#160;&#160;&#160;&#160;&#160;<code class="cCode">transaction_current_ref-&gt;rollback();<br />}<br />catch (CORBA::Exception &amp;) {<br /></code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<code class="cCode">TP::userlog(&quot;rollback failed&quot;);<br /><br />throw;<br />}</code></pre></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="trxcrbcl.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="trxcrbsr.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="admtrx.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
