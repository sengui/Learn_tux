<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/usamples/fm/production.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:51:50" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>The Production Sample Application</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Guide to CORBA University Sample Applications
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="wrapper.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/usamples.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1064263"> </a>
The Production Sample Application
</h1>
<p class="pBody"><a name="wp1058550"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058554"> </a><a href="production.html#wp1058582">How the Production Sample Application Works</a></li>
<li><a name="wp1058558"> </a><a href="production.html#wp1058662">The Development Process for the Production Sample Application</a></li>
<li><a name="wp1058562"> </a><a href="production.html#wp1058746">Building the Production Sample Application</a></li>
<li><a name="wp1058566"> </a><a href="production.html#wp1058951">Compiling the Production Sample Application</a></li>
<li><a name="wp1058570"> </a><a href="production.html#wp1058972">Running the Production Sample Application</a></li>
<li><a name="wp1058574"> </a><a href="production.html#wp1059058">How the Production Sample Application Can Be Scaled Further</a></li>
</ul></div>
<a name="wp1058577"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>The client applications in the Production sample application work in the same manner as the client applications in the Wrapper sample application.</td></tr>
</table>

<a name="wp1065444"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>The Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB were deprecated in Tuxedo 8.1 and are no longer supported. All Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB text references, associated code samples, should only be used to help implement/run third party Java ORB libraries, and for programmer reference only.</td>
</tr>
</table>
<a name="wp1065445"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>Technical support for third party CORBA Java ORBs should be provided by their respective vendors. Oracle Tuxedo does not provide any technical support or documentation for third party CORBA Java ORBs.</td>
</tr>
</table>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058582"> </a>
How the Production Sample Application Works
</h2><p class="pBody"><a name="wp1058583"> </a>
The Production sample application provides the same end-user functionality as the Wrapper sample application. The Production sample application demonstrates how to use CORBA features of the Oracle Tuxedo software to scale a CORBA application. The Production sample application does the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058585"> </a>Replicates the University server application, the Billing server application, and the ATMI Teller application within the <code class="cCode">ORA_GRP </code>and <code class="cCode">APP_GRP</code> server groups defined in the<code class="cCode"> UBBCONFIG</code> file.</li>
<li><a name="wp1058589"> </a>Replicates the <code class="cCode">ORA_GRP1 </code>and <code class="cCode">APP_GRP1</code> server groups on an additional server machine, Production Machine 2, as <code class="cCode">ORA_GRP2 </code>and <code class="cCode">APP_GRP2</code> and partitions the database.</li>
<li><a name="wp1058590"> </a>Implements a stateless object model to scale up the number of requests from client applications the server application can manage simultaneously.</li>
<li><a name="wp1058593"> </a>Assigns unique object IDs (OIDs) to the following objects so that they can be instantiated multiple times simultaneously in their respective server groups, thereby making them available on a per-client-application (and not per-process) basis:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1058594"> </a><code class="cCode">Registrar</code></li>
<li><a name="wp1058595"> </a><code class="cCode">RegistrarFactory</code></li>
<li><a name="wp1058596"> </a><code class="cCode">Teller</code></li>
<li><a name="wp1058597"> </a><code class="cCode">TellerFactory</code></li>
</ul></div>
<li><a name="wp1058598"> </a>Implements factory-based routing to direct requests from client applications on behalf of some students to one server machine, and other students to another server machine.</li>
</ul></div>
<a name="wp1058599"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>To make the Production sample application easy for you to use, the sample application is configured on the Oracle Tuxedo software kit to run on one machine using one database. However, the Production sample application is set up so that it can be configured to run on several machines and to use multiple databases. Changing the configuration to multiple machines and databases involves simply modifying the <code class="cCode">UBBCONFIG</code> file and partitioning the database. </td>
</tr>
</table>

<p class="pBody"><a name="wp1058600"> </a>
The following sections describe how the Production sample application uses replicated server applications, replicated server groups, object state management, and factory-based routing to scale the Production sample application.
</p>
<h3 class="pHeading2"><a name="wp1058602"> </a>
Replicating Server Applications
</h3>
<p class="pBody"><a name="wp1058603"> </a>
When you replicate server applications:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058604"> </a>You obtain a means to balance the load of incoming requests from client applications on that server application. As requests arrive in the Tuxedo domain for the server group, the Oracle Tuxedo system routes the request to the least busy server application within that group.</li>
<li><a name="wp1058605"> </a>You can specify how many copies of a given server application process are running on a server machine. The number of copies determines the extent to which the Tuxedo domain can process requests in-parallel from client applications.</li>
<li><a name="wp1058606"> </a>You obtain a useful failover protection in the event that one of the server application processes stops.</li>
</ul></div>
<p class="pBody"><a name="wp1058607"> </a>
In the Production sample application, the server applications are replicated in the following manner:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058609"> </a>The University server application, the ATMI Teller application, and the server application for the University database are replicated within the <code class="cCode">ORA_GRP</code> group.</li>
<li><a name="wp1058610"> </a>The Billing server application is replicated within the <code class="cCode">APP_GRP</code> group.</li>
</ul></div>
<p class="pBody"><a name="wp1058614"> </a>
<a href="production.html#wp1058616">Figure&#160;7-1</a> shows the replicated <code class="cCode">ORA_GRP</code> and <code class="cCode">APP_GRP</code> server groups.
</p>
<div class="pFigureTitle"><a name="wp1058616"> </a>
Figure&#160;7-1  Replicated Server Groups in the Production Sample Application
</div>

 
 <p class="pGraphic"><a name="wp1058617"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/m3ugroup.gif" alt="Replicated Server Groups in the Production Sample Application" id="wp1059962"/></div><p class="pGraphic">

</p>
<p class="pBody"><a name="wp1058621"> </a>
In <a href="production.html#wp1058616">Figure&#160;7-1</a>, note the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058622"> </a>There can be no more than one instance of the <code class="cCode">RegistrarFactory</code>, <code class="cCode">Registrar</code>, <code class="cCode">TellerFactory</code>, or <code class="cCode">Teller</code> objects within a single server application process.</li>
<li><a name="wp1058623"> </a>There can be any number of <code class="cCode">CourseSynopsisEnumerator</code> objects within a server application process.</li>
</ul></div>
<h3 class="pHeading2"><a name="wp1058627"> </a>
Replicating Server Groups
</h3>
<p class="pBody"><a name="wp1058628"> </a>
Server groups are a feature of the Oracle Tuxedo software that allow you to add server machines to an existing CORBA application. When you replicate a server group, you can do the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058629"> </a>Spread the processing load for a CORBA application across multiple server machines.</li>
<li><a name="wp1058630"> </a>Use factory-based routing to send requests from client applications to a particular server machine.</li>
</ul></div>
<p class="pBody"><a name="wp1058631"> </a>
The way in which server groups are configured and replicated is specified in the <code class="cCode">UBBCONFIG</code> file.
</p>
<p class="pBody"><a name="wp1058637"> </a>
<a href="production.html#wp1058639">Figure&#160;7-2</a> shows the server groups in the Production sample application replicated on a second server machine. The replicated server groups are defined as <code class="cCode">ORA_GRP2</code> and <code class="cCode">APP_GRP2</code> in the <code class="cCode">UBBCONFIG</code> file for the Production sample application.
</p>
<div class="pFigureTitle"><a name="wp1058639"> </a>
Figure&#160;7-2  Replicating Server Groups Across Server Machines
</div>

 
 <p class="pGraphic"><a name="wp1058640"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/m3ugrps.gif" alt="Replicating Server Groups Across Server Machines" id="wp1060926"/></div><p class="pGraphic">

</p>
<p class="pBody"><a name="wp1058644"> </a>
In <a href="production.html#wp1058639">Figure&#160;7-2</a>, the only difference between the content of the server groups on Production Machine 1 and Production Machine 2 is the database. The University database is partitioned into two databases. The database on Production Machine 1 contains student and account information for students with IDs between 100001 and 100005. The database on Production Machine 2 contains student and account information for students with IDs between 100006 and 100010. 
</p>
<h3 class="pHeading2"><a name="wp1058646"> </a>
Using a Stateless Object Model
</h3>
<p class="pBody"><a name="wp1058647"> </a>
To achieve scalability gains, the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects are configured in the Production sample application to have the method activation policy. The method activation policy results in the following behavior changes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058648"> </a>Whenever the objects are invoked, they are instantiated by the Tuxedo domain in the appropriate server group. </li>
<li><a name="wp1058649"> </a>After the invocation is complete, the Tuxedo domain deactivates the objects.</li>
</ul></div>
<p class="pBody"><a name="wp1058650"> </a>
In the Basic through the Production sample applications, the <code class="cCode">Registrar</code> object had an activation policy of <code class="cCode">process</code>. All requests from client applications on the <code class="cCode">Registrar</code> object went to the same object instance in the memory of the server machine. This design is adequate for a small-scale deployment. However, as client application demands increase, requests from client applications on the <code class="cCode">Registrar</code> object eventually become queued, and response time drops.
</p>
<p class="pBody"><a name="wp1058653"> </a>
However, when the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects have an activation policy of <code class="cCode">method</code> and the server applications that manage these objects are replicated, the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects can process multiple requests from client applications in parallel. The only constraint is the number of server application processes that are available to instantiate the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects.
</p>
<p class="pBody"><a name="wp1058654"> </a>
For the CORBA application to instantiate copies of the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects in each of the replicated server application processes, each copy of the <code class="cCode">Registrar</code> and <code class="cCode">Teller</code> objects have an unique object ID (OID). The factories that create these objects are responsible for assigning them unique OIDs. For information about generating unique object IDs, see <a href="../cservers/index.html">Creating CORBA Server Applications</a>.
</p>
<h3 class="pHeading2"><a name="wp1058655"> </a>
Using Factory-based Routing
</h3>
<p class="pBody"><a name="wp1058657"> </a>
Factory-based routing is a CORBA feature that allows you to send a request from a client application to a specific<b class="cBold"> </b>server group. Using factory-based routing, you can spread the processing load for a CORBA application across multiple server machines. The Production sample application uses factory-based routing in the following way:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058658"> </a>Requests from client applications to the <code class="cCode">Registrar</code> object are routed based on the student ID. Requests from student ID 100001 to 100005 go to Production Machine 1. Requests from student ID 100006 to 100010 go to Production Machine 2.</li>
<li><a name="wp1058659"> </a>Requests from the<code class="cCode"> Registrar</code> object to the <code class="cCode">Teller</code> object are routed based on account number. Billing requests for account 200010 to 200014 go to Production Machine 1. Billing requests for account 200015 to 200019 go to Production Machine 2.</li>
</ul></div>
<p class="pBody"><a name="wp1058660"> </a>
For information about setting up factory-based routing, see <a href="../cservers/index.html">Creating CORBA Server Applications</a>.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058662"> </a>
The Development Process for the Production Sample Application
</h2><p class="pBody"><a name="wp1058663"> </a>
This section describes the development process required when scaling a CORBA application. These steps are in addition to the development process outlined in <a href="basic.html">The Basic Sample Application.</a>
</p>
<a name="wp1058667"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The steps in this section have been done for you and are included in the Production sample application.</td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1058669"> </a>
OMG IDL
</h3>
<p class="pBody"><a name="wp1058670"> </a>
During the development process, to support factory-based routing, you would make modifications to the Object Management Group (OMG) Interface Definition Language (IDL) definitions for the following operations:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058671"> </a>The <code class="cCode">find_registrar()</code> operation of the <code class="cCode">RegistrarFactory </code>object to require a <br />student ID.</li>
<li><a name="wp1058672"> </a>The <code class="cCode">find_teller()</code> operation of the <code class="cCode">TellerFactory </code>object to require an account number.</li>
</ul></div>
<p class="pBody"><a name="wp1058673"> </a>
For information about implementing factory-based routing, see <a href="../cservers/index.html">Creating CORBA Server Applications</a>.
</p>
<h3 class="pHeading2"><a name="wp1058676"> </a>
The Client Application
</h3>
<p class="pBody"><a name="wp1058677"> </a>
During the development process, you would specify a <code class="cCode">STU_ID</code> value when creating a <code class="cCode">Registrar</code> object. The <code class="cCode">STU_ID</code> value defines to which server group the request from the client application is routed. 
</p>
<p class="pBody"><a name="wp1058678"> </a>
In the Production sample application, the University server application creates the <code class="cCode">Teller</code> object in the same way a client application would. Therefore, an ACT_NUM<code class="cCode"> </code>value needs to be specified when creating a<code class="cCode"> Teller</code> object.
</p>
<h3 class="pHeading2"><a name="wp1058681"> </a>
The Server Application
</h3>
<p class="pBody"><a name="wp1058682"> </a>
During the development process, you need to modify the invocation to the <code class="cCode">TP::create_object_reference()</code> operation for the <code class="cCode">RegistrarFactory</code> and <code class="cCode">TellerFactory</code> objects to include an <code class="cCode">NVlist</code> that specifies routing criteria. The <code class="cCode">criteria</code> parameter of the <code class="cCode">TP::create_object_reference()</code>operation specifies a list of named values to be used for factory-based routing, as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058683"> </a>The <code class="cCode">RegistrarFactory</code> object in the Production sample application specifies the value for <code class="cCode">criteria</code> to be <code class="cCode">STU_ID</code>.</li>
<li><a name="wp1058684"> </a>The <code class="cCode">TellerFactory</code> object in the Production sample application specifies the value for <code class="cCode">criteria</code> to be ACT_NUM.</li>
</ul></div>
<p class="pBody"><a name="wp1058685"> </a>
The value of the<code class="cCode"> criteria</code> parameter must match exactly the routing criteria name, field, and field type specified in the <code class="cCode">ROUTING</code> section of the <code class="cCode">UBBCONFIG</code> file.
</p>
<p class="pBody"><a name="wp1058686"> </a>
For information about implementing factory-based routing in a factory, see <a href="../cservers/index.html">Creating CORBA Server Applications.</a>
</p>
<h3 class="pHeading2"><a name="wp1058689"> </a>
The UBBCONFIG File
</h3>
<p class="pBody"><a name="wp1058690"> </a>
The <code class="cCode">UBBCONFIG</code> file is the key to achieving scalability in a CORBA application. This section describes how the <code class="cCode">UBBCONFIG </code>file for the Production sample application is modified to:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058691"> </a>Replicate server application processes and server groups</li>
<li><a name="wp1058692"> </a>Implement factory-based routing</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1058695"> </a>
Replicating Server Application Processes and Server Groups
</h4>
<p class="pBody"><a name="wp1058697"> </a>
During the development process, modify the <code class="cCode">UBBCONFIG</code> file in the following way to configure replicated server application processes and server groups:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058698"> </a>In the <code class="cCode">GROUPS</code> section of the <code class="cCode">UBBCONFIG</code> file, specify the names of the groups you want to configure. In the Production sample application, there are four server groups:<code class="cCode"> APP_GRP1</code>, <code class="cCode">APP_GRP2</code>, <code class="cCode">ORA_GRP1</code>, and<code class="cCode"> ORA_GRP2</code>.</li>
<li><a name="wp1058701"> </a>In the <code class="cCode">SERVERS</code> section of the <code class="cCode">UBBCONFIG</code> file, enter the following information for the server application process you want to replicate:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1058702"> </a>A server application name.</li>
<li><a name="wp1058704"> </a>The <code class="cCode">GROUP</code> parameter, which specifies the name of the server group to which the server application process belongs. If you are replicating a server process across multiple groups, specify the server process once for each group.</li>
<li><a name="wp1058706"> </a>The <code class="cCode">SRVID</code> parameter, which specifies a unique administrative ID for the server machine.</li>
<li><a name="wp1058708"> </a>The <code class="cCode">MIN</code> parameter, which specifies the number of instances of the server application process to start when the CORBA application is started. You need to start at least two server application processes.</li>
<li><a name="wp1058710"> </a>The <code class="cCode">MAX</code> parameter, which specifies the maximum number of server application processes that can be running at any one time.You can specify no more than five server application processes.</li>
</ul></div>
</ol></div>
<p class="pBody"><a name="wp1058711"> </a>
The <code class="cCode">MIN</code> and <code class="cCode">MAX</code> parameters determine the degree to which a given server application can process requests in parallel on a given object. During run time, the system administrator can examine resource bottlenecks and start additional server processes, if necessary. In this sense, the application is scaled by the system administrator. 
</p>
<p class="pBody"><a name="wp1058712"> </a>
The following example shows lines from the <code class="cCode">GROUPS</code> and <code class="cCode">SERVERS</code> sections of the <code class="cCode">UBBCONFIG</code> file for the Production sample application. 
</p>
<a name="wp1058713"> </a><div class="pPreformatted"><pre>*GROUPS<br />    APP_GRP1<br />        LMID      = SITE1<br />        GRPNO     = 2<br />        TMSNAME   = TMS<br />    APP_GRP2<br />        LMID      = SITE1<br />        GRPNO     = 3<br />        TMSNAME   = TMS<br />    ORA_GRP1<br />        LMID      = SITE1<br />        GRPNO     = 4<br />        OPENINFO  = &quot;ORACLE_XA:Oracle_XA+Acc=P/scott/tiger+SesTm=100+LogDir<br />                     =.+MaxCur=5&quot;<br />        CLOSEINFO = &quot;&quot;<br />        TMSNAME   = &quot;TMS_ORA&quot;<br />    ORA_GRP2<br />        LMID      = SITE1<br />        GRPNO     = 5<br />        OPENINFO  = &quot;ORACLE_XA:Oracle_XA+Acc=P/scott/tiger+SesTm=100+LogDir<br />                    =.+MaxCur=5&quot;<br />        CLOSEINFO = &quot;&quot;<br />        TMSNAME   = &quot;TMS_ORA&quot;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />*SERVERS<br />    # By default, activate 2 instances of each server<br />    # and allow the administrator to activate up to 5<br />    # instances of each server<br />    DEFAULT:<br />        MIN     = 2<br />        MAX     = 5<br />    tellp_server<br />        SRVGRP  = ORA_GRP1<br />        SRVID   = 10<br />        RESTART = N<br />    tellp_server<br />        SRVGRP  = ORA_GRP2<br />        SRVID   = 10<br />        RESTART = N<br />    billp_server<br />        SRVGRP  = APP_GRP1<br />        SRVID   = 10<br />        RESTART = N<br />    billp_server<br />        SRVGRP  = APP_GRP2<br />        SRVID   = 10<br />        RESTART = N<br />    univp_server<br />        SRVGRP  = ORA_GRP1<br />        SRVID   = 20<br />        RESTART = N<br />    univp_server<br />        SRVGRP  = ORA_GRP2<br />        SRVID   = 20<br />        RESTART = N</pre></div><h4 class="pHeading3"><a name="wp1058717"> </a>
Implementing Factory-based Routing
</h4>
<p class="pBody"><a name="wp1058718"> </a>
For each interface for which you want to enable factory-based routing, you need to define the following information in the <code class="cCode">UBBCONFIG</code> file:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058719"> </a>Details about the data in the routing criteria</li>
<li><a name="wp1058720"> </a>For each kind of criteria, the values that route to specific server groups</li>
</ul></div>
<p class="pBody"><a name="wp1058722"> </a>
During the development process, make the following changes to the <code class="cCode">UBBCONFIG</code> file:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058723"> </a>The <code class="cCode">INTERFACES</code> section lists the names of the interfaces for which you want to enable factory-based routing. For each interface, this section specifies the value on which the interface routes. The routing value is specified in the <code class="cCode">FACTORYROUTING</code> identifier. </li>
<p class="pBodyRelative"><a name="wp1058724"> </a>
The following example shows the <code class="cCode">FACTORYROUTING</code> identifier for the <code class="cCode">Registrar </code>and <code class="cCode">Teller </code>objects in the Production sample application:
</p>
<a name="wp1058725"> </a><div class="pPreformattedRelative"><pre>INTERFACES<br />    &quot;IDL:beasys.com/UniversityP/Registrar:1.0&quot;<br />        FACTORYROUTING = STU_ID<br />    &quot;IDL:beasys.com/BillingP/Teller:1.0&quot;<br />        FACTORYROUTING = ACT_NUM</pre></div><li><a name="wp1058727"> </a>The <code class="cCode">ROUTING</code> section specifies the following data for each routing value:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1058729"> </a>The <code class="cCode">TYPE</code> parameter, which specifies the type of routing. In the Production sample application, the type of routing is factory-based routing. Therefore, this parameter is defined to <code class="cCode">FACTORY.</code></li>
<li><a name="wp1058731"> </a>The <code class="cCode">FIELD</code> parameter, which specifies the name that the factory inserts in the routing value. In the Production sample application, the field parameters are <code class="cCode">student_id</code> and <code class="cCode">account_number</code>.</li>
<li><a name="wp1058733"> </a>The <code class="cCode">FIELDTYPE</code> parameter, which specifies the data type of the routing value. In the Production sample application, the field types for <code class="cCode">STU_ID</code> and <code class="cCode">ACT_NUM</code> are <code class="cCode">long</code>.</li>
<li><a name="wp1058735"> </a>The <code class="cCode">RANGES</code> parameter, which specifies the values that are routed to each group.</li>
<p class="pBodyRelative"><a name="wp1058736"> </a>
The following example shows the <code class="cCode">ROUTING</code> section of the <code class="cCode">UBBCONFIG</code> file used in the Production sample application:
</p>
<a name="wp1058737"> </a><div class="pPreformatted"><pre>*ROUTING<br />    STU_ID<br />        FIELD     = &quot;student_id&quot;<br />        TYPE      = FACTORY<br />        FIELDTYPE = LONG<br />        RANGES    = &quot;100001-100005:ORA_GRP1,100006-100010:ORA_GRP2&quot;<br />    ACT_NUM<br />        FIELD     = &quot;account_number&quot;<br />        TYPE      = FACTORY<br />        FIELDTYPE = LONG<br />        RANGES    = &quot;200010-200014:APP_GRP1,200015-200019:APP_GRP2&quot;</pre></div><p class="pBodyRelative"><a name="wp1058738"> </a>
The example shows that <code class="cCode">Registrar</code> objects for students with IDs 100001 through 100005 are instantiated in <code class="cCode">ORA_GRP1,</code> and students with IDs 100006 through 100010 are instantiated in <code class="cCode">ORA_GRP2.</code>Likewise, <code class="cCode">Teller</code> objects<code class="cCode"> </code>for accounts 200010 through 200014 are instantiated in <code class="cCode">APP_GRP1,</code> and accounts 200015 through 200019 are instantiated in <code class="cCode">APP_GRP2</code>.
</p>
</ul></div>
<li><a name="wp1058739"> </a>The groups specified by the <code class="cCode">RANGES</code> identifier in the <code class="cCode">ROUTING</code> section of the <code class="cCode">UBBCONFIG</code> file need to be identified and configured. For example, the Production sample application specifies four groups: <code class="cCode">ORA_GRP1</code>, <code class="cCode">ORA_GRP2</code>, <code class="cCode">APP_GRP1</code>, and <code class="cCode">APP_GRP2</code>. These groups need to be configured, and the machines on which they run need to be identified. </li>
</ol></div>
<a name="wp1058740"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The names of the server groups in the <code class="cCode">GROUPS</code> section must exactly match the group names specified in the <code class="cCode">ROUTING</code> section.</td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1058742"> </a>
The ICF File
</h3>
<p class="pBody"><a name="wp1058743"> </a>
During the development process, you need to change the activation policy of the <code class="cCode">Registrar</code>, <code class="cCode">RegistrarFactory</code>, <code class="cCode">Teller</code>, and <code class="cCode">TellerFactory</code> objects from process to method.  For information about defining activation and transaction policies for CORBA objects, see <a href="../cservers/index.html">Creating CORBA Server Applications</a>. 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058746"> </a>
Building the Production Sample Application
</h2><p class="pBody"><a name="wp1058747"> </a>
To build the Production sample application, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058748"> </a>Copy the files for the Production sample application into a work directory.</li>
<li><a name="wp1058749"> </a>Change the protection on the files for the Production sample application files.</li>
<li><a name="wp1058750"> </a>Set the environment variables.</li>
<li><a name="wp1058751"> </a>Initialize the University database.</li>
<li><a name="wp1058752"> </a>Load the <code class="cCode">UBBCONFIG</code> file.</li>
<li><a name="wp1058753"> </a>Create a transaction log.</li>
<li><a name="wp1058754"> </a>Build the client and server sample applications.</li>
</ol></div>
<p class="pBody"><a name="wp1058755"> </a>
The following sections describe these steps.
</p>
<a name="wp1062931"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Before you can build or run the Production sample application, you need to complete the steps in <a href="environ.html">Setting Up Your Environment.</a></td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1062936"> </a>
Copying the Files for the Production Sample Application into a Work Directory
</h3>
<p class="pBody"><a name="wp1058762"> </a>
The files for the Production sample application are located in the following directories:
</p>
<p class="pBody"><a name="wp1058763"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058764"> </a>
<code class="cCodeEmphasis">drive</code><code class="cCode">:\</code><code class="cCodeEmphasis">TUXDIR</code><code class="cCode">\samples\corba\university</code>\<code class="cCode">production</code>
</p>
<p class="pBody"><a name="wp1058765"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058766"> </a>
<code class="cCode">/usr/</code><code class="cCodeEmphasis">TUXDIR</code><code class="cCode">/samples/corba/university</code>/<code class="cCode">production</code>
</p>
<p class="pBody"><a name="wp1058767"> </a>
In addition, you need to copy the <code class="cCode">utils </code>directory into your work directory. The <code class="cCode">utils</code> directory contains files that set up logging, tracing, and access to the University database.
</p>
<p class="pBody"><a name="wp1058771"> </a>
You will use the files in <a href="production.html#wp1058778">Table&#160;7-1</a> to create the Production sample application.
</p>
<p class="pGraphic"><a name="wp1058905"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1058778table1058772"><caption><a name="wp1058778"> </a>
Table 7-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Files Included in the Production Sample Application&#160;</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1058782"> </a>
File
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1058784"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058786"> </a>
<code class="cCode">billp.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058788"> </a>
The OMG IDL that declares the<code class="cCode"> Teller</code> and <code class="cCode">TellerFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058790"> </a>
<code class="cCode">univp.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058792"> </a>
The OMG IDL that declares the <code class="cCode">CourseSynopsisEnumerator</code>, <code class="cCode">Registrar</code>, and <code class="cCode">RegistrarFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058794"> </a>
<code class="cCode">billps.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058796"> </a>
The C++ source code for the Billing server application in the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058798"> </a>
<code class="cCode">univps.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058800"> </a>
The C++ source code for the University server application in the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058802"> </a>
<code class="cCode">billp__i.h<br />billp_i.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058804"> </a>
The C++ source code for the method implementations of the <code class="cCode">Teller</code> and <code class="cCode">TellerFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058806"> </a>
<code class="cCode">univp_i.h<br />univp_i.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058808"> </a>
The C++ source code for method implementations of the <code class="cCode">CourseSynopsisEnumerator</code>, <code class="cCode">Registrar</code>, and <code class="cCode">RegistrarFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058810"> </a>
<code class="cCode">univpc.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058812"> </a>
The C++ source code for the CORBA C++ client application in the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058842"> </a>
<code class="cCode">univp_utils.h<br />univp_utils.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058844"> </a>
The files that define database access functions for the CORBA C++ client application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058846"> </a>
<code class="cCode">univp.icf</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058848"> </a>
The Implementation Configuration File (ICF) for the University server application in the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058850"> </a>
<code class="cCode">billp.icf</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058852"> </a>
The ICF file for the Billing server application in the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058854"> </a>
<code class="cCode">tellw_flds, tellw_u.c, tellw_c.h, tellws.ec</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058856"> </a>
The files for the ATMI application Teller.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058858"> </a>
<code class="cCode">setenvp.sh</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058860"> </a>
A UNIX script that sets the environment variables needed to build and run the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058862"> </a>
<code class="cCode">setenvp.cmd</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058864"> </a>
An MS-DOS command procedure that sets the environment variables needed to build and run the Production sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058866"> </a>
<code class="cCode">ubb_p.mk</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058868"> </a>
The<code class="cCode"> UBBCONFIG</code> file for the UNIX operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058870"> </a>
<code class="cCode">ubb_p.nt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058872"> </a>
The<code class="cCode"> UBBCONFIG</code> file for the Windows operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058874"> </a>
<code class="cCode">makefilep.mk</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058876"> </a>
The <code class="cCode">makefile</code> for the Production sample application on the UNIX operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058878"> </a>
<code class="cCode">makefilep.nt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058880"> </a>
The <code class="cCode">makefile</code> for the Production sample application on the Windows operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058882"> </a>
<code class="cCode">log.cpp</code>, <code class="cCode">log.h</code>, <code class="cCode">log_client.cpp</code>, and <code class="cCode">log_server.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058884"> </a>
The files for the client and server applications that provide logging and tracing functions for the sample applications. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058886"> </a>
<code class="cCode">oradbconn.cpp</code> and <code class="cCode">oranoconn.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058888"> </a>
The files that provide access to an Oracle SQL database instance.These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058890"> </a>
<code class="cCode">samplesdb.cpp</code> and <code class="cCode">samplesdb.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058892"> </a>
The files that provide print functions for the database exceptions in the sample applications. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058894"> </a>
<code class="cCode">unique_id.cpp</code> and <code class="cCode">unique_id.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058896"> </a>
C++ Unique ID class routines for the sample applications.These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058898"> </a>
<code class="cCode">samplesdbsql.h</code> and <code class="cCode">samplesdbsql.pc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058900"> </a>
C++ class methods that implement access to the SQL database. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058902"> </a>
<code class="cCode">university.sql</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058904"> </a>
The SQL for the University database. This file is located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1058907"> </a>
Changing the Protection on the Files for the Production Sample Application 
</h3>
<p class="pBody"><a name="wp1058908"> </a>
During the installation of the Oracle Tuxedo software, the sample application files are marked read-only. Before you can edit the files or build the files in the Production sample application, you need to change the protection of the files you copied into your work directory, as follows:
</p>
<p class="pBody"><a name="wp1058909"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058910"> </a>
<code class="cCode">prompt&gt;attrib -r drive:\</code><code class="cCodeEmphasis">workdirectory</code><code class="cCode">\*.*</code>
</p>
<p class="pBody"><a name="wp1058911"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058912"> </a>
<code class="cCode">prompt&gt;chmod u+rw /</code><code class="cCodeEmphasis">workdirectory</code><code class="cCode">/*.*</code>
</p>
<h3 class="pHeading2"><a name="wp1058914"> </a>
Setting the Environment Variables
</h3>
<p class="pBody"><a name="wp1058915"> </a>
Use the following command to set the environment variables used to build the client and server applications in the Production sample application:
</p>
<p class="pBody"><a name="wp1058916"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058917"> </a>
<code class="cCode">prompt&gt;setenvp</code>
</p>
<p class="pBody"><a name="wp1058918"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058919"> </a>
<code class="cCode">prompt&gt;/bin/ksh</code>
</p>
<p class="pBody"><a name="wp1058920"> </a>
<code class="cCode">prompt&gt;. ./setenvp.sh</code>
</p>
<h3 class="pHeading2"><a name="wp1058922"> </a>
Initializing the University Database
</h3>
<p class="pBody"><a name="wp1058923"> </a>
Use the following command to initialize the University database used with the Production sample application:
</p>
<p class="pBody"><a name="wp1058924"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058925"> </a>
<code class="cCode">prompt&gt;nmake -f makefilep.nt initdb</code>
</p>
<p class="pBody"><a name="wp1058926"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058927"> </a>
<code class="cCode">prompt&gt;make -f makefilep.mk initdb</code>
</p>
<h3 class="pHeading2"><a name="wp1058929"> </a>
Loading the UBBCONFIG File
</h3>
<p class="pBody"><a name="wp1058930"> </a>
Use the following command to load the <code class="cCode">UBBCONFIG</code> file:
</p>
<p class="pBody"><a name="wp1058931"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058932"> </a>
<code class="cCode">prompt&gt;tmloadcf -y ubb_p.nt</code>
</p>
<p class="pBody"><a name="wp1058933"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058934"> </a>
<code class="cCode">prompt&gt;tmloadcf -y ubb_p.mk</code>
</p>
<p class="pBody"><a name="wp1058935"> </a>
The build process for the <code class="cCode">UBBCONFIG</code> file prompts you for an application password. This password will be used to log on to the client applications. Enter the password and press Enter. You are then prompted to verify the password by entering it again.
</p>
<h3 class="pHeading2"><a name="wp1058937"> </a>
Creating a Transaction Log
</h3>
<p class="pBody"><a name="wp1058938"> </a>
The transaction log records the transaction activities in a CORBA application. During the development process you need to define the location of the transaction log (specified by the <code class="cCode">TLOGDEVICE</code> parameter) in the <code class="cCode">UBBCONFIG</code> file. For the Production sample application, the transaction log is placed in your work directory. 
</p>
<p class="pBody"><a name="wp1058940"> </a>
You need to complete the following steps to open the transaction log for the Production sample application:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058941"> </a>Enter the following command to start the Interactive Administrative Interface:</li>
<p class="pBodyRelative"><a name="wp1058942"> </a>
<code class="cCode">tmadmin</code>
</p>
<li><a name="wp1058943"> </a>Enter the following command to create a transaction log:</li>
<p class="pBodyRelative"><a name="wp1058944"> </a>
<code class="cCode">crdl -b </code><code class="cCodeEmphasis">blocks</code><code class="cCode"> -z </code><code class="cCodeEmphasis">directorypath<br /></code><code class="cCode">crlog -m SITE1</code>
</p>
<p class="pBodyRelative"><a name="wp1058945"> </a>
where
</p>
<p class="pBodyRelative"><a name="wp1058946"> </a>
<code class="cCodeEmphasis">blocks</code> specifies the number of blocks to be allocated for the transaction log, and <code class="cCodeEmphasis">directorypath</code> indicates the location of the transaction log. The <code class="cCodeEmphasis">directorypath</code> option needs to match the location specified in the <code class="cCode">TLOGDEVICE</code> parameter in the <code class="cCode">UBBCONFIG</code> file. The following is an example of the command on Windows:
</p>
<p class="pBodyRelative"><a name="wp1058947"> </a>
<code class="cCode">crdl -b 500 -z c:\mysamples\university\production\TLOG</code>
</p>
<li><a name="wp1058948"> </a>Enter <code class="cCode">q</code> to quit the Interactive Administrative Interface.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058951"> </a>
Compiling the Production Sample Application
</h2><p class="pBody"><a name="wp1058953"> </a>
During the development process, you would use the<code class="cCode"> buildobjclient</code> and <code class="cCode">buildobjserver</code> commands to build the client and server applications. However, for the Production sample application, this step has been done for you. The directory for the Production sample application contains a <code class="cCode">makefile</code> that builds the client and server sample applications. 
</p>
<p class="pBody"><a name="wp1058956"> </a>
Use the following commands to build the CORBA C++ client and server application in the Production sample application:
</p>
<p class="pBody"><a name="wp1058957"> </a>
<b class="cBold">Windows</b>
</p>
<a name="wp1058958"> </a><div class="pPreformatted"><pre>prompt&gt;nmake -f makefilep.nt</pre></div><p class="pBody"><a name="wp1058959"> </a>
<b class="cBold">UNIX</b>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058972"> </a>
Running the Production Sample Application
</h2><p class="pBody"><a name="wp1058973"> </a>
To run the Production sample application, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058974"> </a>Start the server application.</li>
<li><a name="wp1058975"> </a>Start one or more of the client applications.</li>
</ol></div>
<p class="pBody"><a name="wp1058976"> </a>
The following sections describe these steps in detail.
</p>
<h3 class="pHeading2"><a name="wp1058978"> </a>
Starting the Server Application
</h3>
<p class="pBody"><a name="wp1058979"> </a>
Start the system and sample application server applications in the Production sample application by entering the following command:
</p>
<p class="pBody"><a name="wp1058980"> </a>
<code class="cCode">prompt&gt;tmboot -y</code>
</p>
<p class="pBody"><a name="wp1058981"> </a>
This command starts the following server processes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058982"> </a><code class="cCode">TMSYSEVT</code></li>
<p class="pBodyRelative"><a name="wp1058983"> </a>
The Oracle Tuxedo system EventBroker.
</p>
<li><a name="wp1058984"> </a><code class="cCode">TMFFNAME</code></li>
<p class="pBodyRelative"><a name="wp1058985"> </a>
The transaction management services, including the NameManager and the FactoryFinder services.
</p>
<li><a name="wp1064644"> </a><code class="cCode">TMIFSRVR</code></li>
<p class="pBodyRelative"><a name="wp1064645"> </a>
The Interface Repository server process.
</p>
<p class="pBodyRelative"><a name="wp1064646"> </a>
Four processes of the University server application.
</p>
<li><a name="wp1058990"> </a><code class="cCode">tellp_server</code></li>
<p class="pBodyRelative"><a name="wp1058991"> </a>
Four processes of the ATMI application Teller.
</p>
<li><a name="wp1058992"> </a><code class="cCode">billp_server</code></li>
<p class="pBodyRelative"><a name="wp1058993"> </a>
Four processes of the Billing server application.
</p>
<li><a name="wp1058994"> </a><code class="cCode">ISL</code></li>
<p class="pBodyRelative"><a name="wp1058995"> </a>
The IIOP Listener/Handler process.
</p>
</ul></div>
<p class="pBody"><a name="wp1058996"> </a>
Before using another sample application, enter the following command to stop the system and sample application server processes:
</p>
<p class="pBody"><a name="wp1058997"> </a>
<code class="cCode">prompt&gt;tmshutdown</code>
</p>
<h3 class="pHeading2"><a name="wp1058999"> </a>
Starting the CORBA C++ Client Application
</h3>
<p class="pBody"><a name="wp1059000"> </a>
Start the CORBA C++ client application in the Production sample application by completing the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1059001"> </a>At the MS-DOS prompt, enter the following command:</li>
<p class="pBodyRelative"><a name="wp1059002"> </a>
<code class="cCode">prompt&gt;univp_client</code>
</p>
<li><a name="wp1059003"> </a>At the <code class="cCode">Enter student id: </code>prompt, enter any number between 100001 and 100010. </li>
<li><a name="wp1059004"> </a>Press Enter.</li>
<li><a name="wp1059005"> </a>At the <code class="cCode">Enter domain password:</code> prompt, enter the password you defined when you loaded the<code class="cCode"> UBBCONFIG</code> file.</li>
<li><a name="wp1059006"> </a>Press Enter.</li>
</ol></div>
<a name="wp1059007"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The CORBA C++ client application in the Production sample application works in the A type library. By default, the type library is placed in <code class="cCode">\</code><code class="cCodeEmphasis">TUXDIR</code><code class="cCode">\TypeLibraries.</code></td>
</tr>
</table>

<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1059058"> </a>
How the Production Sample Application Can Be Scaled Further
</h2><p class="pBody"><a name="wp1059059"> </a>
The Production sample application can be scaled even more by:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1059060"> </a>Replicating the server groups in the Production sample application across additional machines.</li>
<p class="pBodyRelative"><a name="wp1059061"> </a>
You need to modify the <code class="cCode">UBBCONFIG</code> file to specify the additional server groups, the server application processes that run in the new server groups, and the server machines on which the server groups run.
</p>
<li><a name="wp1059062"> </a>Changing the factory-based routing tables</li>
<p class="pBodyRelative"><a name="wp1059063"> </a>
For example, instead of routing to the two existing server groups in the Production sample application, you can modify the routing rules in the <code class="cCode">UBBCONFIG</code> file to partition the application further among additional server groups. Any modification to the routing tables must match the information in the <code class="cCode">UBBCONFIG</code> file.
</p>
</ul></div>
<a name="wp1059064"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If you add capacity to an existing CORBA application that uses a database, you must consider how the database is set up, particularly when you are using factory-based routing. For example, if the Production sample application is spread across six machines, the database on each machine must be set up appropriately and in accordance with the routing tables in the <code class="cCode">UBBCONFIG</code> file.</td>
</tr>
</table>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="production.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="wrapper.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq10" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
