<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/usamples/fm/transactions.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:51:49" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>The Transactions Sample Application</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Guide to CORBA University Sample Applications
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="secure.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="wrapper.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/usamples.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1062045"> </a>
The Transactions Sample Application
</h1>
<p class="pBody"><a name="wp1058546"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058550"> </a><a href="transactions.html#wp1058575">How the Transactions Sample Application Works</a></li>
<li><a name="wp1058554"> </a><a href="transactions.html#wp1058601">The Development Process for the Transactions Sample Application</a></li>
<li><a name="wp1058558"> </a><a href="transactions.html#wp1058659">Building the Transactions Sample Application</a></li>
<li><a name="wp1058562"> </a><a href="transactions.html#wp1058856">Compiling the Transactions Sample Application</a></li>
<li><a name="wp1058566"> </a><a href="transactions.html#wp1058881">Running the Transactions Sample Application</a></li>
<li><a name="wp1058570"> </a><a href="transactions.html#wp1058959">Using the Client Applications in the Transactions Sample Application</a></li>
</ul></div>
<a name="wp1062589"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>The Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB were deprecated in Tuxedo 8.1 and are no longer supported. All Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB text references, associated code samples, should only be used to help implement/run third party Java ORB libraries, and for programmer reference only.</td></tr>
</table>

<a name="wp1062590"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>Technical support for third party CORBA Java ORBs should be provided by their respective vendors. Oracle Tuxedo does not provide any technical support or documentation for third party CORBA Java ORBs.</td>
</tr>
</table>
<p class="pBody"><a name="wp1058571"> </a>
For a complete discussion of using transactions in a CORBA application, see <a href="../trans/index.html">Using CORBA Transactions</a>.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058575"> </a>
How the Transactions Sample Application Works
</h2><p class="pBody"><a name="wp1058578"> </a>
In the Transactions sample application, students can register for classes. The operation of registering for courses is executed within the scope of a transaction. The Transactions sample application works in the following way:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058579"> </a>Students submit a list of courses for which they want to be registered.</li>
<li><a name="wp1058580"> </a>For each course in the list, the University server application checks whether:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1058581"> </a>The course is in the database.</li>
<li><a name="wp1058582"> </a>The student is already registered for a course.</li>
<li><a name="wp1058583"> </a>The student exceeds the maximum number of credits the student can take.</li>
</ul></div>
<li><a name="wp1058584"> </a>One of the following occurs:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1058585"> </a>If the course meets all the criteria, the University server application registers the student for the course.</li>
<li><a name="wp1058586"> </a>If the course is not in the database or if the student is already registered for the course, the University server application adds the course to a list of registered courses for which the student could not be registered. After processing all the registration requests, the server application returns the list of courses for which registration failed. The client application prompts the student to either commit the transaction (thereby registering the student for the courses for which registration request succeeded) or to roll back the transaction (thus not registering the student for any of the courses).</li>
<li><a name="wp1058588"> </a>If the student exceeds the maximum number of credits the student can take, the University server application returns a <code class="cCode">TooManyCredits</code> user exception to the client application. The client application provides a brief message explaining that the request was rejected. The client application then rolls back the transaction.</li>
</ul></div>
</ol></div>
<p class="pBody"><a name="wp1058593"> </a>
<a href="transactions.html#wp1058595">Figure&#160;5-1</a> illustrates how the Transactions sample application works.
</p>
<div class="pFigureTitle"><a name="wp1058595"> </a>
Figure&#160;5-1  The Transactions Sample Application
</div>

 
 <p class="pGraphic"><a name="wp1058597"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/transaca.gif" alt="The Transactions Sample Application" id="wp1059551"/></div><p class="pGraphic">

</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058601"> </a>
The Development Process for the Transactions Sample Application
</h2><p class="pBody"><a name="wp1058603"> </a>
This section describes the steps used to add transactions to the Transactions sample application. These steps are in addition to the development process outlined in <a href="basic.html">The Basic Sample Application.</a>
</p>
<a name="wp1058607"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The steps in this section have been done for you and are included in the Transactions sample application.</td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1058609"> </a>
OMG IDL
</h3>
<p class="pBody"><a name="wp1058611"> </a>
During the development process, you would define in Object Management Group (OMG) Interface Definition Language (IDL) the <code class="cCode">register_for_courses() </code>operation for the<code class="cCode"> Registrar</code>. The <code class="cCode">register_for_courses()</code> operation has a parameter, <code class="cCode">NotRegisteredList,</code> which returns to the client application the list of courses for which registration failed. If the value of <code class="cCode">NotRegisteredList</code> is empty, the client application commits the transaction.
</p>
<p class="pBody"><a name="wp1058612"> </a>
You also need to define the <code class="cCode">TooManyCredits</code> user exception.
</p>
<h3 class="pHeading2"><a name="wp1058617"> </a>
The Client Application
</h3>
<p class="pBody"><a name="wp1058620"> </a>
During the development process, you would add the following to your client application:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058622"> </a>The Bootstrap environmental object to obtain a reference to the TransactionCurrent environmental object in the specified Oracle Tuxedo domain.</li>
<li><a name="wp1058624"> </a>The operations of the TransactionCurrent environmental object to include a CORBA object in a transaction.</li>
<li><a name="wp1058625"> </a>A call to the <code class="cCode">register_for_courses()</code> operation so that students can register for courses.</li>
</ul></div>
<p class="pBody"><a name="wp1058626"> </a>
For information about using Transactions in client applications, see <a href="../getstart/index.html">Getting Started with Oracle Tuxedo CORBA Applications</a> and <a href="../trans/index.html">Using CORBA Transactions</a>.
</p>
<h3 class="pHeading2"><a name="wp1058630"> </a>
The University Server Application
</h3>
<p class="pBody"><a name="wp1058631"> </a>
During the development process, you would add the following to the University server application:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058633"> </a>Invocations to the <code class="cCode">TP::open_xa_rm()</code> and <code class="cCode">TP::close_xa_rm()</code> operations in the <code class="cCode">Server::initialize()</code> and <code class="cCode">Server::release() </code>operations of the Server object</li>
<li><a name="wp1058636"> </a>A method implementation for the <code class="cCode">register_for_courses() </code>operation</li>
</ul></div>
<p class="pBody"><a name="wp1058637"> </a>
For information about these tasks, see <a href="../cservers/index.html">Creating CORBA Server Applications</a>.
</p>
<h3 class="pHeading2"><a name="wp1058641"> </a>
The UBBCONFIG File
</h3>
<p class="pBody"><a name="wp1058642"> </a>
During the development process, you need the following in the <code class="cCode">UBBCONFIG</code> file:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058644"> </a>A server group that includes both the University server application and the server application that manages the database. This server group needs to be specified as transactional.</li>
<li><a name="wp1058646"> </a>The <code class="cCode">OPENINFO</code> parameter defined according to the <code class="cCode">XA</code> parameter for the Oracle database. The <code class="cCode">XA </code>parameter for the Oracle database is described in the &quot;Developing and Installing Applications that Use the XA Libraries&quot; section of the <em class="cEmphasis">Oracle7 Server Distributed Systems</em> manual.</li>
</ul></div>
<a name="wp1058647"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If you use a database other than Oracle, refer to the product documentation for information about defining the XA parameter.</td>
</tr>
</table>

<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058649"> </a>The pathname to the transaction log (<code class="cCode">TLOG</code>) in the <code class="cCode">TLOGDEVICE</code> parameter. </li>
</ul></div>
<p class="pBody"><a name="wp1058650"> </a>
For information about the transaction log and defining parameters in the <code class="cCode">UBBCONFIG</code> file, see <a href="../ads/adtask.html">Setting Up an Oracle Tuxedo Application</a>. 
</p>
<h3 class="pHeading2"><a name="wp1058651"> </a>
The ICF File
</h3>
<p class="pBody"><a name="wp1058655"> </a>
During the development process, change the Transaction policy of the <code class="cCode">Registrar </code>object from <code class="cCode">optional</code> to <code class="cCode">always</code>. The <code class="cCode">always </code>Transaction policy indicates that this object must be part of a transaction. For information about defining Transaction policies for CORBA objects, see <a href="../trans/index.html">Using CORBA Transactions</a>.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058659"> </a>
Building the Transactions Sample Application
</h2><p class="pBody"><a name="wp1058660"> </a>
To build the Transactions sample application, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058661"> </a>Copy the files for the Transactions sample application.</li>
<li><a name="wp1058662"> </a>Change the protection on the files for the Transactions sample application files.</li>
<li><a name="wp1058663"> </a>Set the environment variables.</li>
<li><a name="wp1058664"> </a>Initialize the University database.</li>
<li><a name="wp1058665"> </a>Load the <code class="cCode">UBBCONFIG</code> file.</li>
<li><a name="wp1058666"> </a>Create a transaction log.</li>
<li><a name="wp1058667"> </a>Build the client and server sample applications.</li>
</ol></div>
<p class="pBody"><a name="wp1058668"> </a>
The following sections describe these steps.
</p>
<a name="wp1058669"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Before you can build or run the Transactions sample application, you need to complete the steps in <a href="environ.html">Setting Up Your Environment.</a></td>
</tr>
</table>

<h3 class="pHeading2"><a name="wp1058673"> </a>
Copying the Files for the Transactions Sample Application into a Work Directory
</h3>
<p class="pBody"><a name="wp1058676"> </a>
The files for the Transactions sample application are located in the following directories:
</p>
<p class="pBody"><a name="wp1058677"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058678"> </a>
<code class="cCodeEmphasis">drive</code><code class="cCode">:\</code><code class="cCodeEmphasis">TUXDIR</code><code class="cCode">\samples\corba\university</code>\<code class="cCode">transaction</code>
</p>
<p class="pBody"><a name="wp1058679"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058680"> </a>
<code class="cCode">/usr/</code><code class="cCodeEmphasis">TUXDIR</code><code class="cCode">/samples/corba/university</code>/<code class="cCode">transaction</code>
</p>
<p class="pBody"><a name="wp1058681"> </a>
In addition, you need to copy the <code class="cCode">utils </code>directory into your work directory. The <code class="cCode">utils</code> directory contains files that set up logging, tracing, and access to the University database.
</p>
<p class="pBody"><a name="wp1058686"> </a>
You will use the files listed in <a href="transactions.html#wp1058693">Table&#160;5-1</a> to create the Transactions sample application.
</p>
<p class="pGraphic"><a name="wp1058804"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1058693table1058687"><caption><a name="wp1058693"> </a>
Table 5-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Files Included in the Transactions Sample Application&#160;</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1058697"> </a>
File
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1058699"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058701"> </a>
<code class="cCode">univt.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058703"> </a>
The OMG IDL that declares the <code class="cCode">CourseSynopsisEnumerator</code>, <code class="cCode">Registrar</code>, and <code class="cCode">RegistrarFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058705"> </a>
<code class="cCode">univts.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058707"> </a>
The C++ source code for the University server application in the Transactions sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058709"> </a>
<code class="cCode">univt_i.h<br />univt_i.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058711"> </a>
The C++ source code for method implementations of the <code class="cCode">CourseSynopsisEnumerator</code>, <code class="cCode">Registrar</code>, and <code class="cCode">RegistrarFactory</code> interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058713"> </a>
<code class="cCode">univtc.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058715"> </a>
The C++ source code for the CORBA C++ client application in the Transactions sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058749"> </a>
<code class="cCode">univt_utils.h<br />univt_utils.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058751"> </a>
The files that define database access functions for the CORBA C++ client application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058753"> </a>
<code class="cCode">univt.icf</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058755"> </a>
The ICF file for the Transactions sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058757"> </a>
<code class="cCode">setenvt.sh</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058759"> </a>
A UNIX script that sets the environment variables needed to build and run the Transactions sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058761"> </a>
<code class="cCode">setenvt.cmd</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058763"> </a>
An MS-DOS command procedure that sets the environment variables needed to build and run the Transactions sample application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058765"> </a>
<code class="cCode">ubb_t.mk</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058767"> </a>
The <code class="cCode">UBBCONFIG</code> file for the UNIX operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058769"> </a>
<code class="cCode">ubb_t.nt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058771"> </a>
The <code class="cCode">UBBCONFIG</code> file for the Windows operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058773"> </a>
<code class="cCode">makefilet.mk</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058775"> </a>
The <code class="cCode">makefile</code> for the Transactions sample application on the UNIX operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058777"> </a>
<code class="cCode">makefilet.nt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058779"> </a>
The<code class="cCode"> makefile</code> for the Transactions sample application on the Windows operating system.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058781"> </a>
<code class="cCode">log.cpp</code>, <code class="cCode">log.h</code>, <code class="cCode">log_client.cpp</code>, and <code class="cCode">log_server.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058783"> </a>
The client and server applications that provide logging and tracing functions for the sample applications. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058785"> </a>
<code class="cCode">oradbconn.cpp</code> and <code class="cCode">oranoconn.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058787"> </a>
The files that provide access to an Oracle SQL database instance. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058789"> </a>
<code class="cCode">samplesdb.cpp</code> and <code class="cCode">samplesdb.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058791"> </a>
The files that provide print functions for the database exceptions in the sample applications. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058793"> </a>
<code class="cCode">unique_id.cpp</code> and <code class="cCode">unique_id.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058795"> </a>
C++ Unique ID class routines for the sample applications. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058797"> </a>
<code class="cCode">samplesdbsql.h</code> and <code class="cCode">samplesdbsql.pc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058799"> </a>
C++ class methods that implement access to the SQL database. These files are located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058801"> </a>
<code class="cCode">university.sql</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1058803"> </a>
The SQL for the University database. This file is located in the<code class="cCode"> \utils</code> directory.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1058807"> </a>
Changing the Protection on the Files for the Transactions Sample Application 
</h3>
<p class="pBody"><a name="wp1058808"> </a>
During the installation of the Oracle Tuxedo software, the sample application files are marked read-only. Before you can edit the files or build the files in the Transactions sample application, you need to change the protection of the files you copied into your work directory, as follows:
</p>
<p class="pBody"><a name="wp1058809"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058810"> </a>
<code class="cCode">prompt&gt;attrib -r drive:\</code><code class="cCodeEmphasis">workdirectory</code><code class="cCode">\*.*</code>
</p>
<p class="pBody"><a name="wp1058811"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058812"> </a>
<code class="cCode">prompt&gt;chmod u+rw /</code><code class="cCodeEmphasis">workdirectory</code><code class="cCode">/*.*</code>
</p>
<h3 class="pHeading2"><a name="wp1058815"> </a>
Setting the Environment Variables
</h3>
<p class="pBody"><a name="wp1058817"> </a>
Use the following command to set the environment variables used to build the client and server applications in the Transactions sample application:
</p>
<p class="pBody"><a name="wp1058818"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058819"> </a>
<code class="cCode">prompt&gt;setenvt</code>
</p>
<p class="pBody"><a name="wp1058820"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058821"> </a>
<code class="cCode">prompt&gt;/bin/ksh</code>
</p>
<p class="pBody"><a name="wp1058822"> </a>
<code class="cCode">prompt&gt;. ./setenvt.sh</code>
</p>
<h3 class="pHeading2"><a name="wp1058825"> </a>
Initializing the University Database
</h3>
<p class="pBody"><a name="wp1058826"> </a>
Use the following command to initialize the University database used with the Transactions sample application:
</p>
<p class="pBody"><a name="wp1058827"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058828"> </a>
<code class="cCode">prompt&gt;nmake -f makefilet.nt initdb</code>
</p>
<p class="pBody"><a name="wp1058829"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058830"> </a>
<code class="cCode">prompt&gt;make -f makefilet.mk initdb</code>
</p>
<h3 class="pHeading2"><a name="wp1058832"> </a>
Loading the UBBCONFIG File
</h3>
<p class="pBody"><a name="wp1058833"> </a>
Use the following command to load the <code class="cCode">UBBCONFIG</code> file:
</p>
<p class="pBody"><a name="wp1058834"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1058835"> </a>
<code class="cCode">prompt&gt;tmloadcf -y ubb_t.nt</code>
</p>
<p class="pBody"><a name="wp1058836"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1058838"> </a>
<code class="cCode">prompt&gt;tmloadcf -y ubb_t.mk</code>
</p>
<p class="pBody"><a name="wp1058839"> </a>
The build process for the <code class="cCode">UBBCONFIG</code> file prompts you for an application password. This password will be used to log on to the client applications. Enter the password and press Enter. You are then prompted to verify the password by entering it again.
</p>
<h3 class="pHeading2"><a name="wp1058841"> </a>
Creating a Transaction Log
</h3>
<p class="pBody"><a name="wp1058842"> </a>
The transaction log records the transaction activities in a CORBA application. During the development process, you need to define the location of the transaction log (specified by the <code class="cCode">TLOGDEVICE</code> parameter) in the <code class="cCode">UBBCONFIG</code> file. For the Transactions sample application, the transaction log is placed in your work directory. 
</p>
<p class="pBody"><a name="wp1058843"> </a>
To open the transaction log for the Transactions sample application, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058844"> </a>Enter the following command to start the Interactive Administrative Interface:</li>
<p class="pBodyRelative"><a name="wp1058845"> </a>
<code class="cCode">tmadmin</code>
</p>
<li><a name="wp1058846"> </a>Enter the following command to create a transaction log:</li>
<p class="pBodyRelative"><a name="wp1058847"> </a>
<code class="cCode">crdl -b </code><code class="cCodeEmphasis">blocks</code><code class="cCode"> -z </code><code class="cCodeEmphasis">directorypath<br /></code><code class="cCode">clog -m SITE1</code>
</p>
<p class="pBodyRelative"><a name="wp1058848"> </a>
where
</p>
<p class="pBodyRelative"><a name="wp1058849"> </a>
<code class="cCodeEmphasis">blocks</code> specifies the number of blocks to be allocated for the transaction log and <code class="cCodeEmphasis">directorypath</code> indicates the location of the transaction log. The <code class="cCodeEmphasis">directorypath</code> option needs to match the location specified in the <code class="cCode">TLOGDEVICE</code> parameter in the <code class="cCode">UBBCONFIG</code> file. The following is an example of the command on Windows:
</p>
<p class="pBodyRelative"><a name="wp1058850"> </a>
<code class="cCode">crdl -b 500 -z c:\mysamples\university\Transaction\TLOG</code>
</p>
<li><a name="wp1058851"> </a>Enter q to exit the Interactive Administrative Interface.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058856"> </a>
Compiling the Transactions Sample Application
</h2><p class="pBody"><a name="wp1058859"> </a>
During the development process, you would use the<code class="cCode"> buildobjclient</code> and <code class="cCode">buildobjserver</code> commands to build the client and server applications. You would also build a database-specific transaction manager to coordinate the transactional events in the client/server application. However, for the Transactions sample application, this step has been done for you. The directory for the Transactions sample application contains a <code class="cCode">makefile</code> that builds the client and server sample applications and creates a transaction manager called TMS_ORA.
</p>
<a name="wp1058862"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In the <code class="cCode">makefile</code>, the following parameter is hard coded to build a transaction manager for the Oracle database:</td>
</tr>
</table>

<a name="wp1058863"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><code class="cCode">RM=Oracle_XA</code></td>
</tr>
</table>
<a name="wp1058864"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>If you use a database other than Oracle, you need to change this parameter.</td>
</tr>
</table>
<p class="pBody"><a name="wp1058865"> </a>
Use the following commands to build the CORBA C++ client and server applications in the Transactions sample application:
</p>
<p class="pBody"><a name="wp1058866"> </a>
<b class="cBold">Windows</b>
</p>
<a name="wp1058867"> </a><div class="pPreformatted"><pre>prompt&gt;nmake -f makefilet.nt</pre></div><p class="pBody"><a name="wp1058868"> </a>
<b class="cBold">UNIX</b>
</p>
<a name="wp1058869"> </a><div class="pPreformatted"><pre>prompt&gt;make -f makefilet.mk</pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058881"> </a>
Running the Transactions Sample Application
</h2><p class="pBody"><a name="wp1058882"> </a>
To run the Transactions sample application, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058883"> </a>Start the server application.</li>
<li><a name="wp1058884"> </a>Start one or more of the client applications.</li>
</ol></div>
<p class="pBody"><a name="wp1058885"> </a>
These steps are described in the following sections.
</p>
<h3 class="pHeading2"><a name="wp1058887"> </a>
Starting the Server Application
</h3>
<p class="pBody"><a name="wp1058888"> </a>
Start the system and sample application server applications in the Transactions sample application by entering the following command:
</p>
<p class="pBody"><a name="wp1058889"> </a>
<code class="cCode">prompt&gt;tmboot -y</code>
</p>
<p class="pBody"><a name="wp1058890"> </a>
This command starts the following server processes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1058891"> </a><code class="cCode">TMSYSEVT</code></li>
<p class="pBodyRelative"><a name="wp1058892"> </a>
The Oracle Tuxedo system EventBroker.
</p>
<li><a name="wp1058893"> </a><code class="cCode">TMFFNAME</code></li>
<p class="pBodyRelative"><a name="wp1058894"> </a>
The transaction management services, including the NameManager and the FactoryFinder services.
</p>
<li><a name="wp1058895"> </a><code class="cCode">TMIFSRVR</code></li>
<p class="pBodyRelative"><a name="wp1058896"> </a>
The Interface Repository server process.
</p>
<li><a name="wp1058897"> </a><code class="cCode">univt_server</code></li>
<p class="pBodyRelative"><a name="wp1058898"> </a>
The University server process.
</p>
<li><a name="wp1058899"> </a><code class="cCode">ISL</code></li>
<p class="pBodyRelative"><a name="wp1058900"> </a>
The IIOP Listener/Handler process.
</p>
</ul></div>
<p class="pBody"><a name="wp1058901"> </a>
Before using another sample application, enter the following command to stop the system and sample application server processes:
</p>
<p class="pBody"><a name="wp1058902"> </a>
<code class="cCode">prompt&gt;tmshutdown</code>
</p>
<h3 class="pHeading2"><a name="wp1058904"> </a>
Starting the CORBA C++ Client Application
</h3>
<p class="pBody"><a name="wp1058905"> </a>
Start the CORBA C++ client application in the Transactions sample application by completing the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058906"> </a>At the MS-DOS prompt, enter the following command:</li>
<p class="pBodyRelative"><a name="wp1058907"> </a>
<code class="cCode">prompt&gt;univt_client</code>
</p>
<li><a name="wp1058908"> </a>At the <code class="cCode">Enter student id: </code>prompt, enter any number between 100001 and 100010. </li>
<li><a name="wp1058909"> </a>Press Enter.</li>
<li><a name="wp1058910"> </a>At the <code class="cCode">Enter domain password:</code> prompt, enter the password you defined when you loaded the <code class="cCode">UBBCONFIG</code> file.</li>
<li><a name="wp1058911"> </a>Press Enter.</li>
</ol></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1058959"> </a>
Using the Client Applications in the Transactions Sample Application
</h2><p class="pBody"><a name="wp1058960"> </a>
The following sections briefly explain how to use the client applications in the Transactions sample application.
</p>
<h3 class="pHeading2"><a name="wp1058962"> </a>
The CORBA C++ Client Application
</h3>
<p class="pBody"><a name="wp1058963"> </a>
The CORBA C++ client application in the Transactions sample application has the following additional option:
</p>
<a name="wp1058964"> </a><div class="pPreformatted"><pre>&lt;R&gt;    Register for Courses</pre></div><p class="pBody"><a name="wp1058965"> </a>
To register for a course, complete the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1058966"> </a>At the Options prompt, enter R.</li>
<li><a name="wp1058967"> </a>At the <code class="cCode">Course Number</code> prompt, enter a course number followed by -1 . For example:</li>
<p class="pBodyRelative"><a name="wp1058968"> </a>
<code class="cCode">100011<br />100039<br />-1</code>
</p>
<li><a name="wp1058969"> </a>Press Enter.</li>
<li><a name="wp1058970"> </a>At the Options prompt, enter <code class="cCode">L</code> to view a list of courses for which the student ID is registered.</li>
</ol></div>
<p class="pBody"><a name="wp1058971"> </a>
To exit the C++ CORBA client application, enter<code class="cCode"> E</code> at the Options prompt.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="transactions.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="secure.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="wrapper.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
