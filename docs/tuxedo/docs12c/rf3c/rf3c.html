<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="9" />
<meta name="LOC_US_CHANGE" content="41536" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/rf3c/fm/rf3c.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="12/14/11 01:16:12" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Section 3c - C Functions</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">ATMI C Function Reference
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq60" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq61" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq62" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq63" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/rf3c.pdf" target="pdf"><img id="LongDescNotReq64" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq65" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1791310"> </a>
Section 3c - C Functions
</h1>
<p class="pGraphic"><a name="wp1792021"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp2309715table1791312"><caption><a name="wp2309715"> </a>
Table&#160;1  Oracle Tuxedo ATMI C Functions&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp2309719"> </a>
Name
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2309721"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309725"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309728"> </a>
Provides an introduction to the C language ATMI
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309733"> </a>
<a href="rf3c.html#wp1023618"><code class="cCode">AEMsetblockinghook(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309735"> </a>
Establishes an application-specific blocking hook function
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309740"> </a>
<a href="rf3c.html#wp1023907"><code class="cCode">AEOaddtypesw(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309742"> </a>
Installs or replaces a user-defined buffer type at execution time
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309747"> </a>
<a href="rf3c.html#wp1024299"><code class="cCode">AEPisblocked(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309749"> </a>
Determines if a blocking call is in progress
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309754"> </a>
<a href="rf3c.html#wp1025860"><code class="cCode">AEWsetunsol(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309756"> </a>
Posts Windows message for Oracle Tuxedo ATMI unsolicited event
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309761"> </a>
<a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309763"> </a>
Semantics of elements in <code class="cCode">tmtype_sw_t</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309768"> </a>
<a href="rf3c.html#wp1058086"><code class="cCode">catgets(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309770"> </a>
Reads a program message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309775"> </a>
<a href="rf3c.html#wp1059202"><code class="cCode">catopen, catclose(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309777"> </a>
Opens/closes a message catalogue
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309782"> </a>
<a href="rf3c.html#wp1029799"><code class="cCode">decimal(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309784"> </a>
Decimal conversion and arithmetic routines
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309789"> </a>
<a href="rf3c.html#wp1952249"><code class="cCode">getURLEntityCacheDir(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309791"> </a>
Gets the absolute path to the location where the DTD, Schemas, and Entity files are cached. It specifies a particular Xerces parser class method.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309796"> </a>
<a href="rf3c.html#wp1953392"><code class="cCode">getURLEntityCaching(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309798"> </a>
Gets the caching mechanism for the DTD, schemas, and Entity files. It specifies a particular Xerces parser class method.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309803"> </a>
<a href="rf3c.html#wp1031722"><code class="cCode">gp_mktime(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309805"> </a>
Converts a <code class="cCode">tm</code> structure to a calendar time
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309810"> </a>
<a href="rf3c.html#wp1034351"><code class="cCode">nl_langinfo(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309812"> </a>
Language information
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365605"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365607"> </a>
Allocates memory within the RPC stub
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365609"> </a>
<a href="rf3c.html#wp2372321">rpc_sm_client_free, rpc_ss_client_free(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365740"> </a>
 Frees memory returned from a client stub
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365613"> </a>
<a href="rf3c.html#wp2379081">rpc_sm_disable_allocate, rpc_ss_disable_allocate(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365615"> </a>
Releases resources and allocated memory within the stub memory management scheme
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365617"> </a>
<a href="rf3c.html#wp2390190">rpc_sm_enable_allocate, rpc_ss_enable_allocate(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365619"> </a>
Enables the stub memory management environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365621"> </a>
<a href="rf3c.html#wp2397728">rpc_sm_free, rpc_ss_free(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365623"> </a>
Frees memory allocated by the rpc_sm_allocate() routine
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365625"> </a>
<a href="rf3c.html#wp2401504">rpc_sm_set_client_alloc_free, rpc_ss_set_client_alloc_free(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365701"> </a>
 Sets the memory allocation and freeing mechanisms used by the client stubs
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365629"> </a>
<a href="rf3c.html#wp2413978">rpc_sm_swap_client_alloc_free, rpc_ss_swap_client_alloc_free(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2365631"> </a>
Exchanges current memory allocation and freeing mechanism used by client stubs with one supplied by client
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309817"> </a>
<a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309819"> </a>
Modifies and queries a program&#8217;s locale
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309824"> </a>
<a href="rf3c.html#wp1954521"><code class="cCode">setURLEntityCacheDir(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309826"> </a>
Sets the directory where the DTD, schemas, and Entity files are to be cached. It specifies a particular Xerces parser class method.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309831"> </a>
<a href="rf3c.html#wp1955768"><code class="cCode">setURLEntityCaching(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309833"> </a>
Turns caching on or off for DTD, schema, and Entity files by default. It specifies a particular Xerces parser class method.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309838"> </a>
<a href="rf3c.html#wp2144382"><code class="cCode">strerror(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309840"> </a>
Gets error message string
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309845"> </a>
<a href="rf3c.html#wp1062371"><code class="cCode">strftime(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309847"> </a>
Converts date and time to string
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309852"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309854"> </a>
Routine for aborting current transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309859"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309861"> </a>
Routine for sending a service request
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309866"> </a>
<a href="rf3c.html#wp1037464"><code class="cCode">tpadmcall(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309868"> </a>
Administers unbooted application
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309873"> </a>
<a href="rf3c.html#wp1021630"><code class="cCode">tpadvertise(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309875"> </a>
Routine for advertising a service name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309880"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309882"> </a>
Routine for allocating typed buffers
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310518"> </a>
<a href="rf3c.html#wp2320049">tpappthrinit(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310520"> </a>
Routine for creating and initializing a new Tuxedo context in an application-created server thread
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310522"> </a>
<a href="rf3c.html#wp2325705">tpappthrterm(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310524"> </a>
Routine for terminating Tuxedo application-created context in a server process
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309887"> </a>
<a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309889"> </a>
Routine for beginning a transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309894"> </a>
<a href="rf3c.html#wp1039463"><code class="cCode">tpbroadcast(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309896"> </a>
Routine to broadcast notification by name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309901"> </a>
<a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309903"> </a>
Routine for sending service request and awaiting its reply
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309908"> </a>
<a href="rf3c.html#wp1039772"><code class="cCode">tpcancel(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309910"> </a>
Routine for canceling a call descriptor for outstanding reply
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309915"> </a>
<a href="rf3c.html#wp1040017"><code class="cCode">tpchkauth(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309917"> </a>
Routine for checking if authentication required to join an application
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309922"> </a>
<a href="rf3c.html#wp1040306"><code class="cCode">tpchkunsol(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309924"> </a>
Routine for checking for unsolicited message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309929"> </a>
<a href="rf3c.html#wp1040568"><code class="cCode">tpclose(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309931"> </a>
Routine for closing a resource manager
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309936"> </a>
<a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309938"> </a>
Routine for committing current transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309943"> </a>
<a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309945"> </a>
Routine for establishing a conversational service connection
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309950"> </a>
<a href="rf3c.html#wp1037802"><code class="cCode">tpconvert(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309952"> </a>
Converts structures to/from string representations
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309957"> </a>
<a href="rf3c.html#wp1928689"><code class="cCode">tpconvmb(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309959"> </a>
Converts encoding of characters in an input buffer to a named target encoding
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309964"> </a>
<a href="rf3c.html#wp1063533"><code class="cCode">tpcryptpw(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309966"> </a>
Encrypts application password in administrative request
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309971"> </a>
<a href="rf3c.html#wp1041783"><code class="cCode">tpdequeue(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309973"> </a>
Routine to dequeue a message from a queue
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309978"> </a>
<a href="rf3c.html#wp1042150"><code class="cCode">tpdiscon(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309980"> </a>
Routine for taking down a conversational service connection
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309985"> </a>
<a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309987"> </a>
Routine to enqueue a message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309992"> </a>
<a href="rf3c.html#wp1257660"><code class="cCode">tpenvelope(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309994"> </a>
Accesses the digital signature and encryption information associated with a typed message buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2309999"> </a>
<a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310001"> </a>
Gets additional detail about an error generated from the last Oracle Tuxedo ATMI system call 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310006"> </a>
<a href="rf3c.html#wp1480731"><code class="cCode">tpexport(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310008"> </a>
Converts a typed message buffer into an exportable, machine-independent string representation, that includes digital signatures and encryption seals
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310013"> </a>
<a href="rf3c.html#wp1987733"><span class="cHyperlink">
tpfml32toxml(3c)</span></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310015"> </a>
Converts FML32 buffer data to XML buffer data
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310020"> </a>
<a href="rf3c.html#wp2178284"><span class="cHyperlink">
tpfmltoxml(3c)</span></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310022"> </a>
Converts FML buffer data to XML buffer data
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310027"> </a>
<a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310029"> </a>
Routine for forwarding a service request to another service routine
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310034"> </a>
<a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310036"> </a>
Routine for freeing a typed buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310041"> </a>
<a href="rf3c.html#wp2178582"><code class="cCode">tpgblktime(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310043"> </a>
Routine for returning a previously set, per second nontransactional blocktime value
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310048"> </a>
<a href="rf3c.html#wp1064942"><code class="cCode">tpgetadmkey(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310050"> </a>
Gets administrative authentication key
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310062"> </a>
<a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310064"> </a>
Retrieves a context identifier for the current application association
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310069"> </a>
<a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310071"> </a>
Routine for checking if a transaction is in progress
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310076"> </a>
<a href="rf3c.html#wp1930050"><code class="cCode">tpgetmbenc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310078"> </a>
Gets the code-set encoding name from a typed buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310083"> </a>
<a href="rf3c.html#wp2179461">tpgetrepos(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310085"> </a>
Routine for retrieving service and parameter information from a Tuxedo repository file.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310090"> </a>
<a href="rf3c.html#wp1021885"><code class="cCode">tpgetrply(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310092"> </a>
Routine for getting a reply from a previous request
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310097"> </a>
<a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310099"> </a>
Routine for getting a service request priority
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310104"> </a>
<a href="rf3c.html#wp1259847"><code class="cCode">tpimport(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310106"> </a>
Converts an exported representation back into a typed message buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310111"> </a>
<a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310113"> </a>
Joins an application
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310118"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310120"> </a>
Closes a previously opened key handle
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310125"> </a>
<a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310127"> </a>
Gets information associated with a key handle
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310132"> </a>
<a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310134"> </a>
Opens a key handle for digital signature generation, message encryption, or message decryption
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310139"> </a>
<a href="rf3c.html#wp1545991"><code class="cCode">tpkey_setinfo(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310141"> </a>
Sets optional attribute parameters associated with a key handle
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310146"> </a>
<a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310148"> </a>
Routine for sending notification by client identifier
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310153"> </a>
<a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310155"> </a>
Routine for opening a resource manager
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310160"> </a>
<a href="rf3c.html#wp1044210"><code class="cCode">tppost(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310162"> </a>
Posts an event
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310167"> </a>
<a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310169"> </a>
Routine to change the size of a typed buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310174"> </a>
<a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310176"> </a>
Routine for receiving a message in a conversational connection
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310181"> </a>
<a href="rf3c.html#wp1044625"><code class="cCode">tpresume(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310183"> </a>
Resumes a global transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310188"> </a>
<a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310190"> </a>
Routine for returning from a service routine
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310195"> </a>
<a href="rf3c.html#wp2437258"><code class="cCode">tpsblktime(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310197"> </a>
Routine for setting nontransactional blocktime values, in seconds, for the next service call or for all service calls used per context
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438751"> </a>
<a href="rf3c.html#wp1044795">tprmclose(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438753"> </a>
Routines for close a specified RM configured in a multiple RMs server group.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438747"> </a>
<a href="rf3c.html#wp2440145">tprmend(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438749"> </a>
Routines for end current work performed on behalf of a transaction branch in a specified RM.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438743"> </a>
<a href="rf3c.html#wp2444274">tprmopen(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438745"> </a>
Routines for open a specified RM configured in a *RMS section which is associated with a multiple RMs server group.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438739"> </a>
<a href="rf3c.html#wp2446395">tprmstart(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2438741"> </a>
Routines for start work on behalf of a transaction branch of specified RM in a MRM server
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310202"> </a>
<a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310204"> </a>
Routine for setting when <code class="cCode">tpcommit()</code> should return
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310209"> </a>
<a href="rf3c.html#wp1261252"><code class="cCode">tpseal(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310211"> </a>
Marks a typed message buffer for encryption
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310216"> </a>
<a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310218"> </a>
Routine for sending a message in a conversational connection
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310223"> </a>
<a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310225"> </a>
Template for service routines
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310230"> </a>
<a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310232"> </a>
Sets a context identifier for the current application association
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310237"> </a>
<a href="rf3c.html#wp1930111"><code class="cCode">tpsetmbenc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310239"> </a>
Sets the code-set encoding name for a typed buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310244"> </a>
<a href="rf3c.html#wp2183851">tpsetrepos(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310246"> </a>
Adds, edits, or deletes service and parameter information from a Tuxedo Service Metadata repository file
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310251"> </a>
<a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310253"> </a>
Sets the method for handling unsolicited messages
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310258"> </a>
<a href="rf3c.html#wp1261719"><code class="cCode">tpsign(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310260"> </a>
Marks a typed message buffer for digital signature
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310265"> </a>
<a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310267"> </a>
Routine for setting service request priority
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310272"> </a>
<a href="rf3c.html#wp1023204"><code class="cCode">tpstrerror(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310274"> </a>
Gets error message string for an Oracle Tuxedo ATMI system error
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310279"> </a>
<a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310281"> </a>
Gets error detail message string for an Oracle Tuxedo ATMI system
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310286"> </a>
<a href="rf3c.html#wp1045667"><code class="cCode">tpsubscribe(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310288"> </a>
Subscribes to an event
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310293"> </a>
<a href="rf3c.html#wp1045633"><code class="cCode">tpsuspend(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310295"> </a>
Suspends a global transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310300"> </a>
<a href="rf3c.html#wp1023279"><code class="cCode">tpsvrdone(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310302"> </a>
Terminates an Oracle Tuxedo ATMI system server
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310307"> </a>
<a href="rf3c.html#wp1023306"><code class="cCode">tpsvrinit(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310309"> </a>
Initializes an Oracle Tuxedo ATMI system server
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310314"> </a>
<a href="rf3c.html#wp1221377"><code class="cCode">tpsvrthrdone(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310316"> </a>
Terminates an Oracle Tuxedo ATMI server thread
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310321"> </a>
<a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310323"> </a>
Initializes an Oracle Tuxedo ATMI server thread
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310328"> </a>
<a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310330"> </a>
Leaves an application
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310335"> </a>
<a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310337"> </a>
Routine to determine information about a typed buffer
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310342"> </a>
<a href="rf3c.html#wp1045888"><code class="cCode">tpunadvertise(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310344"> </a>
Routine for unadvertising a service name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310349"> </a>
<a href="rf3c.html#wp1045970"><code class="cCode">tpunsubscribe(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310351"> </a>
Unsubscribes to an event
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310356"> </a>
<a href="rf3c.html#wp2186264">tputrace(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310358"> </a>
User-defined routine to provide trace information
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310363"> </a>
<a href="rf3c.html#wp2009111">tpxmltofml32(3c)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310365"> </a>
Converts XML buffer data to FML32 buffer data
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310370"> </a>
<a href="rf3c.html#wp2011500"><span class="cHyperlink">
tpxmltofml(3c)</span></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310372"> </a>
Converts XML buffer data to FML buffer data
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310377"> </a>
<a href="rf3c.html#wp2154415"><code class="cCode">TRY(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310379"> </a>
Exception-returning interface
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310384"> </a>
<a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310386"> </a>
Returns value for environment name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310391"> </a>
<a href="rf3c.html#wp1928429"><code class="cCode">tuxgetmbaconv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310393"> </a>
Gets the value for environment variable <code class="cCode">TPMBACONV</code> in the process environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310398"> </a>
<a href="rf3c.html#wp1928458"><code class="cCode">tuxgetmbenc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310400"> </a>
Gets the code-set encoding name for environment variable <code class="cCode">TPMBENC</code> in the process environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310405"> </a>
<a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310407"> </a>
Changes or adds value to environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310412"> </a>
<a href="rf3c.html#wp1046107"><code class="cCode">tuxreadenv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310414"> </a>
Adds variables to the environment from a file
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310419"> </a>
<a href="rf3c.html#wp1928228"><code class="cCode">tuxsetmbaconv(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310421"> </a>
Sets the value for environment variable <code class="cCode">TPMBACONV</code> in the process environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310426"> </a>
<a href="rf3c.html#wp1928257"><code class="cCode">tuxsetmbenc(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310428"> </a>
Sets the code-set encoding name for environment variable <code class="cCode">TPMBENC</code> in the process environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2461850"> </a>
<br /><a href="rf3c.html#wp2461886">tuxthrputenv(3c)</a>)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2461825"> </a>
Changes or adds an environment variable for the current thread
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310433"> </a>
<a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310435"> </a>
Begins a global transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310440"> </a>
<a href="rf3c.html#wp1046217"><code class="cCode">tx_close(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310442"> </a>
Closes a set of resource managers
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310447"> </a>
<a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310449"> </a>
Commits a global transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310454"> </a>
<a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310456"> </a>
Returns global transaction information
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310461"> </a>
<a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310463"> </a>
Opens a set of resource managers
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310468"> </a>
<a href="rf3c.html#wp1046426"><code class="cCode">tx_rollback(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310470"> </a>
Rolls back a global transaction
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310475"> </a>
<a href="rf3c.html#wp1046490"><code class="cCode">tx_set_commit_return(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310477"> </a>
Sets <code class="cCodeEmphasis">commit_return</code> characteristic
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310482"> </a>
<a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310484"> </a>
Sets <code class="cCodeEmphasis">transaction_control</code> characteristic
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310489"> </a>
<a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310491"> </a>
Sets <code class="cCodeEmphasis">transaction_timeout</code> characteristic
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310496"> </a>
<a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310498"> </a>
Writes a message to the Oracle Tuxedo ATMI system central event log
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310503"> </a>
<a href="rf3c.html#wp1049719"><code class="cCode">Usignal(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310505"> </a>
Signal handling in an Oracle Tuxedo ATMI system environment
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310510"> </a>
<a href="rf3c.html#wp1049777"><code class="cCode">Uunix_err(3c)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2310512"> </a>
Prints UNIX system call error
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1448392"> </a>
Introduction to the C Language Application-to-Transaction Monitor Interface
</h2><h4 class="pHeading3"><a name="wp1299250"> </a>
Description
</h4>
<p class="pBody"><a name="wp1299251"> </a>
The Application-to-Transaction Monitor Interface (ATMI) provides the interface between the application and the transaction processing system. This interface is known as the ATMI interface. It provides function calls to open and close resources, manage transactions, manage typed buffers, and invoke request/response and conversational service calls.
</p>
<h4 class="pHeading3"><a name="wp997276"> </a>
Communication Paradigms
</h4>
<p class="pBody"><a name="wp997287"> </a>
The function calls described in the ATMI reference pages imply a particular model of communication. This model is expressed in terms of how client and server processes can communicate using request and reply messages.
</p>
<p class="pBody"><a name="wp997312"> </a>
There are two basic communication paradigms: request/response and conversational. Request/response services are invoked by service requests along with their associated data. Request/response services can receive exactly one request (upon entering the service routine) and send at most one reply (upon returning from the service routine). Conversational services, on the other hand, are invoked by connection requests along with a means of referring to the open connection (that is, a descriptor used in calling subsequent connection routines). Once the connection has been established and the service routine invoked, either the connecting program or the conversational service can send and receive data as defined by the application until the connection is torn down.
</p>
<p class="pBody"><a name="wp997401"> </a>
Note that a process can initiate both request/response and conversational communication, but cannot accept both request/response and conversational service requests. The following sections describe the two communication paradigms in greater detail.
</p>
<a name="wp1407191"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In various parts of the Oracle Tuxedo documentation we refer to <em class="cEmphasis">threads</em>. When this term is used in a discussion of multithreaded applications, it is self-explanatory. In some instances, however, the term is used in a discussion of a topic that is relevant for both single-threaded and multithreaded applications. In such cases, readers who are running single-threaded applications may assume that the term <em class="cEmphasis">thread</em> refers to an entire process.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1772238"> </a>
Oracle Tuxedo ATMI System Request/<br />Response Paradigm for Client/Server 
</h4>
<p class="pBody"><a name="wp1507326"> </a>
With regard to request/response communication, a client is defined as a process that can send requests and receive replies. By definition, clients cannot receive requests nor send replies. A client can send any number of requests, and can wait for the replies synchronously or receive (some limited number of) the replies at its convenience. In certain cases, a client can send a request that has no reply. <code class="cCode">tpinit()</code> and <code class="cCode">tpterm()</code> allow a client to join and leave an Oracle Tuxedo ATMI system application.
</p>
<p class="pBody"><a name="wp997509"> </a>
A request/response server is a process that can receive one (and only one) service request at a time and send at most one reply to that request. (If the server is multithreaded, however, it can receive multiple requests at one time and issue multiple replies at one time.) While a server is working on a particular request, it can act like a client by initiating request/response or conversational requests and receiving their replies. In such a capacity, a server is called a requester. Note that both client and server processes can be requesters (in fact, a client can be nothing but a requester).
</p>
<p class="pBody"><a name="wp997570"> </a>
A request/response server can forward a request to another request/response server. Here, the server passes along the request it received to another server and does not expect a reply. It is the responsibility of the last server in the chain to send the reply to the original requester. Use of the forwarding routine ensures that the original requester ultimately receives its reply.
</p>
<p class="pBody"><a name="wp997619"> </a>
Servers and service routines offer a structured approach to writing Oracle Tuxedo ATMI system applications. In a server, the application writer can concentrate on the work performed by the service rather than communications details such as receiving requests and sending replies. Because many of the communication details are handled by Oracle Tuxedo ATMI system&#8217;s <code class="cCode">main</code>, the application must adhere to certain conventions when writing a service routine. At the time a server finishes its service routine, it can send a reply using <code class="cCode">tpreturn()</code> or forward the request using <code class="cCode">tpforward()</code>. A service is not allowed to perform any other work nor is it allowed to communicate with any other process after this point. Thus, a service performed by a server is started when a request is received and ended when either a reply is sent or the request is forwarded.
</p>
<p class="pBody"><a name="wp997734"> </a>
Concerning request and reply messages, there is an inherent difference between the two: a request has no associated context before it is sent, but a reply does. For example, when sending a request, the caller must supply addressing information, whereas a reply is always returned to the process that originated the request, that is, addressing context is maintained for a reply and the sender of the reply can exert no control over its destination. The differences between the two message types manifest themselves in the parameters and descriptions of the routines described in <code class="cCode">tpcall()</code>.
</p>
<p class="pBody"><a name="wp997915"> </a>
When a request message is sent, it is sent at a particular priority. The priority affects how a request is dequeued: when a server dequeues requests, it dequeues the one with the highest priority. To prevent starvation, the oldest request is dequeued every so often regardless of priority. By default, a request&#8217;s priority is associated with the service name to which the request is being sent. Service names can be given priorities at configuration time (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a>). A default priority is used if none is defined. In addition, the priority can be set at run time using a routine, <code class="cCode">tpsprio()</code>. By doing so, the caller can override the configuration or default priority when the message is sent.
</p>
<h4 class="pHeading3"><a name="wp997936"> </a>
Oracle Tuxedo ATMI System Conversational Paradigm for Client/Server 
</h4>
<p class="pBody"><a name="wp997947"> </a>
With regard to conversational communication, a client is defined as a process that can initiate a conversation but cannot accept a connection request.
</p>
<p class="pBody"><a name="wp997966"> </a>
A conversational server is a process that can receive connection requests. Once the connection has been established and the service routine invoked, either the connecting program or the conversational service can send and receive data as defined by the application until the connection is torn down. The conversation is half-duplex in nature such that one side of the connection has control and can send data until it gives up control to the other side. In a single-threaded server, while the connection is established, the server is &#8220;reserved&#8221; such that no other process can establish a connection with it. When a connection is established to a multithreaded server, however, that server is not reserved for exclusive use by one process. Instead, it can accept requests from multiple client threads.
</p>
<p class="pBody"><a name="wp1245280"> </a>
As with a request/response server, the conversational server can act as a requester by initiating other requests or connections with other servers. Unlike a request/response server, a conversational server cannot forward a request to another server. Thus, a conversational service performed by a server is started when a request is received and ended when the final reply is sent via <code class="cCode">tpreturn()</code>.
</p>
<p class="pBody"><a name="wp998077"> </a>
Once the connection is established, the connection descriptor implies any context needed regarding addressing information for the participants. Messages can be sent and received as needed by the application. There is no inherent difference between the request and reply messages and no notion of priority of messages.
</p>
<h4 class="pHeading3"><a name="wp998108"> </a>
Message Delivery
</h4>
<p class="pBody"><a name="wp1011864"> </a>
Sending and receiving messages, whether in conversation mode or request/response mode, implies communication between two units of an application. The great majority of messages lead to a reply or at least an acknowledgment, so that is an assurance that the message was received. There are, however, certain messages (some originated by the system, others originated by an application) where a reply or acknowledgment is not expected. For example, the system can send an unsolicited message using <code class="cCode">tpnotify()</code> without the <code class="cCode">TPACK()</code> flag, or an application can send a message using <code class="cCode">tpacall()</code> with the <code class="cCode">TPNOREPLY()</code> flag. If the message queue of the receiving program is full, the message is dropped.
</p>
<p class="pBody"><a name="wp1011871"> </a>
If the sending and receiving side are on different machines, the communication takes place between bridge processes that send and receive messages across a network. This raises the additional possibility of non-delivery due to a circuit failure. Even when either of these conditions leads to the positing of an event or to a <code class="cCode">ULOG</code> message, it is not easy to associate the event or <code class="cCode">ULOG</code> message with the non-arrival of a particular message.
</p>
<p class="pBody"><a name="wp1011877"> </a>
Because the Oracle Tuxedo ATMI system is designed to handle large volumes of messages across broad networks, it is not programmed to detect and correct the small percentage of failures-to-deliver described in the preceding paragraphs. For that reason, there can be no guarantee that every message will be delivered.
</p>
<h4 class="pHeading3"><a name="wp1011791"> </a>
Message Sequencing
</h4>
<p class="pBody"><a name="wp1011946"> </a>
In the conversational model, for messages being exchanged using <code class="cCode">tpsend()</code> and <code class="cCode">tprecv()</code>, a sequence number is added to the message header and messages are received in the order in which they are sent. If a server or client gets a message out of order, the conversation is stopped, any transaction in progress is rolled back, and message <code class="cCode">1572</code> in <code class="cCode">LIBTUX</code>, &#8220;<code class="cCode">Bad Conversational Sequence Number</code>,&#8221; is logged.
</p>
<p class="pBody"><a name="wp1011953"> </a>
In the Request/Response model, messages are not sequenced by the system. If the application logic implies a sequence, it is the responsibility of the application to monitor and control it. The parallel message transmission made possible by the support of multiple network addresses for bridge processes increases the possibility that messages will not be received in the order sent. An application that is concerned about this may choose to specify a single network address for each bridge process, add sequence numbers to their messages or require periodic acknowledgments.
</p>
<h4 class="pHeading3"><a name="wp1011724"> </a>
Queued Message Model
</h4>
<p class="pBody"><a name="wp998166"> </a>
The Oracle Tuxedo ATMI system queued message model allows for enqueuing a request message to stable storage for subsequent processing without waiting for its completion, and optionally getting a reply via a queued response message. The ATMI functions that queue messages and dequeue responses are <code class="cCode">tpenqueue()</code> and <code class="cCode">tpdequeue()</code>. They can be called from any type of Oracle Tuxedo ATMI system application processes: client, server, or conversational. The functions <code class="cCode">tpenqueue()</code> and <code class="cCode">tpdequeue()</code> can also be used for peer-to-peer communication where neither the enqueuing application nor the dequeuing application are designated as server or client.
</p>
<p class="pBody"><a name="wp998187"> </a>
The queued message facility is an XA-compliant resource manager. Persistent messages are enqueued and dequeued within transactions to ensure one-time-only processing.
</p>
<h4 class="pHeading3"><a name="wp998218"> </a>
ATMI Transactions
</h4>
<p class="pBody"><a name="wp998266"> </a>
The Oracle Tuxedo ATMI system supports two sets of mutually exclusive functions for defining and managing transactions: the Oracle Tuxedo system&#8217;s ATMI transaction demarcation functions (the names of which include the prefix <code class="cCode">tp</code>) and X/Open&#8217;s TX Interface functions (the names of which include the prefix <code class="cCode">tx_</code>). Because X/Open used ATMI&#8217;s transaction demarcation functions as the base for the TX Interface, the syntax and semantics of the TX Interface are quite similar to those of the ATMI. This section is an overview of ATMI transaction concepts. The next section introduces additional concepts about the TX Interface.
</p>
<p class="pBody"><a name="wp998305"> </a>
In the Oracle Tuxedo ATMI system, a <em class="cEmphasis">transaction</em> is used to define a single logical unit of work that either wholly succeeds or has no effect whatsoever. A transaction allows work performed in many processes, possibly at different sites, to be treated as an atomic unit of work. The initiator of a transaction normally uses <code class="cCode">tpbegin()</code> and either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> to delineate the operations within a transaction.
</p>
<p class="pBody"><a name="wp998366"> </a>
The initiator may also suspend its work on the current transaction by issuing <code class="cCode">tpsuspend()</code>. Another process may take over the role of the initiator of a suspended transaction by issuing <code class="cCode">tpresume()</code>. As a transaction initiator, a process must call one of the following: <code class="cCode">tpsuspend()</code>, <code class="cCode">tpcommit()</code>, or <code class="cCode">tpabort()</code>. Thus, one process can start a transaction that another may finish.
</p>
<p class="pBody"><a name="wp998429"> </a>
If a process calling a service is in transaction mode, then the called service routine is also placed in transaction mode on behalf of the same transaction. Otherwise, whether the service is invoked in transaction mode or not depends on options specified for the service in the configuration file. A service that is not invoked in transaction mode can define multiple transactions between the time it is invoked and the time it ends. On the other hand, a service routine invoked in transaction mode can participate in only one transaction, and work on that transaction is completed upon termination of the service routine. Note that a connection cannot be upgraded to transaction mode: if <code class="cCode">tpbegin()</code> is called while a conversation exists, the conversation remains outside of the transaction (as if <code class="cCode">tpconnect()</code> had been called with the <code class="cCode">TPNOTRAN()</code> flag).
</p>
<p class="pBody"><a name="wp998549"> </a>
A service routine joining a transaction that was started by another process is called a <em class="cEmphasis">participant</em>. A transaction can have several participants. A service can be invoked to do work on the same transaction more than once. Only the initiator of a transaction (that is, a process calling either <code class="cCode">tpbegin()</code> or <code class="cCode">tpresume()</code>) can call <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. Participants influence the outcome of a transaction by using <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. These two calls signify the end of a service routine and indicate that the routine has finished its part of the transaction.
</p>
<h4 class="pHeading3"><a name="wp1618418"> </a>
TX Transactions
</h4>
<p class="pBody"><a name="wp998675"> </a>
Transactions defined by the TX Interface are practically identical with those defined by the ATMI functions. An application developer may use either set of functions when writing clients and service routines, but should not intermingle one set of functions with the other within a single process (that is, a process cannot call <code class="cCode">tpbegin()</code> and later call <code class="cCode">tx_commit()</code>).
</p>
<p class="pBody"><a name="wp998736"> </a>
The TX Interface has two calls for opening and closing resource managers in a portable manner, <code class="cCode">tx_open()</code> and <code class="cCode">tx_close()</code>, respectively. Transactions are started with <code class="cCode">tx_begin()</code> and completed with either <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code>. <code class="cCode">tx_info()</code> is used to retrieve transaction information, and there are three calls to set options for transactions: <code class="cCode">tx_set_commit_return()</code>, <code class="cCode">tx_set_transaction_control()</code>, and <code class="cCode">tx_set_transaction_timeout()</code>. The TX Interface has no equivalents to ATMI&#8217;s <code class="cCode">tpsuspend()</code> and <code class="cCode">tpresume()</code>.
</p>
<p class="pBody"><a name="wp998849"> </a>
In addition to the semantics and rules defined for ATMI transactions, the TX Interface has some additional semantics that are worth introducing here. First, service routine writers wanting to use the TX Interface must supply their own <code class="cCode">tpsvrinit()</code> routine that calls <code class="cCode">tx_open()</code>. The default Oracle Tuxedo ATMI system-supplied <code class="cCode">tpsvrinit()</code> calls <code class="cCode">tpopen()</code>. The same rule applies for <code class="cCode">tpsvrdone()</code>: if the TX Interface is being used, then service routine writers must supply their own <code class="cCode">tpsvrdone()</code> that calls <code class="cCode">tx_close()</code>.
</p>
<p class="pBody"><a name="wp998944"> </a>
Second, the TX Interface has two additional semantics not found in ATMI. These are chained and unchained transactions, and transaction characteristics.
</p>
<h4 class="pHeading3"><a name="wp998957"> </a>
Chained and Unchained Transactions
</h4>
<p class="pBody"><a name="wp998968"> </a>
The TX Interface supports chained and unchained modes of transaction execution. By default, clients and service routines execute in the unchained mode; when an active transaction is completed, a new transaction does not begin until <code class="cCode">tx_begin()</code> is called.
</p>
<p class="pBody"><a name="wp999009"> </a>
In the chained mode, a new transaction starts implicitly when the current transaction completes. That is, when <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code> is called, the Oracle Tuxedo ATMI system coordinates the completion of the current transaction and initiates a new transaction before returning control to the caller. (Certain failure conditions may prevent a new transaction from starting.)
</p>
<p class="pBody"><a name="wp999064"> </a>
Clients and service routines enable or disable the chained mode by calling <code class="cCode">tx_set_transaction_control()</code>. Transitions between the chained and unchained mode affect the behavior of the next <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code> call. The call to <code class="cCode">tx_set_transaction_control()</code> does not put the caller into or take it out of transaction mode.
</p>
<p class="pBody"><a name="wp999123"> </a>
Since <code class="cCode">tx_close()</code> cannot be called when the caller is in transaction mode, a caller executing in chained mode must switch to unchained mode and complete the current transaction before calling <code class="cCode">tx_close()</code>.
</p>
<h4 class="pHeading3"><a name="wp999160"> </a>
Transaction Characteristics
</h4>
<p class="pBody"><a name="wp999171"> </a>
A client or a service routine may call <code class="cCode">tx_info()</code> to obtain the current values of their transaction characteristics and to determine whether they are executing in transaction mode.
</p>
<p class="pBody"><a name="wp999196"> </a>
The state of an application process includes several transaction characteristics. The caller specifies these by calling <code class="cCode">tx_set_*()</code> functions. When a client or a service routine sets the value of a characteristic, it remains in effect until the caller specifies a different value. When the caller obtains the value of a characteristic via <code class="cCode">tx_info()</code>, it does not change the value.
</p>
<h4 class="pHeading3"><a name="wp1012074"> </a>
Error Handling
</h4>
<p class="pBody"><a name="wp1012133"> </a>
Most of the ATMI functions have one or more error returns. An error condition is indicated by an otherwise impossible returned value. This is usually -1 or error, or 0 for a bad field identifier (<code class="cCode">BADFLDID</code>) or address. The error type is also made available in the external integer <code class="cCode">tperrno</code>. <code class="cCode">tperrno</code> is not cleared on successful calls, so it should be tested only after an error has been indicated.
</p>
<p class="pBody"><a name="wp1397857"> </a>
The <code class="cCode">tpstrerror()</code> function is provided to produce a message on the standard error output. It takes one argument, an integer (found in <code class="cCode">tperrno</code>) and returns a pointer to the text of an error message in <code class="cCode">LIBTUX_CAT</code>. The pointer can be used as an argument to <code class="cCode">userlog()</code>.
</p>
<p class="pBody"><a name="wp1012142"> </a>
<code class="cCode">tperrordetail()</code> can be used as the first step of a three step procedure to get additional detail about an error in the most recent Oracle Tuxedo ATMI system call on the current thread. <code class="cCode">tperrordetail()</code> returns an integer which is then used as an argument to <code class="cCode">tpstrerrordetail()</code> to retrieve a pointer to a string that contains the error message. The pointer can then be used as an argument to <code class="cCode">userlog</code> or to <code class="cCode">fprintf()</code>.
</p>
<p class="pBody"><a name="wp1012154"> </a>
The error codes that can be produced by an ATMI function are described on each ATMI reference page. The <code class="cCode">F_error()</code> and <code class="cCode">F_error32()</code> functions are provided to produce a message on the standard error output for FML errors. They take one parameter, a string; print the argument string appended with a colon and a blank; and then print an error message followed by a newline character. The error message displayed is the one defined for the error number currently in <code class="cCode">Ferror()</code> or <code class="cCode">Ferror32()</code>, which is set when errors occur.
</p>
<p class="pBody"><a name="wp1012212"> </a>
<code class="cCode">Fstrerror()</code>, and its counterpart, <code class="cCode">Fstrerror32()</code>, can be used to retrieve the text of an FML error message from a message catalog; it returns a pointer that can be used as an argument to <code class="cCode">userlog</code>.
</p>
<p class="pBody"><a name="wp1012218"> </a>
The error codes that can be produced by an FML function are described on each FML reference page.
</p>
<h4 class="pHeading3"><a name="wp999257"> </a>
Timeouts
</h4>
<p class="pBody"><a name="wp999421"> </a>
There are three types of timeouts in the Oracle Tuxedo ATMI system: one is associated with the duration of a transaction from start to finish. A second is associated with the maximum length of time a blocking call will remain blocked before the caller regains control. The third is a service timeout and occurs when a call exceeds the number of seconds specified in the <code class="cCode">SVCTIMEOUT</code> parameter in the <code class="cCode">SERVICES</code> section of the configuration file.
</p>
<p class="pBody"><a name="wp1012068"> </a>
The first kind of timeout is specified when a transaction is started with <code class="cCode">tpbegin()</code>. (See <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a> for details.) The second kind of timeout can occur when using the Oracle Tuxedo ATMI system communication routines defined in <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>. Callers of these routines typically block when awaiting a reply that has yet to arrive, although they can also block trying to send data (for example, if request queues are full). The maximum amount of time a caller remains blocked is determined by an Oracle Tuxedo ATMI system configuration file parameter. (See the <code class="cCode">BLOCKTIME</code> parameter in <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details.)
</p>
<p class="pBody"><a name="wp1012069"> </a>
Blocking timeouts are performed by default when the caller is not in transaction mode. When a client or server is in transaction mode, it is subject to the timeout value with which the transaction was started and is not subject to the blocking timeout value specified in the <code class="cCode">UBBCONFIG</code> file.
</p>
<p class="pBody"><a name="wp999488"> </a>
When a transaction timeout occurs, replies to asynchronous requests made in transaction mode become invalid. That is, if a process is waiting for a particular asynchronous reply for a request sent in transaction mode and a transaction timeout occurs, the descriptor for that reply becomes invalid. Similarly, if a transaction timeout occurs, an event is generated on the connection descriptor associated with the transaction and that descriptor becomes invalid. On the other hand, if a blocking timeout occurs, the descriptor is still valid and the waiting process can reissue the call to await the reply.
</p>
<p class="pBody"><a name="wp1012335"> </a>
The service timeout mechanism provides a way for the system to kill processes that may be frozen by some unknown or unexpected system error. When a service timeout occurs in a request/response service, the Oracle Tuxedo ATMI system kills the server process that is executing the frozen service and returns error code <code class="cCode">TPESVCERR</code>. If a service timeout occurs in a conversational service, the <code class="cCode">TP_EVSVCERR</code> event is returned.
</p>
<p class="pBody"><a name="wp1613903"> </a>
If a transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">tpacall()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</p>
<p class="pBody"><a name="wp1773297"> </a>
Since release 6.4, some additional detail has been provided beyond the <code class="cCode">TPESVCERR</code> error code. If a service fails due to exceeding the timeout threshold, an event,<code class="cCode"> .SysServiceTimeout</code>, is posted.
</p>
<h4 class="pHeading3"><a name="wp999569"> </a>
Dynamic Service Advertisements
</h4>
<p class="pBody"><a name="wp999580"> </a>
By default, a server&#8217;s services are advertised when it is booted and unadvertised when it is shut down. If a server needs to control the set of services that it offers at run time, it can do so by calling <code class="cCode">tpadvertise()</code> and <code class="cCode">tpunadvertise()</code>. These routines affect only the services offered by the calling server unless that server belongs to a Multiple Server, Single Queue (MSSQ) set. Because all servers in an MSSQ set must offer the same set of services, these routines also affect the advertisements of all servers sharing the caller&#8217;s MSSQ set.
</p>
<h4 class="pHeading3"><a name="wp999653"> </a>
Buffer Management
</h4>
<p class="pBody"><a name="wp999664"> </a>
Initially, a process has no buffers. Before sending a message, a buffer must be allocated using <code class="cCode">tpalloc()</code>. The sender&#8217;s data can then be placed in the buffer and sent. This buffer has a specific structure. The particular structure is denoted by the <code class="cCodeEmphasis">type</code> argument to the <code class="cCode">tpalloc()</code> function. Since some structures can need further classification, a subtype can also be given (for example, a particular type of C structure).
</p>
<p class="pBody"><a name="wp999730"> </a>
When receiving a message, a buffer is required into which application data can be received. This buffer must be one originally gotten from <code class="cCode">tpalloc()</code>. Note that an Oracle Tuxedo ATMI system server, in its <code class="cCode">main</code>, allocates a buffer whose address is passed to a request/response or conversational service upon invoking the service. (See <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a> for details on how this buffer is treated.)
</p>
<p class="pBody"><a name="wp999792"> </a>
Buffers used for receiving messages are treated slightly differently than those used for sending: the size and address usually change upon receipt of a message, since the system internally swaps the buffer passed into the receive call with internal buffers it used to process the buffer. A buffer may grow or shrink when it receives data. Whether it grows or shrinks depends on the amount of data sent by the sender, and the internal data flow needed to get the data from sender to receiver. Many factors can affect the buffer size, including compression, receiving a message from a different type of machine, and the action of the <code class="cCode">postrecv()</code> function for the type of buffer being used (see <a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a>). The buffer sizes in Workstation clients are usually different from those in native clients.
</p>
<p class="pBody"><a name="wp1012393"> </a>
It is best to think of the receive buffer as a placeholder, rather than the actual container that will receive the message. The system sometimes uses the size of the buffer you pass as a hint, so it does help if it is big enough to hold the expected reply.
</p>
<p class="pBody"><a name="wp1012399"> </a>
On the sending side, buffer types that might be filled to less than their allocated capacity (for example, FML or STRING buffers) send only the amount used. A 100K FML32 buffer with one integer field in it is sent as a much smaller buffer, containing only that integer.
</p>
<p class="pBody"><a name="wp1012405"> </a>
This means that the receiver will receive a buffer smaller than what was originally allocated by the sender, yet larger than the data that was sent. For example, if a STRING buffer of 10K bytes is allocated, and the string &#8220;HELLO&#8221; is copied into it, only the six bytes are sent, and the receiver will probably end up with a buffer that is around 1K or 4K bytes. (It may be larger or smaller, depending on other factors.) The Oracle Tuxedo ATMI system guarantees only that a received message will contain all of the data that was sent; it does not guarantee that the message will contain all the free space it originally contained.
</p>
<p class="pBody"><a name="wp1012411"> </a>
The process receiving the reply is responsible for noting size changes in the buffer (using <code class="cCode">tptypes()</code>) and reallocating the buffer if necessary. All Oracle Tuxedo ATMI functions change a receiver&#8217;s buffer return information about the amount of data in the buffer, so it should become standard practice to check the buffer size every time a reply is received. 
</p>
<p class="pBody"><a name="wp999889"> </a>
One can send and receive messages using the same data buffer. Alternatively, a different data buffer can be allocated for each message. It is usually the responsibility of the calling process to free its buffers by invoking <code class="cCode">tpfree()</code>. However, in limited cases, the Oracle Tuxedo ATMI system frees the caller&#8217;s buffer. For more information about buffer usage, see the descriptions of communication functions such as <code class="cCode">tpfree()</code>.
</p>
<h4 class="pHeading3"><a name="wp999944"> </a>
Buffer Type Switch
</h4>
<p class="pBody"><a name="wp1000062"> </a>
The <code class="cCode">tmtype_sw_t</code> structure provides the description required when adding new buffer types to <code class="cCode">tm_typesw()</code>, the buffer type switch for a process. The switch elements are defined in <a href="../rf5/rf5.html">typesw(5)</a>. The function names used in this entry are templates for the actual function names defined by the Oracle Tuxedo ATMI system or by applications in which custom buffer types are created. These function names can be mapped easily to switch elements: to create a template name simply add the prefix  <code class="cCode">_tm</code> to the element name of a function pointer. For example, the template name for the element <code class="cCode">initbuf</code> is <code class="cCode">_tminitbuf</code>.
</p>
<p class="pBody"><a name="wp1000110"> </a>
The <code class="cCode">type</code> element must be non-NULL and at most 8 characters in length. If this element is not unique in the switch, then <code class="cCode">subtype()</code> must be non-NULL.
</p>
<p class="pBody"><a name="wp1021385"> </a>
The <code class="cCode">subtype()</code> element can be NULL, a string of at most 16 characters, or * (the wildcard character). The combination of <code class="cCode">type()</code> and <code class="cCode">subtype()</code> must uniquely identify an element in the switch.
</p>
<p class="pBody"><a name="wp1000185"> </a>
A given type can have multiple subtypes. If all subtypes are to be treated the same for a given type, then the wildcard character, &#8220;*&#8221;, can be used. Note that the <code class="cCode">tptypes()</code> function can be used to determine a buffer&#8217;s type and subtype if subtypes need to be distinguished. If some subset of the subtypes within a particular type are to be treated individually, and the rest are to be treated identically, then those that are to be singled out with specific subtype values should appear in the switch before the subtype designated with the wildcard. Thus, searching for types and subtypes in the switch is done from top to bottom, and the wildcard subtype entry accepts any &#8220;leftover&#8221; type matches.
</p>
<p class="pBody"><a name="wp1000451"> </a>
The <code class="cCode">dfltsize()</code> element is used when allocating or reallocating a buffer. The semantics of <code class="cCode">tpalloc()</code> and <code class="cCode">tprealloc()</code> are such that the larger of the following two values is used to create or reallocate a buffer: the value of <code class="cCode">dfltsize()</code> or the value of the <code class="cCodeEmphasis">size</code> parameter for the <code class="cCode">tpalloc()</code> and <code class="cCode">tprealloc()</code> functions. For some types of structures, such as a fixed-sized C structure, the buffer size should equal the size of the structure. If <code class="cCode">dfltsize()</code> is set to this value, then the caller may not need to specify the buffer&#8217;s length to routines in which a buffer is passed. <code class="cCode">dfltsize()</code> can be 0 or less. However, if <code class="cCode">tpalloc()</code> or <code class="cCode">tprealloc()</code> is called and the <code class="cCodeEmphasis">size</code> parameter for the function being called is also less than or equal to 0, then the routine will fail. We recommend setting <code class="cCode">dfltsize()</code> to a value greater than 0.
</p>
<p class="pBody"><a name="wp1000525"> </a>
The Oracle Tuxedo ATMI system provides five basic buffer types: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1402771"> </a><code class="cCode">CARRAY</code>&#8212;a character array, possibly containing NULL characters, which is neither encoded nor decoded during transmission</li>
<li><a name="wp1402772"> </a><code class="cCode">STRING</code>&#8212;a NULL-terminated character array</li>
<li><a name="wp1402777"> </a><code class="cCode">FML</code>&#8212;fielded buffers (<code class="cCode">FML</code> or <code class="cCode">FML32</code>)</li>
<li><a name="wp1406825"> </a><code class="cCode">XML</code>&#8212;XML document or datagram buffer</li>
<li><a name="wp1402778"> </a><code class="cCode">VIEW</code>&#8212;simple C structures (<code class="cCode">VIEW</code> or <code class="cCode">VIEW32</code>); all views are handled by the same set of routines. The name of a particular view is its subtype name.</li>
</ul></div>
<p class="pBody"><a name="wp1000659"> </a>
Two of these buffer types have synonyms: <code class="cCode">X_OCTET</code> is a synonym for <code class="cCode">CARRAY</code>, and both <code class="cCode">X_C_TYPE</code> and <code class="cCode">X_COMMON</code> are synonyms for <code class="cCode">VIEW</code>. <code class="cCode">X_C_TYPE</code> supports all the same elements as <code class="cCode">VIEW</code>, whereas <code class="cCode">X_COMMON</code> supports only longs, shorts, and characters. <code class="cCode">X_COMMON</code> should be used when both C and COBOL programs are communicating.
</p>
<p class="pBody"><a name="wp1000773"> </a>
An application wishing to supply its own buffer type can do so by adding an instance to the <code class="cCode">tm_typesw()</code> array. Whenever adding or deleting a buffer type, be careful to leave a NULL entry at the end of the array. Note that a buffer type with a NULL name is not permitted. An application client or server is linked with the new buffer type switch by explicitly specifying the name of the source or object file on the <code class="cCode">buildserver()</code> or <code class="cCode">buildclient()</code> command line using the <code class="cCode">-f</code> option.
</p>
<h4 class="pHeading3"><a name="wp1000784"> </a>
Unsolicited Notification
</h4>
<p class="pBody"><a name="wp1000795"> </a>
There are two methods for sending messages to application clients outside the boundaries of the client/server interaction defined above. The first is the broadcast mechanism supported by <code class="cCode">tpbroadcast()</code>. This function allows application clients, servers, and administrators to broadcast typed buffer messages to a set of clients selected on the basis of the names assigned to them. The names assigned to clients are determined in part by the application (specifically, by the information passed in the <code class="cCode">TPINIT</code> typed buffer at <code class="cCode">tpinit()</code> time) and in part by the system (based on the processor through which the client accesses the application).
</p>
<p class="pBody"><a name="wp1000880"> </a>
The second method is the notification of a particular client as identified from an earlier or current service request. Each service request contains a unique client identifier that identifies the originating client for the service request. Calls to the <code class="cCode">tpcall()</code> and <code class="cCode">tpforward()</code> functions from within a service routine do not change the originating client for that chain of service requests. Client identifiers can be saved and passed between application servers. The <code class="cCode">tpnotify()</code> function is used to notify clients identified in this manner.
</p>
<h4 class="pHeading3"><a name="wp1207588"> </a>
Single or Multiple Application Contexts per Process
</h4>
<p class="pBody"><a name="wp1403261"> </a>
The Oracle Tuxedo ATMI system allows client programs to create an association with one or more applications per process. If <code class="cCode">tpinit()</code> is called with the <code class="cCode">TPMULTICONTEXTS</code> parameter included in the <code class="cCodeEmphasis">flags</code> field of the <code class="cCode">TPINIT</code> structure, then multiple client contexts are allowed. If <code class="cCode">tpinit()</code> is called implicitly, is called with a NULL parameter, or the <code class="cCodeEmphasis">flags</code> field does not include <code class="cCode">TPMULTICONTEXTS</code>, then only a single application association is allowed.
</p>
<p class="pBody"><a name="wp1207590"> </a>
In single-context mode, if <code class="cCode">tpinit()</code> is called more than once (that is, if it is called after the client has already joined the application), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1207591"> </a>
In multicontext mode, each call to <code class="cCode">tpinit()</code> creates a new application association. The application can obtain a handle representing this application association by calling <code class="cCode">tpgetctxt()</code>. Any thread in the same process can call <code class="cCode">tpsetctxt()</code> to set that thread&#8217;s context.
</p>
<p class="pBody"><a name="wp1207592"> </a>
Once an application has chosen single-context mode, all calls to <code class="cCode">tpinit()</code> must specify single-context mode until all application associations are terminated. Similarly, once an application has chosen multicontext mode, all calls to <code class="cCode">tpinit()</code> must specify multicontext mode until all application associations are terminated.
</p>
<p class="pBody"><a name="wp1207593"> </a>
Server programs can be associated with only a single application and cannot act as clients. However, within each server program, there may be multiple server dispatch contexts. Each server dispatch context works in its own thread.
</p>
<p class="pBody"><a name="wp1207594"> </a>
<a href="rf3c.html#wp1506513">Table&#160;2</a> shows the transitions that may occur, within a client process, among the following states: the uninitialized state, the initialized in single-context mode state, and the initialized in multicontext mode state.
</p>
<p class="pGraphic"><a name="wp1503138"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1506513table1207595"><caption><a name="wp1506513"> </a>
Table&#160;2  Per-Process Context Modes

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1506521"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp1506523"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1506531"> </a>
Uninitialized
</div>
<div class="pCellHeading"><a name="wp1506532"> </a>
S<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1506534"> </a>
Initialized Single-context Mode
</div>
<div class="pCellHeading"><a name="wp1506535"> </a>
S<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1506537"> </a>
Initialized Multicontext Mode
</div>
<div class="pCellHeading"><a name="wp1506538"> </a>
S<sub class="cSubscript">2</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506540"> </a>
<code class="cCode">tpinit</code> without <code class="cCode">TPMULTICONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506542"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506544"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506546"> </a>
S<sub class="cSubscript">2</sub>(<code class="cCodeEmphasis">error</code>)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506548"> </a>
<code class="cCode">tpinit</code> with <code class="cCode">TPMULTICONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506550"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506552"> </a>
S<sub class="cSubscript">1</sub> (<code class="cCodeEmphasis">error</code>)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506554"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506556"> </a>
Implicit <code class="cCode">tpinit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506558"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506560"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506562"> </a>
S<sub class="cSubscript">2</sub> (<code class="cCodeEmphasis">error</code>)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506564"> </a>
<code class="cCode">tpterm</code>&#8212;not last association
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506570"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506572"> </a>
<code class="cCode">tpterm</code>&#8212;last association
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506576"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506578"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506580"> </a>
<code class="cCode">tpterm</code>&#8212;no association
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1506582"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pHeading3"><a name="wp1658637"> </a>
Context State Changes for a Client Thread
</h4>
<p class="pBody"><a name="wp1207676"> </a>
In a multicontext application, calls to various functions result in context state changes for the calling thread and any other threads that are active in the same context as the calling process. The following diagram illustrates the context state changes that result from calls to the <code class="cCode">tpinit()</code>, <code class="cCode">tpsetctxt()</code>, and <code class="cCode">tpterm()</code> functions. (The <code class="cCode">tpgetctxt()</code> function does not produce any context state changes.)
</p>
<div class="pFigureTitle"><a name="wp1666105"> </a>
Multicontext State Transitions
</div>

 
 <p class="pGraphic"><a name="wp1666165"> </a>
</p>
<div class="figure" align="left"><img src="wwimages/rf3c-1-1-1.gif" height="372" width="544" alt="Multicontext State Transitions" id="wp1666107"/></div><p class="pGraphic">

</p>
<a name="wp1669720"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>When <code class="cCode">tpterm()</code> is called by a thread running in the multicontext state (<code class="cCode">TPMULTICONTEXTS</code>), the calling thread is placed in the NULL context state (<code class="cCode">TPNULLCONTEXT</code>). All other threads associated with the terminated context are switched to the invalid context state (<code class="cCode">TPINVALIDCONTEXT</code>).</td>
</tr>
</table>

<p class="pBody"><a name="wp1669709"> </a>
<a href="rf3c.html#wp1667767">Table&#160;3</a> lists all possible context state changes produced by calling <code class="cCode">tpinit()</code>, <code class="cCode">tpsetctxt()</code>, and <code class="cCode">tpterm()</code>. These states are thread-specific; different threads can be in different states when they are part of a multicontexted application. By contrast, each context state listed in the preceding table (<a href="rf3c.html#wp1506513">Per-Process Context Modes</a>) applies to an entire process.
</p>
<p class="pGraphic"><a name="wp1667876"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1667767table1667765"><caption><a name="wp1667767"> </a>
Table&#160;3  Context State Changes for a Client Thread

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1667777"> </a>
When this function is executed . . . 
</div>
</th>
    <th colspan="4" rowspan="1"><div class="pCellHeading"><a name="wp1667779"> </a>
Then a thread in this context state results in . . .
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1667789"> </a>
NULL Context
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1667791"> </a>
Single Context
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1667793"> </a>
 Multicontext
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1667795"> </a>
Invalid Context
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667797"> </a>
<code class="cCode">tpinit</code> without <code class="cCode">TPMULTICONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667799"> </a>
Single context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667801"> </a>
Single context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667803"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667805"> </a>
Error
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667807"> </a>
<code class="cCode">tpinit</code> with <code class="cCode">TPMULTICONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667809"> </a>
Multicontext
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667811"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667813"> </a>
Multicontext
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667815"> </a>
Error
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667817"> </a>
<code class="cCode">tpsetctxt</code> to <code class="cCode">TPNULLCONTEXT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667819"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667821"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667823"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667825"> </a>
NULL
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667827"> </a>
<code class="cCode">tpsetctxt</code> to context 0
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667829"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667831"> </a>
Single context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667833"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667835"> </a>
Error
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667837"> </a>
<code class="cCode">tpsetctxt</code> to context &gt; 0
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667839"> </a>
Multicontext
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667841"> </a>
Error
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667843"> </a>
Multicontext
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667845"> </a>
Multicontext
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667847"> </a>
Implicit <code class="cCode">tpinit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667849"> </a>
Single context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667851"> </a>
N/A
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667853"> </a>
N/A
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667855"> </a>
Error
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667857"> </a>
<code class="cCode">tpterm</code> in this thread
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667859"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667861"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667863"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667865"> </a>
NULL
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667867"> </a>
<code class="cCode">tpterm</code> in a different thread of this context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667869"> </a>
N/A
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667871"> </a>
NULL
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667873"> </a>
Invalid
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1667875"> </a>
N/A
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pHeading3"><a name="wp1658602"> </a>
Support for Threads Programming
</h4>
<p class="pBody"><a name="wp1658600"> </a>
The Oracle Tuxedo ATMI system supports multithreaded programming in several ways. If the process is using single-context mode, then as the application creates new threads, those threads share the Oracle Tuxedo ATMI context for the process. In a client, after a thread issues a <code class="cCode">tpinit()</code> call in single-context mode, other threads may then proceed to issue ATMI calls. For example, one thread may issue a <code class="cCode">tpacall()</code> and a different thread in the same process may issue a <code class="cCode">tpgetrply()</code>.
</p>
<p class="pBody"><a name="wp1207678"> </a>
When in multicontext mode, threads initially are not associated with an Oracle Tuxedo ATMI application. A thread can either join an existing application association by calling <code class="cCode">tpsetctxt()</code> or create a new association by calling <code class="cCode">tpinit()</code> with the <code class="cCode">TPMULTICONTEXTS</code> flag set.
</p>
<p class="pBody"><a name="wp1207679"> </a>
Whether running in single-context mode or multicontext mode, the application is responsible for coordinating its threads so that ATMI operations are performed at the appropriate time.
</p>
<p class="pBody"><a name="wp1207680"> </a>
An application may create additional threads within a server by using OS thread functions. These threads may operate independently of the Oracle Tuxedo ATMI system, or they may operate in the same context as one of the server dispatch threads. Initially, application-created server threads are not associated with any server dispatch context. An application-created server thread may call <code class="cCode">tpsetctxt()</code> to associate itself with a server dispatch thread. The application-created server thread must complete all of its ATMI calls before the dispatched thread calls <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. A server thread dispatched by the Oracle Tuxedo ATMI system may not call <code class="cCode">tpsetctxt()</code>. In addition, application-created threads may not make ATMI calls that would cause an implicit <code class="cCode">tpinit()</code> when not associated with a context. On the other hand, this failure to make ATMI calls does not occur with dispatcher-created threads because those threads are always associated with a context. All server threads are prohibited from calling <code class="cCode">tpinit()</code>.
</p>
<p class="pBody"><a name="wp1618424"> </a>
In a multithreaded application, a thread that is operating in the <code class="cCode">TPINVALIDCONTEXT</code> state is prohibited from calling many ATMI functions. The following lists specify which functions may and may not be called under these circumstances.
</p>
<p class="pBody"><a name="wp1618425"> </a>
The Oracle Tuxedo ATMI system allows a thread operating in the <code class="cCode">TPINVALIDCONTEXT</code> state to call the following functions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1618426"> </a><a href="rf3c.html#wp1058086"><code class="cCode">catgets(3c)</code></a></li>
<li><a name="wp1618433"> </a><a href="rf3c.html#wp1059202"><code class="cCode">catopen, catclose(3c)</code></a></li>
<li><a name="wp1618434"> </a><a href="rf3c.html#wp1029799"><code class="cCode">decimal(3c)</code></a></li>
<li><a name="wp1618436"> </a><a href="rf3c.html#wp1031722"><code class="cCode">gp_mktime(3c)</code></a></li>
<li><a name="wp1618443"> </a><a href="rf3c.html#wp1034351"><code class="cCode">nl_langinfo(3c)</code></a></li>
<li><a name="wp1618520"> </a><a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a></li>
<li><a name="wp1620005"> </a><a href="rf3c.html#wp2144382"><code class="cCode">strerror(3c)</code></a></li>
<li><a name="wp1620006"> </a><a href="rf3c.html#wp1062371"><code class="cCode">strftime(3c)</code></a></li>
<li><a name="wp1620007"> </a><a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a></li>
<li><a name="wp1620008"> </a><a href="rf3c.html#wp1037802"><code class="cCode">tpconvert(3c)</code></a></li>
<li><a name="wp2014836"> </a><a href="rf3c.html#wp1063533"><code class="cCode">tpcryptpw(3c)</code></a></li>
<li><a name="wp2014840"> </a><a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a></li>
<li><a name="wp2221027"> </a><a href="rf3c.html#wp1987733">tpfml32toxml(3c)</a></li>
<li><a name="wp2221164"> </a><a href="rf3c.html#wp2178284"><span class="cHyperlink">
tpfmltoxml(3c)</span></a></li>
<li><a name="wp2014844"> </a><a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a></li>
<li><a name="wp2222640"> </a><a href="rf3c.html#wp2178582">tpgblktime(3c)</a></li>
<li><a name="wp1620042"> </a><a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a></li>
<li><a name="wp2176852"> </a><a href="rf3c.html#wp2179461"><code class="cCode">tpgetrepos(3c)</code></a></li>
<li><a name="wp2222683"> </a><a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a></li>
<li><a name="wp2222684"> </a><a href="rf3c.html#wp2437258">tpsblktime(3c)</a></li>
<li><a name="wp2222688"> </a><a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a></li>
<li><a name="wp2176859"> </a><a href="rf3c.html#wp2183851">tpsetrepos(3c)</a></li>
<li><a name="wp1620045"> </a><a href="rf3c.html#wp1023204"><code class="cCode">tpstrerror(3c)</code></a></li>
<li><a name="wp1620046"> </a><a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a></li>
<li><a name="wp1620047"> </a><a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a></li>
<li><a name="wp1620048"> </a><a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a></li>
<li><a name="wp2221240"> </a><a href="rf3c.html#wp2009111">tpxmltofml32(3c)</a></li>
<li><a name="wp2221241"> </a><a href="rf3c.html#wp2011500">tpxmltofml(3c)</a></li>
<li><a name="wp1620050"> </a><a href="rf3c.html#wp2154415"><code class="cCode">TRY(3c)</code></a></li>
<li><a name="wp1620120"> </a><a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a></li>
<li><a name="wp1620125"> </a><a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a></li>
<li><a name="wp1620130"> </a><a href="rf3c.html#wp1046107"><code class="cCode">tuxreadenv(3c)</code></a></li>
<li><a name="wp1620135"> </a><a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a></li>
<li><a name="wp1620174"> </a><a href="rf3c.html#wp1049719"><code class="cCode">Usignal(3c)</code></a></li>
<li><a name="wp1620182"> </a><a href="rf3c.html#wp1049777"><code class="cCode">Uunix_err(3c)</code></a></li>
</ul></div>
<p class="pBody"><a name="wp1618427"> </a>
The Oracle Tuxedo ATMI system <em class="cEmphasis">does not allow</em> a thread operating in the <code class="cCode">TPINVALIDCONTEXT</code> state to call the following functions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1620218"> </a><a href="rf3c.html#wp1025860"><code class="cCode">AEWsetunsol(3c)</code></a></li>
<li><a name="wp1621731"> </a><a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a></li>
<li><a name="wp1621740"> </a><a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a></li>
<li><a name="wp1621752"> </a><a href="rf3c.html#wp1037464"><code class="cCode">tpadmcall(3c)</code></a></li>
<li><a name="wp1621766"> </a><a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a></li>
<li><a name="wp1621778"> </a><a href="rf3c.html#wp1039463"><code class="cCode">tpbroadcast(3c)</code></a></li>
<li><a name="wp1621790"> </a><a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a></li>
<li><a name="wp1621798"> </a><a href="rf3c.html#wp1039772"><code class="cCode">tpcancel(3c)</code></a></li>
<li><a name="wp1621813"> </a><a href="rf3c.html#wp1040017"><code class="cCode">tpchkauth(3c)</code></a></li>
<li><a name="wp1621821"> </a><a href="rf3c.html#wp1040306"><code class="cCode">tpchkunsol(3c)</code></a></li>
<li><a name="wp1621829"> </a><a href="rf3c.html#wp1040568"><code class="cCode">tpclose(3c)</code></a></li>
<li><a name="wp1621839"> </a><a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a></li>
<li><a name="wp1621843"> </a><a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a></li>
<li><a name="wp1623331"> </a><a href="rf3c.html#wp1041783"><code class="cCode">tpdequeue(3c)</code></a></li>
<li><a name="wp1623335"> </a><a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a></li>
<li><a name="wp1623339"> </a><a href="rf3c.html#wp1064942"><code class="cCode">tpgetadmkey(3c)</code></a></li>
<li><a name="wp1623343"> </a><a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a></li>
<li><a name="wp1623347"> </a><a href="rf3c.html#wp1021885"><code class="cCode">tpgetrply(3c)</code></a></li>
<li><a name="wp1623351"> </a><a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a></li>
<li><a name="wp1623355"> </a><a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a></li>
<li><a name="wp1623359"> </a><a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a></li>
<li><a name="wp1623363"> </a><a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a></li>
<li><a name="wp1623367"> </a><a href="rf3c.html#wp1044210"><code class="cCode">tppost(3c)</code></a></li>
<li><a name="wp1623371"> </a><a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a></li>
<li><a name="wp1623375"> </a><a href="rf3c.html#wp1044625"><code class="cCode">tpresume(3c)</code></a></li>
<li><a name="wp1623379"> </a><a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a></li>
<li><a name="wp1623383"> </a><a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a></li>
<li><a name="wp1623392"> </a><a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a></li>
<li><a name="wp1623406"> </a><a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a></li>
<li><a name="wp1623418"> </a><a href="rf3c.html#wp1045667"><code class="cCode">tpsubscribe(3c)</code></a></li>
<li><a name="wp1623430"> </a><a href="rf3c.html#wp1045633"><code class="cCode">tpsuspend(3c)</code></a></li>
<li><a name="wp1623442"> </a><a href="rf3c.html#wp1045970"><code class="cCode">tpunsubscribe(3c)</code></a></li>
<li><a name="wp1623450"> </a><a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a></li>
<li><a name="wp1623465"> </a><a href="rf3c.html#wp1046217"><code class="cCode">tx_close(3c)</code></a></li>
<li><a name="wp1623473"> </a><a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a></li>
<li><a name="wp1623481"> </a><a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a></li>
<li><a name="wp1623491"> </a><a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a></li>
<li><a name="wp1623495"> </a><a href="rf3c.html#wp1046426"><code class="cCode">tx_rollback(3c)</code></a></li>
<li><a name="wp1624983"> </a><a href="rf3c.html#wp1046490"><code class="cCode">tx_set_commit_return(3c)</code></a></li>
<li><a name="wp1624987"> </a><a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a></li>
<li><a name="wp1624991"> </a><a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a></li>
</ul></div>
<h4 class="pHeading3"><a name="wp1000965"> </a>
C Language ATMI Return Codes and Other Definitions
</h4>
<p class="pBody"><a name="wp1000976"> </a>
The following return code and flag definitions are used by the ATMI routines. For an application to work with different transaction monitors without change or recompilation, each system must define its flags and return codes as follows: 
</p>
<a name="wp1594515"> </a><div class="pPreformatted"><pre> /*<br />  * The following definitions must be included in atmi.h<br />  */<br /> <br /> <br /> <br /> /* Flags to service routines */<br /> <br />  #define TPNOBLOCK     0x00000001 /* non-blocking send/rcv */<br />  #define TPSIGRSTRT    0x00000002 /* restart rcv on interrupt */<br />  #define TPNOREPLY     0x00000004 /* no reply expected */<br />  #define TPNOTRAN      0x00000008 /* not sent in transaction mode */<br />  #define TPTRAN        0x00000010 /* sent in transaction mode */<br />  #define TPNOTIME      0x00000020 /* no timeout */<br />  #define TPABSOLUTE    0x00000040 /* absolute value on tmsetprio */<br />  #define TPGETANY      0x00000080 /* get any valid reply */<br />  #define TPNOCHANGE    0x00000100 /* force incoming buffer to match */<br />  #define RESERVED_BIT1 0x00000200 /* reserved for future use */<br />  #define TPCONV        0x00000400 /* conversational service */<br />  #define TPSENDONLY    0x00000800 /* send-only mode */<br />  #define TPRECVONLY    0x00001000 /* recv-only mode */<br />  #define TPACK         0x00002000 /* */<br /> <br /> /* Flags to tpreturn - also defined in xa.h */<br />  #define TPFAIL        0x20000000 /* service FAILURE for tpreturn */<br />  #define TPEXIT        0x08000000 /* service FAILURE with server exit */<br />  #define TPSUCCESS     0x04000000 /* service SUCCESS for tpreturn */<br /> <br /> /* Flags to tpscmt - Valid TP_COMMIT_CONTROL<br />  * characteristic values<br />  */<br />  #define TP_CMT_LOGGED 0x01       /* return after commit<br />                                    * decision is logged */<br />  #define TP_CMT_COMPLETE 0x02     /* return after commit has<br />                                    * completed */<br /> <br /> <br /> <br /> /* client identifier structure */<br />  struct clientid_t {<br />  long clientdata[4];              /* reserved for internal use */<br />  }<br />  typedef struct clientid_t CLIENTID;<br />  /* context identifier structure */<br />  typedef long TPCONTEXT_T;<br />  /* interface to service routines */<br />  struct tpsvcinfo {<br />  name[128];<br />  long flags;                      /* describes service attributes */<br />  char *data;                      /* pointer to data */<br />  long len;                        /* request data length */<br />  int cd;                          /* connection descriptor<br />  * if (<code class="cCodeEmphasis">flags</code>  TPCONV) true */<br />  long appkey;                     /* application authentication client<br />  * key */<br />  CLIENTID cltid;                  /* client identifier for originating<br />   * client */<br />  };<br /> <br /> typedef struct tpsvcinfo TPSVCINFO;<br /> <br /> /* tpinit(3c) interface structure */<br />  #define MAXTIDENT                30<br /> <br /> struct tpinfo_t {<br />  char usrname[MAXTIDENT+2];       /* client user name */<br />  char cltname[MAXTIDENT+2];       /* app client name */<br />  char passwd[MAXTIDENT+2];        /* application password */<br />  long flags;                      /* initialization flags */<br />  long datalen;                    /* length of app specific data */<br />  long data;                       /* placeholder for app data */<br />  };<br />  typedef struct tpinfo_t TPINIT;<br /> <br /> /* The transactionID structure passed to tpsuspend(3c) and tpresume(3c) */<br />  struct tp_tranid_t {<br />  long info[6];                    /* Internally defined */<br />  };<br /> <br /> typedef struct tp_tranid_t TPTRANID;<br /> <br /> /* Flags for TPINIT */<br />  #define TPU_MASK                 0x00000007     /* unsolicited notification<br />                                                   * mask */<br />  #define TPU_SIG                  0x00000001     /* signal based<br />                                    * notification */<br />  #define TPU_DIP                  0x00000002     /* dip-in based<br />                                    * notification */<br />  #define TPU_IGN                  0x00000004     /* ignore unsolicited<br />                                                   * messages */<br />  #define TPU_THREAD               0x00000040     /* THREAD notification */<br />  #define TPSA_FASTPATH            0x00000008     /* System access ==<br />                                                   * fastpath */<br />  #define TPSA_PROTECTED           0x00000010     /* System access ==<br />                                                   * protected */<br />  #define TPMULTICONTEXTS          0x00000020     /* multiple context associa-<br />                                                   * tions per process */<br />  /*  /Q tpqctl_t data structure                  */<br />  #define TMQNAMELEN               127<br />  #define TMMSGIDLEN               32<br />  #define TMCORRIDLEN              32<br /> <br /> struct tpqctl_t {                 /* control parameters to queue primitives */<br />  long flags;                      /* indicates which values are set */<br />  long deq_time;                   /* absolute/relative time for dequeuing */<br />  long priority;                   /* enqueue priority */<br />  long diagnostic;                 /* indicates reason for failure */<br />  char msgid[TMMSGIDLEN];          /* ID of message before which to queue */<br />  char corrid[TMCORRIDLEN];        /* correlation ID used to identify message */<br />  char replyqueue[TMQNAMELEN+1];   /* queue name for reply message */<br />  char failurequeue[TMQNAMELEN+1]; /* queue name for failure message */<br />  CLIENTID cltid;                  /* client identifier for */<br />                                   /* originating client */<br />  long urcode;                     /* application user-return code */<br />  long appkey;                     /* application authentication client key */<br />  long delivery_qos;               /* delivery quality of service */<br />  long reply_qos;                  /* reply message quality of service */<br />  long exp_time                    /* expiration time */<br />  };<br />  typedef struct tpqctl_t TPQCTL;<br /> <br /> /* /Q structure elements that are valid - set in flags */<br />  #ifndef TPNOFLAGS<br />  #define TPNOFLAGS                0x00000    /* no flags set -- no get */<br />  #endif<br />  #define TPQCORRID                0x00001    /* set/get correlation ID */<br />  #define TPQFAILUREQ              0x00002    /* set/get failure queue */<br />  #define TPQBEFOREMSGID           0x00004    /* enqueue before message ID */<br />  #define TPQGETBYMSGIDOLD         0x00008    /* deprecated */<br />  #define TPQMSGID                 0x00010    /* get msgid of enq/deq message */<br />  #define TPQPRIORITY              0x00020    /* set/get message priority */<br />  #define TPQTOP                   0x00040    /* enqueue at queue top */<br />  #define TPQWAIT                  0x00080    /* wait for dequeuing */<br />  #define TPQREPLYQ                0x00100    /* set/get reply queue */<br />  #define TPQTIME_ABS              0x00200    /* set absolute time */<br />  #define TPQTIME_REL              0x00400    /* set relative time */<br />  #define TPQGETBYCORRIDOLD        0x00800    /* deprecated */<br />  #define TPQPEEK                  0x01000    /* non-destructive dequeue */<br />  #define TPQDELIVERYQOS           0x02000    /* delivery quality of service */<br />  #define TPQREPLYQOS              0x04000    /* reply msg quality of service*/<br />  #define TPQEXPTIME_ABS           0x08000    /* absolute expiration time */<br />  #define TPQEXPTIME_REL           0x10000    /* relative expiration time */<br />  #define TPQEXPTIME_NONE          0x20000    /* never expire */<br />  #define TPQGETBYMSGID            0x40008    /* dequeue by msgid */<br />  #define TPQGETBYCORRID           0x80800    /* dequeue by corrid */<br /><br /> /* Valid flags for the quality of service fields in the TPQCTL structure */<br />  #define TPQQOSDEFAULTPERSIST     0x00001    /* queue&#39;s default persistence */<br />                                              /* policy */<br />  #define TPQQOSPERSISTENT         0x00002    /* disk message */<br />  #define TPQQOSNONPERSISTENT      0x00004    /* memory message */<br /><br /> /* error return codes */<br />  extern int tperrno;<br />  extern long tpurcode;<br /> <br /> /* tperrno values - error codes */<br />  * The reference pages explain the context in which the following<br />  * error codes can return.<br />  */<br /> <br />  #define TPMINVAL                 0          /* minimum error message */<br />  #define TPEABORT                 1<br />  #define TPEBADDESC               2<br />  #define TPEBLOCK                 3<br />  #define TPEINVAL                 4<br />  #define TPELIMIT                 5<br />  #define TPENOENT                 6<br />  #define TPEOS                    7<br />  #define TPEPERM                  8<br />  #define TPEPROTO                 9<br />  #define TPESVCERR                10<br />  #define TPESVCFAIL               11<br />  #define TPESYSTEM                12<br />  #define TPETIME                  13<br />  #define TPETRAN                  14<br />  #define TPGOTSIG                 15<br />  #define TPERMERR                 16<br />  #define TPEITYPE                 17<br />  #define TPEOTYPE                 18<br />  #define TPERELEASE               19<br />  #define TPEHAZARD                20<br />  #define TPEHEURISTIC             21<br />  #define TPEEVENT                 22<br />  #define TPEMATCH                 23<br />  #define TPEDIAGNOSTIC            24<br />  #define TPEMIB                   25<br />  #define TPMAXVAL                 26         /* maximum error message */<br /> <br /> /* conversations - events */<br />  #define TPEV_DISCONIMM           0x0001<br />  #define TPEV_SVCERR              0x0002<br />  #define TPEV_SVCFAIL             0x0004<br />  #define TPEV_SVCSUCC             0x0008<br />  #define TPEV_SENDONLY            0x0020<br /> <br /> /* /Q diagnostic codes            */<br />  #define QMEINVAL                 -1<br />  #define QMEBADRMID               -2<br />  #define QMENOTOPEN               -3<br />  #define QMETRAN                  -4<br />  #define QMEBADMSGID              -5<br />  #define QMESYSTEM                -6<br />  #define QMEOS                    -7<br />  #define QMEABORTED               -8<br />  #define QMENOTA                  QMEABORTED<br />  #define QMEPROTO                 -9<br />  #define QMEBADQUEUE              -10<br />  #define QMENOMSG                 -11<br />  #define QMEINUSE                 -12<br />  #define QMENOSPACE               -13<br />  #define QMERELEASE               -14<br />  #define QMEINVHANDLE             -15<br />  #define QMESHARE                 -16<br /><br /> /* EventBroker Messages */<br />  #define TPEVSERVICE              0x00000001<br />  #define TPEVQUEUE                0x00000002<br />  #define TPEVTRAN                 0x00000004<br />  #define TPEVPERSIST              0x00000008<br /> <br /> /* Subscription Control Structure */<br />  struct tpevctl_t {<br />      long flags;<br />      char name1[XATMI_SERVICE_NAME_LENGTH];<br />      char name2[XATMI_SERVICE_NAME_LENGTH];<br />      TPQCTL qctl;<br />  };<br />  typedef struct tpevctl_t TPEVCTL;</pre></div><h4 class="pHeading3"><a name="wp1097458"> </a>
C Language TX Return Codes and Other Definitions
</h4>
<p class="pBody"><a name="wp1003438"> </a>
The following return code and flag definitions are used by the TX routines. For an application to work with different transaction monitors without change or recompilation, each system must define its flags and return codes as follows: 
</p>
<a name="wp1713856"> </a><div class="pPreformatted"><pre>#define TX_H_VERSION           0           /* current version of this<br />                                            * header file */<br /> <br /> /*<br />  * Transaction identifier<br />  */<br />  #define XIDDATASIZE          128         /* size in bytes */<br />  struct xid_t {<br />         long formatID;                    /* format identifier */<br />         long gtrid_length;                /* value not to exceed 64 */<br />         long bqual_length;                /* value not to exceed 64 */<br />         char data[XIDDATASIZE];<br />  };<br />  typedef struct xid_t XID;<br />  /*<br />  * A value of -1 in formatID means that the XID is null.<br />  */<br /> <br /> /*<br />  * Definitions for tx_ routines<br />  */<br />  /* commit return values */<br />  typedef long COMMIT_RETURN;<br />  #define TX_COMMIT_COMPLETED 0<br />  #define TX_COMMIT_DECISION_LOGGED 1<br /> <br /> /* transaction control values */<br />  typedef long TRANSACTION_CONTROL;<br />  #define TX_UNCHAINED 0<br />  #define TX_CHAINED 1<br /> <br /> /* type of transaction timeouts */<br />  typedef long TRANSACTION_TIMEOUT;<br /> <br /> /* transaction state values */<br />  typedef long TRANSACTION_STATE;<br />  #define TX_ACTIVE 0<br />  #define TX_TIMEOUT_ROLLBACK_ONLY 1<br />  #define TX_ROLLBACK_ONLY 2<br /> <br /> /* structure populated by tx_info */<br />  struct tx_info_t {<br />         XID xid;<br />         COMMIT_RETURN when_return;<br />         TRANSACTION_CONTROL transaction_control;<br />         TRANSACTION_TIMEOUT transaction_timeout;<br />         TRANSACTION_STATE   transaction_state;<br />  };<br />  typedef struct tx_info_t TXINFO;<br /> <br /> <br /> /*<br />  * tx_ return codes<br />  * (transaction manager reports to application)<br />  */<br />  #define TX_NOT_SUPPORTED            1 /* option not supported */<br />  #define TX_OK                       0 /* normal execution */<br />  #define TX_OUTSIDE                 -1 /* application is in an RM<br />                                         * local transaction */<br />  #define TX_ROLLBACK                -2 /* transaction was rolled<br />                                         * back */<br />  #define TX_MIXED                   -3 /* transaction was<br />                                         * partially committed and<br />                                         * partially rolled back */<br />  #define TX_HAZARD                  -4 /* transaction may have been<br />                                         * partially committed and<br />                                         * partially rolled back */<br />  #define TX_PROTOCOL_ERROR          -5 /* routine invoked in an<br />                                         * improper context */<br />  #define TX_ERROR                   -6 /* transient error */<br />  #define TX_FAIL                    -7 /* fatal error */<br />  #define TX_EINVAL                  -8 /* invalid arguments were given */<br />  #define TX_COMMITTED               -9 /* transaction has<br />                                         * heuristically committed */<br /> <br />  #define TX_NO_BEGIN                -100 /* transaction committed plus<br />                                           * new transaction could not<br />                                           * be started */<br />  #define TX_ROLLBACK_NO_BEGIN       (TX_ROLLBACK+TX_NO_BEGIN)<br />                                          /* transaction rollback plus<br />                                           * new transaction could not<br />                                           * be started */<br />  #define TX_MIXED_NO_BEGIN          (TX_MIXED+TX_NO_BEGIN)<br />                                          /* mixed plus new transaction<br />                                           * could not be started */<br />  #define TX_HAZARD_NO_BEGIN         (TX_HAZARD+TX_NO_BEGIN)<br />                                          /* hazard plus new transaction<br />                                           * could not be started */<br />  #define TX_COMMITTED_NO_BEGIN      (TX_COMMITTED+TX_NO_BEGIN)<br />                                          /* heuristically committed plus<br />                                           * new transaction could not<br />                                           * be started */</pre></div><h4 class="pHeading3"><a name="wp1713858"> </a>
ATMI State Transitions
</h4>
<p class="pBody"><a name="wp1004562"> </a>
The Oracle Tuxedo ATMI system keeps track of the state for each process and verifies that legal state transitions occur for the various function calls and options. The state information includes the process type (request/response server, conversational server, or client), the initialization state (uninitialized or initialized), the resource management state (closed or open), the transaction state of the process, and the state of all asynchronous request and connection descriptors. When an illegal state transition is attempted, the called function fails, setting <code class="cCode">tperrno</code> to <code class="cCode">TPEPROTO</code>. The legal states and transitions for this information are described in the following tables.
</p>
<p class="pBody"><a name="wp1011525"> </a>
<a href="rf3c.html#wp2176875">Table&#160;4</a> indicates which functions may be called by request/response servers, conversational servers, and clients. Note that <code class="cCode">tpsvrinit()</code>, <code class="cCode">tpsvrdone()</code>, <code class="cCode">tpsvrthrinit()</code>, and <code class="cCode">tpsvrthrdone()</code> are not included in this table because they are not called by applications (that is, they are application-supplied functions that are invoked by the Oracle Tuxedo ATMI system).
</p>
<p class="pGraphic"><a name="wp1019710"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp2176875table1019735"><caption><a name="wp2176875"> </a>
Table&#160;4  Available Functions&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp2176883"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp2176885"> </a>
Process Type
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp2176893"> </a>
Request/Response Server
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2176895"> </a>
Conversational Server
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2176897"> </a>
Client
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176899"> </a>
<code class="cCode">tpabort</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176901"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176903"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176905"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176907"> </a>
<code class="cCode">tpacall</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176909"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176911"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176913"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176915"> </a>
<code class="cCode">tpadvertise</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176917"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176919"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176921"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176923"> </a>
<code class="cCode">tpalloc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176925"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176927"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176929"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176931"> </a>
<code class="cCode">tpbegin</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176933"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176935"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176937"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176939"> </a>
<code class="cCode">tpbroadcast</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176941"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176943"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176945"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176947"> </a>
<code class="cCode">tpcall</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176949"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176951"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176953"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176955"> </a>
<code class="cCode">tpcancel</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176957"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176959"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176961"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176963"> </a>
<code class="cCode">tpchkauth</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176965"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176967"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176969"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176971"> </a>
<code class="cCode">tpchkunsol</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176973"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176975"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176977"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176979"> </a>
<code class="cCode">tpclose</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176981"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176983"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176985"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176987"> </a>
<code class="cCode">tpcommit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176989"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176991"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176993"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176995"> </a>
<code class="cCode">tpconnect</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176997"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2176999"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177001"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177003"> </a>
<code class="cCode">tpdequeue</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177005"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177007"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177009"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177011"> </a>
<code class="cCode">tpdiscon</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177013"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177015"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177017"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177019"> </a>
<code class="cCode">tpenqueue</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177021"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177023"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177025"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212013"> </a>
<code class="cCode">tpfmltoxml</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212015"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212017"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212019"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212066"> </a>
<code class="cCode">tpfml32toxml</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212068"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212070"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212072"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177043"> </a>
<code class="cCode">tpforward</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177045"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177047"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177049"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177051"> </a>
<code class="cCode">tpfree</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177053"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177055"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177057"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177267"> </a>
tpgblktime
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177269"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177271"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177273"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177059"> </a>
<code class="cCode">tpgetctxt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177061"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177063"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177065"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177067"> </a>
<code class="cCode">tpgetlev</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177069"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177071"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177073"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177275"> </a>
tpgetrepos
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177277"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177279"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177281"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177075"> </a>
<code class="cCode">tpgetrply</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177077"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177079"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177081"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177083"> </a>
<code class="cCode">tpgprio</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177085"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177087"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177089"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177091"> </a>
<code class="cCode">tpinit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177093"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177095"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177097"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177099"> </a>
<code class="cCode">tpnotify</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177101"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177103"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177105"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177107"> </a>
<code class="cCode">tpopen</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177109"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177111"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177113"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177115"> </a>
<code class="cCode">tppost</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177117"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177119"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177121"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177123"> </a>
<code class="cCode">tprealloc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177125"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177127"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177129"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177131"> </a>
<code class="cCode">tprecv</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177133"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177135"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177137"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177139"> </a>
<code class="cCode">tpresume</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177141"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177143"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177145"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177147"> </a>
<code class="cCode">tpreturn</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177149"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177151"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177153"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177435"> </a>
tpsblktime
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177437"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177439"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177441"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177155"> </a>
<code class="cCode">tpscmt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177157"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177159"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177161"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177163"> </a>
<code class="cCode">tpsend</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177165"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177167"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177169"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177171"> </a>
<code class="cCode">tpservice</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177173"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177175"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177177"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177179"> </a>
<code class="cCode">tpsetctxt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177181"> </a>
Y (<em class="cEmphasis">in application-<br />    created threads</em>)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177183"> </a>
Y (<em class="cEmphasis">in application-<br />    created threads</em>)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177185"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177443"> </a>
tpsetrepos
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177445"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177447"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177449"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177187"> </a>
<code class="cCode">tpsetunsol</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177189"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177191"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177193"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177195"> </a>
<code class="cCode">tpsprio</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177197"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177199"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177201"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177203"> </a>
<code class="cCode">tpsubscribe</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177205"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177207"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177209"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177211"> </a>
<code class="cCode">tpsuspend</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177213"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177215"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177217"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177219"> </a>
<code class="cCode">tpterm</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177221"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177223"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177225"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177227"> </a>
<code class="cCode">tptypes</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177229"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177231"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177233"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177251"> </a>
<code class="cCode">tpunadvertise</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177253"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177255"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177257"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177259"> </a>
<code class="cCode">tpunsubscribe</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177261"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177263"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2177265"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212090"> </a>
<code class="cCode">tpxmltofml</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212092"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212094"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212096"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212098"> </a>
<code class="cCode">tpxmltofml32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212100"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212102"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2212104"> </a>
Y
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1019708"> </a>
The remaining state tables are for both clients and servers, unless otherwise noted. Keep in mind that because some functions cannot be called by both clients and servers (for example, <code class="cCode">tpinit()</code>), certain state transitions shown below may not be possible for both process types. The above table should be consulted to determine whether the process in question is allowed to call a particular function.
</p>
<p class="pBody"><a name="wp1006153"> </a>
The following state table indicates whether or not a thread in a client process has been initialized and registered with the transaction manager. Note that this table assumes the use of <code class="cCode">tpinit()</code>, which is optional in single-context mode. That is, a single-context client may implicitly join an application by issuing one of many ATMI functions (for example, <code class="cCode">tpconnect()</code> or <code class="cCode">tpcall()</code>). A client must use <code class="cCode">tpinit()</code> when one of the following is true: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1402848"> </a>Application authentication is required. (See <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> and the description of the <code class="cCode">SECURITY</code> keyword in <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details.)</li>
<li><a name="wp1402850"> </a>The client wants to access an XA-compliant resource manager directly. (See <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> for details.)</li>
<li><a name="wp1402857"> </a>The client wants to create multiple application associations.</li>
</ul></div>
<p class="pBody"><a name="wp1506064"> </a>
A server is placed in the initialized state by the Oracle Tuxedo ATMI system&#8217;s <code class="cCode">main()</code> before its <code class="cCode">tpsvrinit()</code> function is invoked, and it is placed in the uninitialized state by the Oracle Tuxedo ATMI system&#8217;s <code class="cCode">main()</code> after its <code class="cCode">tpsvrdone()</code> function has returned. Note that in all of the state tables shown below, an error return from a function causes the thread to remain in the same state, unless otherwise noted.
</p>
<p class="pGraphic"><a name="wp1506168"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1609752table1506065"><caption><a name="wp1609752"> </a>
Table&#160;5  Thread Initialization States&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1609758"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1609760"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1609766"> </a>
Uninitialize<br />I<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1609768"> </a>
Initialize<br />I<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609770"> </a>
<code class="cCode">tpalloc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609772"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609774"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609776"> </a>
<code class="cCode">tpchkauth</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609778"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609780"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609782"> </a>
<code class="cCode">tpfree</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609784"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609786"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609788"> </a>
<code class="cCode">tpgetctxt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609790"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609792"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609794"> </a>
<code class="cCode">tpinit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609796"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609798"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609800"> </a>
<code class="cCode">tprealloc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609802"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609804"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609806"> </a>
<code class="cCode">tpsetctxt</code> <br />(set to a non-NULL context)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609808"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609810"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609812"> </a>
<code class="cCode">tpsetctxt<br /></code>(with the <code class="cCode">TPNULLCONTEXT</code> context set)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609814"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609816"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609818"> </a>
<code class="cCode">tpsetunsol</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609820"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609822"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609824"> </a>
<code class="cCode">tpterm<br /></code>(in this thread)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609826"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609828"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609830"> </a>
<code class="cCode">tpterm</code> <br />(in a different thread of this context)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609832"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609834"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609836"> </a>
<code class="cCode">tptypes</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609838"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609840"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609842"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609844"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1609846"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1506169"> </a>
The remaining state tables assume a precondition of state I<sub class="cSubscript">1</sub> (regardless of whether a process arrived in this state via <code class="cCode">tpinit()</code>, <code class="cCode">tpsetctxt()</code>, or the Oracle Tuxedo ATMI system&#8217;s <code class="cCode">main()</code>).
</p>
<p class="pBody"><a name="wp1008088"> </a>
<a href="rf3c.html#wp1014641">Table&#160;6</a> indicates the state of a client or server with respect to whether or not a resource manager associated with the process has been initialized.
</p>
<p class="pGraphic"><a name="wp1020156"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1014641table1006842"><caption><a name="wp1014641"> </a>
Table&#160;6  Resource Management States&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1007092"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1007094"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1007152"> </a>
Closed<br />R<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1007155"> </a>
Open<br />R<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007013"> </a>
<code class="cCode">tpopen</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020098"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020101"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007115"> </a>
<code class="cCode">tpclose</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020104"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020107"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007125"> </a>
<code class="cCode">tpbegin</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020113"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007135"> </a>
<code class="cCode">tpcommit</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020119"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007229"> </a>
<code class="cCode">tpabort</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020125"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007247"> </a>
<code class="cCode">tpsuspend</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020131"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007265"> </a>
<code class="cCode">tpresume</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020137"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007306"> </a>
<code class="cCode">tpservice</code> with flag <code class="cCode">TPTRAN</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020143"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007313"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020146"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020149"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1020155"> </a>
<a href="rf3c.html#wp1014647">Table&#160;7</a> indicates the state of a process with respect to whether or not the process is associated with a transaction. For servers, transitions to states T<sub class="cSubscript">1</sub>and T<sub class="cSubscript">2</sub> assume a precondition of state R<sub class="cSubscript">1</sub> (for example, <code class="cCode">tpopen()</code> has been called with no subsequent call to <code class="cCode">tpclose()</code> or <code class="cCode">tpterm()</code>).
</p>
<p class="pGraphic"><a name="wp1021377"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1014647table1007419"><caption><a name="wp1014647"> </a>
Table&#160;7  Transaction State of Application Association&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1007696"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp1007698"> </a>
State
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1007784"> </a>
Not in Transaction<br />T<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1007787"> </a>
Initiator<br />T<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1007790"> </a>
Participant<br />T<sub class="cSubscript">2</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007725"> </a>
<code class="cCode">tpbegin</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007738"> </a>
<code class="cCode">tpabort</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020176"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007751"> </a>
<code class="cCode">tpcommit</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020185"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007764"> </a>
<code class="cCode">tpsuspend</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020194"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007848"> </a>
<code class="cCode">tpresume</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020200"> </a>
T<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020203"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007869"> </a>
<code class="cCode">tpservice</code> with flag <code class="cCode">TPTRAN</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020209"> </a>
T<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007894"> </a>
<code class="cCode">tpservice</code> (not in transaction mode)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020218"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007920"> </a>
<code class="cCode">tpreturn</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020227"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020233"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007945"> </a>
<code class="cCode">tpforward</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020236"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020242"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007970"> </a>
<code class="cCode">tpclose</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020245"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1007993"> </a>
<code class="cCode">tpterm</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020254"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020257"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1008018"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020263"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020266"> </a>
T<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020269"> </a>
T<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1503160"> </a>
<a href="rf3c.html#wp1402876">Table&#160;8</a> indicates the state of a single request descriptor returned by <code class="cCode">tpacall()</code>.
</p>
<p class="pGraphic"><a name="wp1402961"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1402876table1402874"><caption><a name="wp1402876"> </a>
Table&#160;8  Asynchronous Request Descriptor States&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1402882"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1402884"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1505352"> </a>
No Descriptor A<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1505358"> </a>
Valid Descriptor A<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402902"> </a>
<code class="cCode">tpacall</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402904"> </a>
A<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402908"> </a>
<code class="cCode">tpgetrply</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402912"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402914"> </a>
<code class="cCode">tpcancel</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402918"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript"> a</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402920"> </a>
<code class="cCode">tpabort</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402922"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402924"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript"> b</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402926"> </a>
<code class="cCode">tpcommit</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402928"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402930"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript"> b</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402932"> </a>
<code class="cCode">tpsuspend</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402934"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402936"> </a>
A<sub class="cSubscript">1</sub> <sup class="cSuperscript">c</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402938"> </a>
<code class="cCode">tpreturn</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402940"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402942"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402944"> </a>
<code class="cCode">tpforward</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402946"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402948"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402950"> </a>
<code class="cCode">tpterm</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402952"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402954"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402956"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402958"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1402960"> </a>
A<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<a name="wp1402962"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><sup class="cSuperscript">a</sup> This state change occurs only if the descriptor is not associated with the caller&#8217;s transaction.</td>
</tr>
</table>

<a name="wp1021241"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">b</sup> This state change occurs only if the descriptor is associated with the caller&#8217;s transaction.</td>
</tr>
</table>
<a name="wp1021246"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">c</sup> If the descriptor is associated with the caller&#8217;s transaction, then <code class="cCode">tpsuspend()</code> returns a protocol error.</td>
</tr>
</table>
<p class="pBody"><a name="wp1021162"> </a>
<a href="rf3c.html#wp1014661">Table&#160;9</a> indicates the state of a connection descriptor returned by <code class="cCode">tpconnect()</code> or provided by a service invocation in the <code class="cCode">TPSVCINFO</code> structure. For primitives that do not take a connection descriptor, the state changes apply to all connection descriptors, unless otherwise noted.
</p>
<p class="pBody"><a name="wp1008843"> </a>
The states are as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1020748"> </a>C<sub class="cSubscript">0</sub>&#8212;No descriptor</li>
<li><a name="wp1020749"> </a>C<sub class="cSubscript">1</sub>&#8212;<code class="cCode">tpconnect()</code> descriptor send-only</li>
<li><a name="wp1020750"> </a>C<sub class="cSubscript">2</sub>&#8212;<code class="cCode">tpconnect()</code> descriptor receive-only </li>
<li><a name="wp1020751"> </a>C<sub class="cSubscript">3</sub>&#8212;<code class="cCode">TPSVCINFO</code> descriptor send-only</li>
<li><a name="wp1020752"> </a>C<sub class="cSubscript">4</sub>&#8212;<code class="cCode">TPSVCINFO</code> descriptor receive-only </li>
<p class="pGraphic"><a name="wp1008881"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1014661table1008882"><caption><a name="wp1014661"> </a>
Table&#160;9  Connection Request Descriptor States&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1009069"> </a>
Function/Event
</div>
</th>
    <th colspan="5" rowspan="1"><div class="pCellHeading"><a name="wp1009071"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1020754"> </a>
C<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1020757"> </a>
C<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1020760"> </a>
C<sub class="cSubscript">2</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1020763"> </a>
C<sub class="cSubscript">3</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1020766"> </a>
C<sub class="cSubscript">4</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1008904"> </a>
<code class="cCode">tpconnect</code> with <code class="cCode">TPSENDONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020773"> </a>
C<sub class="cSubscript">1</sub> <sup class="cSuperscript">a</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009110"> </a>
<code class="cCode">tpconnect</code> with <code class="cCode">TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020788"> </a>
C<sub class="cSubscript">2</sub> <sup class="cSuperscript">a</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009129"> </a>
<code class="cCode">tpservice</code> with flag <code class="cCode">TPSENDONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020803"> </a>
C<sub class="cSubscript">3</sub> <sup class="cSuperscript">b</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009148"> </a>
<code class="cCode">tpservice</code> with flag <code class="cCode">TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020818"> </a>
C<sub class="cSubscript">4 </sub><sup class="cSuperscript">b</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009167"> </a>
<code class="cCode">tprecv</code>/no event
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020839"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020845"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009186"> </a>
<code class="cCode">tprecv</code>/<code class="cCode">TPEV_SENDONLY</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020854"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020860"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009205"> </a>
<code class="cCode">tprecv</code>/<code class="cCode">TPEV_DISCONIMM</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020869"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020875"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009350"> </a>
<code class="cCode">tprecv</code>/<code class="cCode">TPEV_SVCERR</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020884"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009377"> </a>
<code class="cCode">tprecv</code>/<code class="cCode">TPEV_SVCFAIL</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020899"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009404"> </a>
<code class="cCode">tprecv</code>/<code class="cCode">TPEV_SVCSUCC</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020914"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009431"> </a>
<code class="cCode">tpsend</code>/no event
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020926"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020932"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009460"> </a>
<code class="cCode">tpsend</code> with flag <code class="cCode">TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020941"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020947"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009489"> </a>
<code class="cCode">tpsend</code>/<code class="cCode">TPEV_DISCONIMM</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020956"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020962"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009518"> </a>
<code class="cCode">tpsend</code>/<code class="cCode">TPEV_SVCERR</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020971"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009545"> </a>
<code class="cCode">tpsend</code>/<code class="cCode">TPEV_SVCFAIL</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020986"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009572"> </a>
<code class="cCode">tpterm</code> (client only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1020998"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021001"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009601"> </a>
<code class="cCode">tpcommit</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021013"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021016"> </a>
C<sub class="cSubscript">0</sub> <sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021019"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009636"> </a>
<code class="cCode">tpsuspend</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021028"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021031"> </a>
C<sub class="cSubscript">1</sub> <sup class="cSuperscript">d</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021034"> </a>
C<sub class="cSubscript">2 </sub><sup class="cSuperscript">d</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009671"> </a>
<code class="cCode">tpabort</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021043"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021046"> </a>
C<sub class="cSubscript">0</sub> <sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021049"> </a>
C<sub class="cSubscript">0</sub> <sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009706"> </a>
<code class="cCode">tpdiscon</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021061"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021064"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009735"> </a>
<code class="cCode">tpreturn</code> (<code class="cCode">CONV</code> server)
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021076"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021079"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021082"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021085"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009768"> </a>
<code class="cCode">tpforward</code> (<code class="cCode">CONV</code> server)
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021091"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021094"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021097"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021100"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1009801"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021103"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021106"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021109"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021112"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1021115"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
</table>
</div>

</p>
</ul></div>
<a name="wp1021130"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><sup class="cSuperscript">a</sup> If process is in transaction mode and <code class="cCode">TPNOTRAN</code> is not specified, the connection is in transaction mode.</td>
</tr>
</table>

<a name="wp1021157"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">b</sup> If the <code class="cCode">TPTRAN</code> flag is set, the connection is in transaction mode.</td>
</tr>
</table>
<a name="wp1021158"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">c</sup> If the connection is not in transaction mode, no state change.</td>
</tr>
</table>
<a name="wp1021159"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">d</sup> If the connection is in transaction mode, then <code class="cCode">tpsuspend()</code> returns a protocol error.</td>
</tr>
</table>
<h4 class="pHeading3"><a name="wp1009941"> </a>
TX State Transitions
</h4>
<p class="pBody"><a name="wp1009952"> </a>
The Oracle Tuxedo ATMI system ensures that a process calls the TX functions in a legal sequence. When an illegal state transition is attempted (that is, a call from a state with a blank transition entry), the called function returns <code class="cCode">TX_PROTOCOL_ERROR</code>. The legal states and transitions for the TX functions are shown in <a href="rf3c.html#wp1831778">Table&#160;10</a>. Calls that return failure do not make state transitions, unless they are described by specific state table entries. Any Oracle Tuxedo ATMI system client or server is allowed to use the TX functions.
</p>
<p class="pBody"><a name="wp1010017"> </a>
The states are defined below: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1011529"> </a>S<sub class="cSubscript">0</sub>: No RMs have been opened or initialized. An application association cannot start a global transaction until it has successfully called <code class="cCode">tx_open</code>.</li>
<li><a name="wp1010068"> </a>S<sub class="cSubscript">1</sub>: An application association has opened its RM but is not in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX_UNCHAINED</code>.</li>
<li><a name="wp1010109"> </a>S<sub class="cSubscript">2</sub>: An application association has opened its RM but is not in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.</li>
<li><a name="wp1010150"> </a>S<sub class="cSubscript">3</sub>: An application association has opened its RM and is in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX_UNCHAINED</code>.</li>
<li><a name="wp1010191"> </a>S<sub class="cSubscript">4</sub>: An application association has opened its RM and is in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.</li>
<p class="pGraphic"><a name="wp1017676"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1831778table1017471"><caption><a name="wp1831778"> </a>
Table&#160;10  TX Function States and Transitions&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1017485"> </a>
Function
</div>
</th>
    <th colspan="5" rowspan="1"><div class="pCellHeading"><a name="wp1017487"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1017499"> </a>
S<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1017501"> </a>
S<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1017503"> </a>
S<sub class="cSubscript">2</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1017505"> </a>
S<sub class="cSubscript">3</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1017507"> </a>
S<sub class="cSubscript">4</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017509"> </a>
<code class="cCode">tx_begin</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017935"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017938"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017521"> </a>
<code class="cCode">tx_close</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017947"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017950"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017953"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017533"> </a>
<code class="cCode">tx_commit </code><span class="arrow"><img id="LongDescNotReq1" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCode"> TX_SET1</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017971"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017974"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017545"> </a>
<code class="cCode">tx_commit </code><span class="arrow"><img id="LongDescNotReq2" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCode"> TX_SET2</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017989"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017557"> </a>
<code class="cCode">tx_info</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017995"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017998"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018001"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018004"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017569"> </a>
<code class="cCode">tx_open</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018007"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018010"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018013"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018016"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018019"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017581"> </a>
<code class="cCode">tx_rollback </code><span class="arrow"><img id="LongDescNotReq3" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCode"> TX_SET1</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018031"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018034"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017593"> </a>
<code class="cCode">tx_rollback </code><span class="arrow"><img id="LongDescNotReq4" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCode"> TX_SET2</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018049"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017605"> </a>
<code class="cCode">tx_set_commit_return</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018055"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018058"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018061"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018064"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017617"> </a>
<code class="cCode">tx_set_transaction_control   control = TX_CHAINED</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018070"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018073"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018076"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018079"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017641"> </a>
<code class="cCode">tx_set_transaction_control control = TX_UNCHAINED</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018100"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018103"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018106"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018109"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1017665"> </a>
<code class="cCode">tx_set_transaction_timeout</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018130"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018133"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018136"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1018139"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
</table>
</div>

</p>
<li><a name="wp1403050"> </a><code class="cCode">TX_SET1</code> denotes any of the following: <code class="cCode">TX_OK</code>, <code class="cCode">TX_ROLLBACK</code>, <code class="cCode">TX_MIXED</code>, <code class="cCode">TX_HAZARD</code>, or <code class="cCode">TX_COMMITTED</code>. <code class="cCode">TX_ROLLBACK</code> is not returned by <code class="cCode">tx_rollback()</code> and <code class="cCode">TX_COMMITTED</code> is not returned by <code class="cCode">tx_commit()</code>.</li>
<li><a name="wp1010931"> </a><code class="cCode">TX_SET2</code> denotes any of the following: <code class="cCode">TX_NO_BEGIN</code>, <code class="cCode">TX_ROLLBACK_NO_BEGIN</code>, <code class="cCode">TX_MIXED_NO_BEGIN</code>, <code class="cCode">TX_HAZARD_NO_BEGIN</code>, or <code class="cCode">TX_COMMITTED_NO_BEGIN.</code> <code class="cCode">TX_ROLLBACK_NO_BEGIN</code> is not returned by <code class="cCode">tx_rollback()</code> and <code class="cCode">TX_COMMITTED_NO_BEGIN</code> is not returned by <code class="cCode">tx_commit()</code>.</li>
<li><a name="wp1010983"> </a>If <code class="cCode">TX_FAIL</code> is returned on any call, the application process is in an undefined state with respect to the above table.</li>
<li><a name="wp1011011"> </a>When <code class="cCode">tx_info()</code> returns either <code class="cCode">TX_ROLLBACK_ONLY</code> or <code class="cCode">TX_TIMEOUT_ROLLBACK_ONLY</code> in the transaction state information, the transaction is marked rollback-only and will be rolled back whether the application program calls <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code>.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1011071"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1011217"> </a>
<a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a>, <a href="rf3c.html#wp1021630"><code class="cCode">tpadvertise(3c)</code></a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a>,<code class="cCode"> </code><span class="cHyperlink">
<a href="../rf5/rf5.html">tuxtypes(5)</a></span>, <a href="../rf5/rf5.html">typesw(5)</a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023618"> </a>
AEMsetblockinghook(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023619"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023620"> </a>
<code class="cCode">AEMsetblockinghook()</code>&#8212;Establishes an application-specific blocking hook function.
</p>
<h4 class="pHeading3"><a name="wp1023621"> </a>
Synopsis
</h4>
<a name="wp1023622"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />int AEMsetblockinghook(_TM_FARPROC)</pre></div><h4 class="pHeading3"><a name="wp1023623"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023624"> </a>
<code class="cCode">AEMsetblockinghook()</code> is an &#8220;ATMI Extension for Mac&#8221; that allows a Mac task to install a new function which the ATMI networking software uses to implement blocking ATMI calls. It takes a pointer to the procedure instance address of the blocking function to be installed.
</p>
<p class="pBody"><a name="wp1023625"> </a>
A default function, by which blocking ATMI calls are handled, is included. The function <code class="cCode">AEMsetblockinghook()</code> gives the application the ability to execute its own function at &#8220;blocking&#8221; time in place of the default function. If called with a NULL pointer, the blocking hook function is reset to the default function.
</p>
<p class="pBody"><a name="wp1023626"> </a>
When an application invokes a blocking ATMI operation, the operation is initiated and then a loop is entered which is equivalent to the following pseudocode:
</p>
<a name="wp1051042"> </a><div class="pPreformatted"><pre>for(;;) {  <br />        execute operation in non-blocking mode  <br />        if error<br />               break;<br />        if operation complete  <br />               break;  <br />        while(BlockingHook())  <br />                 ;  <br />}</pre></div><h4 class="pHeading3"><a name="wp1817853"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1817854"> </a>
<code class="cCode">AEMsetblockinghook()</code> returns a pointer to the procedure-instance of the previously installed blocking function. The application or library that calls the <code class="cCode">AEMsetblockinghook()</code> function should save this return value so that it can be restored if necessary. (If &#8220;nesting&#8221; is not important, the application may simply discard the value returned by <code class="cCode">AEMsetblockinghook()</code> and eventually use <code class="cCode">AEMsetblockinghook</code>(NULL) to restore the default mechanism.) <code class="cCode">AEMsetblockinghook()</code> returns NULL on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1023629"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023630"> </a>
Under failure, <code class="cCode">AEMsetblockinghook()</code> sets <code class="cCode">tperrno</code> to the following value:
</p>
<h4 class="pDefTerm"><a name="wp1023631"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1095662"> </a>
<code class="cCode">AEMsetblockinghook()</code> was called while a blocking operation was in progress.
</div>
<h4 class="pHeading3"><a name="wp1023632"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1023633"> </a>
This interface is supported only in Mac clients.
</p>
<h4 class="pHeading3"><a name="wp1023634"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1023635"> </a>
The blocking function is reset after <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a> is called by the application.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023907"> </a>
AEOaddtypesw(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023908"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023909"> </a>
<code class="cCode">AEOaddtypesw()</code>&#8212;Installs or replaces a user-defined buffer type at execution time.
</p>
<h4 class="pHeading3"><a name="wp1023910"> </a>
Synopsis
</h4>
<a name="wp1023911"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />#include &lt;tmtypes.h&gt;  <br /> <br />int FAR PASCAL AEOaddtypesw(TMTYPESW *newtype)</pre></div><h4 class="pHeading3"><a name="wp1023912"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023913"> </a>
<code class="cCode">AEOaddtypesw()</code> is an &#8220;ATMI Extension for OS/2&#8221; that allows an OS/2 client to install a new, or replace an existing, user-defined buffer type at execution time. The argument to this function is a pointer to a <code class="cCode">TMTYPESW</code> structure that contains the information for the buffer type to be installed.
</p>
<p class="pBody"><a name="wp1023914"> </a>
If the <code class="cCode">type()</code> and the <code class="cCode">subtype()</code> match an existing buffer type already installed, then all the information is replaced with the new buffer type. If the information does not match the <code class="cCode">type()</code> and the <code class="cCode">subtype()</code> fields, then the new buffer type is added to the existing types registered with the Oracle Tuxedo ATMI system. For new buffer types, make sure that the <code class="cCode">WSH</code> and other Oracle Tuxedo ATMI system processes involved in the call processing have been built with the new buffer type.
</p>
<p class="pBody"><a name="wp1023915"> </a>
The function pointers in the <code class="cCode">TMTYPESW</code> array should appear in the Module Definition file of the application in the <code class="cCode">EXPORTS</code> section.
</p>
<p class="pBody"><a name="wp1023916"> </a>
The application can also use the Oracle Tuxedo ATMI system&#8217;s defined buffer type routines. The application and the Oracle Tuxedo ATMI system&#8217;s buffer routines can be intermixed in one user defined buffer type.
</p>
<h4 class="pHeading3"><a name="wp1023917"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023918"> </a>
Upon success, <code class="cCode">AEOaddtypesw()</code> returns the number of user buffer types in the system Upon failure, <code class="cCode">AEOaddtypesw()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1023919"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023920"> </a>
Upon failure, <code class="cCode">AEOaddtypesw()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1023921"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026174"> </a>
<code class="cCode">AEOaddtypesw()</code> was called and the <code class="cCode">type</code> parameter was NULL.
</div>
<h4 class="pDefTerm"><a name="wp1023922"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1026186"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1023923"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1023924"> </a>
This interface is supported only in Windows clients. The preferred way to install a type switch is to add it to the Oracle Tuxedo ATMI system type switch DLL. Please refer to <em class="cEmphasis">Setting Up an Oracle Tuxedo Application</em> for more information.
</p>
<h4 class="pHeading3"><a name="wp1023925"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1023926"> </a>
FAR PASCAL is used only for the 16-bit OS/2 environment.
</p>
<h4 class="pHeading3"><a name="wp1023927"> </a>
Examples
</h4>
<a name="wp1023928"> </a><div class="pPreformatted"><pre>  #include &lt;os2.h&gt;<br />  #include &lt;atmi.h&gt;<br />  #include &lt;tmtypes.h&gt;<br /> <br />  int FAR PASCAL Nfinit(char FAR *, long);<br />  int (FAR PASCAL * lpFinit)(char FAR *, long);<br />  int FAR PASCAL Nfreinit(char FAR *, long);<br />  int (FAR PASCAL * lpFreinit)(char FAR *, long);<br />  int FAR PASCAL Nfuninit(char FAR *, long);<br />  int (FAR PASCAL * lpFuninit)(char FAR *, long);<br /> <br />  TMTYPESW        newtype =<br />  {<br />  &#8220;MYFML&#8221;,          &#8220;&#8220;,             1024,           NULL,           NULL,<br />  NULL,           _fpresend,      _fpostsend,     _fpostrecv,     _fencdec,<br />  _froute<br />  };<br /> <br />     newtype.initbuf = Nfinit;<br />     newtype.reinitbuf = Nfreinit;<br />     newtype.uninitbuf = Nfuninit;<br /> <br />     if(AEOaddtypesw(newtype) == -1) {<br />             userlog(&#8220;AEOaddtypesw failed %s&#8221;, tpstrerror(tperrno));<br />     }<br />  int<br />  FAR PASCAL<br />  Nfinit(char FAR *ptr, long len)<br />  {<br />        ......<br />        return(1);<br />  }<br /> <br />  int<br />  FAR PASCAL<br />  Nfreinit(char FAR *ptr, long len)<br />  {<br />        ......<br />        return(1);<br />  }<br /> <br />  int<br />  FAR PASCAL<br />  Nfuninit(char FAR *ptr, long mdlen)<br />  {<br />         ......<br />         return(1);<br />  }</pre></div><p class="pBody"><a name="wp1023929"> </a>
The application Module Definition File: 
</p>
<a name="wp1023930"> </a><div class="pPreformatted"><pre>  ; EXAMPLE.DEF file<br /> <br />  NAME         EXAMPLE<br /> <br />  DESCRIPTION  &#39;EXAMPLE for OS/2&#39;<br /> <br />  EXETYPE      OS/2<br /> <br /> <br />  EXPORTS<br />          Nfinit<br />          Nfreinit<br />          Nfuninit<br />           ....</pre></div><h4 class="pHeading3"><a name="wp1023931"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023932"> </a>
<a href="../rfcm/rfcmd.html">buildwsh(1)</a>, <a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a>, <a href="../rf5/rf5.html">typesw(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1024299"> </a>
AEPisblocked(3c)
</h3>
<h4 class="pHeading3"><a name="wp1024300"> </a>
Name
</h4>
<p class="pBody"><a name="wp1024301"> </a>
<code class="cCode">AEPisblocked()</code>&#8212;Determines if a blocking call is in progress.
</p>
<h4 class="pHeading3"><a name="wp1024302"> </a>
Synopsis
</h4>
<a name="wp1024303"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int far pascal AEPisblocked(void)</pre></div><h4 class="pHeading3"><a name="wp1024304"> </a>
Description
</h4>
<p class="pBody"><a name="wp1024305"> </a>
<code class="cCode">AEPisblocked()</code> is an &#8220;ATMI Extension for OS/2 Presentation Manager&#8221; that allows a OS/2 PM task to determine if it is executing while waiting for a previous blocking call to complete.
</p>
<h4 class="pHeading3"><a name="wp1024306"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1024307"> </a>
If there is an outstanding blocking function awaiting completion, <code class="cCode">AEPisblocked()</code> returns 1. Otherwise, it returns 0.
</p>
<h4 class="pHeading3"><a name="wp1024308"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1024309"> </a>
No errors are returned.
</p>
<h4 class="pHeading3"><a name="wp1024310"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1024311"> </a>
This interface is supported only in OS/2 PM clients.
</p>
<h4 class="pHeading3"><a name="wp1024312"> </a>
Comments
</h4>
<p class="pBody"><a name="wp1024313"> </a>
Although a blocking ATMI call appears to an application as though it &#8220;blocks,&#8221; the OS/2 PM ATMI DLL has to relinquish the processor to allow other applications to run. This means that it is possible for the application which issued the blocking call to be reentered, depending on the message(s) it receives. In this instance, the <code class="cCode">AEPisblocked()</code> function can be used to ascertain whether the task has been reentered while waiting for an outstanding blocking call to complete. Note that ATMI prohibits more than one outstanding call per thread.
</p>
<h4 class="pHeading3"><a name="wp1024314"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1054501"> </a>
<a href="rf3c.html#wp1023618"><code class="cCode">AEMsetblockinghook(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1025860"> </a>
AEWsetunsol(3c)
</h3>
<h4 class="pHeading3"><a name="wp1025861"> </a>
Name
</h4>
<p class="pBody"><a name="wp1025862"> </a>
<code class="cCode">AEWsetunsol()</code>&#8212;Posts a Windows message for Oracle Tuxedo ATMI unsolicited event.
</p>
<h4 class="pHeading3"><a name="wp1025863"> </a>
Synopsis
</h4>
<a name="wp1025864"> </a><div class="pPreformatted"><pre>#include &lt;windows.h&gt;<br />#include &lt;atmi.h&gt;<br />int far pascal AEWsetunsol(HWND hWnd, WORD wMsg)</pre></div><h4 class="pHeading3"><a name="wp1025865"> </a>
Description
</h4>
<p class="pBody"><a name="wp1025866"> </a>
In certain Microsoft Windows programming environments, it is natural and convenient for the Oracle Tuxedo ATMI system&#8217;s unsolicited messages to be posted to the Windows event message queue.
</p>
<p class="pBody"><a name="wp1025867"> </a>
<code class="cCode">AEWsetunsol()</code> controls which window to notify, <code class="cCodeEmphasis">hWnd</code>, and which Windows message type to post, <code class="cCodeEmphasis">wMsg</code>. When an Oracle Tuxedo ATMI unsolicited message arrives, a Windows message is posted. <code class="cCode">lParam()</code> is set to the Oracle Tuxedo ATMI system buffer pointer, or zero if none. If <code class="cCode">lParam()</code> is non-zero, the application must call <code class="cCode">tpfree()</code> to release the buffer.
</p>
<p class="pBody"><a name="wp1025868"> </a>
If <code class="cCodeEmphasis">wMsg</code> is zero, any future unsolicited messages will be logged and ignored.
</p>
<p class="pBody"><a name="wp1630153"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">AEWsetunsol()</code>.
</p>
<h4 class="pHeading3"><a name="wp1025869"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1025870"> </a>
Upon failure, <code class="cCode">AEWsetunsol()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1025871"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1025872"> </a>
Upon failure, <code class="cCode">AEWsetunsol()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1025873"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1025874"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1025875"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1025876"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1025877"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1025878"> </a>
This interface is supported only in Microsoft Windows clients.
</p>
<h4 class="pHeading3"><a name="wp1025879"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1025880"> </a>
<code class="cCode">AEWsetunsol()</code> posting of Windows messages may not be activated simultaneously with a <code class="cCode">tpsetunsol()</code> callback routine. The most recent <code class="cCode">tpsetunsol()</code> or <code class="cCode">AEWsetunsol()</code> request controls how unsolicited messages will be handled.
</p>
<h4 class="pHeading3"><a name="wp1025881"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1025882"> </a>
<a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021456"> </a>
buffer(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021457"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021458"> </a>
<code class="cCode">buffer()</code>&#8212;Semantics of elements in <code class="cCode">tmtype_sw_t</code>.
</p>
<h4 class="pHeading3"><a name="wp1021459"> </a>
Synopsis
</h4>
<a name="wp1364654"> </a><div class="pPreformatted"><pre>int     /* Initialize a new data buffer */<br />_tminitbuf(char *ptr, long len)<br />int    /* Reinitialize a reallocated data buffer */<br />_tmreinitbuf(char *ptr, long len)<br />int    /* Uninitialize a data buffer to be freed */<br />_tmuninitbuf(char *ptr, long len)<br />long   /* Process buffer before sending */<br />_tmpresend(char *ptr, long dlen, long mdlen)<br />void   /* Process buffer after sending */<br />_tmpostsend(char *ptr, long dlen, long mdlen)<br />long   /* Process buffer after receiving */<br />_tmpostrecv(char *ptr, long dlen, long mdlen)<br />long   /* Encode/decode a buffer to/from a transmission format */<br />_tmencdec(int op, char *encobj, long elen, char *obj, long olen)<br />int    /* Determine server group for routing based on data */<br />_tmroute(char *routing_name, char *service, char *data, long \  len, char *group)<br />int    /* Evaluate boolean expression on buffer&#8217;s data */<br />_tmfilter(char *ptr, long dlen, char *expr, long exprlen)<br />int    /* Extract buffer&#8217;s data based on format string */<br />_tmformat(char *ptr, long dlen, char *fmt, char *result, long \  maxresult) <br />long   /* Process buffer before sending, possibly generating copy */<br />_tmpresend2(char *iptr, long ilen, long mdlen, char *optr, long olen, long *flags )<br />long  /* Multibyte code-set encoding conversion */ <br />_tmconvmb(char *ibufp, long ilen, char *enc_name, char *obufp, long olen, long <br />&#160;&#160;&#160;&#160;*flags)</pre></div><h4 class="pHeading3"><a name="wp1364615"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021462"> </a>
This page describes the semantics of the elements and routines defined in the <code class="cCode">tmtype_sw_t</code> structure. These descriptions are necessary for adding new buffer types to a process buffer type switch, <code class="cCode">tm_typesw</code>. The switch elements are defined in <a href="../rf5/rf5.html">typesw(5)</a>. The function names used in this entry are templates for the actual function names defined by the Oracle Tuxedo ATMI system as well as by applications adding their own buffer types. The names map to the switch elements very simply: the template names are made by taking each function pointer&#8217;s element name and prepending <code class="cCode">_tm</code> (for example, the element <code class="cCode">initbuf</code> has the function name <code class="cCode">_tminitbuf()</code>).
</p>
<p class="pBody"><a name="wp1021463"> </a>
The element <code class="cCode">type</code> must be non-NULL and up to 8 characters in length. The element <code class="cCode">subtype</code> can be NULL, a string of up to 16 characters, or the wildcard character, &#8220;*&#8221;. If <code class="cCode">type</code> is not unique in the switch, then <code class="cCode">subtype</code> must be used; the combination of <code class="cCode">type</code> and <code class="cCode">subtype</code> must uniquely identify an element in the switch.
</p>
<p class="pBody"><a name="wp1021464"> </a>
A given type can have multiple subtypes. If all subtypes are to be treated the same for a given type, then the wildcard character, &#8220;*&#8221;, can be used. Note that the function <code class="cCode">tptypes()</code> can be used to determine a buffer&#8217;s type and subtype if subtypes need to be distinguished. If some subset of the subtypes within a particular type are to be treated individually, and the rest are to be treated identically, then those which are to be singled out with specific subtype values should appear in the switch before the subtype designated with the wildcard. Thus, searching for types and subtypes in the switch is done from top to bottom, and the wildcard subtype entry accepts any &#8220;leftover&#8221; type matches.
</p>
<p class="pBody"><a name="wp1116548"> </a>
<code class="cCode">dfltsize()</code> is used when allocating or reallocating a buffer. The larger of <code class="cCode">dfltsize()</code> and the routines&#8217; <code class="cCodeEmphasis">size</code> parameter is used to create or reallocate a buffer. For some types of structures, like a fixed sized C structure, the buffer size should equal the size of the structure. If <code class="cCode">dfltsize()</code> is set to this value, then the caller may not need to specify the buffer&#8217;s length to routines in which a buffer is passed. <code class="cCode">dfltsize()</code> can be 0 or less; however, if <code class="cCode">tpalloc()</code> or <code class="cCode">tprealloc()</code> is called and its <code class="cCodeEmphasis">size</code> parameter is also less than or equal to 0, then the routine will fail. It is not recommended to set <code class="cCode">dfltsize()</code> to a value less than 0.
</p>
<h4 class="pHeading3"><a name="wp1116549"> </a>
Routine Specifics
</h4>
<p class="pBody"><a name="wp1116550"> </a>
The names of the functions specified below are template names used within the Oracle Tuxedo ATMI system. Any application adding new routines to the buffer type switch must use names that correspond to real functions, either provided by the application or library routines. If a NULL function pointer is stored in a buffer type switch entry, the Oracle Tuxedo ATMI system calls a default function that takes the correct number and type of arguments, and returns a default value.
</p>
<h4 class="pHeading3"><a name="wp1021468"> </a>
_tminitbuf
</h4>
<p class="pBody"><a name="wp1021469"> </a>
<code class="cCode">_tminitbuf()</code> is called from within <code class="cCode">tpalloc()</code> after a buffer has been allocated. It is passed a pointer to the new buffer, <code class="cCodeEmphasis">ptr</code>, along with its size so that the buffer can be initialized appropriately. <code class="cCodeEmphasis">len </code>is the larger of the length passed into <code class="cCode">tpalloc()</code> and the default specified in <code class="cCode">dfltsize()</code> in that type&#8217;s switch entry. Note that <code class="cCodeEmphasis">ptr</code> will never be NULL due to the semantics of <code class="cCode">tpalloc()</code> and <code class="cCode">tprealloc()</code>. Upon successful return, <code class="cCodeEmphasis">ptr</code> is returned to the caller of <code class="cCode">tpalloc()</code>.
</p>
<p class="pBody"><a name="wp1021470"> </a>
If a single switch entry is used to manipulate many subtypes, then the writer of <code class="cCode">_tminitbuf()</code> can use <code class="cCode">tptypes()</code> to determine the subtype.
</p>
<p class="pBody"><a name="wp1021471"> </a>
If no buffer initialization needs to be performed, specify a NULL function pointer.
</p>
<p class="pBody"><a name="wp1021472"> </a>
Upon success, <code class="cCode">_tminitbuf()</code> returns 1. If the function fails, it returns -1 causing <code class="cCode">tpalloc()</code> to also return failure setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021473"> </a>
_tmreinitbuf
</h4>
<p class="pBody"><a name="wp1021474"> </a>
<code class="cCode">_tmreinitbuf()</code> behaves the same as <code class="cCode">_tminitbuf()</code> except it is used to reinitialize a reallocated buffer. It is called from within <code class="cCode">tprealloc()</code> after the buffer has been reallocated.
</p>
<p class="pBody"><a name="wp1021475"> </a>
If no buffer reinitialization needs to be performed, specify a NULL function pointer.
</p>
<p class="pBody"><a name="wp1021476"> </a>
Upon success, <code class="cCode">_tmreinitbuf()</code> returns 1. If the function fails, it returns -1 causing <code class="cCode">tprealloc()</code> to also return failure setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021477"> </a>
_tmuninitbuf
</h4>
<p class="pBody"><a name="wp1021478"> </a>
<code class="cCode">_tmuninitbuf()</code> is called by <code class="cCode">tpfree()</code> before the data buffer is freed. <code class="cCode">_tmuninitbuf()</code> is passed a pointer to the application portion of a data buffer, along with its size, and can be used to clean up any structures or state information associated with that buffer. <code class="cCodeEmphasis">ptr</code> will never be NULL due to <code class="cCode">tpfree()</code>&#8217;s semantics. Note that <code class="cCode">_tmuninitbuf()</code> should not free the buffer itself. The <code class="cCode">tpfree()</code> function is called automatically for any <code class="cCode">FLD_PTR</code> fields in the data buffer.
</p>
<p class="pBody"><a name="wp1021479"> </a>
If no processing needs to be performed before freeing a buffer, specify a NULL function pointer.
</p>
<p class="pBody"><a name="wp1021480"> </a>
Upon success, <code class="cCode">_tmuninitbuf()</code> returns 1. If the function fails, it returns -1 causing <code class="cCode">tpfree()</code> to print a log message.
</p>
<h4 class="pHeading3"><a name="wp1021481"> </a>
_tmpresend
</h4>
<p class="pBody"><a name="wp1021482"> </a>
<code class="cCode">_tmpresend()</code> is called before a buffer is sent in <code class="cCode">tpcall()</code>, <code class="cCode">tpacall()</code>, <code class="cCode">tpconnect()</code>, <code class="cCode">tpsend()</code>, <code class="cCode">tpbroadcast()</code>, <code class="cCode">tpnotify()</code>, <code class="cCode">tpreturn()</code>, or <code class="cCode">tpforward()</code>. It is also called after <code class="cCode">_tmroute()</code> but before <code class="cCode">_tmencdec()</code>. If <code class="cCodeEmphasis">ptr()</code> is non-NULL, preprocessing is performed on a buffer before it is sent. <code class="cCode">_tmpresend()</code>&#8217;s first argument, <code class="cCodeEmphasis">ptr</code>, is the application data buffer passed into the send call. Its second argument, <code class="cCodeEmphasis">dlen</code>, is the data&#8217;s length as passed into the send call. Its third argument, <code class="cCodeEmphasis">mdlen</code>, is the actual size of the buffer in which the data resides.
</p>
<p class="pBody"><a name="wp1021483"> </a>
One important requirement on this function is that it ensures that when the function returns, the data pointed to by <code class="cCodeEmphasis">ptr</code> can be sent &#8220;as is.&#8221; That is, since <code class="cCode">_tmencdec()</code> is called only if the buffer is being sent to a dissimilar machine, <code class="cCode">_tmpresend()</code> must ensure upon return that no element in <code class="cCodeEmphasis">ptr&#8217;</code>s buffer is a pointer to data that is not contiguous to the buffer.
</p>
<p class="pBody"><a name="wp1021484"> </a>
If no preprocessing needs to be performed on the data and the amount of data the caller specified is the same as the amount that should be sent, specify a NULL function pointer. The default routine returns <code class="cCodeEmphasis">dlen</code> and does nothing to the buffer.
</p>
<p class="pBody"><a name="wp1364658"> </a>
If <code class="cCode">_tmpresend2()</code> is not NULL, <code class="cCode">_tmpresend()</code> is not called and <code class="cCode">_tmpresend2()</code> is called in its place.
</p>
<p class="pBody"><a name="wp1021485"> </a>
Upon success, <code class="cCode">_tmpresend()</code> returns the amount of data to be sent. If the function fails, it returns -1 causing <code class="cCode">_tmpresend()</code>&#8217;s caller to also return failure setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021486"> </a>
_tmpostsend
</h4>
<p class="pBody"><a name="wp1021487"> </a>
<code class="cCode">_tmpostsend()</code> is called after a buffer is sent in <code class="cCode">tpcall()</code>, <code class="cCode">tpbroadcast(), tpnotify(), tpacall(), tpconnect(),</code> or <code class="cCode">tpsend()</code>. This routine allows any post-processing to be performed on a buffer after it is sent and before the function returns. Because the buffer passed into the send call should not be different upon return, <code class="cCode">_tmpostsend()</code> is called to repair a buffer changed by <code class="cCode">_tmpresend()</code>. This function&#8217;s first argument, <code class="cCodeEmphasis">ptr</code>, points to the data sent as a result of <code class="cCode">_tmpresend()</code>. The data&#8217;s length, as returned from <code class="cCode">_tmpresend()</code>, is passed in as this function&#8217;s second argument, <code class="cCodeEmphasis">dlen</code>. The third argument, <code class="cCodeEmphasis">mdlen</code>, is the actual size of the buffer in which the data resides. This routine is called only when <code class="cCodeEmphasis">ptr</code> is non-NULL.
</p>
<p class="pBody"><a name="wp1021488"> </a>
If no post-processing needs to be performed, specify a NULL function pointer.
</p>
<h4 class="pHeading3"><a name="wp1021489"> </a>
_tmpostrecv
</h4>
<p class="pBody"><a name="wp1021490"> </a>
<code class="cCode">_tmpostrecv()</code> is called after a buffer is received, and possibly decoded, in <code class="cCode">tpgetrply(), tpcall(), tprecv(),</code> or in the Oracle Tuxedo ATMI system&#8217;s server abstraction, and before it is returned to the application. If <code class="cCodeEmphasis">ptr</code> is non-NULL, <code class="cCode">_tmpostrecv()</code> allows post-processing to be performed on a buffer after it is received and before it is given to the application. Its first argument, <code class="cCodeEmphasis">ptr</code>, points to the data portion of the buffer received. Its second argument, <code class="cCodeEmphasis">dlen</code>, specifies the data&#8217;s size coming in to <code class="cCode">_tmpostrecv()</code>. The third argument, <code class="cCodeEmphasis">mdlen</code>, specifies the actual size of the buffer in which the data resides.
</p>
<p class="pBody"><a name="wp1021491"> </a>
If <code class="cCode">_tmpostrecv()</code> changes the data length in post-processing, it must return the data&#8217;s new length. The length returned is passed up to the application in a manner dependent on the call used (for example, <code class="cCode">tpcall()</code> sets the data length in one of its arguments for the caller to check upon return).
</p>
<p class="pBody"><a name="wp1021492"> </a>
The buffer&#8217;s size might not be large enough for post-processing to succeed. If more space is required, <code class="cCode">_tmpostrecv()</code> returns the negative absolute value of the desired buffer size. The calling routine then resizes the buffer, and calls <code class="cCode">_tmpostrecv()</code> a second time.
</p>
<p class="pBody"><a name="wp1021493"> </a>
If no post-processing needs to be performed on the data and the amount of data received is the same as the amount that should be returned to the application, specify a NULL function pointer. The default routine returns <code class="cCodeEmphasis">dlen</code> and does nothing to the buffer.
</p>
<p class="pBody"><a name="wp1021494"> </a>
On success, <code class="cCode">_tmpostrecv()</code> returns the size of the data the application should be made aware of when the buffer is passed up from the corresponding receive call. If the function fails, it returns -1 causing <code class="cCode">_tmpostrecv()</code>&#8217;s caller to return failure, setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021495"> </a>
_tmencdec
</h4>
<p class="pBody"><a name="wp1021496"> </a>
<code class="cCode">_tmencdec()</code> is used to encode/decode a buffer sent/received over a network to/from a machine having different data representations. The Oracle Tuxedo ATMI system recommends the use of XDR; however, any encoding/decoding scheme can be used that obeys the semantics of this routine.
</p>
<p class="pBody"><a name="wp1021497"> </a>
This function is called by <code class="cCode">tpcall()</code>, <code class="cCode">tpacall()</code>, <code class="cCode">tpbroadcast()</code>, <code class="cCode">tpnotify()</code>, <code class="cCode">tpconnect()</code>, <code class="cCode">tpsend()</code>, <code class="cCode">tpreturn()</code>, or <code class="cCode">tpforward()</code> to encode the caller&#8217;s buffer only when it is being sent to an &#8220;unlike&#8221; machine. In these calls, <code class="cCode">_tmencdec()</code> is called after both <code class="cCode">_tmroute()</code> and <code class="cCode">_tmpresend()</code>, respectively. Recall from the description of <code class="cCode">_tmpresend()</code> that the buffer passed into <code class="cCode">_tmencdec()</code> contains no pointers to data that is not contiguous to the buffer.
</p>
<p class="pBody"><a name="wp1021498"> </a>
On the receiving end, <code class="cCode">tprecv()</code>, <code class="cCode">tpgetrply()</code>, the receive half of <code class="cCode">tpcall()</code> and the server abstraction all call <code class="cCode">_tmencdec()</code> to decode a buffer after they have received it from an &#8220;unlike&#8221; machine but before calling <code class="cCode">_tmpostrecv()</code>.
</p>
<p class="pBody"><a name="wp1021499"> </a>
<code class="cCode">_tmencdec()</code>&#8217;s first argument, <code class="cCodeEmphasis">op</code>, specifies whether the function is encoding or decoding data. <code class="cCodeEmphasis">op</code> can be one of <code class="cCode">TMENCODE</code> or <code class="cCode">TMDECODE</code>.
</p>
<p class="pBody"><a name="wp1021500"> </a>
When <code class="cCodeEmphasis">op</code> is <code class="cCode">TMENCODE</code>, <code class="cCodeEmphasis">encobj</code> points to a buffer allocated by the Oracle Tuxedo ATMI system where the encoded version of the data will be copied. The unencoded data resides in <code class="cCodeEmphasis">obj</code>. That is, when <code class="cCodeEmphasis">op</code> is <code class="cCode">TMENCODE</code>, <code class="cCode">_tmencdec()</code> transforms <code class="cCodeEmphasis">obj</code> to its encoded format and places the result in <code class="cCodeEmphasis">encobj</code>. The size of the buffer pointed to by <code class="cCodeEmphasis">encobj</code> is specified by <code class="cCodeEmphasis">elen</code> and is at least four times the size of the buffer pointed to by <code class="cCodeEmphasis">obj</code> whose length is <code class="cCodeEmphasis">olen</code>. <code class="cCodeEmphasis">olen</code> is the length returned by <code class="cCode">_tmpresend. _tmencdec() </code>returns the size of the encoded data in <code class="cCodeEmphasis">encobj</code> (that is, the amount of data to actually send). <code class="cCode">_tmencdec()</code> should not free either of the buffers passed into the function.
</p>
<p class="pBody"><a name="wp1021501"> </a>
When <code class="cCodeEmphasis">op</code> is <code class="cCode">TMDECODE</code>, <code class="cCodeEmphasis">encobj</code> points to a buffer allocated by the Oracle Tuxedo ATMI system where the encoded version of the data resides as read off a communication endpoint. The length of the buffer is <code class="cCodeEmphasis">elen</code>. <code class="cCodeEmphasis">obj</code> points to a buffer that is at least the same size as the buffer pointed to by <code class="cCodeEmphasis">encobj</code> into which the decoded data is copied. The length of <code class="cCodeEmphasis">obj</code> is <code class="cCodeEmphasis">olen</code>. As <code class="cCodeEmphasis">obj</code> is the buffer ultimately returned to the application, this buffer may be grown by the Oracle Tuxedo ATMI system before calling <code class="cCode">_tmencdec()</code> to ensure that it is large enough to hold the decoded data. <code class="cCode">_tmencdec()</code> returns the size of the decoded data in <code class="cCodeEmphasis">obj</code>. After <code class="cCode">_tmencdec()</code> returns, <code class="cCode">_tmpostrecv()</code> is called with <code class="cCodeEmphasis">obj</code> passed as its first argument, <code class="cCode">_tmencdec()</code>&#8217;s return value as its second, and <code class="cCodeEmphasis">olen</code> as its third. <code class="cCode">_tmencdec()</code> should not free either of the buffers passed into the function.
</p>
<p class="pBody"><a name="wp1021502"> </a>
<code class="cCode">_tmencdec()</code> is called only when non-NULL data needs to be encoded or decoded.
</p>
<p class="pBody"><a name="wp1021503"> </a>
If no encoding or decoding needs to be performed on the data even when dissimilar machines exist in the network, specify a NULL function pointer. The default routine returns either <code class="cCodeEmphasis">olen</code> (<code class="cCodeEmphasis">op</code> equals <code class="cCode">TMENCODE</code>) or <code class="cCodeEmphasis">elen</code> (<code class="cCodeEmphasis">op</code> equals <code class="cCode">TMDECODE</code>).
</p>
<p class="pBody"><a name="wp1021504"> </a>
On success, <code class="cCode">_tmencdec()</code> returns a non-negative length as described above. If the function fails, it returns -1 causing <code class="cCode">_tmencdec()</code>&#8217;s caller to return failure, setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021505"> </a>
_tmroute
</h4>
<p class="pBody"><a name="wp1021506"> </a>
The default for message routing is to route a message to any available server group that offers the desired service. Each service entry in the <code class="cCode">UBBCONFIG</code> file can specify the logical name of some routing criteria for the service using the <code class="cCode">ROUTING</code> parameter. Multiple services can share the same routing criteria. In the case that a service has a routing criteria name specified, <code class="cCode">_tmroute()</code> is used to determine the server group to which a message is sent based on data in the message. This mapping of data to server group is called &#8220;data-dependent routing.&#8221; <code class="cCode">_tmroute()</code> is called before a buffer is sent (and before <code class="cCode">_tmpresend()</code> and <code class="cCode">_tmencdec()</code> are called) in <code class="cCode">tpcall(), tpacall(), tpconnect(), </code>and <code class="cCode">tpforward()</code>.
</p>
<p class="pBody"><a name="wp1021507"> </a>
<code class="cCodeEmphasis">routing_name</code> is the logical name of the routing criteria (as specified in the <code class="cCode">UBBCONFIG</code> file) and is associated with every service that needs data dependent routing. <code class="cCodeEmphasis">service</code> is the name of the service for which the request is being made. The parameter <code class="cCodeEmphasis">data</code> points to the data that is being transmitted in the request and <code class="cCodeEmphasis">len</code> is its length. Unlike the other routines described in these pages, <code class="cCode">_tmroute()</code> is called even when <code class="cCodeEmphasis">ptr</code> is NULL. The <code class="cCodeEmphasis">group</code> parameter is used to return the name of the group to which the request should be routed. This group name must match one of the group names listed in the <code class="cCode">UBBCONFIG</code> file (and one that is active at the time the group is chosen). If the request can go to any available server providing the specified service, <code class="cCodeEmphasis">group</code> should be set to the NULL string and the function should return 1.
</p>
<p class="pBody"><a name="wp1021508"> </a>
If data dependent routing is not needed for the buffer type, specify a NULL function pointer. The default routine sets <code class="cCodeEmphasis">group</code> to the NULL string and returns 1.
</p>
<p class="pBody"><a name="wp1021509"> </a>
Upon success, <code class="cCode">_tmroute()</code> returns 1. If the function fails, it returns -1 causing <code class="cCode">_tmroute()</code>&#8217;s caller to also return failure; as a result, <code class="cCode">tperrno</code> is set to <code class="cCode">TPESYSTEM</code>. If <code class="cCode">_tmroute()</code> fails because a requested server or service is not available, <code class="cCode">tperrno</code> is set to <code class="cCode">TPENOENT</code>.
</p>
<p class="pBody"><a name="wp1021510"> </a>
If <code class="cCodeEmphasis">group</code> is set to the name of an invalid server group, the function calling <code class="cCode">_tmroute()</code> will return an error and set <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021511"> </a>
_tmfilter
</h4>
<p class="pBody"><a name="wp1021512"> </a>
<code class="cCode">_tmfilter()</code> is called by the EventBroker server to analyze the contents of a buffer posted by <code class="cCode">tppost()</code>. An expression provided by the subscriber (<code class="cCode">tpsubscribe()</code>) is evaluated with respect to the buffer&#8217;s contents. If the expression is true, <code class="cCode">_tmfilter()</code> returns 1 and the EventBroker performs the subscription&#8217;s notification action. Otherwise, if <code class="cCode">_tmfilter()</code> returns 0, the EventBroker does not consider this posting a &#8220;match&#8221; for the subscription.
</p>
<p class="pBody"><a name="wp1021513"> </a>
If <code class="cCodeEmphasis">exprlen</code> is -1, <code class="cCodeEmphasis">expr</code> is interpreted as a NULL-terminated character string. Otherwise <code class="cCodeEmphasis">expr</code> is interpreted as <code class="cCodeEmphasis">exprlen</code> bytes of binary data. An <code class="cCodeEmphasis">exprlen</code> of 0 indicates no expression.
</p>
<p class="pBody"><a name="wp1021514"> </a>
If filtering does not apply to this buffer type, specify a NULL function pointer. The default routine returns 1 if there is no expression or if <code class="cCodeEmphasis">expr</code> is an empty NULL-terminated string. Otherwise the default routine returns 0.
</p>
<h4 class="pHeading3"><a name="wp1021515"> </a>
_tmformat
</h4>
<p class="pBody"><a name="wp1021516"> </a>
<code class="cCode">_tmformat()</code> is called by the EventBroker server to convert a buffer&#8217;s data into a printable string, based on a format specification named <code class="cCodeEmphasis">fmt</code>. The EventBroker converts posted buffers to strings as input for <code class="cCodeEmphasis">userlog</code> or <code class="cCodeEmphasis">system</code> notification actions.
</p>
<p class="pBody"><a name="wp1021517"> </a>
The output is stored as a character string in the memory location pointed to by <code class="cCodeEmphasis">result</code>. Up to <code class="cCodeEmphasis">maxresult</code> bytes are written in <code class="cCodeEmphasis">result</code>, including a terminating NULL character. If <code class="cCodeEmphasis">result</code> is not large enough, <code class="cCode">_tmformat()</code> truncates its output. The output string is always NULL terminated.
</p>
<p class="pBody"><a name="wp1021518"> </a>
On success, <code class="cCode">_tmformat()</code> returns a non-negative integer. 1 means success, 2 means the output string is truncated. If the function fails, it returns -1 and stores an empty string in <code class="cCodeEmphasis">result</code>.
</p>
<p class="pBody"><a name="wp1021519"> </a>
If formatting does not apply to this buffer type, specify a NULL function pointer. The default routine succeeds and returns an empty string in <code class="cCodeEmphasis">result</code>.
</p>
<h4 class="pHeading3"><a name="wp1364729"> </a>
_tmpresend2
</h4>
<p class="pBody"><a name="wp1364734"> </a>
<code class="cCode">_tmpresend2()</code> is called before a buffer is sent in <code class="cCode">tpcall()</code>, <code class="cCode">tpacall()</code>, <code class="cCode">tpconnect()</code>, <code class="cCode">tpsend()</code>, <code class="cCode">tpbroadcast()</code>, <code class="cCode">tpnotify()</code>, <code class="cCode">tpreturn()</code>, and <code class="cCode">tpforward()</code>. It is also called after <code class="cCode">_tmroute()</code> but before <code class="cCode">_tmencdec()</code>. If <code class="cCodeEmphasis">iptr</code> is not NULL, preprocessing is performed on a buffer before the buffer is sent. 
</p>
<p class="pBody"><a name="wp1366067"> </a>
The first argument to <code class="cCode">_tmpresend2()</code>, <code class="cCodeEmphasis">iptr</code>, is the application data buffer passed into the send call. The second argument, <code class="cCodeEmphasis">ilen</code>, is the length of the data as passed into the send call. The third argument, <code class="cCodeEmphasis">mdlen</code>, is the actual size of the buffer in which the data resides. 
</p>
<p class="pBody"><a name="wp1364736"> </a>
Unlike <code class="cCode">_tmpresend()</code>, <code class="cCode">_tmpresend2()</code> receives a pointer, <code class="cCodeEmphasis">optr</code>, which is used to pass a pointer to a buffer into which the data in <code class="cCodeEmphasis">iptr</code> can be placed, after any required processing is done. Use this pointer if you want to use a new buffer for the data modified by <code class="cCode">_tmpresend2()</code> instead of modifying the input buffer. The fifth argument, <code class="cCodeEmphasis">olen</code>, is the size of the <code class="cCodeEmphasis">optr</code> buffer. The sixth argument, <code class="cCodeEmphasis">flags</code>, tells <code class="cCode">_tmpresend2()</code> whether the buffer being processed is the parent buffer (the one being sent). The <code class="cCodeEmphasis">flags</code> argument is returned by <code class="cCode">_tmpresend2()</code> to indicate the results of processing.
</p>
<p class="pBody"><a name="wp1364737"> </a>
The size of the <code class="cCodeEmphasis">optr</code> buffer may not be large enough for successful postprocessing. If more space is required, <code class="cCode">_tmpresend2()</code> returns the negative absolute value of the desired buffer size. All <code class="cCodeEmphasis">olen</code> bytes of the <code class="cCodeEmphasis">optr</code> buffer are preserved. The calling routine then resizes the buffer and calls <code class="cCode">_tmpresend2()</code> a second time. 
</p>
<p class="pBody"><a name="wp1364738"> </a>
If no postprocessing needs to be performed on the data, and the amount of data received is the same as the amount that should be returned to the application, specify a NULL function pointer. The default routine returns <code class="cCodeEmphasis">ilen</code> and does not modify the buffer.
</p>
<p class="pBody"><a name="wp1364739"> </a>
The following is a valid flag on input to <code class="cCode">_tmpresend2()</code>:
</p>
<h4 class="pDefTerm"><a name="wp1364740"> </a>
[<code class="cCode">TMPARENT</code>]
</h4><div class="pDefPara"><a name="wp1364741"> </a>
This is the parent buffer (the one being sent).
</div>
<p class="pBody"><a name="wp1364742"> </a>
The flags returned in <code class="cCodeEmphasis">flags</code> specify the results of <code class="cCode">_tmpresend2()</code>. Possible values are:
</p>
<h4 class="pDefTerm"><a name="wp1364743"> </a>
[<code class="cCode">TMUSEIPTR</code>]
</h4><div class="pDefPara"><a name="wp1364744"> </a>
<code class="cCode">_tmpresend2()</code> was successful: the processed data is in the buffer referenced by <code class="cCodeEmphasis">iptr</code>, and the return value contains the length of the data to be sent. 
</div>
<h4 class="pDefTerm"><a name="wp1364745"> </a>
[<code class="cCode">TMUSEOPTR</code>]
</h4><div class="pDefPara"><a name="wp1364746"> </a>
<code class="cCode">_tmpresend2()</code> was successful: the processed data is in the buffer referenced by <code class="cCodeEmphasis">optr</code>, and the return value contains the length of the data to be sent.
</div>
<p class="pBody"><a name="wp1364747"> </a>
If <code class="cCode">TMUSEOPTR</code> is returned, the processing done after messages are transmitted is different from the processing done by <code class="cCode">_tmpresend()</code>: the <code class="cCodeEmphasis">iptr</code> buffer remains unchanged and <code class="cCode">_tmpostsend()</code> is not called. If <code class="cCode">TMUSEIPTR</code> is returned, <code class="cCode">_tmpostsend()</code> is called, as it is called for <code class="cCode">_tmpresend()</code>. It is the responsibility of the caller to allocate and to free or cache the <code class="cCodeEmphasis">optr</code> buffer.
</p>
<p class="pBody"><a name="wp1364749"> </a>
There are several reasons why you may want to use this approach for a typed buffer:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1364750"> </a>The buffer created by processing for transmission is larger than the maximum length allowed for the input buffer.</li>
<li><a name="wp1364751"> </a>Undoing the processing to prepare a buffer for transmission is so complicated that it is easier to copy the data to a different buffer.</li>
</ul></div>
<p class="pBody"><a name="wp1364753"> </a>
The <code class="cCode">_tmpresend2()</code> function ensures that when a function returns, the data in the buffer to be sent can be sent without further processing. Because <code class="cCode">_tmencdec()</code> is called only if the buffer is being sent to a dissimilar machine, <code class="cCode">_tmpresend2()</code> ensures, upon return, that all data is stored contiguously in the buffer to be sent.
</p>
<p class="pBody"><a name="wp1364754"> </a>
If no preprocessing needs to be performed on the data, and the amount of data specified by the caller is the same as the amount that should be sent, specify a NULL function pointer for <code class="cCode">_tmpresend2()</code> in the buffer type switch. If <code class="cCode">_tmpresend2()</code> is NULL,  <code class="cCode">_tmpresend()</code> is called by default.
</p>
<p class="pBody"><a name="wp1873588"> </a>
Upon success, <code class="cCode">_tmpresend2()</code> returns the amount of data to be sent or, if a larger buffer is needed, the negative absolute value of the desired buffer size. If the function fails, it returns -1, causing the caller of  <code class="cCode">_tmpresend2()</code> to also return failure, setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1873589"> </a>
_tmconvmb
</h4>
<p class="pBody"><a name="wp1872143"> </a>
<code class="cCode">_tmconvmb()</code> is called after <code class="cCode">tmpostrecv()</code> to convert multibyte data from a source encoding to a target encoding. The first argument to <code class="cCode">_tmconvmb()</code>, <code class="cCodeEmphasis">ibufp</code>, is a pointer to a stream of bytes&#8212;the multibyte data&#8212;to be converted. The second argument, <code class="cCodeEmphasis">ilen</code>, is the number of bytes in <code class="cCodeEmphasis">ibufp</code>. The third argument, <code class="cCodeEmphasis">enc_name</code>, is one of the encoding names used in the processing. For an MBSTRING buffer, the third argument is the target encoding name; for an FML32 buffer, the third argument is the source encoding name.
</p>
<p class="pBody"><a name="wp1872159"> </a>
<code class="cCode">_tmconvmb()</code> receives a pointer, <code class="cCodeEmphasis">obufp</code>, which is used to pass a pointer to a buffer into which the data in <code class="cCodeEmphasis">ibufp</code> can be placed, after any required code-set encoding conversion is done. Use this pointer if you want to use a new buffer for the data converted by <code class="cCode">_tmconvmb()</code> instead of modifying the input pointer. The fifth argument, <code class="cCodeEmphasis">olen</code>, is the size of the <code class="cCodeEmphasis">obufp</code> buffer. The <code class="cCodeEmphasis">flags</code> argument is returned by <code class="cCode">_tmconvmb()</code> to indicate the results of processing.
</p>
<p class="pBody"><a name="wp1872172"> </a>
The size of the <code class="cCodeEmphasis">obufp</code> buffer may not be large enough for successful post processing. If more space is required, <code class="cCode">_tmconvmb()</code> returns the negative absolute value of the desired buffer size. All <code class="cCodeEmphasis">ilen</code> bytes of the <code class="cCodeEmphasis">ibufp</code> buffer are preserved. The calling routine then resizes the buffer and calls <code class="cCode">_tmconvmb()</code> a second time.
</p>
<p class="pBody"><a name="wp1872182"> </a>
If no code-set encoding conversion needs to be performed on the data, and the encoding name of the sending process is the same as the encoding name of the receiving process, specify a NULL function pointer. The default routine returns <code class="cCodeEmphasis">ilen</code> and does not convert the buffer. If this function does not know how to convert the code-set encoding, it returns -1.
</p>
<p class="pBody"><a name="wp1872192"> </a>
The value returned in <code class="cCodeEmphasis">flags</code> specifies the result of <code class="cCode">_tmconvmb()</code>. Possible values are:
</p>
<h4 class="pDefTerm"><a name="wp1872193"> </a>
[<code class="cCode">TMUSEIPTR</code>] 
</h4><div class="pDefPara"><a name="wp1872194"> </a>
<code class="cCode">_tmconvmb()</code> was successful: the processed data is in the buffer referenced by <code class="cCodeEmphasis">ibufp</code>, and the return value contains the length of the converted data to be passed to the service.
</div>
<h4 class="pDefTerm"><a name="wp1872198"> </a>
[<code class="cCode">TMUSEOPTR</code>] 
</h4><div class="pDefPara"><a name="wp1872199"> </a>
<code class="cCode">_tmconvmb()</code> was successful: the processed data is in the buffer referenced by <code class="cCodeEmphasis">obufp</code>, and the return value contains the length of the data to be converted. It is the responsibility of the caller to allocate and to free or cache the <code class="cCodeEmphasis">obufp</code> buffer.
</div>
<p class="pBody"><a name="wp1872206"> </a>
Upon success, <code class="cCode">_tmconvmb()</code> returns the amount of data buffer that had code-set encoding conversion or, if a larger buffer is needed, the negative absolute value of the desired buffer size. If the function fails, it returns -1, causing the caller of <code class="cCode">_tmconvmb()</code> to also return failure, setting <code class="cCode">tperrno</code> to <code class="cCode">TPESYSTEM</code>.
</p>
<h4 class="pHeading3"><a name="wp1021520"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1174002"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1042150"><code class="cCode">tpdiscon(3c)</code></a>, <a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>, <a href="rf3c.html#wp1021885"><code class="cCode">tpgetrply(3c)</code></a>, <a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>, <a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>, <a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>, <a href="../rf5/rf5.html">tuxtypes(5)</a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1058086"> </a>
catgets(3c)
</h3>
<h4 class="pHeading3"><a name="wp1058087"> </a>
Name
</h4>
<p class="pBody"><a name="wp1058088"> </a>
<code class="cCode">catgets()</code>&#8212;Reads a program message.
</p>
<h4 class="pHeading3"><a name="wp1058089"> </a>
Synopsis
</h4>
<a name="wp1058090"> </a><div class="pPreformatted"><pre>#include &lt;nl_types.h&gt; <br />char *catgets (nl_catd catd, int set_num, int msg_num, char *s)</pre></div><h4 class="pHeading3"><a name="wp1058091"> </a>
Description
</h4>
<p class="pBody"><a name="wp1058092"> </a>
<code class="cCode">catgets()</code> attempts to read message <code class="cCodeEmphasis">msg_num</code>, in set <code class="cCodeEmphasis">set_num</code>, from the message catalogue identified by <code class="cCodeEmphasis">catd</code>. <code class="cCodeEmphasis">catd</code> is a catalogue descriptor returned from an earlier call to <code class="cCode">catopen()</code>. <code class="cCodeEmphasis">s</code> points to a default message string which will be returned by <code class="cCode">catgets()</code> if the identified message catalogue is not currently available.
</p>
<p class="pBody"><a name="wp1615120"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">catgets()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1058093"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp1058094"> </a>
If the identified message is retrieved successfully, <code class="cCode">catgets()</code> returns a pointer to an internal buffer area containing the NULL terminated message string. If the call is unsuccessful because the message catalogue identified by <code class="cCodeEmphasis">catd</code> is not currently available, a pointer to <code class="cCodeEmphasis">s</code> is returned.
</p>
<h4 class="pHeading3"><a name="wp1058095"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1058096"> </a>
<a href="rf3c.html#wp1059202"><code class="cCode">catopen, catclose(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1059202"> </a>
catopen, catclose(3c)
</h3>
<h4 class="pHeading3"><a name="wp1059203"> </a>
Name
</h4>
<p class="pBody"><a name="wp1059204"> </a>
<code class="cCode">catopen()</code>, <code class="cCode">catclose()</code>&#8212;Opens/closes a message catalogue.
</p>
<h4 class="pHeading3"><a name="wp1059205"> </a>
Synopsis
</h4>
<a name="wp1059206"> </a><div class="pPreformatted"><pre>#include &lt;nl_types.h&gt; <br />nl_catd catopen (char *name, int oflag) <br />int catclose (nl_catd catd)</pre></div><h4 class="pHeading3"><a name="wp1059207"> </a>
Description
</h4>
<p class="pBody"><a name="wp1059208"> </a>
<code class="cCode">catopen()</code> opens a message catalogue and returns a catalogue descriptor. <code class="cCodeEmphasis">name</code> specifies the name of the message catalogue to be opened. If <code class="cCodeEmphasis">name</code> contains a &#8220;<code class="cCode">/</code>&#8221; then <code class="cCodeEmphasis">name</code> specifies a pathname for the message catalogue. Otherwise, the environment variable <code class="cCode">NLSPATH</code> is used. If <code class="cCode">NLSPATH</code> does not exist in the environment, or if a message catalogue cannot be opened in any of the paths specified by <code class="cCode">NLSPATH</code>, then the default path is used (see <a href="../rf5/rf5.html">nl_types(5)</a>).
</p>
<p class="pBody"><a name="wp1059209"> </a>
The names of message catalogues, and their location in the filestore, can vary from one system to another. Individual applications can choose to name or locate message catalogues according to their own special needs. A mechanism is therefore required to specify where the catalogue resides.
</p>
<p class="pBody"><a name="wp1059210"> </a>
The <code class="cCode">NLSPATH</code> variable provides both the location of message catalogues, in the form of a search path, and the naming conventions associated with message catalogue files. For example:
</p>
<p class="pBody"><a name="wp1059211"> </a>
<code class="cCode">NLSPATH=/nlslib/%L/%N.cat:/nlslib/%N/%L</code>
</p>
<p class="pBody"><a name="wp1059212"> </a>
The metacharacter <code class="cCode">%</code> introduces a substitution field, where <code class="cCode">%L</code> substitutes the current setting of the <code class="cCode">LANG</code> environment variable (see following section), and <code class="cCode">%N</code> substitutes the value of the <code class="cCodeEmphasis">name</code> parameter passed to <code class="cCode">catopen()</code>. Thus, in the above example, <code class="cCode">catopen()</code> will search in <code style="font-style: normal" class="cCode">/nlslib/$LANG/</code><span style="font-style: italic">name</span><code class="cCode">.cat</code>, then in <code class="cCode">/nlslib</code>/<code class="cCodeEmphasis">name</code>/<code class="cCode">$LANG</code>, for the required message catalogue.
</p>
<p class="pBody"><a name="wp1059213"> </a>
<code class="cCode">NLSPATH</code> will normally be set up on a system wide basis (for example, in <code class="cCode">/etc/profile</code>) and thus makes the location and naming conventions associated with message catalogues transparent to both programs and users.
</p>
<p class="pBody"><a name="wp1059214"> </a>
The following table lists the full set of metacharacters.
</p>
<p class="pGraphic"><a name="wp1059244"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1832298table1059215">
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1832298"> </a>
Metacharacter
</div>
</td>
    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1832300"> </a>
Description
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059221"> </a>
<code class="cCode">%N</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059223"> </a>
The value of the name parameter passed to <code class="cCode">catopen</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059225"> </a>
<code class="cCode">%L</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059227"> </a>
The value of <code class="cCode">LANG</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059229"> </a>
<code class="cCode">%l</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059231"> </a>
The value of the language element of <code class="cCode">LANG</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059233"> </a>
<code class="cCode">%t</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059235"> </a>
The value of the territory element of <code class="cCode">LANG</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059237"> </a>
<code class="cCode">%c</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059239"> </a>
The value of the codeset element of <code class="cCode">LANG</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059241"> </a>
<code class="cCode">%%</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1059243"> </a>
A single %.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1059245"> </a>
The <code class="cCode">LANG</code> environment variable provides the ability to specify the user&#8217;s requirements for native languages, local customs and character set, as an ASCII string in the form <code class="cCode">LANG=language[_territory[.codeset]]</code>
</p>
<p class="pBody"><a name="wp1059246"> </a>
A user who speaks German as it is spoken in Austria and has a terminal that operates in ISO 8859/1 codeset, would want the setting of the <code class="cCode">LANG</code> variable to be as follows:
</p>
<a name="wp1059247"> </a><div class="pPreformatted"><pre>LANG=De_A.88591</pre></div><p class="pBody"><a name="wp1059248"> </a>
With this setting it should be possible for the user to find relevant catalogues if they exist.
</p>
<p class="pBody"><a name="wp1059249"> </a>
If the <code class="cCode">LANG</code> variable is not set then the value of <code class="cCode">LC_MESSAGES</code> as returned by <a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a> is used. If this is <code class="cCode">NULL</code> then the default path as defined in <a href="../rf5/rf5.html">nl_types(5)</a> is used.
</p>
<p class="pBody"><a name="wp1059250"> </a>
<code class="cCodeEmphasis">oflag()</code> is reserved for future use and should be set to 0. The results of setting this field to any other value are undefined.
</p>
<p class="pBody"><a name="wp1059251"> </a>
<code class="cCode">catclose()</code> closes the message catalogue identified by <code class="cCodeEmphasis">catd</code>.
</p>
<p class="pBody"><a name="wp1615121"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">catopen()</code> or <code class="cCode">catclose()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1059252"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp1059253"> </a>
If successful, <code class="cCode">catopen()</code> returns a message catalogue descriptor for use on subsequent calls to <code class="cCode">catgets()</code> and <code class="cCode">catclose()</code>. Otherwise <code class="cCode">catopen()</code> returns <code class="cCode">(nl_catd) -1</code>. <code class="cCode">catclose()</code> returns 0 if successful, otherwise -1.
</p>
<h4 class="pHeading3"><a name="wp1059254"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1059255"> </a>
<a href="rf3c.html#wp1058086"><code class="cCode">catgets(3c)</code></a>, <a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a>, <a href="../rf5/rf5.html">nl_types(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1029799"> </a>
decimal(3c)
</h3>
<h4 class="pHeading3"><a name="wp1029800"> </a>
Name
</h4>
<p class="pBody"><a name="wp1029801"> </a>
<code class="cCode">decimal()</code>&#8212;Decimal conversion and arithmetic routines.
</p>
<h4 class="pHeading3"><a name="wp1029802"> </a>
Synopsis
</h4>
<a name="wp1029803"> </a><div class="pPreformatted"><pre>#include &#8220;decimal.h&#8221;  </pre></div><a name="wp1116626"> </a><div class="pPreformatted"><pre>int<br />lddecimal(cp, len, np)        /* load a decimal */<br />char*cp;         /* input: location of compacted format */</pre></div><a name="wp1116627"> </a><div class="pPreformatted"><pre>int<br />len;             /* input: length of compacted format */<br />dec_t*np;        /* output: location of dec_t format */</pre></div><a name="wp1116628"> </a><div class="pPreformatted"><pre>void<br />stdecimal(np, cp, len)       /* store a decimal */<br />dec_t*np;        /* input: location of dec_t format */<br />char*cp;         /* output: location of compacted format */<br />int len;         /* input: length of compacted format */</pre></div><a name="wp1116629"> </a><div class="pPreformatted"><pre>int<br />deccmp(n1, n2)   /* compare two decimal numbers */<br />dec_t*n1;        /* input: number to be compared */<br />dec_t*n2;        /* input: number to be compared */</pre></div><a name="wp1116630"> </a><div class="pPreformatted"><pre>int<br />dectoasc(np, cp, len, right) /* convert dec_t to ascii */<br />dec_t*np;        /* input: number to be converted */<br />char*cp;         /* output: number after conversion */<br />int len;         /* input: length of output string */<br />int right;       /* input: number of places to right of decimal point */</pre></div><a name="wp1116631"> </a><div class="pPreformatted"><pre>int<br />deccvasc(cp, len, np)        /* convert ascii to dec_t */<br />char*cp;         /* input: number to be converted */<br />int len;         /* input: maximum length of number to be converted */<br />dec_t*np;        /* output: number after conversion */</pre></div><a name="wp1116632"> </a><div class="pPreformatted"><pre>int<br />dectoint(np, ip)             /* convert int to dec_t */<br />dec_t*np;        /* input: number to be converted */<br />int *ip;         /* output: number after conversion */</pre></div><a name="wp1116633"> </a><div class="pPreformatted"><pre>int<br />deccvint(in, np) /* convert dec_t to int */<br />int in;          /* input: number to be converted */<br />dec_t*np;        /* output: number after conversion */</pre></div><a name="wp1116634"> </a><div class="pPreformatted"><pre>int<br />dectolong(np, lngp)         /* convert dec_t to long */<br />dec_t*np;        /* input: number to be converted */<br />long*lngp;       /* output: number after conversion */</pre></div><a name="wp1116635"> </a><div class="pPreformatted"><pre>int<br />deccvlong(lng, np)        /* convert long to dec_t */<br />longlng;        /* input: number to be converted */<br />dec_t*np;       /* output: number after conversion */</pre></div><a name="wp1116636"> </a><div class="pPreformatted"><pre>int<br />dectodbl(np, dblp)        /* convert dec_t to double */<br />dec_t*np;       /* input: number to be converted */<br />double *dblp;   /* output: number after conversion */</pre></div><a name="wp1116637"> </a><div class="pPreformatted"><pre>int<br />deccvdbl(dbl, np)         /* convert double to dec_t */<br />double *dbl;    /* input: number to be converted */<br />dec_t*np;       /* output: number after conversion */</pre></div><a name="wp1116638"> </a><div class="pPreformatted"><pre>int<br />dectoflt(np, fltp)        /* convert dec_t to float */<br />dec_t*np;       /* input: number to be converted */<br />float*fltp;     /* output: number after conversion */</pre></div><a name="wp1116639"> </a><div class="pPreformatted"><pre>int<br />deccvflt(flt, np)         /* convert float to dec_t */<br />double *flt;    /* input: number to be converted */<br />dec_t*np;       /* output: number after conversion */</pre></div><a name="wp1116640"> </a><div class="pPreformatted"><pre>int<br />decadd(*n1, *n2, *n3)     /* add two decimal numbers */<br />dec_t*n1;        /* input: addend */<br />dec_t*n2;        /* input: addend */<br />dec_t*n3;        /* output: sum */</pre></div><a name="wp1116641"> </a><div class="pPreformatted"><pre>int<br />decsub(*n1, *n2, *n3)     /* subtract two decimal numbers */<br />dec_t*n1;        /* input: minuend */<br />dec_t*n2;        /* input: subtrahend */<br />dec_t*n3;        /* output: difference */</pre></div><a name="wp1116642"> </a><div class="pPreformatted"><pre>int<br />decmul(*n1, *n2, *n3)     /* multiply two decimal numbers */<br />dec_t*n1;        /* input: multiplicand */<br />dec_t*n2;        /* input: multiplicand */<br />dec_t*n3;        /* output: product */</pre></div><a name="wp1116643"> </a><div class="pPreformatted"><pre>int<br />decdiv(*n1, *n2, *n3)    /* divide two decimal numbers */<br />dec_t*n1;        /* input: dividend */<br />dec_t*n2;        /* input: divisor */<br />dec_t*n3;        /* output: quotient */</pre></div><h4 class="pHeading3"><a name="wp1029804"> </a>
Description
</h4>
<p class="pBody"><a name="wp1029805"> </a>
These functions allow storage, conversion, and manipulation of packed decimal data on the Oracle Tuxedo ATMI system. Note that the format in which the decimal data type is represented on the Oracle Tuxedo ATMI system is different from its representation under CICS.
</p>
<p class="pBody"><a name="wp1615126"> </a>
A thread in a multithreaded application may issue a call to any of the <code class="cCode">decimal</code> conversion functions while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1029806"> </a>
Native Decimal Representation
</h4>
<p class="pBody"><a name="wp1029807"> </a>
Decimals are represented on native Oracle Tuxedo ATMI system nodes using the <code class="cCode">dec_t</code> structure. This definition of this structure is as follows:
</p>
<a name="wp1029808"> </a><div class="pPreformatted"><pre>#define DECSIZE                 16<br />struct decimal {<br />       short dec_exp;           /* exponent base 100  */<br />       short dec_pos;           /* sign: 1=pos, 0=neg, -1=null */<br />       short dec_ndgts;         /* number of significant digits */<br />       char  dec_dgts[DECSIZE]; /* actual digits base 100 */<br />};<br />typedef struct decimal dec_t;</pre></div><p class="pBody"><a name="wp1029809"> </a>
It should never be necessary for programmers to directly access the <code class="cCode">dec_t</code> structure, but it is presented here nevertheless to give an understanding of the underlying data structure. If large amounts of decimal data need to be stored, the <code class="cCode">stdecimal()</code> and <code class="cCode">lddecimal()</code> functions may be used to obtain a more compact format. <code class="cCode">dectoasc()</code>, <code class="cCode">dectoint()</code>, <code class="cCode">dectolong()</code>, <code class="cCode">dectodbl()</code>, and <code class="cCode">dectoflt()</code> allow the conversion of decimals to other data types. <code class="cCode">deccvasc()</code>, <code class="cCode">deccvint()</code>, <code class="cCode">deccvlong()</code>, <code class="cCode">deccvdbl()</code>, and <code class="cCode">deccvflt()</code> allow the conversion of other data types to the decimal data type. <code class="cCode">deccmp()</code> is the function which compares two decimals. It returns -1 if the first decimal is less than the second, 0 if the two decimals are equal, and 1 if the first decimal is greater than the second. A negative value other than -1 is returned if either of the arguments is invalid. <code class="cCode">decadd()</code>, <code class="cCode">decsub()</code>, <code class="cCode">decmul()</code>, and <code class="cCode">decdiv()</code> perform arithmetic operations on decimal numbers.
</p>
<h4 class="pHeading3"><a name="wp1029810"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1029811"> </a>
Unless otherwise stated, these functions return 0 on success and a negative value on error.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1952249"> </a>
getURLEntityCacheDir(3c)
</h3>
<h4 class="pHeading3"><a name="wp1953352"> </a>
Name
</h4>
<p class="pBody"><a name="wp1953366"> </a>
<code class="cCode">getURLEntityCacheDir()</code> - Specifies a Xerces class method for getting the absolute path to the location where the DTD, schema and Entity files are cached. 
</p>
<h4 class="pHeading3"><a name="wp1953358"> </a>
Synopsis
</h4>
<a name="wp1953360"> </a><div class="pPreformatted"><pre>char * getURLEntityCacheDir()</pre></div><h4 class="pHeading3"><a name="wp1953362"> </a>
Description
</h4>
<p class="pBody"><a name="wp2177632"> </a>
<code class="cCode">getURLEntityCacheDir()</code> is a method that is called to find out the location where the DTD, schema and Entity files are cached. It returns the absolute path to the cached file location. This method is exclusively used in conjunction with the following two Xerces objects:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2177633"> </a>XercesDOMParser</li>
<li><a name="wp2177634"> </a>SAXparser</li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1953392"> </a>
getURLEntityCaching(3c)
</h3>
<h4 class="pHeading3"><a name="wp2161170"> </a>
Name
</h4>
<p class="pBody"><a name="wp1954500"> </a>
<code class="cCode">GetURLEntityCaching()</code> - Specifies a Xerces class method for getting the caching mechanism for DTD, schema and Entity files.
</p>
<h4 class="pHeading3"><a name="wp1953395"> </a>
Synopsis
</h4>
<a name="wp1953396"> </a><div class="pPreformatted"><pre>bool getURLEntityCaching()</pre></div><h4 class="pHeading3"><a name="wp1953397"> </a>
Description
</h4>
<p class="pBody"><a name="wp2177657"> </a>
<code class="cCode">GetURLEntityCaching()</code> is a method that is called to find out if caching of the DTD, schema and Entity files are turned on or off. It returns <em class="cEmphasis">true</em> if caching is turned on and <em class="cEmphasis">false</em> if caching is turned off. This method is exclusively used in conjunction with the following two Xerces objects:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2177658"> </a>XercesDOMParser</li>
<li><a name="wp2177659"> </a>SAXparser</li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1031722"> </a>
gp_mktime(3c)
</h3>
<h4 class="pHeading3"><a name="wp1031723"> </a>
Name
</h4>
<p class="pBody"><a name="wp1031724"> </a>
<code class="cCode">gp_mktime()</code>&#8212;Converts a <code class="cCode">tm</code> structure to a calendar time.
</p>
<h4 class="pHeading3"><a name="wp1031725"> </a>
Synopsis
</h4>
<a name="wp1031726"> </a><div class="pPreformatted"><pre>#include &lt;time.h&gt;  <br />time_t gp_mktime (struct tm *timeptr);</pre></div><h4 class="pHeading3"><a name="wp1031727"> </a>
Description
</h4>
<p class="pBody"><a name="wp1031728"> </a>
<code class="cCode">gp_mktime()</code> converts the time represented by the <code class="cCode">tm</code> structure pointed to by <code class="cCodeEmphasis">timeptr</code> into a calendar time (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970).
</p>
<p class="pBody"><a name="wp1031729"> </a>
The <code class="cCode">tm</code> structure has the following format: 
</p>
<a name="wp1031730"> </a><div class="pPreformatted"><pre>struct tm {<br />  int tm_sec;     /* seconds after the minute [0, 61] */<br />  int tm_min;     /* minutes after the hour [0, 59] */<br />  int tm_hour;    /* hour since midnight [0, 23] */<br />  int tm_mday;    /* day of the month [1, 31] */<br />  int tm_mon;     /* months since January [0, 11] */<br />  int tm_year;    /* years since 1900 */<br />  int tm_wday;    /* days since Sunday [0, 6] */<br />  int tm_yday;    /* days since January 1 [0, 365] */<br />  int tm_isdst;   /* flag for daylight savings time */<br />};</pre></div><p class="pBody"><a name="wp1031731"> </a>
In addition to computing the calendar time, <code class="cCode">gp_mktime()</code> normalizes the supplied <code class="cCode">tm</code> structure. The original values of the <code class="cCodeEmphasis">tm_wday</code> and <code class="cCodeEmphasis">tm_yday</code> components of the structure are ignored, and the original values of the other components are not restricted to the ranges indicated in the definition of the structure. On successful completion, the values of the <code class="cCodeEmphasis">tm_wday</code> and <code class="cCodeEmphasis">tm_yday</code> components are set appropriately, and the other components are set to represent the specified calendar time, but with their values forced to be within the appropriate ranges. The final value of <code class="cCodeEmphasis">tm_mday</code> is not set until <code class="cCodeEmphasis">tm_mon</code> and <code class="cCodeEmphasis">tm_year</code> are determined.
</p>
<p class="pBody"><a name="wp1031732"> </a>
The original values of the components may be either greater than or less than the specified range. For example, a <code class="cCodeEmphasis">tm_hour</code> of -1 means 1 hour before midnight, <code class="cCodeEmphasis">tm_mday</code> of 0 means the day preceding the current month, and <code class="cCodeEmphasis">tm_mon</code> of -2 means 2 months before January of <code class="cCodeEmphasis">tm_year</code>.
</p>
<p class="pBody"><a name="wp1777874"> </a>
If <code class="cCodeEmphasis">tm_isdst</code> is positive, the original values are assumed to be in the alternate time zone. If it turns out that the alternate time zone is not valid for the computed calendar time, then the components are adjusted to the main time zone. Likewise, if <code class="cCodeEmphasis">tm_isdst</code> is zero, the original values are assumed to be in the main time zone and are converted to the alternate time zone if the main time zone is not valid. If <code class="cCodeEmphasis">tm_isdst</code> is negative, the correct time zone is determined and the components are not adjusted.
</p>
<p class="pBody"><a name="wp1031734"> </a>
Local time zone information is used as if <code class="cCode">gp_mktime()</code> had called <code class="cCode">tzset()</code>.
</p>
<p class="pBody"><a name="wp1031735"> </a>
<code class="cCode">gp_mktime()</code> returns the specified calendar time. If the calendar time cannot be represented, the function returns the value (<code class="cCode">time_t</code>)-1.
</p>
<p class="pBody"><a name="wp1615135"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">gp_mktime()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1031736"> </a>
Example
</h4>
<p class="pBody"><a name="wp1031737"> </a>
What day of the week is July 4, 2001? 
</p>
<a name="wp1031738"> </a><div class="pPreformatted"><pre>  #include &lt;stdio.h&gt;<br />  #include &lt;time.h&gt;<br /> <br />  static char *const wday[] = {<br />  &quot;Sunday&quot;, &quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;,<br />  &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;-unknown-&quot;  <br />  };<br /> <br />  struct tm time_str;<br />  /*...*/  <br />  time_str.tm_year        = 2001 - 1900;  <br />  time_str.tm_mon         = 7 - 1;<br />  time_str.tm_mday        = 4;<br />  time_str.tm_hour        = 0;<br />  time_str.tm_min         = 0;<br />  time_str.tm_sec         = 1;<br />  time_str.tm_isdst       = -1;<br />  if (gp_mktime(time_str) == -1)<br />     time_str.tm_wday=7;<br />  printf(&quot;%s\en&quot;, wday[time_str.tm_wday]);</pre></div><h4 class="pHeading3"><a name="wp1031741"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1031742"> </a>
<code class="cCodeEmphasis">tm_year</code> of the tm structure must be for year 1970 or later. Calendar times before 00:00:00 UTC, January 1, 1970 or after 03:14:07 UTC, January 19, 2038 cannot be represented.
</p>
<h4 class="pHeading3"><a name="wp1031743"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1031744"> </a>
On systems where the C compilation system already provides the ANSI C <code class="cCode">mktime()</code> function, <code class="cCode">gp_mktime()</code> simply calls <code class="cCode">mktime()</code> to do the conversion. Otherwise, the conversion is provided directly in <code class="cCode">gp_mktime()</code>.
</p>
<p class="pBody"><a name="wp1031745"> </a>
In the latter case, the <code class="cCode">TZ</code> environment variable must be set. Note that in many installations, <code class="cCode">TZ</code> is set to the correct value by default when the user logs on. The default value for <code class="cCode">TZ</code> is <code class="cCode">GMT0</code>. The format for <code class="cCode">TZ</code> is the following: 
</p>
<a name="wp1777894"> </a><div class="pPreformatted"><pre><code class="cCode">stdoffset[dst[offset],[start[time],e</code>nd[time]]<code class="cCode">]</code></pre></div><h4 class="pDefTerm"><a name="wp1031746"> </a>
<code class="cCodeEmphasis">std</code> and <code class="cCodeEmphasis">dst</code> 
</h4><div class="pDefPara"><a name="wp1031747"> </a>
Three or more bytes that designate the standard time zone (<code class="cCodeEmphasis">std</code>) and daylight savings time time zone (<code class="cCodeEmphasis">dst</code>). Only <code class="cCodeEmphasis">std</code> is required. If <code class="cCodeEmphasis">dst</code> is missing, then daylight savings time does not apply in this locale. Uppercase and lowercase letters are allowed. Any characters except a leading colon (:), digits, a comma (,), a minus (-) or a plus (+) are allowed.
</div>
<h4 class="pDefTerm"><a name="wp1031748"> </a>
<code class="cCodeEmphasis">offset</code> 
</h4><div class="pDefPara"><a name="wp1031749"> </a>
Indicates the value one must add to the local time to arrive at Coordinated Universal Time. The <code class="cCodeEmphasis">offset</code> has the following form: <code class="cCodeEmphasis">hh</code>[:<code class="cCodeEmphasis">mm</code>[:<code class="cCodeEmphasis">ss</code>]]. The minutes (<code class="cCodeEmphasis">mm</code>) and seconds (<code class="cCodeEmphasis">ss</code>) are optional. The hour (<code class="cCodeEmphasis">hh</code>) is required and may be a single digit. The <code class="cCodeEmphasis">offset</code> following <code class="cCodeEmphasis">std</code> is required. If no <code class="cCodeEmphasis">offset</code> follows <code class="cCodeEmphasis">dst</code>, daylight savings time is assumed to be one hour ahead of standard time. One or more digits may be used; the value is always interpreted as a decimal number. The hour must be between 0 and 24, and the minutes (and seconds) if present, between 0 and 59. Out of range values may cause unpredictable behavior. If preceded by a &#8220;-&#8221;, the time zone is east of the Prime Meridian; otherwise it is west (which may be indicated by an optional preceding &#8220;+&#8221; sign). 
</div>
<h4 class="pDefTerm"><a name="wp1031750"> </a>
<code class="cCodeEmphasis">start</code>/<code class="cCodeEmphasis">time</code>,<code class="cCodeEmphasis">end</code>/<code class="cCodeEmphasis">time</code> 
</h4><div class="pDefPara"><a name="wp1031751"> </a>
Indicates when to change to and back from daylight savings time, where <code class="cCodeEmphasis">start</code>/time describes when the change from standard time to daylight savings time occurs, and <code class="cCodeEmphasis">end</code>/<code class="cCodeEmphasis">time</code> describes when the change back happens. Each <code class="cCodeEmphasis">time</code> field describes when, in current local time, the change is made. 
<a name="wp1031752"> </a>
The formats of <code class="cCodeEmphasis">start</code> and <code class="cCodeEmphasis">end</code> are one of the following:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1031753"> </a>
J<code class="cCodeEmphasis">n</code>
</h4></div>
<div class="pDefPara2"><a name="wp1031754"> </a>
The Julian day <code class="cCodeEmphasis">n</code> (1 <code class="cCodeEmphasis">n</code> 365). Leap days are not counted. That is, in all years, February 28 is day 59 and March 1 is day 60. It is impossible to refer to the occasional February 29. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1031755"> </a>
<code class="cCodeEmphasis">n</code>
</h4></div>
<div class="pDefPara2"><a name="wp1461021"> </a>
The zero-based Julian day (0 <code class="cCodeEmphasis">n</code> 365). Leap days are counted, and it is possible to refer to February 29.   
</div><h4 class="pDefTerm"><a name="wp1461022"> </a>
M<code class="cCodeEmphasis">m.n.d</code> 
</h4><div class="pDefPara"><a name="wp1461023"> </a>
Day <code class="cCodeEmphasis">d</code> (0 <code class="cCodeEmphasis">d</code> 6) of week <code class="cCodeEmphasis">n</code> of month <code class="cCodeEmphasis">m</code> in the year (1 <code class="cCodeEmphasis">n</code> 5, 1 <code class="cCodeEmphasis">m</code> 12), where week 5 means &#8220;the last <code class="cCodeEmphasis">d</code>-day in month <code class="cCodeEmphasis">m</code>,&#8221; which may occur in either the fourth or the fifth week). Week 1 is the first week in which day <code class="cCodeEmphasis">d</code> occurs. Day 0 (zero) is Sunday.
</div>
<p class="pBody"><a name="wp1031759"> </a>
Implementation specific defaults are used for <code class="cCodeEmphasis">start</code> and <code class="cCodeEmphasis">end</code> if these optional fields are not given.
</p>
<p class="pBody"><a name="wp1031760"> </a>
The <code class="cCodeEmphasis">time</code> has the same format as <code class="cCodeEmphasis">offset</code> except that no leading sign (&#8220;-&#8221; or  &#8220;+&#8221;) is allowed. The default, if <code class="cCodeEmphasis">time</code> is not specified, is 02:00:00. 
</p>
<h4 class="pHeading3"><a name="wp1368147"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1366873"> </a>
<code class="cCode">ctime</code>(3c), <code class="cCode">getenv</code>(3c), <code class="cCode">timezone</code>(4) in a UNIX system reference manual
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1034351"> </a>
nl_langinfo(3c)
</h3>
<h4 class="pHeading3"><a name="wp1034352"> </a>
Name
</h4>
<p class="pBody"><a name="wp1034353"> </a>
<code class="cCode">nl_langinfo()</code>&#8212;Language information.
</p>
<h4 class="pHeading3"><a name="wp1034354"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1034355"> </a>
<code class="cCode">#include &lt;nl_types.h&gt; <br />#include &lt;langinfo.h&gt;  <br /> <br />char *nl_langinfo (nl_item item);</code>
</p>
<h4 class="pHeading3"><a name="wp1034356"> </a>
Description
</h4>
<p class="pBody"><a name="wp1034357"> </a>
<code class="cCode">nl_langinfo()</code> returns a pointer to a NULL-terminated string containing information relevant to a particular language or cultural area defined in the programs locale. The manifest constant names and values of <code class="cCodeEmphasis">item</code> are defined by <code class="cCode">langinfo.h</code>.
</p>
<p class="pBody"><a name="wp1034358"> </a>
For example:
</p>
<a name="wp1053120"> </a><div class="pPreformatted"><pre>nl_langinfo (ABDAY_1);</pre></div><p class="pBody"><a name="wp1053121"> </a>
returns a pointer to the string &#8220;<code class="cCode">Dim</code>&#8221; if the identified language is French and a French locale is correctly installed; or &#8220;<code class="cCode">Sun</code>&#8221; if the identified language is English.
</p>
<p class="pBody"><a name="wp1615142"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">nl_langinfo()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1034359"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp1034360"> </a>
If <code class="cCode">setlocale()</code> has not been called successfully, or if <code class="cCode">langinf0()</code> data for a supported language is either not available or <code class="cCodeEmphasis">item</code> is not defined therein, then <code class="cCode">nl_langinfo()</code> returns a pointer to the corresponding string in the C locale. In all locales, <code class="cCode">nl_langinfo()</code> returns a pointer to an empty string if <code class="cCodeEmphasis">item</code> contains an invalid setting.
</p>
<h4 class="pHeading3"><a name="wp1034361"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1034362"> </a>
The array pointed to by the return value should not be modified by the program. Subsequent calls to <code class="cCode">nl_langinfo()</code> may overwrite the array.
</p>
<h4 class="pHeading3"><a name="wp1034363"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1034364"> </a>
<a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a>, <a href="rf3c.html#wp1062371"><code class="cCode">strftime(3c)</code></a>, <a href="../rf5/rf5.html">langinfo(5)</a>, <a href="../rf5/rf5.html">nl_types(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2366371"> </a>
rpc_sm_allocate, rpc_ss_allocate(3c)
</h3>
<h4 class="pHeading3"><a name="wp2367538"> </a>
Name
</h4>
<p class="pBody"><a name="wp2366373"> </a>
<code class="cCode">rpc_sm_allocate(), rpc_ss_allocate()</code>&#8212;Allocates memory within the RPC stub memory management scheme.
</p>
<h4 class="pHeading3"><a name="wp2366375"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2366377"> </a>
<code class="cCode">#include &lt;rpc/rpc.h&gt; </code>
</p>
<p class="pBody"><a name="wp2366378"> </a>
<code class="cCode">idl_void_p_t rpc_sm_allocate(unsigned32 size, unsigned32 *status) </code>
</p>
<p class="pBody"><a name="wp2366379"> </a>
<code class="cCode">idl_void_p_t rpc_ss_allocate(unsigned32 size)</code>
</p>
<h4 class="pHeading3"><a name="wp2366381"> </a>
Description
</h4>
<p class="pBody"><a name="wp2366383"> </a>
Applications call <code class="cCode">rpc_sm_allocat3()</code> to allocate memory within the RPC stub memory management scheme. The input parameter, size, specifies in bytes, the size of memory to be allocated. Before a call to this routine, the stub memory management environment must have been established. For service code that is called from the server stub, the stub itself normally establishes the necessary environment. When <code class="cCode">rpc_sm_allocate()</code> is used by code that is not called from the stub, the application must establish the required memory management environment by calling <code class="cCode">rpc_sm_enable_allocate()</code>.
</p>
<p class="pBody"><a name="wp2371323"> </a>
Specifically, if the parameters of a server stub include any pointers other than those used for passing parameters by reference or the <code class="cCode">[enable_allocate]</code> attribute is specified for the operation in the ACS file, then the environment is automatically set up. Otherwise, the environment must be set up by the application by calling <code class="cCode">rpc_sm_enable_allocate()</code>.
</p>
<p class="pBody"><a name="wp2371325"> </a>
When the stub establishes the memory management environment, the stub itself frees any memory allocated by <code class="cCode">rpc_sm_allocate()</code>. The application can free such memory before returning to the calling stub by calling <code class="cCode">rpc_sm_free()</code>.
</p>
<p class="pBody"><a name="wp2366389"> </a>
When the application establishes the memory management environment, it must free any memory allocated, either by calling <code class="cCode">rpc_sm_free()</code> or by calling <code class="cCode">rpc_sm_disable_allocate()</code>.
</p>
<p class="pBody"><a name="wp2366391"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2366393"> </a>
rpc_s_ok 
</h4><div class="pDefPara"><a name="wp2366395"> </a>
Always returned. The return value is used to determine failure.
</div>
<p class="pBody"><a name="wp2366397"> </a>
<code class="cCode">rpc_ss_allocate()</code> is the exception-returning version of this function and has no status output parameter. No exceptions are raised.
</p>
<p class="pBody"><a name="wp2366399"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_allocate()</code> or <code class="cCode">rpc_ss_allocate()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2366401"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2366403"> </a>
Upon success, the routines return a pointer to the allocated memory. Note that in the ISO standard C environments, <code class="cCode">idl_void_p_t</code> is defined as void * and in other environments it is defined as char *.
</p>
<p class="pBody"><a name="wp2366405"> </a>
If there is insufficient memory, the routines return a NULL pointer.
</p>
<h4 class="pHeading3"><a name="wp2366407"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2366409"> </a>
<a href="rf3c.html#wp2379081">rpc_sm_disable_allocate, rpc_ss_disable_allocate(3c)</a>, <a href="rf3c.html#wp2390190">rpc_sm_enable_allocate, rpc_ss_enable_allocate(3c)</a>, <a href="rf3c.html#wp2397728">rpc_sm_free, rpc_ss_free(3c)</a>
</p>
<p class="pBody"><a name="wp1061497"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2372321"> </a>
rpc_sm_client_free, rpc_ss_client_free(3c)
</h3>
<h4 class="pHeading3"><a name="wp2372323"> </a>
Name
</h4>
<p class="pBody"><a name="wp2372325"> </a>
<code class="cCode">rpc_sm_client_free()</code>, <code class="cCode">rpc_ss_client_free()</code>&#8212;Frees memory returned from a client stub.
</p>
<h4 class="pHeading3"><a name="wp2372327"> </a>
Synopsis
</h4>
<a name="wp2372329"> </a><div class="pPreformatted"><pre>#include &lt;rpc/rpc.h&gt; </pre></div><a name="wp2372330"> </a><div class="pPreformatted"><pre>void rpc_sm_client_free (idl_void_p_t node_to_free, unsigned32 *status)</pre></div><a name="wp2372331"> </a><div class="pPreformatted"><pre>void rpc_ss_client_free (idl_void_p_t node_to_free)</pre></div><h4 class="pHeading3"><a name="wp2372333"> </a>
Description
</h4>
<p class="pBody"><a name="wp2372335"> </a>
The <code class="cCode">rpc_sm_client_free()</code> routine releases memory allocated and returned from a client stub. The input parameter, <code class="cCode">node_to_free</code>, specifies a pointer to memory returned from a client stub. Note that in the ISO standard C environments, <code class="cCode">idl_void_p_t</code> is defined as void * and in other environments is defined as char *.
</p>
<p class="pBody"><a name="wp2372337"> </a>
This routine enables a routine to deallocate dynamically allocated memory returned by an RPC call without knowledge of the memory management environment from which it was called.
</p>
<p class="pBody"><a name="wp2372339"> </a>
Note that this routine is always called from client code, even if the code can is executing as part of a server.
</p>
<p class="pBody"><a name="wp2372341"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2372343"> </a>
rpc_s_ok 
</h4><div class="pDefPara"><a name="wp2372345"> </a>
Success.
</div>
<p class="pBody"><a name="wp2372347"> </a>
<code class="cCode">rpc_ss_client_free()</code> is the exception-returning version of this function and has no status output parameter. No exceptions are raised.
</p>
<p class="pBody"><a name="wp2372349"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_client_free()</code> or <code class="cCode">rpc_ss_client_free()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2372351"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2372353"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2372355"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2372357"> </a>
<a href="rf3c.html#wp2397728">rpc_sm_free, rpc_ss_free(3c)</a>, <a href="rf3c.html#wp2401504">rpc_sm_set_client_alloc_free, rpc_ss_set_client_alloc_free(3c)</a>, <a href="rf3c.html#wp2413978">rpc_sm_swap_client_alloc_free, rpc_ss_swap_client_alloc_free(3c)</a>
</p>
<p class="pBody"><a name="wp2365767"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2379081"> </a>
rpc_sm_disable_allocate, rpc_ss_disable_allocate(3c)
</h3>
<h4 class="pHeading3"><a name="wp2379083"> </a>
Name
</h4>
<p class="pBody"><a name="wp2379085"> </a>
<code class="cCode">rpc_sm_disable_allocate()</code>, <code class="cCode">rpc_ss_disable_allocate()</code>&#8212;Releases resources and allocated memory within the stub memory management scheme.
</p>
<h4 class="pHeading3"><a name="wp2379087"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2379089"> </a>
<code class="cCode">#include &lt;rpc/rpc.h&gt; </code>
</p>
<p class="pBody"><a name="wp2379090"> </a>
<code class="cCode">void rpc_sm_disable_allocate(unsigned32 *status); </code>
</p>
<p class="pBody"><a name="wp2379091"> </a>
<code class="cCode">void rpc_ss_disable_allocate(void);</code>
</p>
<h4 class="pHeading3"><a name="wp2379093"> </a>
Description
</h4>
<p class="pBody"><a name="wp2379095"> </a>
The <code class="cCode">rpc_sm_disable_allocate()</code> routine releases all resources acquired by a call to <code class="cCode">rpc_sm_enable_allocate()</code>, and any memory allocated by calls to <code class="cCode">rpc_sm_allocate()</code> after the call to <code class="cCode">rpc_sm_enable_allocate()</code> was made.
</p>
<p class="pBody"><a name="wp2379097"> </a>
The <code class="cCode">rpc_sm_enable_allocate()</code> and <code class="cCode">rpc_sm_disable_allocate()</code> routines must be used in matching pairs. Calling this routine without a previous matching call to <code class="cCode">rpc_sm_enable_allocate()</code> results in unpredictable behavior.
</p>
<p class="pBody"><a name="wp2379099"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2379101"> </a>
rpc_s_ok 
</h4><div class="pDefPara"><a name="wp2379103"> </a>
Success.
</div>
<p class="pBody"><a name="wp2379105"> </a>
<code class="cCode">rpc_ss_disable_allocate()</code> is the exception-returning version of this function and has no status output parameter. No exceptions are raised.
</p>
<p class="pBody"><a name="wp2379107"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_disable_allocate()</code> or <code class="cCode">rpc_ss_disable_allocate()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2379109"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2379111"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2379113"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2379115"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>, <a href="rf3c.html#wp2390190">rpc_sm_enable_allocate, rpc_ss_enable_allocate(3c)</a>
</p>
<p class="pBody"><a name="wp2379074"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2390190"> </a>
rpc_sm_enable_allocate, rpc_ss_enable_allocate(3c)
</h3>
<h4 class="pHeading3"><a name="wp2390192"> </a>
Name
</h4>
<p class="pBody"><a name="wp2390194"> </a>
<code class="cCode">rpc_sm_enable_allocate()</code>, <code class="cCode">rpc_ss_enable_allocate()</code>&#8212;Enables the stub memory management environment.
</p>
<h4 class="pHeading3"><a name="wp2390196"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2390198"> </a>
<code class="cCode">#include &lt;rpc/rpc.h&gt; </code>
</p>
<p class="pBody"><a name="wp2390199"> </a>
<code class="cCode">void rpc_sm_enable_allocate(unsigned32 *status) </code>
</p>
<p class="pBody"><a name="wp2390200"> </a>
<code class="cCode">void rpc_ss_enable_allocate(void)</code>
</p>
<h4 class="pHeading3"><a name="wp2390202"> </a>
Description
</h4>
<p class="pBody"><a name="wp2390204"> </a>
Applications can call <code class="cCode">rpc_sm_enable_allocate()</code> to establish a stub memory management environment in cases where one is not established by the stub itself. A stub memory management environment must be established before any calls are made to <code class="cCode">rpc_sm_allocate()</code>. For service code called from the server stub, the stub memory management environment is normally established by the stub itself. Code that is called from other contexts needs to call <code class="cCode">rpc_sm_enable_allocate()</code> before calling <code class="cCode">rpc_sm_allocate()</code> (for example, if the service code is called directly instead of from the stub).
</p>
<p class="pBody"><a name="wp2390206"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2390208"> </a>
rpc_s_ok 
</h4><div class="pDefPara"><a name="wp2390210"> </a>
Success.
</div>
<h4 class="pDefTerm"><a name="wp2390212"> </a>
rpc_s_no_memory 
</h4><div class="pDefPara"><a name="wp2390214"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2390216"> </a>
<code class="cCode">rpc_ss_enable_allocate()</code> is the exception-returning version of this function and has no status output parameter. The following exceptions are raised by this routine:
</p>
<h4 class="pDefTerm"><a name="wp2390218"> </a>
rpc_x_no_memory 
</h4><div class="pDefPara"><a name="wp2390220"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2390222"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_enable_allocate()</code> or <code class="cCode">rpc_ss_enable_allocate()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2390224"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2390226"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2390228"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2390230"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>, <a href="rf3c.html#wp2379081">rpc_sm_disable_allocate, rpc_ss_disable_allocate(3c)</a>
</p>
<p class="pBody"><a name="wp2390188"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2397728"> </a>
rpc_sm_free, rpc_ss_free(3c)
</h3>
<h4 class="pHeading3"><a name="wp2397730"> </a>
Name
</h4>
<p class="pBody"><a name="wp2397732"> </a>
<code class="cCode">rpc_sm_free, rpc_ss_free()</code>&#8212;Frees memory allocated by the rpc_sm_allocate() routine.
</p>
<h4 class="pHeading3"><a name="wp2397734"> </a>
Synopsis
</h4>
<a name="wp2397736"> </a><div class="pPreformatted"><pre>#include &lt;rpc/rpc.h&gt;</pre></div><a name="wp2397737"> </a><div class="pPreformatted"><pre>void rpc_sm_free(idl_void_p_t node_to_free, unsigned32 *status)</pre></div><a name="wp2397738"> </a><div class="pPreformatted"><pre>void rpc_ss_free(idl_void_p_t node_to_free)</pre></div><h4 class="pHeading3"><a name="wp2397740"> </a>
Description
</h4>
<p class="pBody"><a name="wp2397742"> </a>
Applications call <code class="cCode">rpc_sm_free()</code> to release memory allocated by <code class="cCode">rpc_sm_allocate()</code>. The input parameter, node_to_free, specifies a pointer to memory allocated by <code class="cCode">rpc_sm_allocate()</code>. Note that in ISO standard C environments, <code class="cCode">idl_void_p_t</code> is defined as void * and in other environments is defined as char *.
</p>
<p class="pBody"><a name="wp2397744"> </a>
When the stub allocates memory within the stub memory management environment, service code called from the stub can also use <code class="cCode">rpc_sm_free()</code> to release memory allocated by the stub.
</p>
<p class="pBody"><a name="wp2397746"> </a>
Unpredictable behavior results if <code class="cCode">rpc_ss_free()</code> is called with a pointer to memory not allocated by <code class="cCode">rpc_sm_allocate()</code> or memory allocated by <code class="cCode">rpc_sm_allocate()</code>, but not the first address of such an allocation.
</p>
<p class="pBody"><a name="wp2397748"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2397750"> </a>
rpc_s_ok 
</h4><div class="pDefPara"><a name="wp2397752"> </a>
Success.
</div>
<p class="pBody"><a name="wp2397754"> </a>
rpc_ss_free is the exception-returning version of this function and has no status output parameter. No exceptions are raised.
</p>
<p class="pBody"><a name="wp2397756"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_free()</code> or <code class="cCode">rpc_ss_free()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2397758"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2397760"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2397762"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2397764"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>
</p>
<p class="pBody"><a name="wp2397701"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2401504"> </a>
rpc_sm_set_client_alloc_free, rpc_ss_set_client_alloc_free(3c)
</h3>
<h4 class="pHeading3"><a name="wp2401506"> </a>
Name
</h4>
<p class="pBody"><a name="wp2401508"> </a>
<code class="cCode">rpc_sm_set_client_alloc_free()</code>, <code class="cCode">rpc_ss_set_client_alloc_free()</code>&#8212;Sets the memory allocation and freeing mechanisms used by the client stubs.
</p>
<h4 class="pHeading3"><a name="wp2401510"> </a>
Synopsis
</h4>
<a name="wp2401512"> </a><div class="pPreformatted"><pre>#include &lt;rpc/rpc.h&gt;  </pre></div><a name="wp2401513"> </a><div class="pPreformatted"><pre>void rpc_sm_set_client_alloc_free(idl_void_p_t (*p_allocate)(unsigned long size), void (*p_free) (idl_void_p_t ptr), unsigned32 *status)</pre></div><a name="wp2401516"> </a><div class="pPreformatted"><pre>void rpc_ss_set_client_alloc_free(idl_void_p_t (*p_allocate)(unsigned long size), void (*p_free) (idl_void_p_t ptr))</pre></div><h4 class="pHeading3"><a name="wp2401521"> </a>
Description
</h4>
<p class="pBody"><a name="wp2401523"> </a>
The <code class="cCode">rpc_sm_set_client_alloc_free()</code> routine overrides the default routines that the client stub uses to manage memory. The input parameters, <code class="cCode">p_allocate</code> and <code class="cCode">p_free</code> specify memory allocator and free routines. The default memory management routines are ISO C <code class="cCode">malloc()</code> and <code class="cCode">free()</code> except when the remote call occurs within server code in which case the memory management routines must be <code class="cCode">rpc_ss_allocate()</code> and <code class="cCode">rpc_ss_free()</code>.
</p>
<p class="pBody"><a name="wp2401525"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2401527"> </a>
<span style="font-weight: bold">rpc_s_ok</span> 
</h4><div class="pDefPara"><a name="wp2401529"> </a>
Success.
</div>
<h4 class="pDefTerm"><a name="wp2401531"> </a>
<span style="font-weight: bold">rpc_s_no_memory</span> 
</h4><div class="pDefPara"><a name="wp2401533"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2401535"> </a>
<code class="cCode">rpc_ss_set_client_alloc_free</code> is the exception-returning version of this function and has no status output parameter. The following exceptions are raised by this routine:
</p>
<h4 class="pDefTerm"><a name="wp2401537"> </a>
<span style="font-weight: bold">rpc_x_no_memory</span> 
</h4><div class="pDefPara"><a name="wp2401539"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2401541"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_set_client_alloc_free()</code> or <code class="cCode">rpc_ss_set_client_alloc_free()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2401543"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2401545"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2401547"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2401549"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>, <a href="rf3c.html#wp2397728">rpc_sm_free, rpc_ss_free(3c)</a>
</p>
<p class="pBody"><a name="wp2401473"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2413978"> </a>
rpc_sm_swap_client_alloc_free, rpc_ss_swap_client_alloc_free(3c)
</h3>
<h4 class="pHeading3"><a name="wp2413980"> </a>
Name
</h4>
<p class="pBody"><a name="wp2413982"> </a>
<code class="cCode">rpc_sm_swap_client_alloc_free()</code>, <code class="cCode">rpc_ss_swap_client_alloc_free()</code>&#8212;Exchanges current memory allocation and freeing mechanism used by client stubs with one supplied by client.
</p>
<h4 class="pHeading3"><a name="wp2413984"> </a>
Synopsis
</h4>
<a name="wp2413986"> </a><div class="pPreformatted"><pre>#include &lt;rpc/rpc.h&gt;<br />void rpc_sm_swap_client_alloc_free(idl_void_p_t (*p_allocate)(unsigned long size),<br />void (*p_free) (idl_void_p_t ptr), idl_void_p_t (**p_p_old_allocate)(unsigned long size),<br />void (**p_p_old_free)( idl_void_p_t ptr), unsigned32 *status)</pre></div><a name="wp2413994"> </a><div class="pPreformatted"><pre>void rpc_ss_swap_client_alloc_free(idl_void_p_t (*p_allocate)(unsigned long size),<br />void (*p_free) (idl_void_p_t ptr), idl_void_p_t (**p_p_old_allocate)(unsigned long size),<br />void (**p_p_old_free)( idl_void_p_t ptr))</pre></div><h4 class="pHeading3"><a name="wp2414000"> </a>
Description
</h4>
<p class="pBody"><a name="wp2414002"> </a>
The <code class="cCode">rpc_sm_swap_client_alloc_free()</code> routine exchanges the current allocate and free mechanisms used by the client stubs for routines supplied by the caller. The input parameters, <code class="cCode">p_allocate</code> and <code class="cCode">p_free</code>, specify new memory allocation and free routines. The output parameters, <code class="cCode">p_p_old_allocate</code> and <code class="cCode">p_p_old_free</code> return the memory allocation and free routines in use before the call to this routine.
</p>
<p class="pBody"><a name="wp2414004"> </a>
When a callable routine is an RPC client, it may need to ensure which allocate and free routines are used, despite the mechanism its caller had selected. This routine allows scoped replacement of the allocation/free mechanism to allow this.
</p>
<p class="pBody"><a name="wp2414006"> </a>
The output parameter, status, returns the status code from this routine. This status code indicates whether the routine completed successfully or, if not, why not. Possible status codes and their meanings include:
</p>
<h4 class="pDefTerm"><a name="wp2414008"> </a>
<code class="cCodeBold">rpc_s_ok</code>
</h4><div class="pDefPara"><a name="wp2414010"> </a>
Success.
</div>
<h4 class="pDefTerm"><a name="wp2414012"> </a>
<code class="cCodeBold">rpc_s_no_memory</code> 
</h4><div class="pDefPara"><a name="wp2414014"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2414016"> </a>
<code class="cCode">rpc_ss_swap_client_alloc_free</code> is the exception-returning version of this function and has no status output parameter. The following exceptions are raised by this routine:
</p>
<h4 class="pDefTerm"><a name="wp2414018"> </a>
<code class="cCodeBold">rpc_x_no_memory</code> 
</h4><div class="pDefPara"><a name="wp2414020"> </a>
Insufficient memory available to set up necessary data structures.
</div>
<p class="pBody"><a name="wp2414022"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">rpc_sm_swap_client_alloc_free()</code> or <code class="cCode">rpc_ss_swap_client_alloc_free()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2414024"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2414026"> </a>
None.
</p>
<h4 class="pHeading3"><a name="wp2414028"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2414030"> </a>
<a href="rf3c.html#wp2366371">rpc_sm_allocate, rpc_ss_allocate(3c)</a>, <a href="rf3c.html#wp2397728">rpc_sm_free, rpc_ss_free(3c)</a>, <a href="rf3c.html#wp2401504">rpc_sm_set_client_alloc_free, rpc_ss_set_client_alloc_free(3c)</a>
</p>
<p class="pBody"><a name="wp2413495"> </a>
Programming Oracle Tuxedo ATMI Applications Using TxRPC.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2372132"> </a>
setlocale(3c)
</h3>
<h4 class="pHeading3"><a name="wp1061498"> </a>
Name
</h4>
<p class="pBody"><a name="wp1061499"> </a>
<code class="cCode">setlocale()</code>&#8212;Modifies and queries a program&#8217;s locale.
</p>
<h4 class="pHeading3"><a name="wp1061500"> </a>
Synopsis
</h4>
<a name="wp1061501"> </a><div class="pPreformatted"><pre>#include &lt;locale.h&gt; <br />char *setlocale (int category, const char *locale);</pre></div><h4 class="pHeading3"><a name="wp1061502"> </a>
Description
</h4>
<p class="pBody"><a name="wp1061503"> </a>
<code class="cCode">setlocale()</code> selects the appropriate piece of the program&#8217;s locale as specified by the <code class="cCodeEmphasis">category</code> and <code class="cCodeEmphasis">locale</code> arguments. The <code class="cCodeEmphasis">category</code> argument may have the following values:
</p>
<a name="wp1061504"> </a><div class="pPreformatted"><pre>LC_CTYPE <br />LC_NUMERIC <br />LC_TIME <br />LC_COLLATE <br />LC_MONETARY <br />LC_MESSAGES <br />LC_ALL</pre></div><p class="pBody"><a name="wp1061505"> </a>
These names are defined in the <code class="cCode">locale.h</code> header file. For the Oracle Tuxedo ATMI system compatibility functions, <code class="cCode">setlocale()</code> allows only a single <code class="cCodeEmphasis">locale</code> for all categories. Setting any category is treated the same as <code class="cCode">LC_ALL</code>, which names the program&#8217;s entire locale.
</p>
<p class="pBody"><a name="wp1061506"> </a>
A value of &#8220;C&#8221; for <code class="cCodeEmphasis">locale</code> specifies the default environment.
</p>
<p class="pBody"><a name="wp1061507"> </a>
A value of &quot;&quot; for <code class="cCodeEmphasis">locale</code> specifies that the locale should be taken from an environment variable. The environment variable <code class="cCode">LANG</code> is checked for a locale.
</p>
<p class="pBody"><a name="wp1061508"> </a>
At program startup, the equivalent of
</p>
<a name="wp1061509"> </a><div class="pPreformatted"><pre><code class="cCode">setlocale(LC_ALL, &quot;C&quot;)</code></pre></div><p class="pBody"><a name="wp1061510"> </a>
is executed. This has the effect of initializing each category to the locale described by the environment &#8220;C&#8221;.
</p>
<p class="pBody"><a name="wp1061511"> </a>
If a pointer to a string is given for <code class="cCodeEmphasis">locale</code>, <code class="cCode">setlocale()</code> attempts to set the locale for all the categories to <code class="cCodeEmphasis">locale</code>. The <code class="cCodeEmphasis">locale</code> must be a simple locale, consisting of a single locale. If <code class="cCode">setlocale()</code> fails to set the locale for any category, a NULL pointer is returned and the program&#8217;s locale for all categories is not changed. Otherwise, locale is returned.
</p>
<p class="pBody"><a name="wp1061512"> </a>
A NULL pointer for <code class="cCodeEmphasis">locale</code> causes <code class="cCode">setlocale()</code> to return the current locale associated with the <code class="cCodeEmphasis">category</code>. The program&#8217;s locale is not changed.
</p>
<p class="pBody"><a name="wp1617633"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">setlocale()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1061513"> </a>
Files
</h4>
<a name="wp1061514"> </a><div class="pPreformatted"><pre><code class="cCode">$TUXDIR/locale/C/LANGINFO - time and money database for the C locale<br />$TUXDIR/locale/</code><code class="cCodeEmphasis">locale</code><code class="cCode">/* - locale specific information for each<br />locale $TUXDIR/locale/C/*_CAT - text messages for the C locale</code></pre></div><h4 class="pHeading3"><a name="wp1061515"> </a>
Note
</h4>
<p class="pBody"><a name="wp1061516"> </a>
A composite locale is not supported. A composite locale is a string beginning with a &#8220;/&#8221;, followed by the locale of each category, separated by a &#8220;/&#8221;.
</p>
<h4 class="pHeading3"><a name="wp1061517"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1357958"> </a>
<a href="../rfcm/rfcmd.html">mklanginfo(1)</a> 
</p>
<p class="pBody"><a name="wp1357953"> </a>
<code class="cCode">ctime</code>(3c), <code class="cCode">ctype</code>(3c), <code class="cCode">getdate</code>(3c), <code class="cCode">localeconv</code>(3c), <code class="cCode">strftime</code>(3c), <code class="cCode">strtod</code>(3c), <code class="cCode">printf</code>(3S), <code class="cCode">environ</code>(5) in a UNIX system reference manual
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1954521"> </a>
setURLEntityCacheDir(3c)
</h3>
<h4 class="pHeading3"><a name="wp2161207"> </a>
Name
</h4>
<p class="pBody"><a name="wp1957035"> </a>
<code class="cCode">setURLEntityCacheDir()</code> - Specifies a Xerces class method for setting the directory where the DTD, schema and Entity files are to be cached.
</p>
<h4 class="pHeading3"><a name="wp1954524"> </a>
Synopsis
</h4>
<a name="wp1954525"> </a><div class="pPreformatted"><pre>void setURLEntityCacheDir (const char* cachedir)</pre></div><h4 class="pHeading3"><a name="wp1954526"> </a>
Description
</h4>
<p class="pBody"><a name="wp2177786"> </a>
<code class="cCode">setURLEntityCacheDir()</code> is method called when caching is turned on and you want the DTD, schema and Entity files to be cached to a specific directory. <code class="cCode">cachedir</code>  specifies the absolute path to the location of the files.
</p>
<p class="pBody"><a name="wp2177787"> </a>
If this method is not called and caching is turned on either by calling the method <code class="cCode">setURLEntityCaching()</code> or by not setting the environment variable, then the files are cached in the current directory. This method is exclusively used in conjunction with the following two Xerces objects:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2177788"> </a>XercesDOMParser</li>
<li><a name="wp2177789"> </a>SAXparser</li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1955768"> </a>
setURLEntityCaching(3c)
</h3>
<h4 class="pHeading3"><a name="wp1955769"> </a>
Name
</h4>
<p class="pBody"><a name="wp1957014"> </a>
<code class="cCode">setURLEntityCaching()</code> - Specifies a Xerces class method for setting or unsetting DTD, schema or Entity file caching for the XML parser.
</p>
<h4 class="pHeading3"><a name="wp1955771"> </a>
Synopsis
</h4>
<a name="wp1955772"> </a><div class="pPreformatted"><pre>void setURLEntityCaching (bool UseCache)</pre></div><h4 class="pHeading3"><a name="wp1955773"> </a>
Description
</h4>
<p class="pBody"><a name="wp2177819"> </a>
<code class="cCode">setURLEntityCaching()</code>is a method that caches the DTD, schema and Entity files by default. It allows you to turn caching of the files on or off. <code class="cCode">UseCache</code> is set to <span style="font-style: italic">false</span> if caching is to be turned off and set to <span style="font-style: italic">true</span> if caching is to be turned on. This method is exclusively used in conjunction with the following two Xerces objects:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2177820"> </a>XercesDOMParser</li>
<li><a name="wp2177821"> </a>SAXparser</li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2144382"> </a>
strerror(3c)
</h3>
<h4 class="pHeading3"><a name="wp1036567"> </a>
Name
</h4>
<p class="pBody"><a name="wp1036568"> </a>
<code class="cCode">strerror()</code>&#8212;Gets error message string.
</p>
<h4 class="pHeading3"><a name="wp1036569"> </a>
Synopsis
</h4>
<a name="wp1036570"> </a><div class="pPreformatted"><pre>#include &lt;string.h&gt; <br />char *strerror (int errnum);</pre></div><h4 class="pHeading3"><a name="wp1036571"> </a>
Description
</h4>
<p class="pBody"><a name="wp1036572"> </a>
<code class="cCode">strerror</code> maps the error number in <code class="cCodeEmphasis">errnum</code> to an error message string, and returns a pointer to that string. <code class="cCode">strerror</code> uses the same set of error messages as <code class="cCode">perror</code>. The returned string should not be overwritten.
</p>
<p class="pBody"><a name="wp1617642"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">strerror()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1036573"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1036574"> </a>
<code class="cCode">perror</code>(3) in a UNIX system reference manual
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1062371"> </a>
strftime(3c)
</h3>
<h4 class="pHeading3"><a name="wp1062372"> </a>
Name
</h4>
<p class="pBody"><a name="wp1062373"> </a>
<code class="cCode">strftime()</code>&#8212;Converts date and time to string.
</p>
<h4 class="pHeading3"><a name="wp1062374"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1062375"> </a>
<code class="cCode">#include &lt;time.h&gt; <br /> <br />size_t *strftime (char *s, size_t maxsize, const char *format, const struct tm *timeptr);</code>
</p>
<h4 class="pHeading3"><a name="wp1062376"> </a>
Description
</h4>
<p class="pBody"><a name="wp1062377"> </a>
<code class="cCode">strftime()</code> places characters into the array pointed to by <code class="cCodeEmphasis">s</code> as controlled by the string pointed to by <code class="cCodeEmphasis">format</code>. The <code class="cCodeEmphasis">format</code> string consists of zero or more directives and ordinary characters. All ordinary characters (including the terminating NULL character) are copied unchanged into the array. For <code class="cCode">strftime()</code>, no more than <code class="cCodeEmphasis">maxsize</code> characters are placed into the array.
</p>
<p class="pBody"><a name="wp1062378"> </a>
If <code class="cCodeEmphasis">format</code> is (char *)0, then the locale&#8217;s default format is used. The default format is the same as <code class="cCode">&quot;%c&quot;</code>.
</p>
<p class="pBody"><a name="wp1062379"> </a>
Each directive is replaced by appropriate characters as described in the following list. The appropriate characters are determined by the <code class="cCode">LC_TIME</code> category of the program&#8217;s locale and by the values contained in the structure pointed to by <code class="cCodeEmphasis">timeptr</code>. 
</p>
<p class="pGraphic"><a name="wp1062509"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1837894table1062380">
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1837894"> </a>
Character
</div>
</td>
    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1837896"> </a>
Description
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062386"> </a>
<code class="cCode">%%</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062388"> </a>
Same as %
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062390"> </a>
<code class="cCode">%a</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062392"> </a>
Locale&#8217;s abbreviated weekday name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062394"> </a>
<code class="cCode">%A</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062396"> </a>
Locale&#8217;s full weekday name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062398"> </a>
<code class="cCode">%b</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062400"> </a>
Locale&#8217;s abbreviated month name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062402"> </a>
<code class="cCode">%B</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062404"> </a>
Locale&#8217;s full month name
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062406"> </a>
<code class="cCode">%c</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062408"> </a>
Locale&#8217;s appropriate date and time representation
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062410"> </a>
<code class="cCode">%C</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062412"> </a>
Locale&#8217;s date and time representation as produced by date(1)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062414"> </a>
<code class="cCode">%d</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062416"> </a>
Day of month ( 01 - 31 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062418"> </a>
<code class="cCode">%D</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062420"> </a>
Date as %m/%d/%y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062422"> </a>
<code class="cCode">%e</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062424"> </a>
Day of month (1-31; single digits are preceded by a blank)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062426"> </a>
<code class="cCode">%h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062428"> </a>
Locale&#8217;s abbreviated month name.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062430"> </a>
<code class="cCode">%H</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062432"> </a>
Hour ( 00 - 23 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062434"> </a>
<code class="cCode">%I</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062436"> </a>
Hour ( 01 - 12 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062438"> </a>
<code class="cCode">%j</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062440"> </a>
Day number of year ( 001 - 366 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062442"> </a>
<code class="cCode">%m</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062444"> </a>
Month number ( 01 - 12 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062446"> </a>
<code class="cCode">%M</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062448"> </a>
Minute ( 00 - 59 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062450"> </a>
<code class="cCode">%n</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062452"> </a>
Same as \
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062454"> </a>
<code class="cCode">%p</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062456"> </a>
Locale&#8217;s equivalent of either AM or PM
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062458"> </a>
<code class="cCode">%r</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062460"> </a>
Time as %I:%M:%S [AM|PM]
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062462"> </a>
<code class="cCode">%R</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062464"> </a>
Time as %H:%M
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062466"> </a>
<code class="cCode">%S</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062468"> </a>
Seconds ( 00 - 61 ), allows for leap seconds
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062470"> </a>
<code class="cCode">%t</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062472"> </a>
Insert a tab
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062474"> </a>
<code class="cCode">%T</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062476"> </a>
Time as %H:%M:%S
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062478"> </a>
<code class="cCode">%U</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062480"> </a>
Week number of year ( 00 - 53 ), Sunday is the first day of week 1
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062482"> </a>
<code class="cCode">%w</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062484"> </a>
Weekday number ( 0 - 6 ), Sunday = 0
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062486"> </a>
<code class="cCode">%W</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062488"> </a>
Week number of year ( 00 - 53 ), Monday is the first day of week 1
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062490"> </a>
<code class="cCode">%x</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062492"> </a>
Locale&#8217;s appropriate date representation
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062494"> </a>
<code class="cCode">%X</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062496"> </a>
Locale&#8217;s appropriate time representation
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062498"> </a>
<code class="cCode">%y</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062500"> </a>
Year within century ( 00 - 99 )
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062502"> </a>
<code class="cCode">%Y</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062504"> </a>
Year as ccyy (for example, 1986)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062506"> </a>
<code class="cCode">%Z</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062508"> </a>
Time zone name or no characters if no time zone exists
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1062510"> </a>
The difference between <code class="cCode">%U</code> and <code class="cCode">%W</code> lies in which day is counted as the first of the week. Week number 01 is the first week in January starting with a Sunday for <code class="cCode">%U</code> or a Monday for <code class="cCode">%W</code>. Week number 00 contains those days before the first Sunday or Monday in January for <code class="cCode">%U</code> and <code class="cCode">%W</code>, respectively.
</p>
<p class="pBody"><a name="wp1062511"> </a>
If the total number of resulting characters including the terminating NULL character is not more than <code class="cCodeEmphasis">maxsize</code>, <code class="cCode">strftime()</code>, returns the number of characters placed into the array pointed to by <code class="cCodeEmphasis">s</code> not including the terminating NULL character. Otherwise, zero is returned and the contents of the array are indeterminate.
</p>
<p class="pBody"><a name="wp1617650"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">strftime()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1062512"> </a>
Selecting the Output Language
</h4>
<p class="pBody"><a name="wp1062513"> </a>
By default, the output of <code class="cCode">strftime()</code>, appears in U.S. English. The user can request that the output of <code class="cCode">strftime()</code> be in a specific language by setting the <code class="cCodeEmphasis">locale</code> for <code class="cCodeEmphasis">category</code> <code class="cCode">LC_TIME</code> in <code class="cCode">setlocale()</code>.
</p>
<h4 class="pHeading3"><a name="wp1062514"> </a>
Time Zone
</h4>
<p class="pBody"><a name="wp1062515"> </a>
The time zone is taken from the environment variable <code class="cCode">TZ</code>. See <code class="cCode">ctime</code>(3c) for a description of <code class="cCode">TZ</code>.
</p>
<h4 class="pHeading3"><a name="wp1062516"> </a>
Examples
</h4>
<p class="pBody"><a name="wp1062517"> </a>
The example illustrates the use of <code class="cCode">strftime()</code>. It shows what the string in <code class="cCode">str</code> would look like if the structure pointed to by <code class="cCodeEmphasis">tmptr</code> contains the values corresponding to Thursday, August 28, 1986 at 12:44:36 in New Jersey.
</p>
<a name="wp1062518"> </a><div class="pPreformatted"><pre>strftime (str, strsize, &quot;%A %b %d %j&quot;, tmptr)</pre></div><p class="pBody"><a name="wp1062519"> </a>
This results in <code class="cCode">str</code> containing &quot;Thursday Aug 28 240&quot;.
</p>
<h4 class="pHeading3"><a name="wp1062520"> </a>
Files
</h4>
<p class="pBody"><a name="wp1062521"> </a>
<code style="font-style: normal" class="cCode">$TUXDIR/locale/</code><span style="font-style: italic">locale</span><code class="cCode">/LANGINFO</code>&#8212;file containing compiled locale-specific date and time information
</p>
<h4 class="pHeading3"><a name="wp1062522"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1062523"> </a>
<a href="../rfcm/rfcmd.html">mklanginfo(1)</a>, <a href="rf3c.html#wp2372132"><code class="cCode">setlocale(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1036832"> </a>
tpabort(3c)
</h3>
<h4 class="pHeading3"><a name="wp1036833"> </a>
Name
</h4>
<p class="pBody"><a name="wp1036834"> </a>
<code class="cCode">tpabort()</code>&#8212;Routine for aborting current transaction.
</p>
<h4 class="pHeading3"><a name="wp1036835"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1036836"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tpabort(long flags)</code> 
</p>
<h4 class="pHeading3"><a name="wp1036837"> </a>
Description
</h4>
<p class="pBody"><a name="wp1036838"> </a>
<code class="cCode">tpabort()</code> signifies the abnormal end of a transaction. When this call returns, all changes made to resources during the transaction are undone. Like <code class="cCode">tpcommit()</code>, this function can be called only by the initiator of a transaction. Participants (that is, service routines) can express their desire to have a transaction aborted by calling <code class="cCode">tpreturn()</code> with <code class="cCode">TPFAIL</code>.
</p>
<p class="pBody"><a name="wp1036839"> </a>
If <code class="cCode">tpabort()</code> is called while call descriptors exist for outstanding replies, then upon return from the function, the transaction is aborted and those descriptors associated with the caller&#8217;s transaction are no longer valid. Call descriptors not associated with the caller&#8217;s transaction remain valid.
</p>
<p class="pBody"><a name="wp1036840"> </a>
For each open connection to a conversational server in transaction mode, <code class="cCode">tpabort()</code> will send a <code class="cCode">TPEV_DISCONIMM</code> event to the server, whether or not the server has control of a connection. Connections opened before <code class="cCode">tpbegin()</code> or with the <code class="cCode">TPNOTRAN</code> flag (that is, not in transaction mode) are not affected.
</p>
<p class="pBody"><a name="wp1036841"> </a>
Currently, the sole argument to the <code class="cCode">tpabort()</code>function, <code class="cCodeEmphasis">flags</code>, is reserved for future use and should be set to 0.
</p>
<p class="pBody"><a name="wp1630155"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpabort()</code>.
</p>
<h4 class="pHeading3"><a name="wp1036842"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1036843"> </a>
Upon failure, <code class="cCode">tpabort()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1036844"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1036845"> </a>
Upon failure, <code class="cCode">tpabort()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1036846"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1036847"> </a>
<code class="cCodeEmphasis">flags</code> is not equal to 0. The caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1036848"> </a>
[<code class="cCode">TPEHEURISTIC</code>] 
</h4><div class="pDefPara"><a name="wp1036849"> </a>
Due to a heuristic decision, the work done on behalf of the transaction was partially committed and partially aborted.
</div>
<h4 class="pDefTerm"><a name="wp1036850"> </a>
[<code class="cCode">TPEHAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1036851"> </a>
Due to some failure, the work done on behalf of the transaction could have been heuristically completed.
</div>
<h4 class="pDefTerm"><a name="wp1036852"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1036853"> </a>
<code class="cCode">tpabort()</code> was called improperly (for example, by a participant).
</div>
<h4 class="pDefTerm"><a name="wp1036854"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1036855"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1036856"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1036857"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1036858"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1036859"> </a>
When using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code>, and <code class="cCode">tpabort()</code> to delineate an Oracle Tuxedo ATMI system transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>.
</p>
<h4 class="pHeading3"><a name="wp1036860"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1036861"> </a>
<a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1037129"> </a>
tpacall(3c)
</h3>
<h4 class="pHeading3"><a name="wp1037130"> </a>
Name
</h4>
<p class="pBody"><a name="wp1037131"> </a>
<code class="cCode">tpacall()</code>&#8212;Routine for sending a service request.
</p>
<h4 class="pHeading3"><a name="wp1037132"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1037133"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tpacall(char *svc, char *data, long len, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp1037134"> </a>
Description
</h4>
<p class="pBody"><a name="wp1037135"> </a>
<code class="cCode">tpacall()</code> sends a request message to the service named by <code class="cCodeEmphasis">svc</code>. The request is sent out at the priority defined for <code class="cCodeEmphasis">svc</code> unless overridden by a previous call to <code class="cCode">tpspri()</code>. If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should specify the amount of data in the buffer that should be sent. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified, (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and may be 0). If <code class="cCodeEmphasis">data</code> is NULL, <code class="cCodeEmphasis">len</code> is ignored and a request is sent with no data portion. The type and subtype of <code class="cCodeEmphasis">data</code> must match one of the types and subtypes recognized by <code class="cCodeEmphasis">svc</code>. Note that for each request sent while in transaction mode, a corresponding reply must ultimately be received.
</p>
<p class="pBody"><a name="wp1037136"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp1037137"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1037138"> </a>
If the caller is in transaction mode and this flag is set, then when <code class="cCodeEmphasis">svc</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. If <code class="cCodeEmphasis">svc</code> belongs to a server that does not support transactions, then this flag must be set when the caller is in transaction mode. Note that <code class="cCodeEmphasis">svc</code> may still be invoked in transaction mode but it will not be the same transaction: a <code class="cCodeEmphasis">svc</code> may have as a configuration attribute that it is automatically invoked in transaction mode. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other). If a service fails that was invoked with this flag, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1037139"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp1037140"> </a>
Informs <code class="cCode">tpacall()</code> that a reply is not expected. When <code class="cCode">TPNOREPLY</code> is set, the function returns 0 on success, where 0 is an invalid descriptor. When the caller is in transaction mode, this setting cannot be used unless <code class="cCode">TPNOTRAN</code> is also set.
</div>
<h4 class="pDefTerm"><a name="wp1037141"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1037142"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1037143"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1037144"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1037145"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1037146"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued.
</div>
<p class="pBody"><a name="wp1630163"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpacall()</code>.
</p>
<h4 class="pHeading3"><a name="wp1037147"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1037148"> </a>
Upon successful completion, <code class="cCode">tpacall()</code> returns a descriptor that can be used to receive the reply of the request sent. 
</p>
<p class="pBody"><a name="wp1233883"> </a>
Upon failure, <code class="cCode">tpacall()</code> returns a value of -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1037149"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1037150"> </a>
Upon failure, <code class="cCode">tpacall()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1037151"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1037152"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">svc</code> is NULL, <code class="cCodeEmphasis">data</code> does not point to space allocated with <code class="cCode">tpalloc()</code>, or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1037153"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1037154"> </a>
Cannot send to <code class="cCodeEmphasis">svc</code> because it does not exist or is a conversational service.
</div>
<h4 class="pDefTerm"><a name="wp1037155"> </a>
[<code class="cCode">TPEITYPE</code>] 
</h4><div class="pDefPara"><a name="wp1037156"> </a>
The type and subtype of <code class="cCodeEmphasis">data</code> is not one of the allowed types and subtypes that <code class="cCodeEmphasis">svc</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp1037157"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp1037158"> </a>
The caller&#8217;s request was not sent because the maximum number of outstanding asynchronous requests has been reached.
</div>
<h4 class="pDefTerm"><a name="wp1037159"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1037160"> </a>
<code class="cCodeEmphasis">svc</code> belongs to a server that does not support transactions and <code class="cCode">TPNOTRAN</code> was not set.
</div>
<h4 class="pDefTerm"><a name="wp1037161"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1037162"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpacall()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1841253"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1841268"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1841277"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1037163"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1037164"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1037165"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1037166"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1037167"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1037168"> </a>
<code class="cCode">tpacall()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1037169"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1037170"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1037171"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1037172"> </a>
An operating system error has occurred. If a message queue on a remote location is filled, <code class="cCode">TPEOS</code> may be returned even if <code class="cCode">tpacall()</code> returned successfully.
</div>
<h4 class="pHeading3"><a name="wp1037173"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1037174"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1039772"><code class="cCode">tpcancel(3c)</code></a>, <a href="rf3c.html#wp1021885"><code class="cCode">tpgetrply(3c)</code></a>, <a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a>, <a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1037464"> </a>
tpadmcall(3c)
</h3>
<h4 class="pHeading3"><a name="wp1037465"> </a>
Name
</h4>
<p class="pBody"><a name="wp1037466"> </a>
<code class="cCode">tpadmcall()</code>&#8212;Administers unbooted application.
</p>
<h4 class="pHeading3"><a name="wp1037467"> </a>
Synopsis
</h4>
<a name="wp1037468"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />#include &lt;fml32.h&gt; <br />#include &lt;tpadm.h&gt; <br /> <br />int tpadmcall(FBFR32 *inbuf, FBFR32 **outbuf, long flags) </pre></div><h4 class="pHeading3"><a name="wp1037469"> </a>
Description
</h4>
<p class="pBody"><a name="wp1037470"> </a>
<code class="cCode">tpadmcall()</code> is used to retrieve and update attributes of an unbooted application. It may also be used in an active application to perform direct retrievals of a limited set of attributes without requiring communication to an external process. This function provides sufficient capability such that complete system configuration and administration can take place through system provided interface routines.
</p>
<p class="pBody"><a name="wp1037471"> </a>
<code class="cCodeEmphasis">inbuf</code> is a pointer to an FML32 buffer previously allocated with <code class="cCode">tpalloc()</code> that contains the desired administrative operation and its parameters.
</p>
<p class="pBody"><a name="wp1037472"> </a>
<code class="cCodeEmphasis">outbuf</code> is the address of a pointer to the FML32 buffer that should contain the results. <code class="cCodeEmphasis">outbuf</code> must point to an FML32 buffer originally allocated by <code class="cCode">tpalloc()</code>. If the same buffer is to be used for both sending and receiving, <code class="cCodeEmphasis">outbuf</code> should be set to the address of <code class="cCodeEmphasis">inbuf</code>.
</p>
<p class="pBody"><a name="wp1037473"> </a>
Currently, <code class="cCode">tpadmcall()</code>&#8217;s last argument, <code class="cCodeEmphasis">flags</code>, is reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1037474"> </a>
<a href="../rf5/rf5.html">MIB(5)</a> should be consulted for generic information on construction of administrative requests. <a href="../rf5/rf5.html">TM_MIB(5)</a> and <a href="../rf5/rf5.html">APPQ_MIB(5)</a> should be consulted for information on the classes that are accessible through <code class="cCode">tpadmcall()</code>.
</p>
<p class="pBody"><a name="wp1037475"> </a>
There are four modes in which calls to <code class="cCode">tpadmcall()</code> can be made. 
</p>
<h4 class="pDefTerm"><a name="wp1037476"> </a>
Mode 1: Unbooted, Unconfigured Application: 
</h4><div class="pDefPara"><a name="wp1037477"> </a>
The caller is assumed to be the administrator of the application. The only operations permitted are to SET a NEW T_DOMAIN class object, thus defining an initial configuration for the application, and to GET and SET objects of the classes defined in <code class="cCode">APPQ_MIB()</code>.
</div>
<h4 class="pDefTerm"><a name="wp1037478"> </a>
Mode 2: Unbooted, Configured Application: 
</h4><div class="pDefPara"><a name="wp1037479"> </a>
The caller is assigned administrator or other privileges based on a comparison of their UID/GID to that defined in the configuration for the administrator on the local system. The caller may GET and SET any attributes for any class in <code class="cCode">TM_MIB()</code> and <code class="cCode">APPQ_MIB()</code> for which they have the appropriate permissions. Note that some classes contain only attributes that are inaccessible in an unbooted application and attempts to access these classes will fail.
</div>
<h4 class="pDefTerm"><a name="wp1037480"> </a>
Mode 3: Booted Application, Unattached Process: 
</h4><div class="pDefPara"><a name="wp1037481"> </a>
The caller is assigned administrator or other privileges based on a comparison of their UID/GID to that defined in the configuration for the administrator on the local system. The caller may GET any attributes for any class in <code class="cCode">TM_MIB()</code> for which they have the appropriate permissions. Similarly, the caller may GET and SET any attributes for any class in <code class="cCode">APPQ_MIB()</code>, subject to class-specific restrictions. Attributes accessible only while ACTIVE will not be returned.
</div>
<h4 class="pDefTerm"><a name="wp1037482"> </a>
Mode 4: Booted Application, Attached Process: 
</h4><div class="pDefPara"><a name="wp1037483"> </a>
Permissions are determined from the authentication key assigned at <code class="cCode">tpinit()</code> time. The caller may GET any attributes for any class in <code class="cCode">TM_MIB()</code> for which they have the appropriate permissions. Additionally, the caller may GET and SET any attributes for any class in <code class="cCode">APPQ_MIB()</code>, subject to class-specific restrictions.
</div>
<p class="pBody"><a name="wp1037484"> </a>
Access to and update of binary Oracle Tuxedo ATMI system application configuration files through this interface routine is controlled through the use of UNIX system permissions on directory names and filenames. 
</p>
<p class="pBody"><a name="wp1630171"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpadmcall()</code>.
</p>
<h4 class="pHeading3"><a name="wp1037485"> </a>
Environment Variables
</h4>
<p class="pBody"><a name="wp1037486"> </a>
The following environment variables must be set prior to calling this routine: 
</p>
<h4 class="pDefTerm"><a name="wp1037487"> </a>
<code class="cCode">TUXCONFIG</code> 
</h4><div class="pDefPara"><a name="wp1037488"> </a>
Name of the file or device on which the binary Oracle Tuxedo system configuration file for this application is or should be stored.
</div>
<h4 class="pHeading3"><a name="wp1037489"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1037490"> </a>
Use of the <code class="cCode">TA_OCCURS</code> attribute on <code class="cCode">GET</code> requests is not supported when using <code class="cCode">tpadmcall()</code>. <code class="cCode">GETNEXT</code> requests are not supported when using <code class="cCode">tpadmcall()</code>.
</p>
<h4 class="pHeading3"><a name="wp1037491"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1037492"> </a>
<code class="cCode">tpadmcall()</code> returns 0 on success and -1 on failure. 
</p>
<h4 class="pHeading3"><a name="wp1037493"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1037494"> </a>
Upon failure, <code class="cCode">tpadmcall()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<a name="wp1233924"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Except for <code class="cCode">TPEINVAL</code>, the caller&#8217;s output buffer, <code class="cCodeEmphasis">outbuf</code>, will be modified to include <code class="cCode">TA_ERROR</code>, <code class="cCode">TA_STATUS</code>, and possibly <code class="cCode">TA_BADFLD</code> attributes to further qualify the error condition. See <a href="../rf5/rf5.html">MIB(5)</a>, <a href="../rf5/rf5.html">TM_MIB(5)</a>, and <a href="../rf5/rf5.html">APPQ_MIB(5)</a> for an explanation of possible error codes returned in this fashion. </td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp1037495"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1037496"> </a>
Invalid arguments were specified. The <code class="cCodeEmphasis">flags</code> value is invalid or <code class="cCodeEmphasis">inbuf</code> or <code class="cCodeEmphasis">outbuf</code> are not pointers to typed buffers of type &#8220;FML32.&#8221;
</div>
<h4 class="pDefTerm"><a name="wp1037497"> </a>
[<code class="cCode">TPEMIB</code>] 
</h4><div class="pDefPara"><a name="wp1037498"> </a>
The administrative request failed. <code class="cCodeEmphasis">outbuf</code> is updated and returned to the caller with FML32 fields indicating the cause of the error as is discussed in <a href="../rf5/rf5.html">MIB(5)</a> and <a href="../rf5/rf5.html">TM_MIB(5)</a>.
</div>
<h4 class="pDefTerm"><a name="wp1037499"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1037500"> </a>
<code class="cCode">tpadmcall()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1037501"> </a>
[<code class="cCode">TPERELEASE</code>] 
</h4><div class="pDefPara"><a name="wp1037502"> </a>
<code class="cCode">tpadmcall()</code> was called with the <code class="cCode">TUXCONFIG</code> environment variable pointing to a different release version configuration file.
</div>
<h4 class="pDefTerm"><a name="wp1037503"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1037504"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in <code class="cCode">Uunixerr</code>.
</div>
<h4 class="pDefTerm"><a name="wp1037505"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1037506"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to <code class="cCode">userlog()</code>.
</div>
<h4 class="pHeading3"><a name="wp1037507"> </a>
Interoperability
</h4>
<p class="pBody"><a name="wp1037508"> </a>
This interface supports access and update to the local configuration file and bulletin board only; therefore, there are no interoperability concerns. 
</p>
<h4 class="pHeading3"><a name="wp1037509"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1037510"> </a>
This interface is available only on UNIX system sites running Oracle Tuxedo ATMI release 5.0 or later. 
</p>
<h4 class="pHeading3"><a name="wp1037511"> </a>
Files
</h4>
<p class="pBody"><a name="wp2217613"> </a>
The following library files are required:
</p>
<p class="pBody"><a name="wp1037512"> </a>
<code class="cCode">${TUXDIR}/lib/libtmib.a</code>, <code class="cCode">${TUXDIR}/lib/libqm.a</code>, <code class="cCode">${TUXDIR}/lib/libtmib.so.</code><code class="cCodeEmphasis">&lt;rel&gt;</code>, <code class="cCode">${TUXDIR}/lib/libqm.so.</code><code class="cCodeEmphasis">&lt;rel&gt;</code>, <code class="cCode">${TUXDIR}/lib/libtmib.lib</code>, <code class="cCode">${TUXDIR}/lib/libqm.lib</code>
</p>
<p class="pBody"><a name="wp1804608"> </a>
The libraries must be linked manually when using buildclient. The user must use: <code class="cCode">-L${TUXDIR}/lib -ltmid -lqm</code>
</p>
<h4 class="pHeading3"><a name="wp1037513"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1805517"> </a>
<a href="../rf5/rf5.html">ACL_MIB(5)</a>, <a href="../rf5/rf5.html">APPQ_MIB(5)</a>, <a href="../rf5/rf5.html">EVENT_MIB(5)</a>, <a href="../rf5/rf5.html">MIB(5)</a>, <a href="../rf5/rf5.html">TM_MIB(5)</a>, <a href="../rf5/rf5.html">WS_MIB(5)</a> <br /><em class="cEmphasis">Setting Up an Oracle Tuxedo Application<br />Administering an Oracle Tuxedo Application at Run Time</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021630"> </a>
tpadvertise(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021631"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021632"> </a>
<code class="cCode">tpadvertise()</code>&#8212;Routine for advertising a service name.
</p>
<h4 class="pHeading3"><a name="wp1021633"> </a>
Synopsis
</h4>
<a name="wp1021634"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpadvertise(char *svcname, void (*func)(TPSVCINFO *))</pre></div><h4 class="pHeading3"><a name="wp1021635"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021636"> </a>
<code class="cCode">tpadvertise()</code> allows a server to advertise the services that it offers. By default, a server&#8217;s services are advertised when it is booted and unadvertised when it is shutdown.
</p>
<p class="pBody"><a name="wp1021637"> </a>
All servers belonging to a Multiple Server, Single Queue (MSSQ) set must offer the same set of services. These routines enforce this rule by affecting the advertisements of all servers sharing an MSSQ set.
</p>
<p class="pBody"><a name="wp1021638"> </a>
<code class="cCode">tpadvertise()</code> advertises <code class="cCodeEmphasis">svcname</code> for the server (or the set of servers sharing the caller&#8217;s MSSQ set). <code class="cCodeEmphasis">svcname</code> should be 127 characters or less, but cannot be NULL or the NULL string (&#8220;&#8221;). (See *SERVICES section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>.)<code class="cCodeEmphasis">func</code> is the address of an Oracle Tuxedo ATMI system service function. This function will be invoked whenever a request for <code class="cCodeEmphasis">svcname</code> is received by the server. <code class="cCodeEmphasis">func</code> cannot be NULL. Explicitly specified function names (see <a href="../rf5/rf5.html">servopts(5)</a>) can be up to 128 characters long. Names longer than 127 characters are accepted and truncated to 127 characters. Users should make sure that truncated names do not match other service names.
</p>
<p class="pBody"><a name="wp1021639"> </a>
If <code class="cCodeEmphasis">svcname</code> is already advertised for the server and <code class="cCodeEmphasis">func</code> matches its current function, then <code class="cCode">tpadvertise()</code> returns success (this includes truncated names that match already advertised names). However, if <code class="cCodeEmphasis">svcname</code> is already advertised for the server but <code class="cCodeEmphasis">func</code> does not match its current function, then an error is returned (this can happen if truncated names match already advertised names).
</p>
<p class="pBody"><a name="wp1021640"> </a>
Service names starting with dot (.) are reserved for administrative services. An error will be returned if an application attempts to advertise one of these services.
</p>
<h4 class="pHeading3"><a name="wp1021641"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021642"> </a>
Upon failure, <code class="cCode">tpadvertise()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1021643"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1021644"> </a>
Upon failure, <code class="cCode">tpadvertise()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1021645"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026270"> </a>
<code class="cCodeEmphasis">svcname</code> is NULL or the NULL string (&#8220;&#8221;),or begins with a &#8220;.&#8221; or <code class="cCodeEmphasis">func</code> is NULL.
</div>
<h4 class="pDefTerm"><a name="wp1021646"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1026274"> </a>
<code class="cCodeEmphasis">svcname</code> cannot be advertised because of space limitations. (See <code class="cCode">MAXSERVICES</code> in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>.)
</div>
<h4 class="pDefTerm"><a name="wp1021647"> </a>
[<code class="cCode">TPEMATCH</code>]
</h4><div class="pDefPara"><a name="wp1026278"> </a>
<code class="cCodeEmphasis">svcname</code> is already advertised for the server but with a function other than <code class="cCodeEmphasis">func</code>. Although the function fails, <code class="cCodeEmphasis">svcname</code> remains advertised with its current function (that is, <code class="cCodeEmphasis">func</code> does not replace the current function).
</div>
<h4 class="pDefTerm"><a name="wp1021648"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1026282"> </a>
<code class="cCode">tpadvertise()</code> was called in an improper context (for example, by a client).
</div>
<h4 class="pDefTerm"><a name="wp1021649"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1026286"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1021650"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1026290"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1021651"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1021652"> </a>
<a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1045888"><code class="cCode">tpunadvertise(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021676"> </a>
tpalloc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021677"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021678"> </a>
<code class="cCode">tpalloc()</code>&#8212;Routine for allocating typed buffers.
</p>
<h4 class="pHeading3"><a name="wp1021679"> </a>
Synopsis
</h4>
<a name="wp1021680"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />char * tpalloc(char *type, char *subtype, long size)</pre></div><h4 class="pHeading3"><a name="wp1021681"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021682"> </a>
<code class="cCode">tpalloc()</code> returns a pointer to a buffer of type <code class="cCodeEmphasis">type</code>. Depending on the type of buffer, both <code class="cCodeEmphasis">subtype</code> and <code class="cCodeEmphasis">size</code> are optional. The Oracle Tuxedo ATMI system provides a variety of typed buffers, and applications are free to add their own buffer types. Consult <a href="../rf5/rf5.html">tuxtypes(5)</a> for more details.
</p>
<p class="pBody"><a name="wp1021683"> </a>
If <code class="cCodeEmphasis">subtype</code> is non-NULL in <code class="cCode">tmtype_sw</code> for a particular buffer type, then <code class="cCodeEmphasis">subtype</code> must be specified when <code class="cCode">tpalloc()</code> is called. The allocated buffer will be at least as large as the larger of <code class="cCodeEmphasis">size</code> and <code class="cCode">dfltsize</code>, where <code class="cCode">dfltsize</code> is the default buffer size specified in <code class="cCode">tmtype_sw</code> for the particular buffer type. For buffer type <code class="cCode">STRING</code> the minimum is 512 bytes; for buffer types <code class="cCode">FML</code> and <code class="cCode">VIEW</code> the minimum is 1024 bytes.
</p>
<p class="pBody"><a name="wp1021684"> </a>
Note that only the first eight bytes of <code class="cCodeEmphasis">type</code> and the first 16 bytes of <code class="cCodeEmphasis">subtype</code> are significant.
</p>
<p class="pBody"><a name="wp1021685"> </a>
Because some buffer types require initialization before they can be used, <code class="cCode">tpalloc()</code> initializes a buffer (in an Oracle Tuxedo ATMI system-specific manner) after it is allocated and before it is returned. Thus, the buffer returned to the caller is ready for use. Note that unless the initialization routine cleared the buffer, the buffer is not initialized to zeros by <code class="cCode">tpalloc()</code>.
</p>
<p class="pBody"><a name="wp1617657"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpalloc()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1021686"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021687"> </a>
Upon successful completion, <code class="cCode">tpalloc()</code> returns a pointer to a buffer of the appropriate type aligned on a long word; otherwise, it returns NULL and sets <code class="cCode">tperrno</code> to indicate the condition.
</p>
<h4 class="pHeading3"><a name="wp1021688"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1021689"> </a>
Upon failure, <code class="cCode">tpalloc()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1021690"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1128607"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">type</code> is NULL).
</div>
<h4 class="pDefTerm"><a name="wp1021691"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1128610"> </a>
No entry in <code class="cCode">tmtype_sw</code> matches <code class="cCodeEmphasis">type</code> and, if non-NULL, <code class="cCodeEmphasis">subtype</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021692"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1128613"> </a>
<code class="cCode">tpalloc()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1021693"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1128616"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1021694"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1128619"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1021695"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1021696"> </a>
If buffer initialization fails, the allocated buffer is freed and <code class="cCode">tpalloc()</code> fails returning NULL.
</p>
<p class="pBody"><a name="wp1021697"> </a>
This function should not be used in concert with <code class="cCode">malloc()</code>, <code class="cCode">realloc()</code>, or <code class="cCode">free()</code> in the C library (for example, a buffer allocated with <code class="cCode">tpalloc()</code> should not be freed with <code class="cCode">free()</code>).
</p>
<p class="pBody"><a name="wp1021698"> </a>
Two buffer types are supported by any compliant implementation of the Oracle Tuxedo ATMI system extension. Details are in the <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>.
</p>
<h4 class="pHeading3"><a name="wp1021699"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2305388"> </a>
<a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>, <a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2320049"> </a>
tpappthrinit(3c)
</h3>
<h4 class="pHeading3"><a name="wp2320050"> </a>
Name
</h4>
<p class="pBody"><a name="wp2320051"> </a>
<code class="cCode">tpappthrinit()</code> - Routine for creating and initializing a new Tuxedo context in an application-created server thread
</p>
<h4 class="pHeading3"><a name="wp2320052"> </a>
Synopsis
</h4>
<a name="wp2320053"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;atmi.h&gt; <br />int tpappthrinit(TPINIT *tpthrinfo);</code></pre></div><h4 class="pHeading3"><a name="wp2320054"> </a>
Description
</h4>
<p class="pBody"><a name="wp2361112"> </a>
<code class="cCode">tpappthrinit()</code> creates a new Tuxedo context in an application-created server thread. The context created by tpappthrinit() connects to the domain that the application server is in. It also sets the context of current application thread to the newly created context.
</p>
<p class="pBody"><a name="wp2361113"> </a>
Before an application-created thread in a Tuxedo server process can use Tuxedo ATMI system communication or transaction routines, it first must call <code class="cCode">tpappthrinit()</code>, or associate itself with a valid context using <code class="cCode">tpsetctxt()</code>.
</p>
<p class="pBody"><a name="wp2354771"> </a>
After<code class="cCode"> tpappthrinit()</code> successfully returns, the application-created server thread can initiate service requests and define transactions.
</p>
<a name="wp2361222"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The application thread cannot call <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. The application thread may send, but cannot receive unsolicited messages.</td>
</tr>
</table>

<p class="pBody"><a name="wp2361233"> </a>
After <code class="cCode">tpappthrinit()</code> successfully returns, the application-created server thread can get the current context by calling <code class="cCode">tpgetctxt()</code> and pass it as a <code class="cCode">tpsetctxt()</code> parameter called by another application-created server thread to associate itself to the context. 
</p>
<a name="wp2361252"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>It is not allowed to set the context created by<code class="cCode"> tpappthrinit()</code> in service routine.</td>
</tr>
</table>

<p class="pBody"><a name="wp2354775"> </a>
The <code class="cCode">tpappthrinit()</code> argument, <code class="cCode">tpthrinfo</code>, is a pointer to a TPINIT buffer type and a NULL subtype. TPINIT is a buffer type is defined in the <code class="cCode">atmi.h</code> header file. The buffer must be allocated via <code class="cCode">tpalloc()</code> prior to calling <code class="cCode">tpappthrinit()</code>. It should be released using <code class="cCode">tpfree()</code> after calling <code class="cCode">tpappthrinit()</code>.
</p>
<p class="pBody"><a name="wp2354777"> </a>
Please refer to the <code class="cCode">tpinit()</code> routine for description of TPINIT structure. The <code class="cCode">tpthrinfo</code> members <code class="cCode">usrname</code>, <code class="cCode">data</code>, and <code class="cCode">datalen</code> are used to pass authentication information to <code class="cCode">tpappthrinit()</code>. The <code class="cCode">tpthrinfo</code> members <code class="cCode">cltname</code>, <code class="cCode">grpname</code> and <code class="cCode">passwd</code> are currently not used and must be set to a 0-length string. The TPINIT member flags is also not used by <code class="cCode">tpappthrinit()</code>. 
</p>
<p class="pBody"><a name="wp2354779"> </a>
<code class="cCode">tpappthrinit()</code> can only be called in an application created server-thread. The server must be built using the buildserver <code class="cCode">-t</code> option.  
</p>
<a name="wp2361350"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">tpappthrinit()</code> is not allowed in service routines.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp2346052"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2360345"> </a>
Upon successfully creating and initializing a Tuxedo context, <code class="cCode">tpappthrinit()</code> returns 0.
</p>
<p class="pBody"><a name="wp2360346"> </a>
Upon failure, it leaves the calling thread in TPNULLCONTEXT, returns -1, and sets tperrno to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2351074"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2351075"> </a>
Upon failure, <code class="cCode">tpappthrinit()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2351076"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2350203"> </a>
Invalid arguments were specified. For example: <code class="cCode">tpthrinfo</code> is non-NULL but does not point to a TPINIT typed buffer.
</div>
<h4 class="pDefTerm"><a name="wp2350198"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2320069"> </a>
<code class="cCode">tpappthrinit(</code>) has been called improperly. For example: it is called in client program, or service routine, or the server is not built with the <code class="cCode">buildserver -t</code> option.
</div>
<h4 class="pDefTerm"><a name="wp2320070"> </a>
<code class="cCode">[TPENOENT]</code>
</h4><div class="pDefPara"><a name="wp2320071"> </a>
The context cannot be created due to space limitations.
</div>
<h4 class="pDefTerm"><a name="wp2360537"> </a>
<code class="cCode">[TPEPERM]</code>
</h4><div class="pDefPara"><a name="wp2360538"> </a>
The context cannot be created because of authentication failure.
</div>
<h4 class="pDefTerm"><a name="wp2320072"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2320073"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2320074"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2320075"> </a>
An operating system error has occurred. 
</div>
<h4 class="pHeading3"><a name="wp2320076"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2305420"> </a>
<a href="rf3c.html#wp2325705"><code class="cHyperlinkCode">
tpappthrterm(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cHyperlinkCode">
tpinit(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cHyperlinkCode">
tpterm(3c)</code></a>,<a href="rf3c.html#wp2272018"><code class="cHyperlinkCode">
tpgetctxt(3c)</code></a>, <a href="rf3c.html#wp1223538"><code class="cHyperlinkCode">
tpsetctxt(3c)</code></a>
</p>
<p class="pBody"><a name="wp2332149"> </a>
<span class="cHyperlink">
<a href="../pgc/pgthr.html">Programming a Multithreaded and Multicontexted ATMI application</a></span>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2325705"> </a>
tpappthrterm(3c)
</h3>
<h4 class="pHeading3"><a name="wp2325706"> </a>
Name
</h4>
<p class="pBody"><a name="wp2325707"> </a>
<code class="cCode">tpappthrterm()</code> - Routine for terminating Tuxedo context created by <code class="cCode">tpappthrinit()</code> in an application-created server thread.
</p>
<h4 class="pHeading3"><a name="wp2325708"> </a>
Synopsis
</h4>
<a name="wp2325709"> </a><div class="pPreformatted"><pre><code class="cCode">#include&lt;atmi.h&gt;<br />int tpappthrterm(void);</code></pre></div><h4 class="pHeading3"><a name="wp2325710"> </a>
Description
</h4>
<p class="pBody"><a name="wp2360859"> </a>
<code class="cCode">tpappthrterm()</code> removes the current Tuxedo context, and sets the context of a current application-created server thread to <code class="cCode">TPNULLCONTEXT</code>. If the application thread is in transaction mode, then the transaction is rolled back. When <code class="cCode">tpappthrterm()</code> returns successfully, the caller can no longer perform most Tuxedo ATMI operations. Any outstanding conversations are immediately disconnected.
</p>
<p class="pBody"><a name="wp2364259"> </a>
<code class="cCode">tpappthrterm()</code> can only be used to terminated a context which is created by <code class="cCode">tpappthrinit()</code>, and it can only be invoked in an application-created server thread, the server must be built using the <code class="cCode">buildserver</code> -t option .<code class="cCode"> </code>
</p>
<a name="wp2364260"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td><code class="cCode">tpappthrterm()</code> is not allowed in service routine, or in application-created server thread which is currently associated with a server-dispatched context.</td></tr>
</table>

<p class="pBodyRelative"><a name="wp2360865"> </a>
It is important to avoid calling <code class="cCode">tpappthrterm()</code> on a context while other application created server-threads are still working on that context. 
</p>
<h4 class="pHeading3"><a name="wp2351411"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2325715"> </a>
Upon successfully terminating a Tuxedo context, <code class="cCode">tpappthrterm()</code>returns <code class="cCode">0</code> and sets current context to <code class="cCode">TPNULLCONTEXT</code>.
</p>
<p class="pBody"><a name="wp2325716"> </a>
Upon failure, <code class="cCode">tpappthrterm()</code> returns <code class="cCode">-1</code> and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2325717"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2325718"> </a>
Upon failure, <code class="cCode">tpappthrterm()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2325719"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2325720"> </a>
<code class="cCode">tpappthrterm() </code>has been called improperly. For example, it is called in client program, or service routine, or it is called in an application-created server thread which is currently associated with a server-dispatched context.
</div>
<h4 class="pDefTerm"><a name="wp2325721"> </a>
<code class="cCode"> [TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2325722"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2325723"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2325724"> </a>
An operating system error has occurred. 
</div>
<h4 class="pHeading3"><a name="wp2331336"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2331337"> </a>
<a href="rf3c.html#wp2320049"><code class="cHyperlinkCode">
tpappthrinit(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cHyperlinkCode">
tpinit(3c)</code></a>, <a href="rf3c.html#wp2272018"><code class="cHyperlinkCode">
tpgetctxt(3c)</code></a>, <a href="rf3c.html#wp1223538"><code class="cHyperlinkCode">
tpsetctxt(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cHyperlinkCode">
tpterm(3c)</code></a>
</p>
<p class="pBody"><a name="wp2362874"> </a>
<span class="cHyperlink">
<a href="../pgc/pgthr.html">Programming a Multithreaded and Multicontexted ATMI application</a></span>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2305391"> </a>
tpbegin(3c)
</h3>
<h4 class="pHeading3"><a name="wp1039169"> </a>
Name
</h4>
<p class="pBody"><a name="wp1039170"> </a>
<code class="cCode">tpbegin()</code>&#8212;Routine for beginning a transaction.
</p>
<h4 class="pHeading3"><a name="wp1039171"> </a>
Synopsis
</h4>
<a name="wp1039172"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;atmi.h&gt; <br />int tpbegin(unsigned long timeout, long flags)</code> </pre></div><h4 class="pHeading3"><a name="wp1039173"> </a>
Description
</h4>
<p class="pBody"><a name="wp1039174"> </a>
A transaction in the Oracle Tuxedo ATMI system is used to define a single logical unit of work that either wholly succeeds or has no effect whatsoever. A transaction allows work being performed in many processes, at possibly different sites, to be treated as an atomic unit of work. The initiator of a transaction uses <code class="cCode">tpbegin()</code> and either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> to delineate the operations within a transaction. Once <code class="cCode">tpbegin()</code> is called, communication with any other program can place the latter (of necessity, a server) in &#8220;transaction mode&#8221; (that is, the server&#8217;s work becomes part of the transaction). Programs that join a transaction are called participants. A transaction always has one initiator and can have several participants. Only the initiator of a transaction can call <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. Participants can influence the outcome of a transaction by the return values (<code class="cCodeEmphasis">rval</code>s) they use when they call <code class="cCode">tpreturn()</code>. Once in transaction mode, any service requests made to servers are processed on behalf of the transaction (unless the requester explicitly specifies otherwise).
</p>
<p class="pBody"><a name="wp1039175"> </a>
Note that if a program starts a transaction while it has any open connections that it initiated to conversational servers, these connections will not be upgraded to transaction mode. It is as if the <code class="cCode">TPNOTRAN</code> flag had been specified on the <code class="cCode">tpconnect()</code> call.
</p>
<p class="pBody"><a name="wp1039176"> </a>
<code class="cCode">tpbegin()</code>&#8217;s first argument, <code class="cCodeEmphasis">timeout</code>, specifies that the transaction should be allowed at least <code class="cCodeEmphasis">timeout</code> seconds before timing out. Once a transaction times out it must be marked abort-only. If <code class="cCodeEmphasis">timeout</code> is 0, then the transaction is given the maximum number of seconds allowed by the system before timing out (that is, the timeout value equals the maximum value for an unsigned long as defined by the system).
</p>
<p class="pBody"><a name="wp1039177"> </a>
Currently, <code class="cCode">tpbegin()</code>&#8217;s second argument, <code class="cCodeEmphasis">flags</code>, is reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1630179"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpbegin()</code>.
</p>
<h4 class="pHeading3"><a name="wp1039178"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1039179"> </a>
Upon failure, <code class="cCode">tpbegin()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1039180"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1039181"> </a>
Upon failure, <code class="cCode">tpbegin()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1039182"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1039183"> </a>
<code class="cCodeEmphasis">flags</code> is not equal to 0.
</div>
<h4 class="pDefTerm"><a name="wp1039184"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1039185"> </a>
The caller cannot be placed in transaction mode because an error occurred starting the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1039186"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1039187"> </a>
<code class="cCode">tpbegin()</code> was called in an improper context (for example, the caller is already in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp1039188"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1039189"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1039190"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1039191"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1039192"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1039193"> </a>
When using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code>, and <code class="cCode">tpabort()</code> to delineate an Oracle Tuxedo ATMI system transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. See <code class="cCode">buildserver()</code> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI system transaction.
</p>
<h4 class="pHeading3"><a name="wp1039194"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1039195"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a>, <a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1039463"> </a>
tpbroadcast(3c)
</h3>
<h4 class="pHeading3"><a name="wp1039464"> </a>
Name
</h4>
<p class="pBody"><a name="wp1039465"> </a>
<code class="cCode">tpbroadcast()</code>&#8212;Routine to broadcast notification by name.
</p>
<h4 class="pHeading3"><a name="wp1039466"> </a>
Synopsis
</h4>
<a name="wp1039467"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br /> <br />int tpbroadcast(char *lmid, char *usrname, char *cltname,<br />  char *data,  long len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1039468"> </a>
Description
</h4>
<p class="pBody"><a name="wp1039469"> </a>
<code class="cCode">tpbroadcast()</code> allows a client or server to send unsolicited messages to registered clients within the system. The target client set consists of those clients matching identifiers passed to <code class="cCode">tpbroadcast()</code>. Wildcards can be used in specifying identifiers.
</p>
<p class="pBody"><a name="wp1039470"> </a>
<code class="cCodeEmphasis">lmid</code>, <code class="cCodeEmphasis">usrname</code>, and <code class="cCodeEmphasis">cltname</code> are logical identifiers used to select the target client set. A NULL value for any argument constitutes a wildcard for that argument. A wildcard argument matches all client identifiers for that field. A 0-length string for any argument matches only 0-length client identifiers. Each identifier must meet the size restrictions defined for the system to be considered valid, that is, each identifier must be between 0 and <code class="cCode">MAXTIDENT</code> characters in length.
</p>
<p class="pBody"><a name="wp1039471"> </a>
The data portion of the request is pointed to by <code class="cCodeEmphasis">data</code>, a buffer previously allocated by <code class="cCode">tpalloc()</code>. <code class="cCodeEmphasis">len</code> specifies how much of <code class="cCodeEmphasis">data</code> to send. Note that if <code class="cCodeEmphasis">data</code> points to a buffer type that does not require a length to be specified (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and may be 0). Also, <code class="cCodeEmphasis">data</code> may be NULL, in which case <code class="cCodeEmphasis">len</code> is ignored. The buffer passes through the typed buffer switch routines just as any other outgoing or incoming message would; for example, encode/decode are performed automatically.
</p>
<p class="pBody"><a name="wp1039472"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1039473"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1039474"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full).
</div>
<h4 class="pDefTerm"><a name="wp1039475"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1039476"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1039477"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1039478"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Upon successful return from <code class="cCode">tpbroadcast()</code>, the message has been delivered to the system for forwarding to the selected clients. <code class="cCode">tpbroadcast()</code> does not wait for the message to be delivered to each selected client.
</div>
<div class="pDefParaCont"><a name="wp1630224"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpbroadcast()</code>.
</div>
<h4 class="pHeading3"><a name="wp1630225"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1039480"> </a>
Upon failure, <code class="cCode">tpbroadcast()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1039481"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1039482"> </a>
Upon failure, <code class="cCode">tpbroadcast()</code>sends no broadcast messages to application clients and sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1039483"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1039484"> </a>
Invalid arguments were given (for example, identifiers too long or invalid flags). Note that use of an illegal <code class="cCode">LMID</code> will cause <code class="cCode">tpbroadcast() </code>to fail and return <code class="cCode">TPEINVAL</code>. However, non-existent user or client names will simply successfully broadcast to no one.
</div>
<h4 class="pDefTerm"><a name="wp1039485"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1039486"> </a>
A blocking timeout occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
</div>
<h4 class="pDefTerm"><a name="wp1039487"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1039488"> </a>
A blocking condition was found on the call and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1039489"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1039490"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1039491"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1039492"> </a>
<code class="cCode">tpbroadcast()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1039493"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1039494"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1039495"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1039496"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1039497"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1039501"> </a>
The interfaces described in <a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a> are supported on native site UNIX-based processors. In addition, the routines <code class="cCode">tpbroadcast()</code> and <code class="cCode">tpchkunsol()</code> as well as the function <code class="cCode">tpsetunsol()</code> are supported on UNIX and MS-DOS workstation processors.
</p>
<h4 class="pHeading3"><a name="wp1039502"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1039503"> </a>
Clients that select signal-based notification may not be signal-able by the system due to signal restrictions. When this occurs, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. (See the description of the <code class="cCode">RESOURCES</code> <code class="cCode">NOTIFY</code> parameter in <code class="cCode">UBBCONFIG()</code> for a detailed discussion of notification methods.)
</p>
<p class="pBody"><a name="wp1377198"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1377199"> </a>A native client must be running as an application administrator</li>
<li><a name="wp1377200"> </a>A Workstation client is not required to be running as the application administrator</li>
</ul></div>
<p class="pBody"><a name="wp1377201"> </a>
The ID for the application administrator is identified as part of the configuration for the application.
</p>
<p class="pBody"><a name="wp1039505"> </a>
If signal-based notification is selected for a client, then certain ATMI calls can fail, returning <code class="cCode">TPGOTSIG</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> and <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> for more information on notification method selection.
</p>
<h4 class="pHeading3"><a name="wp1039506"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1039507"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021731"> </a>
tpcall(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021732"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021733"> </a>
<code class="cCode">tpcall()</code>&#8212;Routine for sending service request and awaiting its reply.
</p>
<h4 class="pHeading3"><a name="wp1021734"> </a>
Synopsis
</h4>
<a name="wp1021735"> </a><div class="pPreformatted"><pre>int tpcall(char *svc, char *idata, long ilen, char **odata, long \ <br />   *olen, long flags)</pre></div><h4 class="pHeading3"><a name="wp1021736"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021737"> </a>
<code class="cCode">tpcall()</code> sends a request and synchronously awaits its reply. A call to this function is the same as calling <code class="cCode">tpacall()</code> immediately followed by <code class="cCode">tpgetrply()</code>. <code class="cCode">tpcall()</code> sends a request to the service named by <code class="cCodeEmphasis">svc</code>. The request is sent out at the priority defined for <code class="cCodeEmphasis">svc</code> unless overridden by a previous call to <code class="cCode">tpspri()</code>. The data portion of a request is pointed to by <code class="cCodeEmphasis">idata</code>, a buffer previously allocated by <code class="cCode">tpalloc()</code>. <code class="cCodeEmphasis">ilen</code> specifies how much of <code class="cCodeEmphasis">idata</code> to send. Note that if <code class="cCodeEmphasis">idata</code> points to a buffer of a type that does not require a length to be specified, (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">ilen</code> is ignored (and may be 0). Also, <code class="cCodeEmphasis">idata</code> may be NULL, in which case <code class="cCodeEmphasis">ilen</code> is ignored. The type and subtype of <code class="cCodeEmphasis">idata</code> must match one of the types and subtypes recognized by <code class="cCodeEmphasis">svc</code>.
</p>
<p class="pBody"><a name="wp1817656"> </a>
<code class="cCodeEmphasis">odata</code> is the address of a pointer to the buffer where a reply is read into, and <code class="cCodeEmphasis">olen</code> points to the length of that reply. *<code class="cCodeEmphasis">odata</code> must point to a buffer originally allocated by <code class="cCode">tpalloc()</code>. If the same buffer is to be used for both sending and receiving, <code class="cCodeEmphasis">odata</code> should be set to the address of <code class="cCodeEmphasis">idata</code>. <code class="cCode">FML</code> and <code class="cCode">FML32</code> buffers often assume a minimum size of 4096 bytes; if the reply is larger than 4096, the size of the buffer is increased to a size large enough to accommodate the data being returned. Also, if <code class="cCodeEmphasis">idata</code> and *<code class="cCodeEmphasis">odata</code> were equal when <code class="cCode">tpcall()</code> was invoked, and *<code class="cCodeEmphasis">odata</code> is changed, then <code class="cCodeEmphasis">idata</code> no longer points to a valid address. Using the old address can lead to data corruption or process exceptions. As of release 6.4, the default allocation for buffers is 1024 bytes. Also, historical information is maintained on recently used buffers, allowing a buffer of optimal size to be reused as a return buffer.
</p>
<p class="pBody"><a name="wp1021739"> </a>
Buffers on the sending side that may be only partially filled (for example, FML or STRING buffers) will have only the amount that is used send. The system may then enlarge the received data size by some arbitrary amount. This means that the receiver may receive a buffer that is smaller than what was originally allocated by the sender, yet larger than the data that was sent.
</p>
<p class="pBody"><a name="wp1021740"> </a>
The receive buffer may grow, or it may shrink, and its address almost invariably changes, as the system swaps buffers around internally. To determine whether (and how much) a reply buffer changed in size, compare its total size before <code class="cCode">tpgetrply()</code> was issued with *<code class="cCodeEmphasis">len</code>. See <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a> for more information about buffer management.
</p>
<p class="pBody"><a name="wp1021741"> </a>
If *<code class="cCodeEmphasis">olen</code> is 0 upon return, then the reply has no data portion and neither *<code class="cCodeEmphasis">odata</code> nor the buffer it points to were modified. It is an error for *<code class="cCodeEmphasis">odata</code> or <code class="cCodeEmphasis">olen</code> to be NULL.
</p>
<p class="pBody"><a name="wp1021742"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp1021743"> </a>
<code class="cCode">TPNOTRAN</code>
</h4><div class="pDefPara"><a name="wp1026335"> </a>
If the caller is in transaction mode and this flag is set, then when <code class="cCodeEmphasis">svc</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. Note that <code class="cCodeEmphasis">svc</code> may still be invoked in transaction mode but it will not be the same transaction: a <code class="cCodeEmphasis">svc</code> may have as a configuration attribute that it is automatically invoked in transaction mode. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other). If a service fails that was invoked with this flag, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1021744"> </a>
<code class="cCode">TPNOCHANGE</code>
</h4><div class="pDefPara"><a name="wp1026339"> </a>
By default, if a buffer is received that differs in type from the buffer pointed to by *<code class="cCodeEmphasis">odata</code>, then *<code class="cCodeEmphasis">odata</code>&#8217;s buffer type changes to the received buffer&#8217;s type so long as the receiver recognizes the incoming buffer type. When this flag is set, the type of the buffer pointed to by *<code class="cCodeEmphasis">odata</code> is not allowed to change. That is, the type and subtype of the received buffer must match the type and subtype of the buffer pointed to by *<code class="cCodeEmphasis">odata</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021745"> </a>
<code class="cCode">TPNOBLOCK</code>
</h4><div class="pDefPara"><a name="wp1026343"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). Note that this flag applies only to the send portion of <code class="cCode">tpcall()</code>: the function may block waiting for the reply. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1021746"> </a>
<code class="cCode">TPNOTIME</code>
</h4><div class="pDefPara"><a name="wp1026347"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. However, if the caller is in transaction mode, this flag has no effect; it is subject to the transaction timeout limit. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1021747"> </a>
<code class="cCode">TPSIGRSTRT</code>
</h4><div class="pDefPara"><a name="wp1026351"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued.
</div>
<p class="pBody"><a name="wp1630239"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpcall()</code>.
</p>
<h4 class="pHeading3"><a name="wp1021748"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021749"> </a>
Upon successful return from <code class="cCode">tpcall()</code> or upon return where <code class="cCode">tperrno</code> is set to <code class="cCode">TPESVCFAIL</code>, <code class="cCode">tpurcode()</code> contains an application defined value that was sent as part of <code class="cCode">tpreturn()</code>. 
</p>
<p class="pBody"><a name="wp1233962"> </a>
Upon failure, <code class="cCode">tpcall()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. If a call fails with a particular <code class="cCode">tperrno</code> value, a subsequent call to <code class="cCode">tperrordetail()</code>, with no intermediate ATMI calls, may provide more detailed information about the generated error. Refer to the <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a> reference page for more information.
</p>
<h4 class="pHeading3"><a name="wp1021750"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1021751"> </a>
Upon failure, <code class="cCode">tpcall()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1021752"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026367"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">svc</code> is NULL or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1021753"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1026371"> </a>
Cannot send to <code class="cCodeEmphasis">svc</code> because it does not exist, or it is a conversational service, or the name provided begins with a dot (.).
</div>
<h4 class="pDefTerm"><a name="wp1021754"> </a>
[<code class="cCode">TPEITYPE</code>]
</h4><div class="pDefPara"><a name="wp1026375"> </a>
The type and subtype of <code class="cCodeEmphasis">idata</code> is not one of the allowed types and subtypes that <code class="cCodeEmphasis">svc</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp1021755"> </a>
[<code class="cCode">TPEOTYPE</code>]
</h4><div class="pDefPara"><a name="wp1026379"> </a>
Either the type and subtype of the reply are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set in <code class="cCodeEmphasis">flags</code> and the type and subtype of *<code class="cCodeEmphasis">odata</code> do not match the type and subtype of the reply sent by the service. Neither *<code class="cCodeEmphasis">odata</code>, its contents, nor *<code class="cCodeEmphasis">olen</code> is changed. If the service request was made on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only since the reply is discarded.
</div>
<h4 class="pDefTerm"><a name="wp1021756"> </a>
[<code class="cCode">TPETRAN</code>]
</h4><div class="pDefPara"><a name="wp1026383"> </a>
<code class="cCodeEmphasis">svc</code> belongs to a server that does not support transactions and <code class="cCode">TPNOTRAN</code> was not set.
</div>
<h4 class="pDefTerm"><a name="wp1021757"> </a>
[<code class="cCode">TPETIME</code>]
</h4><div class="pDefPara"><a name="wp1854304"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpcall()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854305"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.) In either case, no changes are made to <code class="cCode">*odata</code>, its contents, or <code class="cCode">*olen</code>.
<a name="wp1854306"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854307"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021758"> </a>
[<code class="cCode">TPESVCFAIL</code>]
</h4><div class="pDefPara"><a name="wp1026391"> </a>
The service routine sending the caller&#8217;s reply called <code class="cCode">tpreturn()</code> with <code class="cCode">TPFAIL</code>. This is an application-level failure. The contents of the service&#8217;s reply, if one was sent, is available in the buffer pointed to by *<code class="cCodeEmphasis">odata</code>. If the service request was made on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">tpacall()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp1021759"> </a>
[<code class="cCode">TPESVCERR</code>]
</h4><div class="pDefPara"><a name="wp1026395"> </a>
A service routine encountered an error either in <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a> or <a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a> (for example, bad arguments were passed). No reply data is returned when this error occurs (that is, neither *<code class="cCodeEmphasis">odata</code>, its contents, nor *<code class="cCodeEmphasis">olen</code> is changed). If the service request was made on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPNOTRAN</code> was not set), then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">tpacall()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set. If either <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in the <code class="cCode">TM_MIB</code> is non-zero, <code class="cCode">TPESVCERR</code> is returned when a service timeout occurs.
</div>
<h4 class="pDefTerm"><a name="wp1026400"> </a>
[<code class="cCode">TPEBLOCK</code>]
</h4><div class="pDefPara"><a name="wp1026401"> </a>
A blocking condition was found on the send call and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1021761"> </a>
[<code class="cCode">TPGOTSIG</code>]
</h4><div class="pDefPara"><a name="wp1026405"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1021762"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1026409"> </a>
<code class="cCode">tpcall()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1026414"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1026415"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1021764"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1026419"> </a>
An operating system error has occurred. If a message queue on a remote location is filled, <code class="cCode">TPEOS</code> may be returned even if <code class="cCode">tpcall()</code> returned successfully.
</div>
<h4 class="pHeading3"><a name="wp1021765"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1021766"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>,<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>, <a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>, <a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>, <a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>, <a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1039772"> </a>
tpcancel(3c)
</h3>
<h4 class="pHeading3"><a name="wp1039773"> </a>
Name
</h4>
<p class="pBody"><a name="wp1039774"> </a>
<code class="cCode">tpcancel()</code>&#8212;Routine for canceling a call descriptor for outstanding reply.
</p>
<h4 class="pHeading3"><a name="wp1039775"> </a>
Synopsis
</h4>
<a name="wp1039776"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpcancel(int cd)</pre></div><h4 class="pHeading3"><a name="wp1039777"> </a>
Description
</h4>
<p class="pBody"><a name="wp1039778"> </a>
<code class="cCode">tpcancel()</code> cancels a call descriptor, <code class="cCodeEmphasis">cd</code>, returned by <code class="cCode">tpacall()</code>. It is an error to attempt to cancel a call descriptor associated with a transaction.
</p>
<p class="pBody"><a name="wp1039779"> </a>
Upon success, <code class="cCodeEmphasis">cd</code> is no longer valid and any reply received on behalf of <code class="cCodeEmphasis">cd</code> will be silently discarded.
</p>
<p class="pBody"><a name="wp1630260"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpcancel()</code>.
</p>
<h4 class="pHeading3"><a name="wp1039780"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1039781"> </a>
Upon failure, <code class="cCode">tpcancel()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1039782"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1039783"> </a>
Upon failure, <code class="cCode">tpcancel()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1039784"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp1039785"> </a>
<code class="cCodeEmphasis">cd</code> is an invalid descriptor.
</div>
<h4 class="pDefTerm"><a name="wp1039786"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1039787"> </a>
<code class="cCodeEmphasis">cd</code>() is associated with the caller&#8217;s transaction. <code class="cCodeEmphasis">cd</code> remains valid and the caller&#8217;s current transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1039788"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1039789"> </a>
<code class="cCode">tpcancel()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1039790"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1039791"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1039792"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1039793"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1039794"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1039795"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1040017"> </a>
tpchkauth(3c)
</h3>
<h4 class="pHeading3"><a name="wp1040018"> </a>
Name
</h4>
<p class="pBody"><a name="wp1040019"> </a>
<code class="cCode">tpchkauth()</code>&#8212;Routine for checking if authentication required to join an application.
</p>
<h4 class="pHeading3"><a name="wp1040020"> </a>
Synopsis
</h4>
<a name="wp1040021"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br /> <br />int tpchkauth(void) </pre></div><h4 class="pHeading3"><a name="wp1040022"> </a>
Description
</h4>
<p class="pBody"><a name="wp1040023"> </a>
<code class="cCode">tpchkauth()</code> checks if authentication is required by the application configuration. This is typically used by application clients prior to calling <code class="cCode">tpinit()</code> to determine if a password should be obtained from the user.
</p>
<p class="pBody"><a name="wp1630268"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpchkauth()</code>.
</p>
<h4 class="pHeading3"><a name="wp1040024"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1040025"> </a>
Upon success, <code class="cCode">tpchkauth()</code> returns one of the following non-negative values:
</p>
<h4 class="pDefTerm"><a name="wp1040026"> </a>
<code class="cCode">TPNOAUTH</code> 
</h4><div class="pDefPara"><a name="wp1040027"> </a>
Indicates that no authentication is required.
</div>
<h4 class="pDefTerm"><a name="wp1040028"> </a>
<code class="cCode">TPSYSAUTH</code> 
</h4><div class="pDefPara"><a name="wp1040029"> </a>
Indicates that system authentication only is required.
</div>
<h4 class="pDefTerm"><a name="wp1040030"> </a>
<code class="cCode">TPAPPAUTH</code> 
</h4><div class="pDefPara"><a name="wp1040031"> </a>
Indicates that both system and application specific authentication are required.
</div>
<p class="pBody"><a name="wp1040032"> </a>
Upon failure, <code class="cCode">tpchkauth()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1040033"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1040034"> </a>
Upon failure, <code class="cCode">tpchkauth()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1040035"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1040036"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1040037"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1040038"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1040039"> </a>
Interoperability
</h4>
<p class="pBody"><a name="wp1040040"> </a>
<code class="cCode">tpchkauth()</code> is available only on sites running release 4.2 or later.
</p>
<h4 class="pHeading3"><a name="wp1040041"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1040042"> </a>
The interfaces described in <a href="rf3c.html#wp1040017"><code class="cCode">tpchkauth(3c)</code></a> are supported on UNIX, Windows, and MS-DOS operating systems.
</p>
<h4 class="pHeading3"><a name="wp1040057"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1040058"> </a>
<a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1040306"> </a>
tpchkunsol(3c)
</h3>
<h4 class="pHeading3"><a name="wp1040307"> </a>
Name
</h4>
<p class="pBody"><a name="wp1040308"> </a>
<code class="cCode">tpchkunsol()</code>&#8212;Routine for checking for unsolicited message.
</p>
<h4 class="pHeading3"><a name="wp1040309"> </a>
Synopsis
</h4>
<a name="wp1040310"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpchkunsol(void) </pre></div><h4 class="pHeading3"><a name="wp1040311"> </a>
Description
</h4>
<p class="pBody"><a name="wp1040312"> </a>
<code class="cCode">tpchkunsol()</code> is used by a client to trigger checking for unsolicited messages. Calls to this routine in a client using signal-based notification do nothing and return immediately. This call has no arguments. Calls to this routine can result in calls to an application-defined unsolicited message handling routine by the Oracle Tuxedo ATMI system libraries.
</p>
<p class="pBody"><a name="wp1631039"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpchkunsol()</code>.
</p>
<h4 class="pHeading3"><a name="wp1040313"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1040314"> </a>
Upon successful completion, <code class="cCode">tpchkunsol()</code> returns the number of unsolicited messages dispatched; otherwise it returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1040315"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1040316"> </a>
Upon failure, <code class="cCode">tpchkunsol()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1040317"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1040318"> </a>
<code class="cCode">tpchkunsol()</code> was called in an improper context (for example, from within a server).
</div>
<h4 class="pDefTerm"><a name="wp1040319"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1040320"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1040321"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1040322"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1040323"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1040324"> </a>
The interfaces described in <a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a> are supported on native site UNIX-based processors. In addition, the routines <code class="cCode">tpbroadcast()</code> and <code class="cCode">tpchkunsol()</code> as well as the function <code class="cCode">tpsetunsol()</code> are supported on UNIX and MS-DOS workstation processors.
</p>
<p class="pBody"><a name="wp1040325"> </a>
Clients that select signal-based notification may not be signal-able by the system due to signal restrictions. When this occurs, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. (See the description of the <code class="cCode">RESOURCES</code> <code class="cCode">NOTIFY</code> parameter in <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for a detailed discussion of notification methods.) 
</p>
<p class="pBody"><a name="wp1377210"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1377211"> </a>A native client must be running as an application administrator</li>
<li><a name="wp1377212"> </a>A Workstation client is not required to be running as the application administrator</li>
</ul></div>
<p class="pBody"><a name="wp1377213"> </a>
The ID for the application administrator is identified as part of the configuration for the application.
</p>
<p class="pBody"><a name="wp1040326"> </a>
If signal-based notification is selected for a client, then certain ATMI calls can fail, returning <code class="cCode">TPGOTSIG</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> and <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> for more information on notification method selection.
</p>
<h4 class="pHeading3"><a name="wp1040327"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1040328"> </a>
<a href="rf3c.html#wp1039463"><code class="cCode">tpbroadcast(3c)</code></a>,<a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a>, <a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1040568"> </a>
tpclose(3c)
</h3>
<h4 class="pHeading3"><a name="wp1040569"> </a>
Name
</h4>
<p class="pBody"><a name="wp1040570"> </a>
<code class="cCode">tpclose()</code>&#8212;Routine for closing a resource manager.
</p>
<h4 class="pHeading3"><a name="wp1040571"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1040572"> </a>
<code class="cCode">#include &lt;atmi.h&gt;   <br />int tpclose(void) </code>
</p>
<h4 class="pHeading3"><a name="wp1040573"> </a>
Description
</h4>
<p class="pBody"><a name="wp1040574"> </a>
<code class="cCode">tpclose()</code> tears down the association between the caller and the resource manager to which it is linked. Since resource managers differ in their <code class="cCode">close</code> semantics, the specific information needed to close a particular resource manager is placed in a configuration file.
</p>
<p class="pBody"><a name="wp1040575"> </a>
If a resource manager is already closed (that is, <code class="cCode">tpclose()</code> is called more than once), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1631047"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpclose()</code>.
</p>
<p class="pBody"><a name="wp2433373"> </a>
If the current server is built with the <code class="cCode">-M</code> option, tpclose tries to close all of opened RMs including opened by <code class="cCode">tprmopen(3c)</code> routine in runtime stage.
</p>
<h4 class="pHeading3"><a name="wp1040576"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1040577"> </a>
Upon failure, <code class="cCode">tpclose()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1040578"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1040579"> </a>
Upon failure, <code class="cCode">tpclose()</code> fails and sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1040580"> </a>
[<code class="cCode">TPERMERR</code>] 
</h4><div class="pDefPara"><a name="wp1040581"> </a>
A resource manager failed to close correctly. More information concerning the reason a resource manager failed to close can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1040582"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1040583"> </a>
<code class="cCode">tpclose()</code> was called in an improper context (for example, while the caller is in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp1040584"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1040585"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1040586"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1040587"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1040588"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1040589"> </a>
<a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2444274"><code class="cCode">tprmopen(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp1044795"><code class="cCode">tprmclose(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2446395"><code class="cCode">tprmstart(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2440145"><code class="cCode">tprmend(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1040811"> </a>
tpcommit(3c)
</h3>
<h4 class="pHeading3"><a name="wp1040812"> </a>
Name
</h4>
<p class="pBody"><a name="wp1040813"> </a>
<code class="cCode">tpcommit()</code>&#8212;Routine for committing current transaction.
</p>
<h4 class="pHeading3"><a name="wp1040814"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1040815"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tpcommit(long flags)</code> 
</p>
<h4 class="pHeading3"><a name="wp1040816"> </a>
Description
</h4>
<p class="pBody"><a name="wp1040817"> </a>
<code class="cCode">tpcommit()</code> signifies the end of a transaction, using a two-phase commit protocol to coordinate participants. <code class="cCode">tpcommit()</code> can be called only by the initiator of a transaction. If any of the participants cannot commit the transaction (for example, they call <code class="cCode">tpreturn()</code> with <code class="cCode">TPFAIL</code>), then the entire transaction is aborted and <code class="cCode">tpcommit()</code> fails. That is, all of the work involved in the transaction is undone. If all participants agree to commit their portion of the transaction, then this decision is logged to stable storage and all participants are asked to commit their work.
</p>
<p class="pBody"><a name="wp1040818"> </a>
Depending on the setting of the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic (see <a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a>), <code class="cCode">tpcommit()</code> can return successfully either after the commit decision has been logged or after the two-phase commit protocol has completed. If <code class="cCode">tpcommit()</code> returns after the commit decision has been logged but before the second phase has completed (<code class="cCode">TP_CMT_LOGGED</code>), then all participants have agreed to commit the work they did on behalf of the transaction and should fulfill their promise to commit the transaction during the second phase. However, because <code class="cCode">tpcommit()</code> is returning before the second phase has completed, there is a hazard that one or more of the participants can heuristically complete their portion of the transaction (in a manner that is not consistent with the commit decision) even though the function has returned success.
</p>
<p class="pBody"><a name="wp1040819"> </a>
If the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic is set such that <code class="cCode">tpcommit()</code> returns after the two-phase commit protocol has completed (<code class="cCode">TP_CMT_COMPLETE</code>), then its return value reflects the exact status of the transaction (that is, whether the transaction heuristically completed or not).
</p>
<p class="pBody"><a name="wp2303423"> </a>
Note that if only a single resource manager is involved in a transaction, then a one-phase commit is performed (that is, the resource manager is not asked whether or not it can commit; it is simply told to commit). In this case, the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic has no bearing and <code class="cCode">tpcommit()</code> will return heuristic outcomes if present.
</p>
<p class="pBody"><a name="wp1040821"> </a>
If <code class="cCode">tpcommit()</code> is called while call descriptors exist for outstanding replies, then upon return from the function, the transaction is aborted and those descriptors associated with the caller&#8217;s transaction are no longer valid. Call descriptors not associated with the caller&#8217;s transaction remain valid.
</p>
<p class="pBody"><a name="wp1040822"> </a>
<code class="cCode">tpcommit()</code> must be called after all connections associated with the caller&#8217;s transaction are closed (otherwise <code class="cCode">TPEABORT</code> is returned, the transaction is aborted and these connections are disconnected in a disorderly fashion with a <code class="cCode">TPEV_DISCONIMM</code> event). Connections opened before <code class="cCode">tpbegin()</code> or with the <code class="cCode">TPNOTRAN</code> flag (that is, connections not in transaction mode) are not affected by calls to <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>.
</p>
<p class="pBody"><a name="wp1040823"> </a>
Currently, <code class="cCode">tpcommit()</code>&#8217;s sole argument, <code class="cCodeEmphasis">flags</code>, is reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1631055"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpcommit()</code>.
</p>
<h4 class="pHeading3"><a name="wp1040824"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1040825"> </a>
Upon failure, <code class="cCode">tpcommit()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1040826"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1040827"> </a>
Upon failure, <code class="cCode">tpcommit()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1842745"> </a>
[<code class="cCode">TPEABORT</code>] 
</h4><div class="pDefPara"><a name="wp1842751"> </a>
The transaction could not commit because either the work performed by the initiator or by one or more of its participants could not commit. This error is also returned if <code class="cCode">tpcommit()</code> is called with outstanding replies or open conversational connections.
</div>
<h4 class="pDefTerm"><a name="wp1842772"> </a>
[<code class="cCode">TPEHAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1842778"> </a>
Due to some failure, the work done on behalf of the transaction could have been heuristically completed.
</div>
<h4 class="pDefTerm"><a name="wp1842768"> </a>
[<code class="cCode">TPEHEURISTIC</code>] 
</h4><div class="pDefPara"><a name="wp1842767"> </a>
Due to a heuristic decision, the work done on behalf of the transaction was partially committed and partially aborted.
</div>
<h4 class="pDefTerm"><a name="wp1842752"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1040829"> </a>
<code class="cCodeEmphasis">flags</code> is not equal to 0. The caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1842793"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1040831"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1842789"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1040839"> </a>
<code class="cCode">tpcommit()</code> was called in an improper context (for example, by a participant).
</div>
<h4 class="pDefTerm"><a name="wp1040840"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1040841"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1842785"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefParaCont"><a name="wp1842781"> </a>
The transaction has timed out and its status is unknown: it may have been either committed or aborted. If a transaction has timed out and its status is known to be aborted, then <code class="cCode">TPEABORT</code> is returned.
</div>
<h4 class="pHeading3"><a name="wp1040844"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1040845"> </a>
When using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code>, and <code class="cCode">tpabort()</code> to delineate an Oracle Tuxedo ATMI system transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI system transaction.
</p>
<h4 class="pHeading3"><a name="wp1040846"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1040847"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1041087"> </a>
tpconnect(3c)
</h3>
<h4 class="pHeading3"><a name="wp1041088"> </a>
Name
</h4>
<p class="pBody"><a name="wp1041089"> </a>
<code class="cCode">tpconnect()</code>&#8212;Routine for establishing a conversational service connection.
</p>
<h4 class="pHeading3"><a name="wp1041090"> </a>
Synopsis
</h4>
<a name="wp1041091"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;atmi.h&gt; <br /> <br />int tpconnect(char *svc, char *data, long len, long flags)</code></pre></div><h4 class="pHeading3"><a name="wp1041092"> </a>
Description
</h4>
<p class="pBody"><a name="wp1041093"> </a>
<code class="cCode">tpconnect()</code> allows a program to set up a half-duplex connection to a conversational service, <code class="cCodeEmphasis">svc</code>. The name must be one of the conversational service names posted by a conversational server.
</p>
<p class="pBody"><a name="wp1041094"> </a>
As part of setting up a connection, the caller can pass application-defined data to the listening program. If the caller chooses to pass data, then <code class="cCodeEmphasis">data</code> must point to a buffer previously allocated by <code class="cCode">tpalloc()</code>. <code class="cCodeEmphasis">len</code> specifies how much of the buffer to send. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified, (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and may be 0). Also, <code class="cCodeEmphasis">data</code> can be NULL in which case <code class="cCodeEmphasis">len</code> is ignored (no application data is passed to the conversational service). The type and subtype of <code class="cCodeEmphasis">data</code> must match one of the types and subtypes recognized by <code class="cCodeEmphasis">svc</code>. <code class="cCodeEmphasis">data</code> and <code class="cCodeEmphasis">len</code> are passed to the conversational service via the <code class="cCode">TPSVCINFO</code> structure with which the service is invoked; the service does not have to call <code class="cCode">tprecv()</code> to get the data.
</p>
<p class="pBody"><a name="wp1041095"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1041096"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1041097"> </a>
If the caller is in transaction mode and this flag is set, then when <code class="cCodeEmphasis">svc</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. Note that <code class="cCodeEmphasis">svc</code> may still be invoked in transaction mode but it will not be the same transaction: a <code class="cCodeEmphasis">svc</code> may have as a configuration attribute that it is automatically invoked in transaction mode. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other). If a service fails that was invoked with this flag, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1041098"> </a>
<code class="cCode">TPSENDONLY</code> 
</h4><div class="pDefPara"><a name="wp1041099"> </a>
The caller wants the connection to be set up initially such that it can only send data and the called service can only receive data (that is, the caller initially has control of the connection). Either <code class="cCode">TPSENDONLY</code> or <code class="cCode">TPRECVONLY</code> must be specified.
</div>
<h4 class="pDefTerm"><a name="wp1041100"> </a>
<code class="cCode">TPRECVONLY</code> 
</h4><div class="pDefPara"><a name="wp1041101"> </a>
The caller wants the connection to be set up initially such that it can only receive data and the called service can only send data (that is, the service being called initially has control of the connection). Either <code class="cCode">TPSENDONLY</code> or <code class="cCode">TPRECVONLY</code> must be specified.
</div>
<h4 class="pDefTerm"><a name="wp1041102"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1041103"> </a>
The connection is not established and the data is not sent if a blocking condition exists (for example, the data buffers through which the message is sent are full). Note that this flag applies only to the send portion of <code class="cCode">tpconnect()</code>; the function may block waiting for an acknowledgement from the server. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a blocking timeout or transaction timeout occurs.
</div>
<h4 class="pDefTerm"><a name="wp1041104"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1041105"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts will still affect the program.
</div>
<h4 class="pDefTerm"><a name="wp1041106"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1041107"> </a>
If a signal interrupts any underlying system calls, then the interrupted call is reissued.
</div>
<p class="pBody"><a name="wp1631063"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpconnect()</code>.
</p>
<h4 class="pHeading3"><a name="wp1041108"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1041109"> </a>
Upon successful completion, <code class="cCode">tpconnect()</code> returns a descriptor that is used to refer to the connection in subsequent calls. Otherwise it returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1041110"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1041111"> </a>
Upon failure, <code class="cCode">tpconnect()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1842854"> </a>
[<code class="cCode">TPEBLOCK</code>]
</h4><div class="pDefPara"><a name="wp1842860"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1842852"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1041113"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">svc</code> is NULL, <code class="cCodeEmphasis">data</code> is non-NULL and does not point to a buffer allocated by <code class="cCode">tpalloc()</code>, <code class="cCode">TPSENDONLY</code> or <code class="cCode">TPRECVONLY</code> was not specified in <code class="cCodeEmphasis">flags</code>, or <code class="cCodeEmphasis">flags</code> are otherwise invalid).
</div>
<h4 class="pDefTerm"><a name="wp1842865"> </a>
[<code class="cCode">TPEITYPE</code>] 
</h4><div class="pDefPara"><a name="wp1842871"> </a>
The type and subtype of <code class="cCodeEmphasis">data</code> is not one of the allowed types and subtypes that <code class="cCodeEmphasis">svc</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp1842876"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp1842882"> </a>
The caller&#8217;s request was not sent because the maximum number of outstanding connections has been reached.
</div>
<h4 class="pDefTerm"><a name="wp1842872"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1041115"> </a>
Cannot initiate a connection to <code class="cCodeEmphasis">svc</code> because it does not exist or is not a conversational service.
</div>
<h4 class="pDefTerm"><a name="wp1842889"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1842900"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1842907"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1842913"> </a>
<code class="cCode">tpconnect()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1842933"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1842939"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1842927"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854315"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpconnect()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854316"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854317"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to start new conversations, send new requests, or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854318"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1842914"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1041121"> </a>
<code class="cCodeEmphasis">svc</code> belongs to a program that does not support transactions and <code class="cCode">TPNOTRAN</code> was not set.
</div>
<h4 class="pDefTerm"><a name="wp1041126"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1041127"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pHeading3"><a name="wp1041134"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1041135"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>,<a href="rf3c.html#wp1042150"><code class="cCode">tpdiscon(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1037802"> </a>
tpconvert(3c)
</h3>
<h4 class="pHeading3"><a name="wp1037803"> </a>
Name
</h4>
<p class="pBody"><a name="wp1037804"> </a>
<code class="cCode">tpconvert()</code>&#8212;Converts structures to/from string representations.
</p>
<h4 class="pHeading3"><a name="wp1037805"> </a>
Synopsis
</h4>
<a name="wp1037806"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />#include &lt;xa.h&gt;<br /> <br />int tpconvert(char *strrep, char *binrep, long flags)</pre></div><h4 class="pHeading3"><a name="wp1037807"> </a>
Description
</h4>
<p class="pBody"><a name="wp1037808"> </a>
<code class="cCode">tpconvert()</code> converts the string representation of interface structures (<code class="cCodeEmphasis">strrep</code>) to or from the binary representation (<code class="cCodeEmphasis">binrep</code>).
</p>
<p class="pBody"><a name="wp1037809"> </a>
Both the direction of the conversion and the interface structure type are determined from the <code class="cCodeEmphasis">flags</code> argument. To convert a structure from binary representation to string representation, the programmer must set the <code class="cCode">TPTOSTRING</code> bit in <code class="cCodeEmphasis">flags</code>. To convert a structure from string to binary the programmer must clear the bit. The following flags are defined to indicate the particular structure type to be converted; only one may be specified at a time: 
</p>
<h4 class="pDefTerm"><a name="wp1037810"> </a>
<code class="cCode">TPCONVCLTID</code> 
</h4><div class="pDefPara"><a name="wp1037811"> </a>
Convert <code class="cCode">CLIENTID</code> (see <code class="cCode">atmi.h</code>).
</div>
<h4 class="pDefTerm"><a name="wp1037812"> </a>
<code class="cCode">TPCONVTRANID</code> 
</h4><div class="pDefPara"><a name="wp1037813"> </a>
Convert <code class="cCode">TPTRANID</code> (see <code class="cCode">atmi.h</code>).
</div>
<h4 class="pDefTerm"><a name="wp1037814"> </a>
<code class="cCode">TPCONVXID</code> 
</h4><div class="pDefPara"><a name="wp1037815"> </a>
Convert <code class="cCode">XID</code> (see <code class="cCode">xa.h</code>).
</div>
<p class="pBody"><a name="wp1037816"> </a>
For conversions from binary to string representation, <code class="cCodeEmphasis">strrep</code> should be at least <code class="cCode">TPCONVMAXSTR</code> characters in length.
</p>
<p class="pBody"><a name="wp1037817"> </a>
Note that unequal string versions of <code class="cCode">TPTRANID</code> and <code class="cCode">XID</code> values may be considered <code class="cCodeEmphasis">equal</code> by the system when accessing <a href="../rf5/rf5.html">TM_MIB(5)</a> classes that allow these values as key fields (for example, <code class="cCode">T_TRANSACTION</code> or <code class="cCode">T_ULOG</code>). Therefore, string values for these data types should not be fabricated or manipulated by application programs. <a href="../rf5/rf5.html">TM_MIB(5)</a> guarantees that only objects matching the global transaction identified by the string are returned when one of these values is used as a key field.
</p>
<p class="pBody"><a name="wp1617665"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpconvert()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1037818"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1037819"> </a>
Upon failure, <code class="cCode">tpconvert()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. 
</p>
<h4 class="pHeading3"><a name="wp1037820"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1037821"> </a>
Under the following conditions, <code class="cCode">tpconvert()</code> fails and sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1037822"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1037823"> </a>
Invalid arguments were specified. <code class="cCodeEmphasis">strrep</code> or <code class="cCodeEmphasis">binrep</code> is a NULL pointer, or <code class="cCodeEmphasis">flags</code> does not indicate exactly one structure type.
</div>
<h4 class="pDefTerm"><a name="wp1037824"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1037825"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in <code class="cCode">Uunixerr</code>.
</div>
<h4 class="pDefTerm"><a name="wp1037826"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1037827"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>.
</div>
<h4 class="pHeading3"><a name="wp1037828"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1037829"> </a>
This interface is available only on Oracle Tuxedo ATMI release 5.0 or later. This interface is available on workstation platforms. 
</p>
<h4 class="pHeading3"><a name="wp1037830"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1037831"> </a>
<a href="rf3c.html#wp1044625"><code class="cCode">tpresume(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1045633"><code class="cCode">tpsuspend(3c)</code></a>, <a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a>, <a href="../rf5/rf5.html">TM_MIB(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1928689"> </a>
tpconvmb(3c)
</h3>
<h4 class="pHeading3"><a name="wp1928690"> </a>
Name
</h4>
<p class="pBody"><a name="wp1928691"> </a>
<code class="cCode">tpconvmb()</code>&#8212;Converts encoding of characters in an input buffer to a named target encoding.
</p>
<h4 class="pHeading3"><a name="wp1928692"> </a>
Synopsis
</h4>
<a name="wp1930761"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br />int<br />tpconvmb (char **bufp, int *len, char *target_encoding, long flags) </pre></div><h4 class="pHeading3"><a name="wp1930755"> </a>
Description
</h4>
<p class="pBody"><a name="wp1930774"> </a>
This function is used to convert an input buffer to a desired codeset encoding. 
</p>
<p class="pBody"><a name="wp2194432"> </a>
This function is added for user convenience and is not required for normal codeset data conversion that is done automatically.
</p>
<p class="pBody"><a name="wp1930776"> </a>
The <code class="cCodeEmphasis">bufp</code> argument is a valid pointer to an MBSTRING typed buffer message. This pointer will be reallocated internally if the size of the buffer is insufficient to handle the output data of the converted buffer.
</p>
<p class="pBody"><a name="wp1930777"> </a>
The <code class="cCodeEmphasis">len</code> argument, on input, contains the number of bytes that need to be converted. Upon successful completion of conversion it will contain the number of bytes used in bufp.
</p>
<p class="pBody"><a name="wp1930778"> </a>
The <code class="cCodeEmphasis">target_encoding</code> argument is the target codeset encoding name used to convert the typed buffer provided in the bufp message.
</p>
<p class="pBody"><a name="wp1930779"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not used by the Tuxedo conversion code. It will be passed along to the buffer type switch function for user defined conversion functions.
</p>
<h4 class="pHeading3"><a name="wp1930757"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1930790"> </a>
Upon success, tpconvmb() returns 0. This function returns -1 on error and sets tperrno as described below. The function may fail for the following reasons. 
</p>
<h4 class="pDefTerm"><a name="wp1930749"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1930795"> </a>
<code class="cCodeEmphasis">target_encoding</code>, <code class="cCodeEmphasis">len</code>, or <code class="cCodeEmphasis">bufp</code> arguments are NULL. <code class="cCodeEmphasis">len</code> or <code class="cCodeEmphasis">target_encoding</code> is invalid.
</div>
<h4 class="pDefTerm"><a name="wp1930796"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1930797"> </a>
<code class="cCodeEmphasis">bufp</code> translates to a Tuxedo buffer that does not have a buffer typeswitch conversion function
</div>
<h4 class="pDefTerm"><a name="wp1930798"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1930799"> </a>
A Tuxedo system error has occurred. (e.g. <code class="cCodeEmphasis">bufp</code> does not correspond to a valid Tuxedo buffer).
</div>
<h4 class="pDefTerm"><a name="wp1930800"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1930801"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in Uunixerr.
</div>
<h4 class="pHeading3"><a name="wp1928694"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1928710"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1930050"><code class="cCode">tpgetmbenc(3c)</code></a>, <a href="rf3c.html#wp1930111"><code class="cCode">tpsetmbenc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1063533"> </a>
tpcryptpw(3c)
</h3>
<h4 class="pHeading3"><a name="wp1063534"> </a>
Name
</h4>
<p class="pBody"><a name="wp1063535"> </a>
<code class="cCode">tpcryptpw()</code>&#8212;Encrypts the application password in an administrative request.
</p>
<h4 class="pHeading3"><a name="wp1063536"> </a>
Synopsis
</h4>
<a name="wp1063537"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />#include &lt;fml32.h&gt; <br /> <br />int tpcryptpw(FBFR32 *buf) </pre></div><h4 class="pHeading3"><a name="wp1063538"> </a>
Description
</h4>
<p class="pBody"><a name="wp1063539"> </a>
<code class="cCode">tpcryptpw()</code> is used to encrypt the application password stored in an administrative request buffer prior to sending the request for servicing. Application passwords are stored as string values using the FML32 field identifier <code class="cCode">TA_PASSWORD</code>. This encryption is necessary to insure that clear text passwords are not compromised and that appropriate propagation of the update can take place to all active application sites. Additional system fields may be added to the callers buffer and existing fields may be modified to satisfy the request.
</p>
<p class="pBody"><a name="wp1617681"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpcryptpw()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1063540"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1063541"> </a>
Upon failure, <code class="cCode">tpcryptpw()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1063542"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1063543"> </a>
Upon failure, <code class="cCode">tpcryptpw()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1063544"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1063545"> </a>
Invalid arguments were specified. The <code class="cCodeEmphasis">buf</code> value is NULL, does not point to a FML32 typed buffer or appdir could not be determined from the input buffer or the environment.
</div>
<h4 class="pDefTerm"><a name="wp1063546"> </a>
[<code class="cCode">TPEPERM</code>] 
</h4><div class="pDefPara"><a name="wp1063547"> </a>
The calling process did not have the appropriate permissions necessary to perform the requested task.
</div>
<h4 class="pDefTerm"><a name="wp1063548"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1063549"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in <code class="cCode">Uunixerr</code>.
</div>
<h4 class="pDefTerm"><a name="wp1063550"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1063551"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>.
</div>
<h4 class="pHeading3"><a name="wp1063552"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1063553"> </a>
This interface is available only on UNIX system sites running Oracle Tuxedo ATMI release 5.0 or later. This interface is not available to Workstation clients. 
</p>
<h4 class="pHeading3"><a name="wp1063554"> </a>
Files
</h4>
<p class="pBody"><a name="wp1063555"> </a>
<code class="cCode">${TUXDIR}/lib/libtmib.a</code>, <code class="cCode">${TUXDIR}/lib/libtmib.so.</code><code class="cCodeEmphasis">rel</code> 
</p>
<h4 class="pHeading3"><a name="wp1063556"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1063557"> </a>
<a href="../rf5/rf5.html">MIB(5)</a>, <a href="../rf5/rf5.html">TM_MIB(5)</a> 
</p>
<p class="pBody"><a name="wp1270343"> </a>
<em class="cEmphasis">Setting Up an Oracle Tuxedo Application</em>
</p>
<p class="pBody"><a name="wp1450303"> </a>
<em class="cEmphasis">Administering an Oracle Tuxedo Application at Run Time</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1041783"> </a>
tpdequeue(3c)
</h3>
<h4 class="pHeading3"><a name="wp1041784"> </a>
Name
</h4>
<p class="pBody"><a name="wp1041785"> </a>
<code class="cCode">tpdequeue()</code>&#8212;Routine to dequeue a message from a queue.
</p>
<h4 class="pHeading3"><a name="wp1041786"> </a>
Synopsis
</h4>
<a name="wp1041787"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpdequeue(char *qspace, char *qname, TPQCTL *ctl, char **data, long *len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1041788"> </a>
Description
</h4>
<p class="pBody"><a name="wp1340107"> </a>
<code class="cCode">tpdequeue()</code> takes a message for processing from the queue named by <code class="cCodeEmphasis">qname</code> in the <code class="cCodeEmphasis">qspace</code> queue space.
</p>
<p class="pBody"><a name="wp1041790"> </a>
By default, the message at the top of the queue is dequeued. The order of messages on the queue is defined when the queue is created. The application can request a particular message for dequeuing by specifying its message identifier or correlation identifier using the <code class="cCodeEmphasis">ctl</code> parameter. <code class="cCodeEmphasis">ctl</code> flags can also be used to indicate that the application wants to wait for a message, in the case when a message is not currently available. It is possible to use the <code class="cCodeEmphasis">ctl</code> parameter to look at a message without removing it from the queue or changing its relative position on the queue. See the section below describing this parameter.
</p>
<p class="pBody"><a name="wp1041791"> </a>
<code class="cCodeEmphasis">data</code> is the address of a pointer to the buffer into which a message is read, and <code class="cCodeEmphasis">len</code> points to the length of that message. *<code class="cCodeEmphasis">data</code> must point to a buffer originally allocated by <code class="cCode">tpalloc()</code>. If a message is larger than the buffer passed to <code class="cCode">tpdequeue</code>, the buffer is increased in size to accommodate the message. To determine whether a message buffer changed in size, compare its (total) size before <code class="cCode">tpdequeue()</code> was issued with *<code class="cCodeEmphasis">len</code>. If *<code class="cCodeEmphasis">len</code> is larger, then the buffer has grown; otherwise, the buffer has not changed size. Note that *<code class="cCodeEmphasis">data</code> may change for reasons other than the buffer&#8217;s size increased. If *<code class="cCodeEmphasis">len</code> is 0 upon return, then the message dequeued has no data portion and neither *<code class="cCodeEmphasis">data</code> nor the buffer it points to were modified. It is an error for *<code class="cCodeEmphasis">data</code> or <code class="cCodeEmphasis">len</code> to be NULL.
</p>
<p class="pBody"><a name="wp1041792"> </a>
The message is dequeued in transaction mode if the caller is in transaction mode and the <code class="cCode">TPNOTRAN</code> flag is not set. This has the effect that if <code class="cCode">tpdequeue()</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is removed from the queue. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be left on the queue (that is, the removal of the message from the queue is also rolled back). It is not possible to enqueue and dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp1041793"> </a>
The message is not dequeued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully dequeued and the message may be lost.
</p>
<p class="pBody"><a name="wp1041794"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1041795"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1041796"> </a>
If the caller is in transaction mode and this flag is set, the message is not dequeued within the caller&#8217;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when dequeuing the message. If message dequeuing fails, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1041797"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1614609"> </a>
The message is not dequeued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on a Oracle product other than the Oracle Tuxedo ATMI system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<div class="pDefParaCont"><a name="wp1643913"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). This blocking condition does not include blocking on the queue itself if the <code class="cCode">TPQWAIT</code> option in <code class="cCodeEmphasis">flags</code> (of the <code class="cCode">TPQCTL</code> structure) is specified.
</div>
<h4 class="pDefTerm"><a name="wp1643914"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1041800"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1041801"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1041802"> </a>
When this flag is set, the type of the buffer pointed to by *<code class="cCodeEmphasis">data</code> is not allowed to change. By default, if a buffer is received that differs in type from the buffer pointed to by *<code class="cCodeEmphasis">data</code>, then *<code class="cCodeEmphasis">data</code>&#8217;s buffer type changes to the received buffer&#8217;s type so long as the receiver recognizes the incoming buffer type. That is, the type and subtype of the dequeued message must match the type and subtype of the buffer pointed to by *<code class="cCodeEmphasis">data</code>.
</div>
<h4 class="pDefTerm"><a name="wp1041803"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1643720"> </a>
Setting this flag indicates that any underlying system calls that are interrupted by a signal should be reissued. When this flag is not set and a signal interrupts a system call, the call fails and sets <code class="cCode">tperrno</code> to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1643721"> </a>
If <code class="cCode">tpdequeue()</code> returns successfully, the application can retrieve additional information about the message using the <code class="cCodeEmphasis">ctl</code> data structure. The information may include the message identifier for the dequeued message; a correlation identifier that should accompany any reply or failure message so that the originator can correlate the message with the original request; the quality of service the message was delivered with, the quality of service any replies to the message should be delivered with; the name of a reply queue if a reply is desired; and the name of the failure queue on which the application can queue information regarding failure to dequeue the message. These are described below.
</p>
<p class="pBody"><a name="wp1631071"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpdequeue()</code>.
</p>
<h4 class="pHeading3"><a name="wp1041806"> </a>
Control Parameter
</h4>
<p class="pBody"><a name="wp1041807"> </a>
The <code class="cCode">TPQCTL</code> structure is used by the application program to pass and retrieve parameters associated with dequeuing the message. The <code class="cCodeEmphasis">flags</code> element of <code class="cCode">TPQCTL</code> is used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp1041808"> </a>
On input to <code class="cCode">tpdequeue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1041809"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values<br />                        * are set */<br />char msgid[32];        /* ID of message to dequeue */<br />char corrid[32];       /* correlation identifier of<br />                        * message to dequeue */</pre></div><p class="pBody"><a name="wp1041810"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpdequeue()</code>:
</p>
<h4 class="pDefTerm"><a name="wp1041811"> </a>
<code class="cCode">TPNOFLAGS</code>
</h4><div class="pDefPara"><a name="wp1041812"> </a>
No flags are set. No information is taken from the control structure.
</div>
<h4 class="pDefTerm"><a name="wp1041813"> </a>
<code class="cCode">TPQGETBYMSGID</code>
</h4><div class="pDefPara"><a name="wp1041814"> </a>
Setting this flag requests that the message with the message identifier specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq5" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> be dequeued. The message identifier may be acquired by a prior call to <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>. Note that a message identifier changes if the message has moved from one queue to another. Note also that the entire 32 bytes of the message identifier value are significant, so the value specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq6" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1041815"> </a>
<code class="cCode">TPQGETBYCORRID</code>
</h4><div class="pDefPara"><a name="wp1041816"> </a>
Setting this flag requests that the message with the correlation identifier specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq7" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> be dequeued. The correlation identifier is specified by the application when enqueuing the message with <code class="cCode">tpenqueue()</code>. Note that the entire 32 bytes of the correlation identifier value are significant, so the value specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq8" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1041817"> </a>
<code class="cCode">TPQWAIT</code> 
</h4><div class="pDefPara"><a name="wp1377241"> </a>
Setting this flag indicates that an error should not be returned if the queue is empty. Instead, the process should wait until a message is available. If <code class="cCode">TPQWAIT</code> is set in conjunction with <code class="cCode">TPQGETBYMSGID</code> or <code class="cCode">TPQGETBYCORRID</code>, it indicates that an error should not be returned if no message with the specified message identifier or correlation identifier is present in the queue. Instead, the process should wait until a message meeting the criteria is available. The process is still subject to the caller&#8217;s transaction timeout, or, when not in transaction mode, the process is subject to the timeout specified on the <code class="cCode">TMQUEUE</code> process by the <code class="cCode">-t</code> option.
</div>
<div class="pDefParaCont"><a name="wp1377247"> </a>
If a message matching the desired criteria is not immediately available and the configured action resources are exhausted, <code class="cCode">tpdequeue</code> returns -1, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESYSTEM</code>.
<a name="wp1716996"> </a>
Note that each <code class="cCode">tpdequeue()</code> request specifying the <code class="cCode">TPQWAIT</code> control parameter requires that a queue manager (<code class="cCode">TMQUEUE</code>) action object be available if a message satisfying the condition is not immediately available. If an action object is not available, the <code class="cCode">tpdequeue()</code> request fails. The number of available queue manager actions are specified when a queue space is created or modified. When a waiting dequeue request completes, the associated action object associated is made available for another request.
</div>
<h4 class="pDefTerm"><a name="wp1377275"> </a>
<code class="cCode">TPQPEEK</code>
</h4><div class="pDefPara"><a name="wp1377269"> </a>
If this flag is set, the specified message is read but is not removed from the queue. This flag implies the <code class="cCode">TPNOTRAN</code> flag has been set for the <code class="cCode">tpdequeue</code>() operation. That is, non-destructive dequeuing is non-transactional. Note that it is not possible to read messages enqueued or dequeued within a transaction before the transaction completes.
</div>
<div class="pDefParaCont"><a name="wp1632960"> </a>
When a thread is non-destructively dequeuing a message using <code class="cCode">TPQPEEK</code>, the message may not be seen by other non-blocking dequeuers for the brief time the system is processing the non-destructive dequeue request. This includes dequeuers using specific selection criteria (such as message identifier and correlation identifier) that are looking for the message currently being non-destructively dequeued.
</div>
<p class="pBody"><a name="wp1041819"> </a>
On output from <code class="cCode">tpdequeue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure: 
</p>
<a name="wp1340079"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values <br />                        * should be set */<br /> <br />long priority;         /* enqueue priority */ <br />char msgid[32];        /* ID of message dequeued */ <br />char corrid[32];       /* correlation identifier used to<br />                        * identify the message */<br />long delivery_qos;     /* delivery quality of service */<br />long reply_qos;        /* reply message quality of service */<br />char replyqueue[128];   /* queue name for reply */ <br />char failurequeue[128]; /* queue name for failure */ <br />long diagnostic;       /* reason for failure */ <br />long appkey;           /* application authentication client <br />                        * key */ <br />long urcode;           /* user-return code */ <br />CLIENTID cltid;        /* client identifier for originating <br />                        * client */</pre></div><p class="pBody"><a name="wp1722856"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling output information from <code class="cCode">tpdequeue()</code>. For any of these bits, if the flag bit is turned on when <code class="cCode">tpdequeue()</code> is called, the associated element in the structure is populated with the value provided when the message was queued, and the bit remains set. If a value is not available or the bit is not set when <code class="cCode">tpdequeue()</code> is called, <code class="cCode">tpdequeue()</code> completes with the flag turned off.
</p>
<h4 class="pDefTerm"><a name="wp1722565"> </a>
<code class="cCode">TPQPRIORITY</code> 
</h4><div class="pDefPara"><a name="wp1722566"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with an explicit priority, then the priority is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq9" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">priority</code>. The priority is in the range 1 to 100, inclusive, and the higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). For queues not ordered by priority, the value is informational.
</div>
<div class="pDefParaCont"><a name="wp1722567"> </a>
If no priority was explicitly specified when the message was queued and the call to <code class="cCode">tpdequeue()</code> is successful, the priority for the message is 50.
</div>
<h4 class="pDefTerm"><a name="wp1722568"> </a>
<code class="cCode">TPQMSGID</code> 
</h4><div class="pDefPara"><a name="wp1722569"> </a>
If this flag is set and the call to <code class="cCode">tpdequeue()</code> is successful, the message identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq10" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. The entire 32 bytes of the message identifier value are significant.
</div>
<h4 class="pDefTerm"><a name="wp1722570"> </a>
<code class="cCode">TPQCORRID</code> 
</h4><div class="pDefPara"><a name="wp1722571"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a correlation identifier, then the correlation identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq11" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code>. The entire 32 bytes of the correlation identifier value are significant. Any Oracle Tuxedo ATMI /Q provided reply to a message has the correlation identifier of the original request message.
</div>
<h4 class="pDefTerm"><a name="wp1722572"> </a>
<code class="cCode">TPQDELIVERYQOS</code>
</h4><div class="pDefPara"><a name="wp1722573"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a delivery quality of service, then the flag&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;is stored in <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code>. If no delivery quality of service was explicitly specified when the message was queued, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<h4 class="pDefTerm"><a name="wp1722574"> </a>
<code class="cCode">TPQREPLYQOS</code>
</h4><div class="pDefPara"><a name="wp1726801"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a reply quality of service, then the flag&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;is stored in <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>. If no reply quality of service was explicitly specified when the message was queued, the default delivery policy of the <code class="cCodeEmphasis">ctl-&gt;replyqueue</code> queue dictates the delivery quality of service for any reply.
</div>
<div class="pDefParaCont"><a name="wp1726805"> </a>
Note that the default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
</div>
<h4 class="pDefTerm"><a name="wp1726802"> </a>
<code class="cCode">TPQREPLYQ</code> 
</h4><div class="pDefPara"><a name="wp1722577"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a reply queue, then the name of the reply queue is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq12" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">replyqueue</code>. Any reply to the message should go to the named reply queue within the same queue space as the request message.
</div>
<h4 class="pDefTerm"><a name="wp1722578"> </a>
<code class="cCode">TPQFAILUREQ</code> 
</h4><div class="pDefPara"><a name="wp1722579"> </a>
If this flag is set, the call to <code class="cCode">tpdequeue()</code> is successful, and the message was queued with a failure queue, then the name of the failure queue is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq13" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">failurequeue</code>. Any failure message should go to the named failure queue within the same queue space as the request message.
</div>
<p class="pBody"><a name="wp1041832"> </a>
The following remaining bits for the <code class="cCodeEmphasis">flags</code> parameter are cleared (set to zero) when <code class="cCode">tpdequeue()</code> is called: <code class="cCode">TPQTOP</code>, <code class="cCode">TPQBEFOREMSGID</code>, <code class="cCode">TPQTIME_ABS</code>, <code class="cCode">TPQTIME_REL</code>, <code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code>. These bits are valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpenqueue()</code>.
</p>
<p class="pBody"><a name="wp1645378"> </a>
If the call to <code class="cCode">tpdequeue()</code> failed and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq14" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">diagnostic</code>. The possible values are defined below in the Diagnostics section.
</p>
<p class="pBody"><a name="wp1041833"> </a>
Additionally on output, if the call to <code class="cCode">tpdequeue()</code> is successful, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq15" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">appkey</code> is set to the application authentication key, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq16" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">cltid</code> is set to the identifier for the client originating the request, and <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq17" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">urcode</code> is set to the user-return code value that was set when the message was enqueued.
</p>
<p class="pBody"><a name="wp1041834"> </a>
If the <code class="cCodeEmphasis">ctl</code> parameter is NULL, the input flags are considered to be <code class="cCode">TPNOFLAGS</code>, and no output information is made available to the application program.
</p>
<h4 class="pHeading3"><a name="wp1041835"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1041836"> </a>
Upon failure, <code class="cCode">tpdequeue()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1041837"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1041838"> </a>
Upon failure, <code class="cCode">tpdequeue()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1041839"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1041840"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">qname</code> is NULL, <code class="cCodeEmphasis">data</code> does not point to space allocated with <code class="cCode">tpalloc()</code> or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1041841"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1591450"> </a>
Cannot access the <code class="cCodeEmphasis">qspace</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp1041843"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp1589365"> </a>
Either the type and subtype of the dequeued message are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set in <code class="cCodeEmphasis">flags</code> and the type and subtype of *<code class="cCodeEmphasis">data</code> do not match the type and subtype of the dequeued message. In either case, *<code class="cCodeEmphasis">data</code>, its contents, and *<code class="cCodeEmphasis">len</code> are <em class="cEmphasis">not</em> changed. When the call is made in transaction mode and this error occurs, the transaction is marked abort-only, and the message remains on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1041845"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854323"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpdequeue()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854324"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.) In either case, no changes are made to <code class="cCode">*data</code>, its contents, or <code class="cCode">*len</code>.
<a name="wp1854325"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to perform further conversational work, send new requests, or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854326"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1041847"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1041848"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1041849"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1041850"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1041851"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1041852"> </a>
<code class="cCode">tpdequeue()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1041853"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1041854"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1041855"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1041856"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp1041857"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp1041858"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via <code class="cCodeEmphasis">ctl</code> structure.
</div>
<h4 class="pHeading3"><a name="wp1041859"> </a>
Diagnostic
</h4>
<p class="pBody"><a name="wp1041860"> </a>
The following diagnostic values are returned during the dequeuing of a message: 
</p>
<h4 class="pDefTerm"><a name="wp1041861"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1041862"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1041863"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp1041864"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1041865"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp1041866"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1041867"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1041868"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> flag set and an error occurred trying to start a transaction in which to dequeue the message. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1041869"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp1041870"> </a>
An invalid message identifier was specified for dequeuing.
</div>
<h4 class="pDefTerm"><a name="wp1402509"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1041874"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1041875"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp1041876"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1041877"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp1041878"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1041879"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1041880"> </a>
A dequeue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1041881"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp1041882"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1041883"> </a>
[<code class="cCode">QMENOMSG</code>] 
</h4><div class="pDefPara"><a name="wp1041884"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1613811"> </a>
[<code class="cCode">QMEINUSE</code>] 
</h4><div class="pDefPara"><a name="wp1613812"> </a>
When dequeuing a message by message identifier or correlation identifier, the specified message is in use by another transaction. Otherwise, all messages currently on the queue are in use by other transactions. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1613813"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1613814"> </a>
When dequeuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp1041885"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1041886"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>,<code class="cCode"> </code><a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>, <a href="../rf5/rf5.html">APPQ_MIB(5)</a>,<code class="cCode"> </code><span class="cHyperlink">
<a href="../rf5/rf5.html">TMQUEUE(5)</a></span> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1042150"> </a>
tpdiscon(3c)
</h3>
<h4 class="pHeading3"><a name="wp1042151"> </a>
Name
</h4>
<p class="pBody"><a name="wp1042152"> </a>
<code class="cCode">tpdiscon()</code>&#8212;Routine for taking down a conversational service connection.
</p>
<h4 class="pHeading3"><a name="wp1042153"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1042154"> </a>
<code class="cCode">#include &lt;atmi.h&gt;   <br />int tpdiscon(int cd)</code>
</p>
<h4 class="pHeading3"><a name="wp1042155"> </a>
Description
</h4>
<p class="pBody"><a name="wp1042156"> </a>
<code class="cCode">tpdiscon()</code> immediately tears down the connection specified by <code class="cCodeEmphasis">cd</code> and generates a <code class="cCode">TPEV_DISCONIMM</code> event on the other end of the connection.
</p>
<p class="pBody"><a name="wp1042157"> </a>
<code class="cCode">tpdiscon()</code> can be called only by the initiator of the conversation. <code class="cCode">tpdiscon()</code> cannot be called within a conversational service on the descriptor with which it was invoked. Rather, a conversational service must use <code class="cCode">tpreturn()</code> to signify that it has completed its part of the conversation. Similarly, even though a program communicating with a conversational service can issue <code class="cCode">tpdiscon()</code>, the preferred way is to let the service tear down the connection in <code class="cCode">tpreturn()</code>; doing so ensures correct results.
</p>
<p class="pBody"><a name="wp1042158"> </a>
<code class="cCode">tpdiscon()</code> causes the connection to be torn down immediately (that is, abortive rather than orderly). Any data that has not yet reached its destination may be lost. <code class="cCode">tpdiscon()</code> can be issued even when the program on the other end of the connection is participating in the caller&#8217;s transaction. In this case, the transaction must be aborted. Also, the caller does not need to have control of the connection when <code class="cCode">tpdiscon()</code> is called.
</p>
<h4 class="pHeading3"><a name="wp1042159"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1042160"> </a>
Upon failure, <code class="cCode">tpdiscon()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1042161"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1042162"> </a>
Upon failure, <code class="cCode">tpdiscon()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1042163"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp1042164"> </a>
<code class="cCodeEmphasis">cd</code> is invalid or is the descriptor with which a conversational service was invoked.
</div>
<h4 class="pDefTerm"><a name="wp1042165"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854331"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpdiscon()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854332"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. (Note that calling <code class="cCode">tpdiscon()</code> on a connection in the caller&#8217;s transaction would have resulted in the transaction being marked abort-only, even if <code class="cCode">tpdiscon()</code> had succeeded.) 
<a name="wp1857773"> </a>
If the caller is not in transaction mode, a blocking timeout has occurred.
<a name="wp1854333"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to perform further conversational work, send new requests, or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854334"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1042167"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1042168"> </a>
<code class="cCode">tpdiscon()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1042169"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1042170"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. The descriptor is no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp1042171"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1042172"> </a>
An operating system error has occurred. The descriptor is no longer valid.
</div>
<h4 class="pHeading3"><a name="wp1042173"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1042174"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1042179"> </a>
tpenqueue(3c)
</h3>
<h4 class="pHeading3"><a name="wp1042180"> </a>
Name
</h4>
<p class="pBody"><a name="wp1042181"> </a>
<code class="cCode">tpenqueue()</code>&#8212;Routine to enqueue a message.
</p>
<h4 class="pHeading3"><a name="wp1042182"> </a>
Synopsis
</h4>
<a name="wp1042183"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />int tpenqueue(char *qspace, char *qname, TPQCTL *ctl, char *data, long len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1042184"> </a>
Description
</h4>
<p class="pBody"><a name="wp1042185"> </a>
<code class="cCode">tpenqueue()</code> stores a message on the queue named by <code class="cCodeEmphasis">qname</code> in the <code class="cCodeEmphasis">qspace</code> queue space. A queue space is a collection of queues, one of which must be <code class="cCodeEmphasis">qname</code>.
</p>
<p class="pBody"><a name="wp1042186"> </a>
When the message is intended for an Oracle Tuxedo ATMI system server, the <code class="cCodeEmphasis">qname</code> matches the name of a service provided by the server. The system provided server, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, provides a default mechanism for dequeuing messages from the queue and forwarding them to servers that provide a service matching the queue name. If the originator expects a reply, then the reply to the forwarded service request is stored on the originator&#8217;s queue, unless otherwise specified. The originator will dequeue the reply message at a subsequent time. Queues can also be used for a reliable message transfer mechanism between any pair of Oracle Tuxedo ATMI system processes (clients and/or servers). In this case, the queue name does not match a service name but some agreed upon name for transferring the message.
</p>
<p class="pBody"><a name="wp1042187"> </a>
If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should specify the amount of data in the buffer that should be queued. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored. If <code class="cCodeEmphasis">data</code> is NULL, <code class="cCodeEmphasis">len</code> is ignored and a message is queued with no data portion.
</p>
<p class="pBody"><a name="wp1042188"> </a>
The message is queued at the priority defined for <code class="cCodeEmphasis">qspace</code> unless overridden by a previous call to <code class="cCode">tpsprio()</code>.
</p>
<p class="pBody"><a name="wp1042189"> </a>
If the caller is within a transaction and the <code class="cCode">TPNOTRAN</code> flag is not set, the message is queued in transaction mode. This has the effect that if <code class="cCode">tpenqueue()</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is guaranteed to be available subsequent to the transaction completing. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be removed from the queue (that is, the placing of the message on the queue is also rolled back). It is not possible to enqueue then dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp1042190"> </a>
The message is not queued in transaction mode if either the caller is not in transaction mode, or the <code class="cCode">TPNOTRAN</code> flag is set. Once <code class="cCode">tpenqueue()</code> returns successfully, the submitted message is guaranteed to be in the queue. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully stored on the queue.
</p>
<p class="pBody"><a name="wp1407137"> </a>
The order in which messages are placed on the queue is controlled by the application via <code class="cCodeEmphasis">ctl</code> data structure as described below; the default queue ordering is set when the queue is created.
</p>
<p class="pBody"><a name="wp1042192"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp1042193"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1042194"> </a>
If the caller is in transaction mode and this flag is set, the message is not queued within the caller&#8217;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when queuing the message. If message queuing fails, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1042195"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1615072"> </a>
The message is not enqueued if a blocking condition exists. If this flag is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. If this flag is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the diagnostic field of the <code class="cCode">TPQCTL</code> structure is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on an Oracle product other than the Oracle Tuxedo ATMI system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<div class="pDefParaCont"><a name="wp1615073"> </a>
When <code class="cCode">TPNOBLOCK</code> is not set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). If a timeout occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1042197"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1042198"> </a>
Setting this flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1042199"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1042200"> </a>
If this flag is set and a signal interrupts any underlying system calls, the interrupted system call is reissued. If <code class="cCode">TPSIGRSTRT</code> is not set and a signal interrupts a system call, <code class="cCode">tpenqueue()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1042201"> </a>
Additional information about queuing the message can be specified via <code class="cCodeEmphasis">ctl</code> data structure. This information includes values to override the default queue ordering placing the message at the top of the queue or before an enqueued message; an absolute or relative time after which a queued message is made available; an absolute or relative time when a message expires and is removed from the queue; the quality of service for delivering the message; the quality of service that any replies to the message should use; a correlation identifier that aids in correlating a reply or failure message with the queued message; the name of a queue to which a reply should be enqueued; and the name of a queue to which any failure message should be enqueued.
</p>
<p class="pBody"><a name="wp1631081"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpenqueue()</code>.
</p>
<h4 class="pHeading3"><a name="wp1042202"> </a>
Control Parameter
</h4>
<p class="pBody"><a name="wp1042203"> </a>
The <code class="cCode">TPQCTL</code> structure is used by the application program to pass and retrieve parameters associated with enqueuing the message. The <code class="cCodeEmphasis">flags</code> element of <code class="cCode">TPQCTL</code> is used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp1042204"> </a>
On input to <code class="cCode">tpenqueue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1042205"> </a><div class="pPreformatted"><pre>long flags;            /* indicates which of the values  <br />                        * are set */  <br />long deq_time;         /* absolute/relative for dequeuing */  <br />long priority;         /* enqueue priority */  <br />long exp_time          /* expiration time */  <br />long delivery_qos      /* delivery quality of service */  <br />long reply_qos         /* reply quality of service */  <br />long urcode;           /* user-return code */  <br />char msgid[32];        /* ID of message before which to queue  <br />                        * request */  <br />char corrid[32];       /* correlation identifier used to  <br />                        * identify the msg */  <br />char replyqueue[128];   /* queue name for reply message */  <br />char failurequeue[128]; /* queue name for failure message */</pre></div><p class="pBody"><a name="wp1042206"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">flags</code> parameter controlling input information for <code class="cCode">tpenqueue()</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1042207"> </a>
<code class="cCode">TPNOFLAGS</code> 
</h4><div class="pDefPara"><a name="wp1042208"> </a>
No flags or values are set. No information is taken from the control structure.
</div>
<h4 class="pDefTerm"><a name="wp1042209"> </a>
<code class="cCode">TPQTOP</code> 
</h4><div class="pDefPara"><a name="wp1042210"> </a>
Setting this flag indicates that the queue ordering be overridden and the message placed at the top of the queue. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. <code class="cCode">TPQTOP</code> and <code class="cCode">TPQBEFOREMSGID</code> are mutually exclusive flags.
</div>
<h4 class="pDefTerm"><a name="wp1042211"> </a>
<code class="cCode">TPQBEFOREMSGID</code> 
</h4><div class="pDefPara"><a name="wp1042212"> </a>
Setting this flag indicates that the queue ordering be overridden and the message placed in the queue before the message identified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq18" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. <code class="cCode">TPQTOP</code> and <code class="cCode">TPQBEFOREMSGID</code> are mutually exclusive flags. Note that the entire 32 bytes of the message identifier value are significant, so the value identified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq19" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1755604"> </a>
<code class="cCode">TPQTIME_ABS</code>
</h4><div class="pDefPara"><a name="wp1748049"> </a>
If this flag is set, the message is made available after the time specified by <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq20" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">deq_time</code>. The <code class="cCodeEmphasis">deq_time</code> is an absolute time value as generated by <code class="cCode">time</code>(2), <code class="cCode">mktime</code>(3C), or <a href="rf3c.html#wp1031722"><code class="cCode">gp_mktime(3c)</code></a> (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970). <code class="cCode">TPQTIME_ABS</code> and <code class="cCode">TPQTIME_REL</code> are mutually exclusive flags. The absolute time is determined by the clock on the machine where the queue manager process resides.
</div>
<h4 class="pDefTerm"><a name="wp1042215"> </a>
<code class="cCode">TPQTIME_REL</code>
</h4><div class="pDefPara"><a name="wp1042216"> </a>
If this flag is set, the message is made available after a time relative to the completion of the enqueuing operation. <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq21" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">deq_time</code> specifies the number of seconds to delay after the enqueuing completes before the submitted message should be available. <code class="cCode">TPQTIME_ABS</code> and <code class="cCode">TPQTIME_REL</code> are mutually exclusive flags.
</div>
<h4 class="pDefTerm"><a name="wp1042217"> </a>
<code class="cCode">TPQPRIORITY</code>
</h4><div class="pDefPara"><a name="wp1748052"> </a>
If this flag is set, the priority at which the message should be enqueued is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq22" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">priority</code>. The priority must be in the range 1 to 100, inclusive. The higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). For queues not ordered by priority, this value is informational.
</div>
<div class="pDefParaCont"><a name="wp1589550"> </a>
If this flag is not set, the priority for the message is 50 by default.
</div>
<h4 class="pDefTerm"><a name="wp1042219"> </a>
<code class="cCode">TPQCORRID</code>
</h4><div class="pDefParaCont"><a name="wp1755453"> </a>
If this flag is set, the correlation identifier value specified in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq23" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> is available when a message is dequeued with <code class="cCode">tpdequeue()</code>. This identifier accompanies any reply or failure message that is queued so that an application can correlate a reply with a particular request. Note that the entire 32 bytes of the correlation identifier value are significant, so the value specified in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq24" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">corrid</code> must be completely initialized (for example, padded with NULL characters).
</div>
<h4 class="pDefTerm"><a name="wp1042221"> </a>
<code class="cCode">TPQREPLYQ</code>
</h4><div class="pDefPara"><a name="wp1042222"> </a>
If this flag is set, a reply queue named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq25" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">replyqueue</code> is associated with the queued message. Any reply to the message will be queued to the named queue within the same queue space as the request message. This string must be NULL terminated (maximum 127 characters in length).
</div>
<h4 class="pDefTerm"><a name="wp1042223"> </a>
<code class="cCode">TPQFAILUREQ</code>
</h4><div class="pDefPara"><a name="wp1632951"> </a>
If this flag is set, a failure queue named in the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq26" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">failurequeue</code> is associated with the queued message. If (1) the enqueued message is processed by <code class="cCode">TMQFORWARD()</code>, (2) <code class="cCode">TMQFORWARD</code> was started with the <code class="cCode">-d</code> option, and (3) the service fails and returns a non-NULL reply, a failure message consisting of the reply and its associated <code class="cCode">tpurcode</code> is enqueued to the named queue within the same queue space as the original request message. This string must be NULL-terminated (maximum 127 characters in length).
</div>
<h4 class="pDefTerm"><a name="wp1633985"> </a>
<code class="cCode">TPQDELIVERYQOS</code>, <code class="cCode">TPQREPLYQOS</code>
</h4><div class="pDefPara"><a name="wp1633986"> </a>
If the <code class="cCode">TPQDELIVERYQOS</code> flag is set, the flags specified by <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code> control the quality of service for delivery of the message. In this case, one of three mutually exclusive flags&#8212; <code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;must be set in <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code>. If <code class="cCode">TPQDELIVERYQOS</code> is not set, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<div class="pDefParaCont"><a name="wp1304327"> </a>
If the <code class="cCode">TPQREPLYQOS</code> flag is set, the flags specified by <code class="cCodeEmphasis">ctl-&gt;reply_qos</code> control the quality of service for any reply to the message. In this case, one of three mutually exclusive flags&#8212;<code class="cCode">TPQQOSDEFAULTPERSIST</code>, <code class="cCode">TPQQOSPERSISTENT</code>, or <code class="cCode">TPQQOSNONPERSISTENT</code>&#8212;must be set in <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>. The <code class="cCode">TPQREPLYQOS</code> flag is used when a reply is returned from messages processed by <code class="cCode">TMQFORWARD</code>. Applications not using <code class="cCode">TMQFORWARD</code> to invoke services may use the <code class="cCode">TPQREPLYQOS</code> flag as a hint for their own reply mechanism.
<a name="wp1592900"> </a>
If TPQREPLYQOS is not set, the default delivery policy of the <code class="cCodeEmphasis">ctl-&gt;replyqueue</code> queue dictates the delivery quality of service for any reply. Note that the default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
<a name="wp1303292"> </a>
The following is the list of valid flags for <code class="cCodeEmphasis">ctl-&gt;delivery_qos</code> and <code class="cCodeEmphasis">ctl-&gt;reply_qos</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1303293"> </a>
<code class="cCode">TPQQOSDEFAULTPERSIST</code>
</h4></div>
<div class="pDefPara2"><a name="wp1303294"> </a>
This flag specifies that the message is to be delivered using the default delivery policy specified on the target queue.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1303295"> </a>
<code class="cCode">TPQQOSPERSISTENT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1303296"> </a>
This flag specifies that the message is to be delivered in a persistent manner using the disk-based delivery method. Setting this flag overrides the default delivery policy specified on the target queue.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1303298"> </a>
<code class="cCode">TPQQOSNONPERSISTENT</code>
</h4></div>
<div class="pDefPara2"><a name="wp1303299"> </a>
This flag specifies that the message is to be delivered in a non-persistent manner using the memory-based delivery method. Specifically, the message is queued in memory until it is dequeued. Setting this flag overrides the default delivery policy specified on the target queue. If the caller is transactional, non-persistent messages are enqueued within the caller&#8217;s transaction, however, non-persistent messages are lost if the system is shut down, crashes, or the IPC shared memory for the queue space is removed.
</div><h4 class="pDefTerm"><a name="wp1304340"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>
</h4><div class="pDefPara"><a name="wp1645178"> </a>
If this flag is set, the message has an absolute expiration time, which is the absolute time when the message will be removed from the queue.
<a name="wp1645179"> </a>
The absolute expiration time is determined by the clock on the machine where the queue manager process resides.
</div>
<div class="pDefParaCont"><a name="wp1645151"> </a>
The absolute expiration time is indicated by the value stored in <code class="cCodeEmphasis">ctl-&gt;exp_time</code>. The value of <code class="cCodeEmphasis">ctl-&gt;exp_time</code> must be set to an absolute time value generated by <code class="cCode">time</code>(2), <code class="cCode">mktime</code>(3C), or <a href="rf3c.html#wp1031722"><code class="cCode">gp_mktime(3c)</code></a> (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970).
<a name="wp1645135"> </a>
If an absolute time is specified that is earlier than the time of the enqueue operation, the operation succeeds, but the message is not counted for the purpose of calculating thresholds. If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. If a message expires while it is within a transaction, the expiration does not cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no notification that the message has expired.
<a name="wp1320836"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<h4 class="pDefTerm"><a name="wp1320838"> </a>
<code class="cCode">TPQEXPTIME_REL</code>
</h4><div class="pDefPara"><a name="wp1320839"> </a>
If this flag is set, the message has a relative expiration time, which is the number of seconds <em class="cEmphasis">after</em> the message arrives at the queue that the message is removed from the queue. The relative expiration time is indicated by the value stored in <code class="cCodeEmphasis">ctl-&gt;exp_time</code>.
</div>
<div class="pDefParaCont"><a name="wp1645190"> </a>
If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. The expiration of a message during a transaction, does not cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no acknowledgment that the message has expired.
<a name="wp1320840"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<h4 class="pDefTerm"><a name="wp1320842"> </a>
<code class="cCode">TPQEXPTIME_NONE</code>
</h4><div class="pDefPara"><a name="wp1320843"> </a>
Setting this flag indicates that the message should not expire. This flag overrides any default expiration policy associated with the target queue. A message can be removed by dequeuing it or by deleting it via an administrative interface.
</div>
<div class="pDefParaCont"><a name="wp1320844"> </a>
<code class="cCode">TPQEXPTIME_ABS</code>, <code class="cCode">TPQEXPTIME_REL</code>, and <code class="cCode">TPQEXPTIME_NONE</code> are mutually exclusive flags. If none of these flags is set, the default expiration time associated with the target queue is applied to the message.
</div>
<p class="pBody"><a name="wp1317309"> </a>
Additionally, the <code class="cCodeEmphasis">urcode</code> element of <code class="cCode">TPQCTL</code> can be set with a user-return code. This value will be returned to the application that dequeues the message.
</p>
<p class="pBody"><a name="wp1042226"> </a>
On output from <code class="cCode">tpenqueue()</code>, the following elements may be set in the <code class="cCode">TPQCTL</code> structure:
</p>
<a name="wp1502195"> </a><div class="pPreformatted"><pre>long flags;         /* indicates which of the values  <br />                                * are set */  <br />char msgid[32];                /* ID of enqueued message */  <br />long diagnostic;               /* indicates reason for failure */</pre></div><p class="pBody"><a name="wp1727007"> </a>
The following is a valid bit for the <code class="cCodeEmphasis">flags</code> parameter controlling output information from <code class="cCode">tpenqueue()</code>. If this flag is turned on when <code class="cCode">tpenqueue()</code> is called, the /Q server <a href="../rf5/rf5.html">TMQUEUE(5)</a> populates the associated element in the structure with a message identifier. If this flag is turned off when <code class="cCode">tpenqueue()</code> is called, <code class="cCode">TMQUEUE()</code> does <em class="cEmphasis">not</em> populate the associated element in the structure with a message identifier.
</p>
<h4 class="pDefTerm"><a name="wp1042229"> </a>
<code class="cCode">TPQMSGID</code> 
</h4><div class="pDefPara"><a name="wp1042230"> </a>
If this flag is set and the call to <code class="cCode">tpenqueue()</code> is successful, the message identifier is stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq27" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code>. The entire 32 bytes of the message identifier value are significant, so the value stored in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq28" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">msgid</code> is completely initialized (for example, padded with NULL characters). The actual padding character used for initialization varies between releases of the Oracle Tuxedo ATMI /Q component.
</div>
<p class="pBody"><a name="wp1727011"> </a>
The remaining members of the control structure are not used on input to <code class="cCode">tpenqueue()</code>.
</p>
<p class="pBody"><a name="wp1042231"> </a>
If the call to <code class="cCode">tpenqueue()</code> failed and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq29" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">diagnostic</code>. The possible values are defined below in the Diagnostics section.
</p>
<p class="pBody"><a name="wp1042232"> </a>
If this parameter is NULL, the input flags are considered to be <code class="cCode">TPNOFLAGS</code> and no output information is made available to the application program.
</p>
<h4 class="pHeading3"><a name="wp1042233"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1042234"> </a>
Upon failure, <code class="cCode">tpenqueue()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. Otherwise, the message has been successfully queued when <code class="cCode">tpenqueue()</code> returns.
</p>
<h4 class="pHeading3"><a name="wp1042235"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1042236"> </a>
Upon failure, <code class="cCode">tpenqueue()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1042237"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1042238"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">qspace</code> is NULL, <code class="cCodeEmphasis">data</code> does not point to space allocated with <code class="cCode">tpalloc()</code>, or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1042239"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1591385"> </a>
Cannot access the <code class="cCodeEmphasis">qspace</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp1042241"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854339"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpenqueue()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854340"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854341"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854342"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1042243"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1042244"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1042245"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1042246"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1042247"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1042248"> </a>
<code class="cCode">tpenqueue()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1042249"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1042250"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1042251"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1042252"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1042253"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp1042254"> </a>
Enqueuing a message on the specified queue failed. The reason for failure can be determined by the diagnostic returned via <code class="cCodeEmphasis">ctl</code>.
</div>
<h4 class="pHeading3"><a name="wp1042255"> </a>
Diagnostic
</h4>
<p class="pBody"><a name="wp1042256"> </a>
The following diagnostic values are returned during the enqueuing of a message: 
</p>
<h4 class="pDefTerm"><a name="wp1042257"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1042258"> </a>
An invalid flag value was specified.
</div>
<h4 class="pDefTerm"><a name="wp1042259"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp1042260"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1042261"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp1042262"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp1042263"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1042264"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> flag set and an error occurred trying to start a transaction in which to enqueue the message. This diagnostic is not returned by queue managers from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1042265"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp1042266"> </a>
An invalid message identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp1363667"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1042268"> </a>
A system error occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1042269"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp1042270"> </a>
An operating system error occurred.
</div>
<h4 class="pDefTerm"><a name="wp1042271"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp1042272"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp1042273"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1042274"> </a>
An enqueue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp1042275"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp1042276"> </a>
An invalid or deleted queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1613871"> </a>
[<code class="cCode">QMENOSPACE</code>] 
</h4><div class="pDefPara"><a name="wp1613872"> </a>
Due to an insufficient resource, such as no space on the queue, the message with its required quality of service (persistent or non-persistent storage) was not enqueued. <code class="cCode">QMENOSPACE</code> is returned when any of the following configured resources is exceeded: (1) the amount of disk (persistent) space allotted to the queue space, (2) the amount of memory (non-persistent) space allotted to the queue space, (3) the maximum number of simultaneously active transactions allowed for the queue space, (4) the maximum number of messages that the queue space can contain at any one time, (5) the maximum number of concurrent actions that the Queuing Services component can handle, or (6) the maximum number of authenticated users that may concurrently use the Queuing Services component.
</div>
<h4 class="pDefTerm"><a name="wp1613864"> </a>
[<code class="cCode">QMERELEASE</code>]
</h4><div class="pDefPara"><a name="wp1613865"> </a>
An attempt was made to enqueue a message to a queue manager that is from a version of the Oracle Tuxedo system that does not support a newer feature.
</div>
<h4 class="pDefTerm"><a name="wp1613855"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1613856"> </a>
When enqueuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp1042279"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1344881"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>, <a href="rf3c.html#wp1031722"><code class="cCode">gp_mktime(3c)</code></a>, <a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1041783"><code class="cCode">tpdequeue(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>, <a href="../rf5/rf5.html">APPQ_MIB(5)</a>, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, <a href="../rf5/rf5.html">TMQUEUE(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1257660"> </a>
tpenvelope(3c)
</h3>
<h4 class="pHeading3"><a name="wp1257661"> </a>
Name
</h4>
<p class="pBody"><a name="wp1257662"> </a>
<code class="cCode">tpenvelope()</code>&#8212;Accesses the digital signature and encryption information associated with a typed message buffer. 
</p>
<h4 class="pHeading3"><a name="wp1257663"> </a>
Synopsis
</h4>
<a name="wp1257664"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpenvelope(char *<code class="cCodeEmphasis">data</code>, long <code class="cCodeEmphasis">len</code>, int <code class="cCodeEmphasis">occurrence</code>, TPKEY *<code class="cCodeEmphasis">outputkey</code>, long *<code class="cCodeEmphasis">status</code>, char *<code class="cCodeEmphasis">timestamp</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1257665"> </a>
Description
</h4>
<p class="pBody"><a name="wp1257666"> </a>
<code class="cCode">tpenvelope()</code> provides access to the following types of digital signature and encryption information associated with a typed message buffer:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1519324"> </a>Digital-signature registration requests</li>
<p class="pBodyRelative"><a name="wp1519346"> </a>
A sending process <em class="cEmphasis">explicitly</em> registers a digital signature request for a message buffer by calling <code class="cCode">tpsign()</code>, or <em class="cEmphasis">implicitly</em> registers a digital signature request for a message buffer by calling <code class="cCode">tpkey_open()</code> with the <code class="cCode">TPKEY_AUTOSIGN</code> flag specified.
</p>
<li><a name="wp1519333"> </a>Digital signatures</li>
<p class="pBodyRelative"><a name="wp1527780"> </a>
Just before the message buffer is sent, the public key software generates and attaches a digital signature to the message buffer for each digital-signature registration request; a digital signature enables a receiving process to verify the signer (originator) of the message.
</p>
<li><a name="wp1519334"> </a>Encryption registration requests</li>
<p class="pBodyRelative"><a name="wp1520196"> </a>
A sending process <em class="cEmphasis">explicitly</em> registers an encryption (seal) request for a message buffer by calling <code class="cCode">tpseal()</code>, or <em class="cEmphasis">implicitly</em> registers an encryption (seal) request for a message buffer by calling <code class="cCode">tpkey_open()</code> with the <code class="cCode">TPKEY_AUTOENCRYPT</code> flag specified.
</p>
<li><a name="wp1519338"> </a>Encryption envelopes</li>
<p class="pBodyRelative"><a name="wp1523601"> </a>
Just before the message buffer is sent, the public key software encrypts the message content and attaches an encryption envelope to the message buffer for each encryption registration request; an encryption envelope enables a receiving process to decrypt the message.
</p>
</ul></div>
<p class="pBody"><a name="wp1257667"> </a>
Signature and encryption information is available to both sending and receiving processes. In a sending process, digital signature and encryption information is generally in a pending state, waiting until the message is sent. In a receiving process, digital signatures have already been verified, and encryption and decryption have already been performed. Failures in decryption or signature verification might prevent message delivery, in which case the receiving process never receives the message buffer and therefore has no knowledge of the message buffer.
</p>
<p class="pBody"><a name="wp1257668"> </a>
<code class="cCodeEmphasis">data</code> must point to a valid typed message buffer either (1) previously allocated by a process calling <code class="cCode">tpalloc()</code> or (2) delivered by the system to a receiving process. If the message buffer is self-describing, <code class="cCodeEmphasis">len</code> is ignored (and may be 0). Otherwise, <code class="cCodeEmphasis">len</code> must contain the length of data in <code class="cCodeEmphasis">data</code>.
</p>
<p class="pBody"><a name="wp1518777"> </a>
There may be multiple occurrences of digital-signature registration requests, digital signatures, encryption registration requests, and encryption envelopes associated with a message buffer. The occurrences are stored in sequence, with the first item at the zero position and subsequent items in consecutive positions. The <code class="cCodeEmphasis">occurrence</code> input parameter indicates which item is requested. When the value of <code class="cCodeEmphasis">occurrence</code> is beyond the position of the last item, <code class="cCode">tpenvelope()</code> fails with the <code class="cCode">TPENOENT</code> error condition. All items may be examined by calling <code class="cCode">tpenvelope()</code> repeatedly until <code class="cCode">TPENOENT</code> is returned.
</p>
<p class="pBody"><a name="wp1513997"> </a>
The handle to the key associated with a digital-signature registration request, digital signature, encryption registration request, or encryption envelope is returned via <code class="cCodeEmphasis">outputkey</code>. The key handle returned is a separate copy of the original key opened by calling <code class="cCode">tpkey_open()</code>. Properties of the key, such as the <code class="cCode">PRINCIPAL</code> attribute parameter, can be obtained by calling <code class="cCode">tpkey_getinfo()</code>. It is the caller&#8217;s responsibility to release key handle <code class="cCodeEmphasis">outputkey</code> by calling <code class="cCode">tpkey_close()</code>.
</p>
<a name="wp1580833"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If <code class="cCodeEmphasis">outputkey</code> is NULL, no key handle is returned.</td>
</tr>
</table>

<p class="pBody"><a name="wp1257671"> </a>
The <code class="cCodeEmphasis">status</code> output parameter reports the state of the digital-signature registration request, digital signature, encryption registration request, or encryption envelope. If the value of the status is not NULL, it is set to one of the following states:
</p>
<h4 class="pDefTerm"><a name="wp1518546"> </a>
<code class="cCode">TPSIGN_PENDING</code>
</h4><div class="pDefPara"><a name="wp1518547"> </a>
A digital signature has been requested on behalf of the <em class="cEmphasis">signer</em> principal associated with the corresponding private key, and will be generated when the message buffer is transmitted from this process.
</div>
<h4 class="pDefTerm"><a name="wp1257680"> </a>
<code class="cCode">TPSIGN_OK</code>
</h4><div class="pDefPara"><a name="wp1257681"> </a>
The digital signature has been verified.
</div>
<h4 class="pDefTerm"><a name="wp1518154"> </a>
<code class="cCode">TPSIGN_TAMPERED_MESSAGE</code>
</h4><div class="pDefPara"><a name="wp1518155"> </a>
The digital signature is not valid because the content of the message buffer has been altered.
</div>
<h4 class="pDefTerm"><a name="wp1518161"> </a>
<code class="cCode">TPSIGN_TAMPERED_CERT</code>
</h4><div class="pDefPara"><a name="wp1518162"> </a>
The digital signature is not valid because the signer&#8217;s digital certificate has been altered.
</div>
<h4 class="pDefTerm"><a name="wp1518168"> </a>
<code class="cCode">TPSIGN_REVOKED_CERT</code>
</h4><div class="pDefPara"><a name="wp1518169"> </a>
The digital signature is not valid because the signer&#8217;s digital certificate has been revoked.
</div>
<h4 class="pDefTerm"><a name="wp1518175"> </a>
<code class="cCode">TPSIGN_POSTDATED</code>
</h4><div class="pDefPara"><a name="wp1518176"> </a>
The digital signature is not valid because its timestamp is too far into the future.
</div>
<h4 class="pDefTerm"><a name="wp1518182"> </a>
<code class="cCode">TPSIGN_EXPIRED_CERT</code>
</h4><div class="pDefPara"><a name="wp1518183"> </a>
The digital signature is not valid because the signer&#8217;s digital certificate has expired.
</div>
<h4 class="pDefTerm"><a name="wp1518189"> </a>
<code class="cCode">TPSIGN_EXPIRED</code>
</h4><div class="pDefPara"><a name="wp1518190"> </a>
The digital signature is not valid because its timestamp is too old.
</div>
<h4 class="pDefTerm"><a name="wp1257684"> </a>
<code class="cCode">TPSIGN_UNKNOWN</code>
</h4><div class="pDefPara"><a name="wp1518195"> </a>
The digital signature is not valid because the signer&#8217;s digital certificate was issued by an unknown Certification Authority (CA).
</div>
<h4 class="pDefTerm"><a name="wp1518211"> </a>
<code class="cCode">TPSEAL_PENDING</code>
</h4><div class="pDefPara"><a name="wp1518212"> </a>
An encryption (seal) has been requested for the <em class="cEmphasis">recipient</em> principal associated with the corresponding public key, and will be performed when the message buffer is transmitted from this process.
</div>
<h4 class="pDefTerm"><a name="wp1518196"> </a>
<code class="cCode">TPSEAL_OK</code>
</h4><div class="pDefPara"><a name="wp1518197"> </a>
The encryption envelope is valid.
</div>
<h4 class="pDefTerm"><a name="wp1518259"> </a>
<code class="cCode">TPSEAL_TAMPERED_CERT</code>
</h4><div class="pDefPara"><a name="wp1518260"> </a>
The encryption envelope is not valid because the recipient&#8217;s digital certificate has been altered.
</div>
<h4 class="pDefTerm"><a name="wp1518218"> </a>
<code class="cCode">TPSEAL_REVOKED_CERT</code>
</h4><div class="pDefPara"><a name="wp1518219"> </a>
The encryption envelope is not valid because the recipient&#8217;s digital certificate has been revoked.
</div>
<h4 class="pDefTerm"><a name="wp1517335"> </a>
<code class="cCode">TPSEAL_EXPIRED_CERT</code>
</h4><div class="pDefPara"><a name="wp1517336"> </a>
The encryption envelope is not valid because the recipient&#8217;s digital certificate has expired.
</div>
<h4 class="pDefTerm"><a name="wp1518247"> </a>
<code class="cCode">TPSEAL_UNKNOWN</code>
</h4><div class="pDefPara"><a name="wp1518636"> </a>
The encryption envelope is not valid because the recipient&#8217;s digital certificate was issued by an unknown CA.
</div>
<p class="pBody"><a name="wp1518637"> </a>
The <code class="cCodeEmphasis">timestamp</code> output parameter contains the digital signature&#8217;s timestamp according to the local clock on the machine where the digital signature was generated. The integrity of this value is protected by the associated digital signature. The memory location indicated by <code class="cCodeEmphasis">timestamp</code> is set to the NULL-terminated signature time in format <code class="cCode">YYYYMMDDHHMMSS</code>, where <code class="cCode">YYYY</code>=year, <code class="cCode">MM</code>=month, <code class="cCode">DD</code>=day, <code class="cCode">HH</code>=hour, <code class="cCode">MM</code>=minute, and <code class="cCode">SS</code>=second. <code class="cCodeEmphasis">timestamp</code> may be NULL, in which case no value is returned. Encryption seals do not contain timestamps, and the memory location indicated by <code class="cCodeEmphasis">timestamp</code> is unchanged.
</p>
<p class="pBody"><a name="wp1257699"> </a>
The <code class="cCodeEmphasis">flags</code> parameter may be set to one of the following values:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1257700"> </a><code class="cCode">TPKEY_REMOVE</code>&#8211; The item at position <code class="cCodeEmphasis">occurrence</code> is removed (that is, it is no longer associated with the buffer). Output parameters <code class="cCodeEmphasis">outputkey</code>, <code class="cCodeEmphasis">status</code>, and <code class="cCodeEmphasis">timestamp</code> related to the item are captured before the item is removed. Items at subsequent positions are shifted down by one, so there are never any gaps in the numbering of <code class="cCodeEmphasis">occurrence</code>.</li>
<li><a name="wp1257701"> </a><code class="cCode">TPKEY_REMOVEALL</code>&#8211; All items associated with the message buffer are removed. The output parameters <code class="cCodeEmphasis">outputkey</code>, <code class="cCodeEmphasis">status</code>, and <code class="cCodeEmphasis">timestamp</code> are not returned.</li>
<li><a name="wp1257702"> </a><code class="cCode">TPKEY_VERIFY</code>&#8211; All digital signatures associated with the message buffer are reverified. The status of a signature may change after reverification. For example, if a message buffer has been modified by a receiving process, the status of the originator&#8217;s signature changes from <code class="cCode">TPSIGN_OK</code> to <code class="cCode">TPSIGN_TAMPERED_MESSAGE</code>.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1257703"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1257704"> </a>
On failure, this function returns <code class="cCode">-1</code> and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1257705"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1257706"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1257707"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">data</code> is NULL or the value assigned to <code class="cCodeEmphasis">flags</code> is unrecognized.
</div>
<h4 class="pDefTerm"><a name="wp1257708"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1257709"> </a>
This <code class="cCodeEmphasis">occurrence</code> does not exist. 
</div>
<h4 class="pDefTerm"><a name="wp1257710"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1257711"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1257712"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1257713"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>, <a href="rf3c.html#wp1261252"><code class="cCode">tpseal(3c)</code></a>, <a href="rf3c.html#wp1261719"><code class="cCode">tpsign(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021798"> </a>
tperrordetail(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021799"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021800"> </a>
<code class="cCode">tperrordetail()</code>&#8212;Gets additional detail about an error generated from the last Oracle Tuxedo ATMI system call.
</p>
<h4 class="pHeading3"><a name="wp1021801"> </a>
Synopsis
</h4>
<a name="wp1021802"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tperrordetail(long flags)</pre></div><h4 class="pHeading3"><a name="wp1021803"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021804"> </a>
<code class="cCode">tperrordetail()</code> returns additional detail related to an error produced by the last Oracle Tuxedo ATMI system routine called in the current thread. <code class="cCode">tperrordetail()</code> returns a numeric value that is also represented by a symbolic name. If the last Oracle Tuxedo ATMI system routine called in the current thread did not produce an error, then <code class="cCode">tperrordetail()</code> will return zero. Therefore, <code class="cCode">tperrordetail()</code> should be called after an error has been indicated; that is, when <code class="cCode">tperrno</code> has been set.
</p>
<p class="pBody"><a name="wp1021805"> </a>
Currently <code class="cCodeEmphasis">flags</code> is reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1617697"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tperrordetail()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1021806"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021807"> </a>
Upon failure, <code class="cCode">tperrordetail()</code> returns a <code class="cCode">-1</code> and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<p class="pBody"><a name="wp1021808"> </a>
These are the symbolic names and meaning for each numeric value that <code class="cCode">tperrordetail()</code> may return. The order in which these are listed is not significant and does not imply precedence.
</p>
<h4 class="pDefTerm"><a name="wp1731440"> </a>
<code class="cCode">TPED_CLIENTDISCONNECTED</code>
</h4><div class="pDefPara"><a name="wp1731441"> </a>
A Jolt client is disconnected currently. The <code class="cCode">TPACK</code> flag is used in a <code class="cCode">tpnotify()</code> call and the target of <code class="cCode">tpnotify()</code> is a currently disconnected Jolt client. When <code class="cCode">tpnotify()</code> fails, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_CLIENTDISCONNECTED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1738947"> </a>
<code class="cCode">TPED_DECRYPTION_FAILURE</code>
</h4><div class="pDefPara"><a name="wp1739006"> </a>
A process receiving an encrypted message cannot decrypt the message. This error most likely occurs because the process does not have access to the private key required to decrypt the message.
</div>
<div class="pDefParaCont"><a name="wp1738949"> </a>
When a call fails due to this error, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_DECRYPTION_FAILURE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1731442"> </a>
<code class="cCode">TPED_DOMAINUNREACHABLE</code>
</h4><div class="pDefPara"><a name="wp1731443"> </a>
A domain is unreachable. Specifically, a domain configured to satisfy a request that a local domain cannot service was not reachable when a request was made. After the request failure, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_DOMAINUNREACHABLE</code>.
</div>
<div class="pDefParaCont"><a name="wp1731444"> </a>
The following table indicates the corresponding values returned by <code class="cCode">tperrno</code> when calls to <code class="cCode">tpcall()</code>, <code class="cCode">tpgetrply()</code>, or <code class="cCode">tprecv()</code> fail because of an unreachable domain. The error detail returned by a subsequent call to <code class="cCode">tperrordetail()</code> is <code class="cCode">TPED_DOMAINUNREACHABLE</code>.
<p class="pGraphic"><a name="wp1731470"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1731447table1731445">
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1731447"> </a>
ATMI Call
</div>
</td>
    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1731449"> </a>
tperrno
</div>
</td>
    <td class="table" scope="row"><div class="pCellHeading"><a name="wp1731451"> </a>
Error Detail
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731453"> </a>
<code class="cCode">tpcall</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731455"> </a>
<code class="cCode">TPESVCERR</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731457"> </a>
<code class="cCode">TPED_DOMAINUNREACHABLE</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731459"> </a>
<code class="cCode">tpgetrply</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731461"> </a>
<code class="cCode">TPESVCERR</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731463"> </a>
<code class="cCode">TPED_DOMAINUNREACHABLE</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731465"> </a>
<code class="cCode">tprecv</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731467"> </a>
<code class="cCode">TPEEVENT TPEV_SVCERR</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1731469"> </a>
<code class="cCode">TPED_DOMAINUNREACHABLE</code>
</div>
</td>
</tr>
</table>
</div>

</p>
</div>
<div class="pDefPara"><a name="wp1731471"> </a>
Note that the <code class="cCode">TPED_DOMAINUNREACHABLE</code> feature applies to Oracle Tuxedo Domains only. It does not apply to other domains products such as Connect OSI TP Domains and Connect SNA Domains.
</div>
<h4 class="pDefTerm"><a name="wp1738314"> </a>
<code class="cCode">TPED_INVALID_CERTIFICATE</code>
</h4><div class="pDefPara"><a name="wp1738315"> </a>
A process receiving a digitally signed message cannot verify the digital signature because the associated digital certificate is invalid. This error most likely occurs because the digital certificate has expired, the digital certificate was issued by an unknown Certification Authority (CA), or the digital certificate has been altered.
</div>
<div class="pDefParaCont"><a name="wp1738316"> </a>
When a call fails due to this error, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_INVALID_CERTIFICATE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1738322"> </a>
<code class="cCode">TPED_INVALID_SIGNATURE</code>
</h4><div class="pDefPara"><a name="wp1739002"> </a>
A process receiving a digitally signed message cannot verify the digital signature because the signature is invalid. This error most likely occurs because the message has been altered, the timestamp for the digital signature is too old, or the timestamp for the digital signature is too far into the future.
</div>
<div class="pDefParaCont"><a name="wp1738324"> </a>
When a call fails due to this error, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_INVALID_SIGNATURE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1735049"> </a>
<code class="cCode">TPED_INVALIDCONTEXT</code>
</h4><div class="pDefPara"><a name="wp1735050"> </a>
A thread is blocked in an ATMI call when another thread terminates its context. Specifically, any thread blocked in an ATMI call when another thread terminates its context will return from the ATMI call with a failure return; <code class="cCode">tperrno</code> is set to <code class="cCode">TPESYSTEM</code>. A subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_INVALIDCONTEXT</code>.
</div>
<h4 class="pDefTerm"><a name="wp1814421"> </a>
<code class="cCode">TPED_INVALID_XA_TRANSACTION</code>
</h4><div class="pDefPara"><a name="wp1814422"> </a>
An attempt was made to start a transaction but the <code class="cCode">NO_XA</code> flag was turned on in this domain.
</div>
<h4 class="pDefTerm"><a name="wp1735076"> </a>
<code class="cCode">TPED_NOCLIENT</code>
</h4><div class="pDefPara"><a name="wp1735077"> </a>
No client exists. The <code class="cCode">TPACK</code> flag is used in a <code class="cCode">tpnotify()</code> call but there is no target for <code class="cCode">tpnotify()</code>. When <code class="cCode">tpnotify()</code> fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPENOENT</code>. A subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_NOCLIENT</code>.
</div>
<h4 class="pDefTerm"><a name="wp1734413"> </a>
<code class="cCode">TPED_NOUNSOLHANDLER</code>
</h4><div class="pDefPara"><a name="wp1734414"> </a>
A client does not have an unsolicited handler set. The <code class="cCode">TPACK</code> flag is used in a <code class="cCode">tpnotify()</code> call and the target of the <code class="cCode">tpnotify()</code> is in an Oracle Tuxedo ATMI session, but it has not set an unsolicited notification handler. When <code class="cCode">tpnotify()</code> fails, <code class="cCode">tperrno</code> is set to <code class="cCode">TPENOENT</code>. A subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_NOUNSOLHANDLER</code>.
</div>
<h4 class="pDefTerm"><a name="wp2470989"> </a>
<code class="cCode">TPED_RDMA_MSGQDAEMON</code>
</h4><div class="pDefPara"><a name="wp2470990"> </a>
<code class="cCode">RDMA Msgq_daemon</code> failure. When RDMA is enabled, requests sent through RDMA fails when the RDMA daemon process (<code class="cCode">Msgq_daemon</code>), encounters a serious problem. <code class="cCode">tperrno</code> then returns <code class="cCode">TPEOS/TPETIME</code>, and a subsequent call to t<code class="cCode">perrordetail()</code> with no intermediate ATMI calls returns <code class="cCode">TPED_RDMA_MSGQDAEMON</code>.
</div>
<div class="pDefParaCont"><a name="wp2470991"> </a>
The request failure could be encountered by the following calls:
<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp2470992"> </a><code class="cCode">tpcall/tpacall/tpgetrply/tpadmcall/tpforward</code></li>
<li><a name="wp2470993"> </a><code class="cCode">tpinit/tpappthrinit</code></li>
<li><a name="wp2470994"> </a><code class="cCode">tpbegin/tpcommit/tpscmt/tpabort/tpsuspend/tpresume</code></li>
<li><a name="wp2470995"> </a><code class="cCode">tpconnect/tpsend/tprecv/tpdiscon</code></li>
<li><a name="wp2470996"> </a><code class="cCode">tpbroadcast/tpnotify</code></li>
<li><a name="wp2470997"> </a><code class="cCode">tpenqueue/tpdequeue</code></li>
<li><a name="wp2470998"> </a><code class="cCode">tpsubscribe/tpunsubscribe/tppost</code></li>
</ul></div>
</div>
<h4 class="pDefTerm"><a name="wp2465172"> </a>
<code class="cCode">TPED_RDMA_INVALIDQUEUE</code>
</h4><div class="pDefPara"><a name="wp2465173"> </a>
Invalid RDMA queue. When RDMA is enabled, <code class="cCode">Msgq_daemon</code> shared memory may cause an internal error. After the request failure, <code class="cCode">tperrno</code> returns <code class="cCode">TPEOS</code>, and a subsequent call to t<code class="cCode">perrordetail()</code> with no intermediate ATMI calls return <code class="cCode">TPED_RDMA_INVALIDQUEUE</code>. Refer to <code class="cCode">TPED_RDMA_MSGQDAEMON</code>  for the calls that could encounter this failure.
</div>
<h4 class="pDefTerm"><a name="wp2465184"> </a>
<code class="cCode">TPED_RDMA_NOMEMORY</code>
</h4><div class="pDefPara"><a name="wp2471257"> </a>
Not enough shared memory to handle RDMA request. When RDMA is enabled and <code class="cCode">Msgq_daemon</code> starts without enough shared memory, an internal error may develop; <code class="cCode">tperrno</code> then returns <code class="cCode">TPEOS</code>. A subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_RDMA_NOMEMORY</code>. Refer to <code class="cCode">TPED_RDMA_MSGQDAEMON</code>  for the calls that may possibly encounter this failure.
</div>
<h4 class="pDefTerm"><a name="wp1021809"> </a>
<code class="cCode">TPED_SVCTIMEOUT</code>
</h4><div class="pDefPara"><a name="wp1026424"> </a>
A server was terminated due to a service timeout. The service timeout is controlled by the value of <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in <code class="cCode">T_SERVER</code> and <code class="cCode">T_SERVICE</code> classes in the <code class="cCode">TM_MIB</code>. When a call fails due to this error, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_SVCTIMEOUT</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021810"> </a>
<code class="cCode">TPED_TERM</code>
</h4><div class="pDefPara"><a name="wp1150817"> </a>
A Workstation client has been disconnected from the application. When a call fails due to this error, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls will return <code class="cCode">TPED_TERM</code>.
</div>
<h4 class="pHeading3"><a name="wp1155806"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1155802"> </a>
Upon failure, <code class="cCode">tperrordetail()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1021813"> </a>
<code class="cCode">TPEINVAL</code>
</h4><div class="pDefPara"><a name="wp1026432"> </a>
<code class="cCodeEmphasis">flags</code> not set to zero
</div>
<h4 class="pHeading3"><a name="wp1480729"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1480730"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>, <a href="../rf5/rf5.html">tperrno(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1480731"> </a>
tpexport(3c)
</h3>
<h4 class="pHeading3"><a name="wp1259182"> </a>
Name
</h4>
<p class="pBody"><a name="wp1259183"> </a>
<code class="cCode">tpexport()</code>&#8212;Converts a typed message buffer into an exportable, machine-independent string representation, that includes digital signatures and encryption envelopes.
</p>
<h4 class="pHeading3"><a name="wp1259184"> </a>
Synopsis
</h4>
<a name="wp1259185"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpexport(char *<code class="cCodeEmphasis">ibuf</code>, long <code class="cCodeEmphasis">ilen</code>, char *<code class="cCodeEmphasis">ostr</code>, long *<code class="cCodeEmphasis">olen</code>, <br />long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1259186"> </a>
Description
</h4>
<p class="pBody"><a name="wp1259187"> </a>
<code class="cCode">tpexport()</code> converts a typed message buffer into an externalized representation. An externalized representation is a message buffer that does <em class="cEmphasis">not</em> include any Oracle Tuxedo ATMI header information that is normally added to a message buffer just before the buffer is transmitted.
</p>
<p class="pBody"><a name="wp1259188"> </a>
The externalized representation may be transmitted between processes, machines, or Oracle Tuxedo ATMI applications via any communication mechanism. It may be archived on permanent storage, and remains valid after a system shutdown and reboot.
</p>
<p class="pBody"><a name="wp1259189"> </a>
An externalized representation includes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1259190"> </a>Any digital signatures associated with <code class="cCodeEmphasis">ibuf</code>. They are verified later when the buffer is imported.</li>
<li><a name="wp1259191"> </a>Any encryption envelopes associated with <code class="cCodeEmphasis">ibuf</code>. The buffer content remains protected by encryption. Only specified recipients with access to a valid private key for decryption may later import the buffer.</li>
</ul></div>
<p class="pBody"><a name="wp1259192"> </a>
<code class="cCodeEmphasis">ibuf</code> must point to a valid typed message buffer either (1) previously allocated by a process calling <code class="cCode">tpalloc()</code> or (2) delivered by the system to a receiving process. <code class="cCodeEmphasis">ilen</code> specifies how much of <code class="cCodeEmphasis">ibuf</code> to export. Note that if <code class="cCodeEmphasis">ibuf</code> points to a buffer type for which a length need not be specified (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">ilen</code> is ignored (and may be 0).
</p>
<p class="pBody"><a name="wp1259193"> </a>
<code class="cCodeEmphasis">ostr</code> is a pointer to the output area that will hold an externalized representation of the buffer&#8217;s content and associated properties. If <code class="cCode">TPEX_STRING</code> is set in <code class="cCodeEmphasis">flags</code>, then the externalized format will be a string type. Otherwise, the output length is determined by *<code class="cCodeEmphasis">olen</code> and may contain embedded NULL bytes.
</p>
<p class="pBody"><a name="wp1259194"> </a>
On input, *<code class="cCodeEmphasis">olen</code> specifies the maximum storage size available at <code class="cCodeEmphasis">ostr</code>. On output *<code class="cCodeEmphasis">olen</code> is set to the actual number of bytes written to <code class="cCodeEmphasis">ostr</code> (including a terminating NULL character if <code class="cCode">TPEX_STRING</code> is set in <code class="cCodeEmphasis">flags</code>).
</p>
<p class="pBody"><a name="wp1259195"> </a>
The <code class="cCodeEmphasis">flags</code> argument may be set to <code class="cCode">TPEX_STRING</code> if string format (base 64 encoded) is desired for the output buffer. Otherwise, the output will be binary.
</p>
<h4 class="pHeading3"><a name="wp1259196"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1259197"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1259198"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1259199"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1259200"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">ibuf</code> is NULL or the value of <code class="cCodeEmphasis">flags</code> is not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1259201"> </a>
[<code class="cCode">TPEPERM</code>]
</h4><div class="pDefPara"><a name="wp1259202"> </a>
Permission failure. The cryptographic service provider was not able to access a private key necessary to produce a digital signature.
</div>
<h4 class="pDefTerm"><a name="wp1259203"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1259204"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pDefTerm"><a name="wp1259205"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1259206"> </a>
Insufficient output storage was provided. *<code class="cCodeEmphasis">olen</code> is set to the necessary amount of space.
</div>
<h4 class="pHeading3"><a name="wp1259207"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1259208"> </a>
<a href="rf3c.html#wp1259847"><code class="cCode">tpimport(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1987733"> </a>
tpfml32toxml(3c)
</h3>
<h4 class="pHeading3"><a name="wp2005939"> </a>
Name
</h4>
<p class="pBody"><a name="wp2005940"> </a>
<code class="cCode">tpfml32toxml()</code>&#8212;Converts FML32 buffers to XML data
</p>
<h4 class="pHeading3"><a name="wp2005941"> </a>
Synopsis
</h4>
<a name="wp2177831"> </a><div class="pPreformatted"><pre>#include &lt;fml32.h&gt;<br />int tpfml32toxml (FBFR32 *fml32bufp, char *vfile, char *rtag, char **xmlbufp, long flags) </pre></div><h4 class="pHeading3"><a name="wp1989572"> </a>
Description
</h4>
<p class="pBody"><a name="wp2177906"> </a>
This function is used to convert FML32 buffers to XML data. It supports the following valid arguments:
</p>
<h4 class="pDefTerm"><a name="wp2177907"> </a>
<code class="cCode">fml32bufp</code>
</h4><div class="pDefPara"><a name="wp2177908"> </a>
This argument is a pointer to an input FML32 typed buffer.
</div>
<h4 class="pDefTerm"><a name="wp2194440"> </a>
<code class="cCode">vfile</code>
</h4><div class="pDefPara"><a name="wp2194441"> </a>
This argument is not used for FML32 to XML conversion at this time. It is reserved for the fully qualified path name of an XML Schema file used to validate XML output when this capability is supported by Xerces.
</div>
<h4 class="pDefTerm"><a name="wp2194442"> </a>
<code class="cCode">rtag</code>
</h4><div class="pDefPara"><a name="wp2194443"> </a>
The argument is a pointer to the input root element name for the output XML document.When a root element name is specified during conversion, it is identified and saved for use as an XML root tag with an optional <code class="cCode">Type</code> attribute added to the root element name. If the input root name is not specified, then the default output XML root tag &lt;FML32&gt; is used.
</div>
<h4 class="pDefTerm"><a name="wp2194444"> </a>
<code class="cCode">xmlbufp</code>
</h4><div class="pDefPara"><a name="wp2194445"> </a>
This argument is a pointer to an output XML typed buffer in a pre-defined format for describing FML32 fielded buffers.
</div>
<h4 class="pDefTerm"><a name="wp2194446"> </a>
<code class="cCode">flag</code>
</h4><div class="pDefPara"><a name="wp2194447"> </a>
This argument is not used for FML32 to XML conversion at this time and should be set to 0.
</div>
<h4 class="pHeading3"><a name="wp2194448"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2194449"> </a>
Upon success,<code class="cCode"> tpfml32toxml()</code> returns <code class="cCode">0</code>. This function returns <code class="cCode">-1</code> on error and sets <code class="cCode">tperrno</code> to indicate the error condition. 
</p>
<h4 class="pHeading3"><a name="wp2194450"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2194451"> </a>
Upon failure, <code class="cCode">tpfml32toxml()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2194452"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp2194453"> </a>
Either <code class="cCode">fml32bufp</code> or <code class="cCode">xmlbufp</code> is not a valid typed buffer.
</div>
<h4 class="pDefTerm"><a name="wp2194456"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2194457"> </a>
A Tuxedo system error has occurred. The exact nature of the error is written to <code class="cCode">userlog(3)</code>. This will also indicate when a conversion to XML was unable to be done. In that instance error detail info will be added to the userlog.
</div>
<h4 class="pDefTerm"><a name="wp2194458"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp2194459"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in Uunixerr.
</div>
<h4 class="pHeading3"><a name="wp2152898"> </a>
SEE ALSO
</h4>
<p class="pBody"><a name="wp2152899"> </a>
<a href="rf3c.html#wp2009111"><code class="cCode">tpxmltofml32(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2011500"><code class="cCode">tpxmltofml(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2178284"><code class="cCode">tpfmltoxml(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2178284"> </a>
tpfmltoxml(3c)
</h3>
<h4 class="pHeading3"><a name="wp2006746"> </a>
Name
</h4>
<p class="pBody"><a name="wp2006747"> </a>
<code class="cCode">tpfmltoxml()</code>&#8212;Converts FML buffers to XML data
</p>
<h4 class="pHeading3"><a name="wp2007327"> </a>
Synopsis
</h4>
<a name="wp2178396"> </a><div class="pPreformatted"><pre>#include &lt;fml.h&gt;<br />int tpfmltoxml (FBFR *fmlbufp, char *vfile, char *rtag, char **xmlbufp, long flags)</pre></div><h4 class="pHeading3"><a name="wp2007332"> </a>
Description
</h4>
<p class="pBody"><a name="wp2178408"> </a>
This function is used to convert FML buffers to XML data. It supports the following valid arguments:
</p>
<h4 class="pDefTerm"><a name="wp2194580"> </a>
<code class="cCode">fmlbufp</code>
</h4><div class="pDefPara"><a name="wp2194581"> </a>
The argument is a pointer to an input FML typed buffer.
</div>
<p class="pBody"><a name="wp2194582"> </a>
<code class="cCode">vfile</code>
</p>
<div class="pDefPara"><a name="wp2194583"> </a>
The argument is not used for FML to XML conversion at this time. It is reserved for the fully qualified path name of an XML Schema file used to validate XML output when this capability is supported by Xerces.
</div>
<p class="pBody"><a name="wp2194584"> </a>
<code class="cCode">rtag</code>
</p>
<div class="pDefPara"><a name="wp2194585"> </a>
This argument is a pointer to the input root element name for the output XML document.When a root element name is specified during conversion, it is identified and saved for use as an XML root tag with an optional <code class="cCode">Type</code> attribute added to the root element name. If the input root name is not specified, then the default output XML root tag <code class="cCode">&lt;FML&gt;</code> is used.
</div>
<h4 class="pDefTerm"><a name="wp2194586"> </a>
<code class="cCode">xmlbufp</code>
</h4><div class="pDefPara"><a name="wp2194587"> </a>
This argument is a pointer to an output XML typed buffer in a pre-defined format for describing FML fielded buffers.
</div>
<h4 class="pDefTerm"><a name="wp2194588"> </a>
<code class="cCode">flag</code>
</h4><div class="pDefPara"><a name="wp2194589"> </a>
This argument is not used for FML to XML conversion at this time and should be set to <code class="cCode">0</code>. 
</div>
<h4 class="pHeading3"><a name="wp2194601"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2194602"> </a>
Upon success, <code class="cCode">tpfmltoxml()</code> returns <code class="cCode">0</code>. This function returns <code class="cCode">-1</code> on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2194603"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2194604"> </a>
Upon failure, <code class="cCode">tpfmltoxml()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2194605"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp2194606"> </a>
Either <code class="cCode">fml32bufp</code> or <code class="cCode">xmlbufp</code> is not a valid typed buffer.
</div>
<h4 class="pDefTerm"><a name="wp2194609"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2194610"> </a>
A Tuxedo system error has occurred. The exact nature of the error is written to <code class="cCode">userlog(3)</code>. This will also indicate when a conversion to XML was unable to be done. In that instance error detail info will be added to the userlog.
</div>
<h4 class="pDefTerm"><a name="wp2194611"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2194612"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in Uunixerr.
</div>
<h4 class="pHeading3"><a name="wp2194613"> </a>
SEE ALSO
</h4>
<p class="pBody"><a name="wp2194614"> </a>
<a href="rf3c.html#wp2009111"><code class="cCode">tpxmltofml32(3c)</code></a><code class="cCode">,</code><a href="rf3c.html#wp1987733"><code class="cCode">tpfml32toxml(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2011500"><code class="cCode">tpxmltofml(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2006034"> </a>
tpforward(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021836"> </a>
Name
</h4>
<p class="pBody"><a name="wp1989510"> </a>
<code class="cCode">tpforward()</code>&#8212;Routine for forwarding a service request to another service routine.
</p>
<h4 class="pHeading3"><a name="wp1989512"> </a>
Synopsis
</h4>
<a name="wp1021839"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />void tpforward(char *svc, char *data, long len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1021840"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021841"> </a>
<code class="cCode">tpforward()</code> allows a service routine to forward a client&#8217;s request to another service routine for further processing. <code class="cCode">tpforward()</code> acts like <code class="cCode">tpreturn()</code> in that it is the last call made in a service routine. Like <code class="cCode">tpreturn()</code>, <code class="cCode">tpforward()</code> should be called from within the service routine dispatched to ensure correct return of control to the Oracle Tuxedo ATMI system dispatcher. <code class="cCode">tpforward()</code> cannot be called from within a conversational service.
</p>
<p class="pBody"><a name="wp1021842"> </a>
This function forwards a request to the service named by <code class="cCodeEmphasis">svc</code> using data pointed to by <code class="cCodeEmphasis">data</code>. The service name must not begin with a dot. A service routine forwarding a request receives no reply. After the request is forwarded, the service routine returns to the communication manager dispatcher and the server is free to do other work. Note that because no reply is expected from a forwarded request, the request may be forwarded without error to any service routine in the same executable as the service that forwarded the request.
</p>
<p class="pBody"><a name="wp1021843"> </a>
If the service routine is in transaction mode, <code class="cCode">tpforward()</code> puts the caller portion of the transaction in a state where it may be completed when the originator of the transaction issues either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. If a transaction was explicitly started with <code class="cCode">tpbegin()</code> while in a service routine, the transaction must be ended with either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> before calling <code class="cCode">tpforward()</code>. Thus, all services in a &#8220;forward chain&#8221; are either all started in transaction mode or none are.
</p>
<p class="pBody"><a name="wp1021844"> </a>
The last server in a forward chain sends a reply back to the originator of the request using <code class="cCode">tpreturn()</code>. In essence, <code class="cCode">tpforward()</code> transfers to another server the responsibility of sending a reply back to the awaiting requester.
</p>
<p class="pBody"><a name="wp1021845"> </a>
<code class="cCode">tpforward()</code> should be called after receiving all replies expected from service requests initiated by the service routine. Any outstanding replies which are not received will automatically be dropped by the communication manager dispatcher upon receipt. In addition, the descriptors for those replies become invalid and the request is not forwarded to <code class="cCodeEmphasis">svc</code>.
</p>
<p class="pBody"><a name="wp1021846"> </a>
<code class="cCodeEmphasis">data</code> points to the data portion of a reply to be sent. If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously obtained by a call to <code class="cCode">tpalloc()</code>. If this is the same buffer passed to the service routine upon its invocation, then its disposition is up to the Oracle Tuxedo ATMI system dispatcher; the service routine writer does not have to worry about whether it is freed or not. In fact, any attempt by the user to free this buffer will fail. However, if the buffer passed to <code class="cCode">tpforward()</code> is not the same one with which the service is invoked, then <code class="cCode">tpforward()</code> will free that buffer. <code class="cCodeEmphasis">len</code> specifies the amount of the data buffer to be sent. If <code class="cCodeEmphasis">data</code> points to a buffer which does not require a length to be specified, (for example, an FML fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and can be 0). If <code class="cCodeEmphasis">data</code> is NULL, then <code class="cCodeEmphasis">len</code> is ignored and a request with zero length data is sent.
</p>
<p class="pBody"><a name="wp1021847"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and should be set to 0 (zero).
</p>
<h4 class="pHeading3"><a name="wp1021848"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021849"> </a>
A service routine does not return any value to its caller, the communication manager dispatcher. Thus, <code class="cCode">tpforward()</code> is declared as a void. See <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a> for a more extensive discussion.
</p>
<h4 class="pHeading3"><a name="wp1021850"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1169831"> </a>
If any errors occur either in the handling of the parameters passed to the function or in its processing, a &#8220;failed&#8221; message is sent back to the original requester (unless no reply is to be sent). The existence of outstanding replies or subordinate connections, or the caller&#8217;s transaction being marked abort-only, qualify as failures which generate failed messages.
</p>
<p class="pBody"><a name="wp1169832"> </a>
If either <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in the <code class="cCode">TM_MIB</code> is non-zero, the event, <code class="cCode">TPEV_SVCERR</code> is returned when a service timeout occurs.
</p>
<p class="pBody"><a name="wp1169833"> </a>
Failed messages are detected by the requester with the <code class="cCode">TPESVCERR</code> error indication. When such an error occurs, the caller&#8217;s data is not sent. Also, this error causes the caller&#8217;s current transaction to be marked abort-only.
</p>
<p class="pBody"><a name="wp1021854"> </a>
If a transaction timeout occurs, either during the service routine or while the request is being forwarded, the requester waiting for a reply with either <code class="cCode">tpcall()</code> or <code class="cCode">tpgetrply()</code> will get a <code class="cCode">TPETIME</code> error return. When a service fails inside a transaction, the transaction times out and is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. All further ATMI calls for that transaction will fail with <code class="cCode">TPETIME</code>. The waiting requester will not receive any data. Service routines, however, are expected to terminate using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. A conversational service routine must use <code class="cCode">tpreturn()</code>; it cannot use <code class="cCode">tpforward()</code>.
</p>
<p class="pBody"><a name="wp1021855"> </a>
If a service routine returns without using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> (that is, if it uses the C language <code class="cCode">return</code> statement or simply &#8220;falls out of the function&#8221;) or if <code class="cCode">tpforward()</code> is called from a conversational server, the server will print a warning message in a log file and return a service error to the original requester. All open connections to subordinates will be disconnected immediately, and any outstanding asynchronous replies will be marked stale. If the server was in transaction mode at the time of failure, the transaction is marked abort-only. Note also that if either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> are used outside of a service routine (for example, in clients, or in <code class="cCode">tpsvrinit()</code> or <code class="cCode">tpsvrdone()</code>), then these routines simply return having no effect.
</p>
<h4 class="pHeading3"><a name="wp1021856"> </a>
Client/Server Affinity
</h4>
<p class="pBody"><a name="wp2429026"> </a>
If you configure service session roles that invoke <code class="cCode">tpforward</code>, see <a href="rf3c.html#wp2429030">Table&#160;11</a>.
</p>
<p class="pGraphic"><a name="wp2429059"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp2429030table2429027"><caption><a name="wp2429030"> </a>
Table&#160;11  tpforward Session Roles

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp2429036"> </a>
Session Role
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2429038"> </a>
Forwarding service
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2429040"> </a>
Forwarded service
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429042"> </a>
<code class="cCode">BEGIN </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429044"> </a>
<code class="cCode">LIBTUX_CAT:6835: ERROR</code>&#39; is printed in ULOG. The session will not initiate.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429046"> </a>
The affinity server and affinity scope should be determined by forwarded service The affinity client is the one that calls forwarding service.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429048"> </a>
<code class="cCode">END</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429050"> </a>
 <code class="cCode">LIBTUX_CAT:6836: ERROR</code>&#39; is printed in ULOG. The session will not terminate between affinity client and server.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429052"> </a>
Unless the forwarding service is involved in the session, the session terminates.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429054"> </a>
<code class="cCode">NONE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429056"> </a>
The session is propagated.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2429058"> </a>
 The session is propagated.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp2428988"> </a>
For more information see,<span class="cHyperlink">
<a href="../int/intatm.html"> What is Client/Server Affinity? in Oracle Tuxedo ATMI Architecture</a></span>.
</p>
<h4 class="pHeading3"><a name="wp2428971"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1021857"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1042579"> </a>
tpfree(3c)
</h3>
<h4 class="pHeading3"><a name="wp1042580"> </a>
Name
</h4>
<p class="pBody"><a name="wp1042581"> </a>
<code class="cCode">tpfree()</code>&#8212;Routine for freeing a typed buffer.
</p>
<h4 class="pHeading3"><a name="wp1042582"> </a>
Synopsis
</h4>
<a name="wp1042583"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />void tpfree(char *ptr)</pre></div><h4 class="pHeading3"><a name="wp1042584"> </a>
Description
</h4>
<p class="pBody"><a name="wp1042585"> </a>
The argument to <code class="cCode">tpfree()</code> is a pointer to a buffer previously obtained by either <code class="cCode">tpalloc()</code> or <code class="cCode">tprealloc()</code>. If <code class="cCodeEmphasis">ptr</code> is NULL, no action occurs. Undefined results will occur if <code class="cCodeEmphasis">ptr</code> does not point to a typed buffer (or if it points to space previously freed with <code class="cCode">tpfree()</code>). Inside service routines, <code class="cCode">tpfree()</code> returns and does not free the buffer if <code class="cCodeEmphasis">ptr</code> points to the buffer passed into a service routine.
</p>
<p class="pBody"><a name="wp1042586"> </a>
Some buffer types require state information or associated data to be removed as part of freeing a buffer. <code class="cCode">tpfree()</code> removes any of these associations (in a communication manager-specific manner) before a buffer is freed.
</p>
<p class="pBody"><a name="wp1042587"> </a>
Once <code class="cCode">tpfree()</code> returns, <code class="cCodeEmphasis">ptr</code> should not be passed as an argument to any Oracle Tuxedo ATMI system routine or used in any other manner.
</p>
<p class="pBody"><a name="wp1617705"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpfree()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<p class="pBody"><a name="wp1760992"> </a>
When freeing an <code class="cCode">FML32</code> buffer using <code class="cCode">tpfree()</code>, the routine recursively frees all embedded buffers to prevent memory leaks. In order to preserve the embedded buffers, you should assign the associated pointer to NULL before issuing the <code class="cCode">tpfree()</code> command. As stated above, if <em class="cEmphasis">ptr</em> is NULL, no action occurs.
</p>
<h4 class="pHeading3"><a name="wp1042588"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1042589"> </a>
<code class="cCode">tpfree()</code> does not return any value to its caller. Thus, it is declared as a void.
</p>
<h4 class="pHeading3"><a name="wp1042590"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1042591"> </a>
This function should not be used in concert with <code class="cCode">malloc()</code>, <code class="cCode">realloc(),</code> or <code class="cCode">free()</code> in the C library (for example, a buffer allocated with <code class="cCode">tpalloc()</code> should not be freed with <code class="cCode">free()</code>).
</p>
<h4 class="pHeading3"><a name="wp1042592"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1042593"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2178582"> </a>
tpgblktime(3c)
</h3>
<h4 class="pHeading3"><a name="wp2178583"> </a>
Name
</h4>
<p class="pBody"><a name="wp2178584"> </a>
<code class="cCode">tpgblktime()</code>&#8212;Retrieves a previously set, per second, blocktime value
</p>
<h4 class="pHeading3"><a name="wp2178585"> </a>
Synopsis
</h4>
<a name="wp2178586"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />int <code class="cCode">tpgblktime(TPBLK_NEXT</code>, <code class="cCode">TPBLK_ALL </code>long flags<code class="cCode">)</code></pre></div><h4 class="pHeading3"><a name="wp2178587"> </a>
Description
</h4>
<p class="pBody"><a name="wp2194634"> </a>
<code class="cCode">tpgblktime()</code> retrieves a previously set, per second, blocktime value<code class="cCode">.</code>If <code class="cCode">tpgblktime()</code> specifies a blocktime flag value, and no such <code class="cCode">flag</code> value has been set, the return value is 0. A blocktime flag value less than 0 produces an error.
</p>
<p class="pBody"><a name="wp2194635"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp2194636"> </a>
<code class="cCode">TPBLK_NEXT</code>
</h4><div class="pDefPara"><a name="wp2194637"> </a>
This flag returns the per second<span style="font-weight: bold"> </span>blocktime value for the previously set <code class="cCode">tpsblktime(TPBLK_NEXT)</code>call.
</div>
<h4 class="pDefTerm"><a name="wp2194638"> </a>
<code class="cCode">TPBLK_ALL</code>
</h4><div class="pDefPara"><a name="wp2194639"> </a>
This flag returns the per second blocktime value for the previously set <code class="cCode">tpsblktime(TPBLK_ALL)</code>call.
</div>
<h4 class="pDefTerm"><a name="wp2194640"> </a>
<code class="cCode">0</code>
</h4><div class="pDefPara"><a name="wp2194641"> </a>
This flag returns the applicable blocktime value for the next blocking ATMI set due to a previous <code class="cCode">tpsblktime()</code> call with the <code class="cCode">TPBLK_NEXT</code> or <code class="cCode">TPBLK_ALL</code> flag blocktime value, or a system-wide default blocktime value.
</div>
<a name="wp2194642"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>When a workstation client calls a <code class="cCode">tpgblktime()</code> <code class="cCode">0</code> flag, the system-wide default blocktime value cannot be returned. A 0 value is returned instead.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp2194643"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2194644"> </a>
Upon success, <code class="cCode">tpgblktime()</code> returns a positive integer indicating the blocking time value currently in effect for the corresponding flag value. A 0 return value indicates that no such blocking time override is currently in effect.
</p>
<p class="pBody"><a name="wp2194645"> </a>
This function returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition. The failure does not affect the existing transaction, if one exists.
</p>
<h4 class="pHeading3"><a name="wp2194646"> </a>
Error
</h4>
<p class="pBody"><a name="wp2194647"> </a>
Upon failure, <code class="cCode">tpgblktime()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2194659"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp2194660"> </a>
Invalid arguments were given. For example, the <code class="cCodeEmphasis">flags</code> value is negative or more than one blocktime flag value (<code class="cCode">TPBLK_NEXT</code>, <code class="cCode">TPBLK_ALL</code>, or <code class="cCode">0)</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp2194661"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2194662"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp2179258"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2179274"> </a>
<a href="rf3c.html#wp1021731">tpcall(3c)</a>, <a href="rf3c.html#wp1040811">tpcommit(3c)</a>, <a href="rf3c.html#wp1022967">tprecv(3c)</a>, <a href="rf3c.html#wp2437258">tpsblktime(3c)</a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1064942"> </a>
tpgetadmkey(3c)
</h3>
<h4 class="pHeading3"><a name="wp1064943"> </a>
Name
</h4>
<p class="pBody"><a name="wp1064944"> </a>
<code class="cCode">tpgetadmkey()</code>&#8212;Gets administrative authentication key.
</p>
<h4 class="pHeading3"><a name="wp1064945"> </a>
Synopsis
</h4>
<a name="wp1064946"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />long tpgetadmkey(TPINIT *tpinfo) </pre></div><h4 class="pHeading3"><a name="wp1064947"> </a>
Description
</h4>
<p class="pBody"><a name="wp1064948"> </a>
<code class="cCode">tpgetadmkey()</code> is available for application use by an application specific authentication server. It returns an application security key suitable for assignment to the indicated user for the purpose of administrative authentication. This routine must be called with a client name (that is, <code class="cCodeEmphasis">tpinfo</code><span class="arrow"><img id="LongDescNotReq30" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">cltname</code>) of either <code class="cCode">tpsysadm()</code> or <code class="cCode">tpsysop()</code>; otherwise, a valid administrative key will not be returned.
</p>
<p class="pBody"><a name="wp1631089"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpgetadmkey()</code>.
</p>
<h4 class="pHeading3"><a name="wp1064949"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1064950"> </a>
Upon success, <code class="cCode">tpgetadmkey()</code> returns a non-0 value with the high-order bit (0x80000000) set; otherwise it returns 0. Zero may be returned if <code class="cCodeEmphasis">tpinfo</code> is NULL, <code class="cCodeEmphasis">tpinfo</code><span class="arrow"><img id="LongDescNotReq31" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">cltname</code> is not <code class="cCode">tpsysadm()</code> or <code class="cCode">tpsysop()</code>, or lastly if the effective user ID is not the configured application administrator for this site.
</p>
<h4 class="pHeading3"><a name="wp1064951"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1064952"> </a>
A zero return value is the only indication that a valid administrative key was not assigned. 
</p>
<h4 class="pHeading3"><a name="wp1064953"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1064954"> </a>
This interface is available only on UNIX system sites running Oracle Tuxedo release 5.0 or later. 
</p>
<h4 class="pHeading3"><a name="wp1064955"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1064956"> </a>
<a href="../rfcm/rfcmd.html">tpaddusr(1)</a>, <a href="../rfcm/rfcmd.html">tpusradd(1)</a>, <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="../rf5/rf5.html">AUTHSVR(5)</a> 
</p>
<p class="pBody"><a name="wp1270359"> </a>
<em class="cEmphasis">Setting Up an Oracle Tuxedo Application</em>
</p>
<p class="pBody"><a name="wp1450330"> </a>
<em class="cEmphasis">Administering an Oracle Tuxedo Application at Run Time</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2272018"> </a>
tpgetctxt(3c)
</h3>
<h4 class="pHeading3"><a name="wp1226461"> </a>
Name
</h4>
<p class="pBody"><a name="wp1226462"> </a>
<code class="cCode">tpgetctxt()</code>&#8212;Retrieves a context identifier for the current application association.
</p>
<h4 class="pHeading3"><a name="wp1226463"> </a>
Synopsis
</h4>
<a name="wp1226464"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpgetctxt(TPCONTEXT_T *<code class="cCodeEmphasis">context</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1226466"> </a>
Description
</h4>
<p class="pBody"><a name="wp1226467"> </a>
<code class="cCode">tpgetctxt()</code> retrieves an identifier that represents the current application context and places that identifier in <code class="cCodeEmphasis">context</code>. This function operates on a per-thread basis in a multithreaded environment, and on a per-process basis in a non-threaded environment.
</p>
<p class="pBody"><a name="wp1407558"> </a>
Typically, a thread: 
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1226468"> </a>Calls <code class="cCode">tpinit()</code></li>
<li><a name="wp1226469"> </a>Calls <code class="cCode">tpgetctxt()</code></li>
<li><a name="wp1226470"> </a>Handles the value of <code class="cCodeEmphasis">context</code> as follows:</li>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1407503"> </a>In a multithreaded application&#8212;passes the value of <code class="cCodeEmphasis">context</code> to another thread in the same process so the other thread can call <code class="cCode">tpsetctxt()</code>.</li>
<li><a name="wp1407564"> </a>In a single-threaded or multithreaded application&#8212;saves this context identifier for itself so it can switch back to the indicated context later.</li>
</ul></div>
</ol></div>
<p class="pBody"><a name="wp1226471"> </a>
The second argument, <code class="cCodeEmphasis">flags</code>, is not currently used and must be set to 0.
</p>
<p class="pBody"><a name="wp1245378"> </a>
<code class="cCode">tpgetctxt()</code> may be called in single-context applications as well as in multicontext applications.
</p>
<p class="pBody"><a name="wp1617714"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpgetctxt()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1226473"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1226474"> </a>
Upon successful completion, <code class="cCode">tpgetctxt()</code> returns a non-negative value. Context is set to the current context ID, which may be represented by any of the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1406350"> </a>A context ID greater than 0, indicating a context in a multicontexted application.</li>
<li><a name="wp1657708"> </a><code class="cCode">TPSINGLECONTEXT</code>, indicating that the current thread has successfully executed <code class="cCode">tpinit()</code> without the <code class="cCode">TPMULTICONTEXTS</code> flag, or that the current thread was just created in a process that has successfully executed <code class="cCode">tpinit()</code> without the <code class="cCode">TPMULTICONTEXTS</code> flag. The value of <code class="cCode">TPSINGLECONTEXT</code> is 0.</li>
<li><a name="wp1657707"> </a><code class="cCode">TPNULLCONTEXT</code>, indicating that the current thread is not associated with a context. </li>
<li><a name="wp1406357"> </a><code class="cCode">TPINVALIDCONTEXT</code>, indicating that the current thread is in the invalid context state. If a thread in a multicontexted client issues a call to <code class="cCode">tpterm()</code> while other threads in the same context are still working, the working threads are placed in the <code class="cCode">TPINVALIDCONTEXT</code> context. The value of <code class="cCode">TPINVALIDCONTEXT</code> is -1. </li>
<p class="pBodyRelative"><a name="wp1618302"> </a>
A thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is prohibited from issuing calls to most ATMI functions. For a complete list of functions that may and may not be called, see the <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>.
</p>
<p class="pBodyRelative"><a name="wp1618291"> </a>
For details about the <code class="cCode">TPINVALIDCONTEXT</code> context state, see <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>.
</p>
</ul></div>
<p class="pBody"><a name="wp1226475"> </a>
Upon failure, <code class="cCode">tpgetctxt()</code> returns a value of -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. 
</p>
<h4 class="pHeading3"><a name="wp1226476"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1226477"> </a>
Upon failure, <code class="cCode">tpgetctxt()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1226478"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1226479"> </a>
Invalid arguments have been given. For example, the value of <code class="cCodeEmphasis">context</code> is NULL or the value of <code class="cCodeEmphasis">flags</code> is not 0.
</div>
<h4 class="pDefTerm"><a name="wp1226482"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1226483"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error has been written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1226484"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1226485"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1226486"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1618321"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1225812"> </a>
tpgetlev(3c)
</h3>
<h4 class="pHeading3"><a name="wp1042784"> </a>
Name
</h4>
<p class="pBody"><a name="wp1042785"> </a>
<code class="cCode">tpgetlev()</code>&#8212;Routine for checking if a transaction is in progress.
</p>
<h4 class="pHeading3"><a name="wp1042786"> </a>
Synopsis
</h4>
<a name="wp1042787"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpgetlev() </pre></div><h4 class="pHeading3"><a name="wp1042788"> </a>
Description
</h4>
<p class="pBody"><a name="wp1042789"> </a>
<code class="cCode">tpgetlev()</code> returns to the caller the current transaction level. Currently, the only levels defined are 0 and 1.
</p>
<p class="pBody"><a name="wp1631097"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpgetlev()</code>.
</p>
<h4 class="pHeading3"><a name="wp1042790"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1042791"> </a>
Upon successful completion, <code class="cCode">tpgetlev()</code> returns either a 0 to indicate that no transaction is in progress, or 1 to indicate that a transaction is in progress; 
</p>
<p class="pBody"><a name="wp1238021"> </a>
Upon failure, <code class="cCode">tpgetlev()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1042792"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1042793"> </a>
Upon failure, <code class="cCode">tpgetlev()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1042794"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1042795"> </a>
<code class="cCode">tpgetlev()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1042796"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1042797"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1042798"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1042799"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1042800"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1042801"> </a>
When using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code> and <code class="cCode">tpabort()</code> to delineate an Oracle Tuxedo ATMI system transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI system transaction.
</p>
<h4 class="pHeading3"><a name="wp1042802"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1042803"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp2446410"><code class="cCode">tpscmt(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1930050"> </a>
tpgetmbenc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1930051"> </a>
Name
</h4>
<p class="pBody"><a name="wp1930052"> </a>
<code class="cCode">tpgetmbenc()</code>&#8212;Gets the code-set encoding name from a typed buffer.
</p>
<h4 class="pHeading3"><a name="wp1930053"> </a>
Synopsis
</h4>
<a name="wp1931566"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br />int<br />tpgetmbenc (char *bufp, char *enc_name, long flags)</pre></div><h4 class="pHeading3"><a name="wp1931559"> </a>
Description
</h4>
<p class="pBody"><a name="wp1934467"> </a>
This function is used to get the codeset encoding name sent with a typed buffer. This name can be compared to a target codeset if a conversion is required (see <a href="rf3c.html#wp1928689">tpconvmb(3c)</a>).
</p>
<p class="pBody"><a name="wp1934468"> </a>
The <code class="cCodeEmphasis">bufp</code> argument is a valid pointer to a typed buffer message.
</p>
<p class="pBody"><a name="wp1934469"> </a>
The <code class="cCodeEmphasis">enc_name</code> argument will be set to the encoding name, found in <code class="cCodeEmphasis">bufp</code>, upon successful execution of this function. The returned string will be NULL terminated. The user must take care to allocate a buffer large enough to hold the encoding name plus the NULL terminator (see <code class="cCode">NL_LANGMAX</code> in <code class="cCode">&lt;limits.h&gt;</code>). An MBSTRING typed buffer without the encoding name set is invalid.
</p>
<p class="pBody"><a name="wp1934470"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not currently used and should be set to zero.
</p>
<h4 class="pHeading3"><a name="wp1931560"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1934482"> </a>
Upon success, <code class="cCode">tpgetmbenc()</code> returns a value of 0. This function returns -1 on error and sets tperrno as described below for each function. The function may fail for the following reasons. 
</p>
<h4 class="pDefTerm"><a name="wp1934483"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1934484"> </a>
<code class="cCodeEmphasis">enc_name</code> or <code class="cCodeEmphasis">bufp</code> argument is NULL.
</div>
<h4 class="pDefTerm"><a name="wp1934485"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1934486"> </a>
This error occurs if <code class="cCodeEmphasis">bufp</code> cannot provide an encoding name.
</div>
<h4 class="pDefTerm"><a name="wp1934487"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1934488"> </a>
A Tuxedo system error has occurred. (e.g. <code class="cCodeEmphasis">bufp</code> does not correspond to a valid Tuxedo buffer).
</div>
<h4 class="pHeading3"><a name="wp1930055"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1930071"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1928689"><code class="cCode">tpconvmb(3c)</code></a>, <a href="rf3c.html#wp1930111"><code class="cCode">tpsetmbenc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2179461"> </a>
tpgetrepos(3c)
</h3>
<h4 class="pHeading3"><a name="wp2179462"> </a>
Name
</h4>
<p class="pBody"><a name="wp2179463"> </a>
<code class="cCode">tpgetrepos()</code> - retrieves service parameter information from a Tuxedo service metadata repository file.
</p>
<a name="wp2179464"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;</pre></div><h4 class="pHeading3"><a name="wp2179465"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2179466"> </a>
<code class="cCode">int tpgetrepos(char</code> <code class="cCode">*reposfile,</code> <code class="cCode">FBFR32*</code> <code class="cCode">idata,</code> <code class="cCode">FBFR32**</code> <code class="cCode">odata)</code>
</p>
<h4 class="pHeading3"><a name="wp2179467"> </a>
Description
</h4>
<p class="pBody"><a name="wp2179468"> </a>
tpgetrepos() provides an alternative repository access interface to the <code class="cCode">.TMMETAREPOS</code> service provided by <a href="../rf5/rf5.html">TMMETADATA(5)</a><code class="cCode">.</code> It retrieves service parameters from a Tuxedo service metadata repository file. To use tpgetrepos(), the metadata repository file must reside on the native client or server that initiates the request. This allows for repository information access even when <a href="../rf5/rf5.html">TMMETADATA(5)</a>has not been booted.
</p>
<a name="wp2179476"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">tpgetrepos()</code> can also be used to view Jolt repository files. It cannot modify an existing Jolt repository file or create a new one.</td>
</tr>
</table>

<p class="pBody"><a name="wp2179477"> </a>
<code class="cCode">tpgetrepos()</code> accepts the following parameters:
</p>
<h4 class="pDefTerm"><a name="wp2179478"> </a>
<code class="cCode">reposfile</code>
</h4><div class="pDefPara"><a name="wp2179479"> </a>
specifies the path name of a file accessible on the current machine where the Tuxedo Metadata Repository is located. The caller must have read permission for this file.
</div>
<h4 class="pDefTerm"><a name="wp2179480"> </a>
<code class="cCode">idata</code> 
</h4><div class="pDefPara"><a name="wp2179481"> </a>
specifies what type of service parameter information is retrieved, and points to an FML32 buffer.
</div>
<h4 class="pDefTerm"><a name="wp2179482"> </a>
*<code class="cCode">odata</code>
</h4><div class="pDefPara"><a name="wp2179483"> </a>
On output, points to an FML32 buffer containing the retrieved service parameter information and operation status.
</div>
<p class="pBody"><a name="wp2179484"> </a>
<a href="../rf5/rf5.html">METAREPOS(5)</a>describes the FML32 buffer format tpgetrepos()uses. It is similar to the format used by the Tuxedo MIB.
</p>
<h4 class="pHeading3"><a name="wp2180090"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp2180091"> </a>
tpgetrepos() returns 0 on success. On failure, it sets <code class="cCode">tperrno</code> and returns -1. On most failure conditions, the <code class="cCode">TA_ERROR</code> field in *odata is populated with information about the specific error, as is done by the Tuxedo MIB.
</p>
<h4 class="pHeading3"><a name="wp2216742"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2216772"> </a>
Upon failure, <code class="cCode">tpgetrepos()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<a name="wp2216773"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Except for <code class="cCode">TPEINVAL</code>, <code class="cCode">odata</code> is modified to include <code class="cCode">TA_ERROR</code>, <code class="cCode">TA_STATUS</code> for each service entry to further qualify the error condition.</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp2216774"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2216775"> </a>
Invalid arguments were specified. The reposfile value is invalid or <code class="cCode">idata</code> or <code class="cCode">odata</code> are not pointers to <code class="cCode">FML32</code> typed buffers.
</div>
<h4 class="pDefTerm"><a name="wp2216776"> </a>
<code class="cCode">[TPEMIB]</code>
</h4><div class="pDefPara"><a name="wp2216777"> </a>
The <code class="cCode">MIB</code>-like request failed. odata is updated and returned to the caller with <code class="cCode">FML32</code> fields indicating the cause of the error as discussed in <code class="cCode">MIB(5)</code>.
</div>
<h4 class="pDefTerm"><a name="wp2216778"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2216779"> </a>
<code class="cCode">tpgetrepos()</code> was improperly called. The reposfile file argument given is not a valid repository file.
</div>
<h4 class="pDefTerm"><a name="wp2216780"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2216781"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in <code class="cCode">Uunixerr</code>.
</div>
<h4 class="pDefTerm"><a name="wp2216782"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2216783"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is reported in <code class="cCode">userlog()</code>.
</div>
<h4 class="pHeading3"><a name="wp2180092"> </a>
Portability
</h4>
<p class="pBody"><a name="wp2217718"> </a>
This interface is available only on Oracle Tuxedo release 9.0 or later.
</p>
<h4 class="pHeading3"><a name="wp2217713"> </a>
Files
</h4>
<p class="pBody"><a name="wp2217590"> </a>
The following library files are required:
</p>
<p class="pBody"><a name="wp2217597"> </a>
<code class="cCode">${TUXDIR}/lib/libtrep.a<br />${TUXDIR}/lib/libtrep.so.&lt;rel&gt;<br />${TUXDIR}/lib/libtrep.lib</code>
</p>
<p class="pBody"><a name="wp2217689"> </a>
The libraries must be linked manually when using buildclient. The user must use: <code class="cCode">-L${TUXDIR}/lib -ltrep</code>
</p>
<h4 class="pHeading3"><a name="wp2217690"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2217705"> </a>
<a href="rf3c.html#wp2183851"><code class="cCode">tpsetrepos(3c)</code></a>, <a href="../rfcm/rfcmd.html">tmloadrepos(1)</a>, <a href="../rfcm/rfcmd.html">tmunloadrepos(1)</a>, <a href="../rf5/rf5.html">TMMETADATA(5)</a>, <span class="cHyperlink">
<a href="../ads/admrp.html">Managing The Tuxedo Service Metadata Repository</a></span> in <em class="cEmphasis">Setting Up an Oracle Tuxedo Application</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1021885"> </a>
tpgetrply(3c)
</h3>
<h4 class="pHeading3"><a name="wp1021886"> </a>
Name
</h4>
<p class="pBody"><a name="wp1021887"> </a>
<code class="cCode">tpgetrply()</code>&#8212;Routine for getting a reply from a previous request.
</p>
<h4 class="pHeading3"><a name="wp1021888"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1021889"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tpgetrply(int *</code><code class="cCodeEmphasis">cd</code><code class="cCode">, char **</code><code class="cCodeEmphasis">data</code><code class="cCode">, long *</code><code class="cCodeEmphasis">len</code><code class="cCode">, long </code><code class="cCodeEmphasis">flags</code><code class="cCode">)</code>
</p>
<h4 class="pHeading3"><a name="wp1021890"> </a>
Description
</h4>
<p class="pBody"><a name="wp1021891"> </a>
<code class="cCode">tpgetrply()</code> returns a reply from a previously sent request. This function&#8217;s first argument, <code class="cCodeEmphasis">cd</code>, points to a call descriptor returned by <code class="cCode">tpacall()</code>. By default, the function waits until the reply matching *<code class="cCodeEmphasis">cd</code> arrives or a timeout occurs.
</p>
<p class="pBody"><a name="wp1169514"> </a>
<code class="cCodeEmphasis">data</code> must be the address of a pointer to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should point to a long that <code class="cCode">tpgetrply()</code> sets to the amount of data successfully received. Upon successful return, *<code class="cCodeEmphasis">data</code> points to a buffer containing the reply and *<code class="cCodeEmphasis">len</code> contains the size of the data. FML and FML32 buffers often assume a minimum size of 4096 bytes; if the reply is larger than 4096, the size of the buffer is increased to a size large enough to accommodate the data being returned. As of release 6.4, the default allocation for buffers is 1024 bytes. Also, historical information is maintained on recently used buffers, allowing a buffer of optimal size to be reused as a return buffer.
</p>
<p class="pBody"><a name="wp1021893"> </a>
Buffers on the sending side that may be only partially filled (for example, FML or STRING buffers) will have only the amount that is used send. The system may then enlarge the received data size by some arbitrary amount. This means that the receiver may receive a buffer that is smaller than what was originally allocated by the sender, yet larger than the data that was sent.
</p>
<p class="pBody"><a name="wp1021894"> </a>
The receive buffer may grow, or it may shrink, and its address almost invariably changes, as the system swaps buffers around internally. To determine whether (and how much) a reply buffer changed in size, compare its total size before <code class="cCode">tpgetrply()</code> was issued with *<code class="cCodeEmphasis">len</code>. See the <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a> for more information about buffer management.
</p>
<p class="pBody"><a name="wp1021895"> </a>
If *<code class="cCodeEmphasis">len</code> is 0, then the reply has no data portion and neither *<code class="cCodeEmphasis">data</code> nor the buffer it points to were modified. 
</p>
<p class="pBody"><a name="wp1021896"> </a>
It is an error for *<code class="cCodeEmphasis">data</code> or <code class="cCodeEmphasis">len</code> to be NULL.
</p>
<p class="pBody"><a name="wp1021897"> </a>
Within any particular context of a multithreaded program:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1762123"> </a>Calls to <code class="cCode">tpgetrply(TPGETANY)</code> and <code class="cCode">tpgetrply()</code> for a specific handle cannot be issued concurrently.</li>
<li><a name="wp1764623"> </a>Multiple calls to <code class="cCode">tpgetrply(TPGETANY)</code> cannot be issued concurrently.</li>
</ul></div>
<p class="pBody"><a name="wp1762114"> </a>
Any <code class="cCode">tpgetrply()</code> call that would, if issued, cause a violation of either of these restrictions, returns -1 and sets <code class="cCode">tperrno</code> to <code class="cCode">TPEPROTO</code>.
</p>
<p class="pBody"><a name="wp1765268"> </a>
It is acceptable to issue:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1765191"> </a>Concurrent calls to <code class="cCode">tpgetrply()</code> for different handles.</li>
<li><a name="wp1765204"> </a>A call to <code class="cCode">tpgetrply</code>(<code class="cCode">TPGETANY)</code> in a single context concurrently with a call to <code class="cCode">tpgetrply()</code>, with or without <code class="cCode">TPGETANY</code>, in a different context.</li>
</ul></div>
<p class="pBody"><a name="wp1762117"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1021898"> </a>
<code class="cCode">TPGETANY</code>
</h4><div class="pDefPara"><a name="wp1026437"> </a>
This flag signifies that <code class="cCode">tpgetrply()</code> should ignore the descriptor pointed to by <code class="cCodeEmphasis">cd</code>, return any reply available and set <code class="cCodeEmphasis">cd</code> to point to the call descriptor for the reply returned. If no replies exist, <code class="cCode">tpgetrply()</code> by default will wait for one to arrive.
</div>
<h4 class="pDefTerm"><a name="wp1021899"> </a>
<code class="cCode">TPNOCHANGE</code>
</h4><div class="pDefPara"><a name="wp1026441"> </a>
By default, if a buffer is received that differs in type from the buffer pointed to by *<code class="cCodeEmphasis">data</code>, then *<code class="cCodeEmphasis">data</code>&#8217;s buffer type changes to the received buffer&#8217;s type so long as the receiver recognizes the incoming buffer type. When this flag is set, the type of the buffer pointed to by *<code class="cCodeEmphasis">data</code> is not allowed to change. That is, the type and subtype of the received buffer must match the type and subtype of the buffer pointed to by *<code class="cCodeEmphasis">data</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021900"> </a>
<code class="cCode">TPNOBLOCK</code>
</h4><div class="pDefPara"><a name="wp1026445"> </a>
<code class="cCode">tpgetrply()</code> does not wait for the reply to arrive. If the reply is available, then <code class="cCode">tpgetrply()</code> gets the reply and returns. When this flag is not specified and a reply is not available, the caller blocks until the reply arrives or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1021901"> </a>
<code class="cCode">TPNOTIME</code>
</h4><div class="pDefPara"><a name="wp1026449"> </a>
This flag signifies that the caller is willing to block indefinitely for its reply and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1021902"> </a>
<code class="cCode">TPSIGRSTRT</code>
</h4><div class="pDefPara"><a name="wp1026453"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued.
</div>
<p class="pBody"><a name="wp1021903"> </a>
Except as noted below, *<code class="cCodeEmphasis">cd</code> is no longer valid after its reply is received.
</p>
<p class="pBody"><a name="wp1631105"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpgetrply()</code>.
</p>
<h4 class="pHeading3"><a name="wp1021904"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1021905"> </a>
Upon successful return from <code class="cCode">tpgetrply()</code> or upon return where <code class="cCode">tperrno</code> is set to <code class="cCode">TPESVCFAIL</code>, <code class="cCode">tpurcode()</code> contains an application defined value that was sent as part of <code class="cCode">tpreturn()</code>. 
</p>
<p class="pBody"><a name="wp1238031"> </a>
Upon failure, <code class="cCode">tpgetrply()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1021906"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1021907"> </a>
Upon failure, <code class="cCode">tpgetrply()</code> sets <code class="cCode">tperrno</code> as indicated below. Note that if <code class="cCode">TPGETANY</code> is not set, then *<code class="cCodeEmphasis">cd</code> is invalidated unless otherwise stated. If <code class="cCode">TPGETANY</code> is set, then <code class="cCodeEmphasis">cd</code> points to the descriptor for the reply on which the failure occurred; if an error occurred before a reply could be retrieved, then <code class="cCodeEmphasis">cd</code> points to 0. Also, the failure does not affect the caller&#8217;s transaction, if one exists, unless otherwise stated. If a call fails with a particular <code class="cCode">tperrno</code> value, a subsequent call to <code class="cCode">tperrordetail()</code> with no intermediate ATMI calls, may provide more detailed information about the generated error. Refer to the <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a> reference page for more information.
</p>
<h4 class="pDefTerm"><a name="wp1021908"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026457"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">cd</code>, <code class="cCodeEmphasis">data</code>, *<code class="cCodeEmphasis">data</code> or <code class="cCodeEmphasis">len</code> is NULL or <code class="cCodeEmphasis">flags</code> are invalid). If <code class="cCodeEmphasis">cd</code> is non-NULL, then it is still valid after this error and the reply remains outstanding.
</div>
<h4 class="pDefTerm"><a name="wp1021909"> </a>
[<code class="cCode">TPEOTYPE</code>]
</h4><div class="pDefPara"><a name="wp1026461"> </a>
Either the type and subtype of the reply are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set in <code class="cCodeEmphasis">flags</code> and the type and subtype of *<code class="cCodeEmphasis">data</code> do not match the type and subtype of the reply sent by the service. Regardless, neither *<code class="cCodeEmphasis">data</code>, its contents nor *<code class="cCodeEmphasis">len</code> are changed. If the reply was to be received on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only since the reply is discarded.
</div>
<h4 class="pDefTerm"><a name="wp1021910"> </a>
[<code class="cCode">TPEBADDESC</code>]
</h4><div class="pDefPara"><a name="wp1026465"> </a>
<code class="cCodeEmphasis">cd</code> points to an invalid descriptor.
</div>
<h4 class="pDefTerm"><a name="wp1021911"> </a>
[<code class="cCode">TPETIME</code>]
</h4><div class="pDefPara"><a name="wp1854347"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpgetrply()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854348"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.) In either case, no changes are made to <code class="cCode">*data</code>, its contents, or <code class="cCode">*len</code>. <code class="cCode">*cd</code> remains valid unless the caller is in transaction mode (and <code class="cCode">TPGETANY</code> has not been set).
<a name="wp1854349"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854350"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1021912"> </a>
[<code class="cCode">TPESVCFAIL</code>]
</h4><div class="pDefPara"><a name="wp1773052"> </a>
The service routine sending the caller&#8217;s reply called <code class="cCode">tpreturn()</code> with <code class="cCode">TPFAIL</code>. This is an application-level failure. The contents of the service&#8217;s reply, if one was sent, is available in the buffer pointed to by *<code class="cCodeEmphasis">data</code>. If the service request was made on behalf of the caller&#8217;s transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">tpacall()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp1021913"> </a>
[<code class="cCode">TPESVCERR</code>]
</h4><div class="pDefPara"><a name="wp1773063"> </a>
A service routine encountered an error either in <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> (for example, bad arguments were passed). No reply data is returned when this error occurs (that is, neither *<code class="cCodeEmphasis">data</code>, its contents nor *<code class="cCodeEmphasis">len</code> are changed). If the service request was made on behalf of the caller&#8217;s transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">tpacall()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set. If either <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in the <code class="cCode">TM_MIB</code> is non-zero, <code class="cCode">TPESVCERR</code> is returned when a service timeout occurs.
</div>
<h4 class="pDefTerm"><a name="wp1021914"> </a>
[<code class="cCode">TPEBLOCK</code>]
</h4><div class="pDefPara"><a name="wp1026481"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified. *<code class="cCodeEmphasis">cd</code> remains valid.
</div>
<h4 class="pDefTerm"><a name="wp1021915"> </a>
[<code class="cCode">TPGOTSIG</code>]
</h4><div class="pDefPara"><a name="wp1026485"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1021916"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1026489"> </a>
<code class="cCode">tpgetrply()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1021920"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1026493"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1021921"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1026497"> </a>
An operating system error has occurred. If a message queue on a remote location is filled, <code class="cCode">TPEOS</code> may possibly be returned.
</div>
<h4 class="pHeading3"><a name="wp1021922"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1021923"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1039772"><code class="cCode">tpcancel(3c)</code></a>, <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>, <a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1042995"> </a>
tpgprio(3c)
</h3>
<h4 class="pHeading3"><a name="wp1042996"> </a>
Name
</h4>
<p class="pBody"><a name="wp1042997"> </a>
<code class="cCode">tpgprio()</code>&#8212;Routine for getting a service request priority.
</p>
<h4 class="pHeading3"><a name="wp1042998"> </a>
Synopsis
</h4>
<a name="wp1042999"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpgprio(void)</pre></div><h4 class="pHeading3"><a name="wp1043000"> </a>
Description
</h4>
<p class="pBody"><a name="wp2194676"> </a>
<code class="cCode">tpgprio()</code> returns the priority for the last request sent or received by the current thread in its current context. Priorities can range from 1 to 100, inclusive, with 100 being the highest priority. <code class="cCode">tpgprio()</code> may be called after <code class="cCode">tpcall()</code> or <code class="cCode">tpacall()</code>, (also <code class="cCode">tpenqueue()</code>, or <code class="cCode">tpdequeue()</code>, assuming the queued management facility is installed), and the priority returned is for the request sent. Also, <code class="cCode">tpgprio()</code> may be called within a service routine to find out at what priority the invoked service was sent. <code class="cCode">tpgprio()</code> may be called any number of times and will return the same value until the next request is sent.
</p>
<p class="pBody"><a name="wp1043002"> </a>
In a multithreaded application <code class="cCode">tpgprio()</code> operates on a per-thread basis.
</p>
<p class="pBody"><a name="wp1407607"> </a>
Because the conversation primitives are not associated with priorities, issuing <code class="cCode">tpsend()</code> or <code class="cCode">tprecv()</code> has no affect on the priority returned by <code class="cCode">tpgprio()</code>. Also, there is no priority associated with a conversational service routine unless a <code class="cCode">tpcall()</code> or <code class="cCode">tpacall()</code> is done within that service.
</p>
<p class="pBody"><a name="wp1631113"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpgprio()</code>.
</p>
<h4 class="pHeading3"><a name="wp1043003"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1043004"> </a>
Upon success, <code class="cCode">tpgprio()</code> returns a request&#8217;s priority; 
</p>
<p class="pBody"><a name="wp1238039"> </a>
Upon failure, <code class="cCode">tpgprio()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1043005"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1043006"> </a>
Upon failure, <code class="cCode">tpgprio()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1043007"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1043008"> </a>
<code class="cCode">tpgprio()</code> was called and no requests (via <code class="cCode">tpcall()</code> or <code class="cCode">tpacall()</code>) have been sent, or it is called within a conversational service for which no requests have been sent.
</div>
<h4 class="pDefTerm"><a name="wp1043009"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1043010"> </a>
<code class="cCode">tpgprio()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1043011"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1043012"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1043013"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1043014"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1043015"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1043016"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1041783"><code class="cCode">tpdequeue(3c)</code></a>, <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1045232"><code class="cCode">tpsprio(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1259847"> </a>
tpimport(3c)
</h3>
<h4 class="pHeading3"><a name="wp1259848"> </a>
Name
</h4>
<p class="pBody"><a name="wp1259849"> </a>
<code class="cCode">tpimport()</code>&#8212;Converts an externalized representation of a message buffer into a typed message buffer. 
</p>
<h4 class="pHeading3"><a name="wp1259850"> </a>
Synopsis
</h4>
<a name="wp1259851"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpimport(char *<code class="cCodeEmphasis">istr</code>, long <code class="cCodeEmphasis">ilen</code>, char **<code class="cCodeEmphasis">obuf</code>, long *<code class="cCodeEmphasis">olen</code>, <br />long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1259852"> </a>
Description
</h4>
<p class="pBody"><a name="wp1259853"> </a>
<code class="cCode">tpimport()</code> converts an externalized representation of a message buffer into a typed message buffer. An externalized representation is a message buffer that does <em class="cEmphasis">not</em> include any Oracle Tuxedo ATMI header information that is normally added to a message buffer just before the buffer is transmitted. A process converts a typed message buffer into an externalized representation by calling the <code class="cCode">tpexport()</code> function.
</p>
<p class="pBody"><a name="wp1259854"> </a>
Any digital signatures associated with <code class="cCodeEmphasis">istr</code> are verified when the buffer is imported, and are available for examination after importing via <code class="cCode">tpenvelope()</code>.
</p>
<p class="pBody"><a name="wp1259855"> </a>
If the <code class="cCodeEmphasis">istr</code> buffer representation is encrypted, the importing process must have access to a valid private key for decryption. Decryption is performed automatically during the importing process.
</p>
<p class="pBody"><a name="wp1259856"> </a>
If <code class="cCode">TPEX_STRING</code> is <em class="cEmphasis">not</em> set in <code class="cCodeEmphasis">flags</code>, then <code class="cCodeEmphasis">ilen</code> contains the length of the binary data contained in <code class="cCodeEmphasis">istr</code>. If <code class="cCodeEmphasis">ilen</code> is 0, <code class="cCodeEmphasis">istr</code> is assumed to point to a NULL-terminated string, and the <code class="cCode">TPEX_STRING</code> flag is inferred.
</p>
<p class="pBody"><a name="wp1259857"> </a>
*<code class="cCodeEmphasis">obuf</code> must point to a valid typed message buffer either (1) previously allocated by a process calling <code class="cCode">tpalloc()</code> or (2) delivered by the system to a receiving process. The buffer will be reallocated as necessary to accommodate the result, and its buffer type or subtype may change.
</p>
<p class="pBody"><a name="wp1259858"> </a>
*<code class="cCodeEmphasis">olen</code> is set to the amount of valid data contained in the output buffer. If <code class="cCodeEmphasis">olen</code> is NULL on input, it is ignored.
</p>
<p class="pBody"><a name="wp1259859"> </a>
The <code class="cCodeEmphasis">flags</code> argument should be set to <code class="cCode">TPEX_STRING</code> if the input externalized representation is in string format (base 64 encoded). Otherwise, the input is in binary format of length <code class="cCodeEmphasis">ilen</code>.
</p>
<h4 class="pHeading3"><a name="wp1259860"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1259861"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1259862"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1259863"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1259864"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">istr</code> is NULL or the <code class="cCodeEmphasis">flags</code> parameter is not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1259865"> </a>
[<code class="cCode">TPEPERM</code>]
</h4><div class="pDefPara"><a name="wp1259866"> </a>
Permission failure. The cryptographic service provider was not able to access a private key necessary for decryption.
</div>
<h4 class="pDefTerm"><a name="wp1259867"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1259868"> </a>
A protocol failure occurred. The failure involves an invalid data format in <code class="cCodeEmphasis">istr</code> or a digital signature that failed verification.
</div>
<h4 class="pDefTerm"><a name="wp1259869"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1259870"> </a>
An error occurred. Consult the system error log file for more details.
</div>
<h4 class="pHeading3"><a name="wp1259871"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1259872"> </a>
<a href="rf3c.html#wp1257660"><code class="cCode">tpenvelope(3c)</code></a>, <a href="rf3c.html#wp1480731"><code class="cCode">tpexport(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1022852"> </a>
tpinit(3c)
</h3>
<h4 class="pHeading3"><a name="wp1022853"> </a>
Name
</h4>
<p class="pBody"><a name="wp1022964"> </a>
<code class="cCode">tpinit()</code>&#8212;Joins an application.
</p>
<h4 class="pHeading3"><a name="wp1022854"> </a>
Synopsis
</h4>
<a name="wp1022855"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;atmi.h&gt;<br />int tpinit(TPINIT *tpinfo)</code> </pre></div><h4 class="pHeading3"><a name="wp1022856"> </a>
Description
</h4>
<p class="pBody"><a name="wp1022857"> </a>
<code class="cCode">tpinit()</code> allows a client to join an Oracle Tuxedo ATMI system application. Before a client can use any of the Oracle Tuxedo ATMI system communication or transaction routines, it must first join an Oracle Tuxedo ATMI system application. 
</p>
<p class="pBody"><a name="wp1403372"> </a>
<code class="cCode">tpinit()</code> has two modes of operation: single-context mode and multicontext mode, which will be discussed in detail below. Because calling <code class="cCode">tpinit()</code> is optional when in single-context mode, a single-context client may also join an application by calling many ATMI routines (for example, <code class="cCode">tpcall()</code>), which transparently call <code class="cCode">tpinit()</code> with <code class="cCodeEmphasis">tpinfo</code> set to NULL. A client may want to call <code class="cCode">tpinit()</code> directly so that it can set the parameters described below. In addition, <code class="cCode">tpinit()</code> must be used when multicontext mode is required, when application authentication is required (see the description of the <code class="cCode">SECURITY</code> keyword in <a href="../rf5/rf5.html">UBBCONFIG(5)</a>), or when the application wishes to supply its own buffer type switch (see <a href="../rf5/rf5.html">typesw(5)</a>). After <code class="cCode">tpinit()</code> successfully returns, the client can initiate service requests and define transactions.
</p>
<p class="pBody"><a name="wp1022858"> </a>
In single-context mode, if <code class="cCode">tpinit()</code> is called more than once (that is, if it is called after the client has already joined the application), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1631121"> </a>
In a multithreaded client, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpinit()</code>. To join an Oracle Tuxedo ATMI application, a multithreaded Workstation client must always call <code class="cCode">tpinit()</code> with the <code class="cCode">TPMULTICONTEXTS</code> flag set, even if the client is running in single-context mode.
</p>
<a name="wp1814306"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The <code class="cCode">TPMULTICONTEXTS</code> mode of <code class="cCode">tpinit</code> will continue to work properly when the <code class="cCode">TMNOTHREADS</code> environment variable is set to <code class="cCode">yes</code>. Setting this environment variable to <code class="cCode">yes</code> turns off multithreaded processing for applications that do not use threads.</td>
</tr>
</table>

<h5 class="pHeading4"><a name="wp1403373"> </a>
Description of the TPINFO Structure
</h5>
<p class="pBody"><a name="wp1022859"> </a>
<code class="cCode">tpinit()</code>&#8217;s argument, <code class="cCodeEmphasis">tpinfo</code>, is a pointer to a typed buffer of type <code class="cCode">TPINIT</code> and a NULL subtype. <code class="cCode">TPINIT</code> is a buffer type that is <code class="cCode">typedef</code>ed in the <code class="cCode">atmi.h</code> header file. The buffer must be allocated via <code class="cCode">tpalloc()</code> prior to calling <code class="cCode">tpinit()</code>. The buffer should be freed using <code class="cCode">tpfree()</code> after calling <code class="cCode">tpinit()</code>. The <code class="cCode">TPINIT</code> typed buffer structure includes the following members:
</p>
<a name="wp1081737"> </a><div class="pPreformatted"><pre><code class="cCode">char      usrname[MAXTIDENT+2]; <br />char      cltname[MAXTIDENT+2];<br />char      passwd[MAXTIDENT+2];<br />char      grpname[MAXTIDENT+2];<br />long      flags;<br />long      datalen;<br />long      data;</code></pre></div><p class="pBody"><a name="wp1081738"> </a>
The values of <code class="cCode">usrname</code>, <code class="cCode">cltname</code>, <code class="cCode">grpname</code>, and <code class="cCode">passwd</code> are all NULL-terminated strings. <code class="cCode">usrname</code> is a name representing the caller. <code class="cCode">cltname</code> is a client name whose semantics are application defined. The value <code class="cCode">sysclient</code> is reserved by the system for the <code class="cCode">cltname</code> field. The <code class="cCode">usrname</code> and <code class="cCode">cltname</code> fields are associated with the client at <code class="cCode">tpinit()</code> time and are used for both broadcast notification and administrative statistics retrieval. They should not have more characters than <code class="cCode">MAXTIDENT</code>, which is defined as 30. <code class="cCode">passwd</code> is an application password in unencrypted format that is used for validation against the application password. The <code class="cCode">passwd</code> is limited to 30 characters. <code class="cCode">grpname</code> is used to associate the client with a resource manager group name. If <code class="cCode">grpname</code> is set to a 0-length string, then the client is not associated with a resource manager and is in the default client group. The value of <code class="cCode">grpname</code> must be the NULL string (0-length string) for Workstation clients. Note that <code class="cCode">grpname</code> is not related to ACL GROUPS.
</p>
<h5 class="pHeading4"><a name="wp1403380"> </a>
Single-context Mode Versus Multicontext Mode
</h5>
<p class="pBody"><a name="wp1216254"> </a>
<code class="cCode">tpinit()</code> has two modes of operation: single-context mode and multicontext mode. In single-context mode, a process may join at most one application at any one time. Multiple application threads may access this application. Single-context mode is specified by calling <code class="cCode">tpinit()</code> with a NULL parameter or by calling it without specifying the <code class="cCode">TPMULTICONTEXTS</code> flag in the <code class="cCode">flags</code> field of the <code class="cCode">TPINIT</code> structure. Single-context mode is also specified when <code class="cCode">tpinit()</code> is called implicitly by another ATMI function. The context state for a process operating in single-context mode is <code class="cCode">TPSINGLECONTEXT</code>.
</p>
<a name="wp1814285"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The <code class="cCode">TPMULTICONTEXTS</code> mode of <code class="cCode">tpinit</code> will continue to work properly when the <code class="cCode">TMNOTHREADS</code> environment variable is set to <code class="cCode">&#8220;yes&#8221;</code>. </td>
</tr>
</table>

<p class="pBody"><a name="wp1403437"> </a>
In single-context mode, if <code class="cCode">tpinit()</code> is called more than once (that is, if it is called after the client has already joined the application), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1216256"> </a>
Multicontext mode is entered by calling <code class="cCode">tpinit()</code> with the <code class="cCode">TPMULTICONTEXTS</code> flag set in the <code class="cCode">flags</code> field of the <code class="cCode">TPINIT</code> structure. In multicontext mode, each call to <code class="cCode">tpinit()</code> results in the creation of a separate application association. 
</p>
<p class="pBody"><a name="wp1238199"> </a>
An application association is a context that associates a process and an Oracle Tuxedo ATMI application. A client may have associations with multiple Oracle Tuxedo ATMI applications, and may also have multiple associations with the same application. All of a client&#8217;s associations must be made to applications running the same release of the Oracle Tuxedo ATMI system, and either all associations must be native clients or all associations must be Workstation clients. 
</p>
<p class="pBody"><a name="wp1238200"> </a>
For native clients, the value of the <code class="cCode">TUXCONFIG</code> environment variable is used to identify the application to which the new association will be made. For Workstation clients, the value of the <code class="cCode">WSNADDR</code> or <code class="cCode">WSENVFILE</code> environment variable is used to identify the application to which the new association will be made. The context for the current thread is set to the new association.
</p>
<p class="pBody"><a name="wp1216257"> </a>
In multicontext mode, the application can get a handle for the current context by calling <code class="cCode">tpgetctxt()</code> and pass that handle as a parameter to <code class="cCode">tpsetctxt()</code>, thus setting the context in which a particular thread or process will operate.
</p>
<p class="pBody"><a name="wp1216258"> </a>
Mixing single-context mode and multicontext mode is not allowed. Once an application has chosen one of these modes, calling <code class="cCode">tpinit()</code> in the other mode is not allowed unless <code class="cCode">tpterm()</code> is first called for all application associations.
</p>
<h5 class="pHeading4"><a name="wp1216259"> </a>
TPINFO Structure Field Descriptions
</h5>
<p class="pBody"><a name="wp1403381"> </a>
In addition to controlling multicontext and single-context modes, the setting of <code class="cCode">flags</code> is used to indicate both the client-specific notification mechanism and the mode of system access. These two settings may override the application default. If these settings cannot override the application default, <code class="cCode">tpinit()</code> prints a warning in a log file, ignores the setting, and restores the application default setting in the <code class="cCode">flags</code> field upon return from <code class="cCode">tpinit()</code>. For client notification, the possible values for <code class="cCode">flags</code> are as follows: 
</p>
<h4 class="pDefTerm"><a name="wp1022863"> </a>
<code class="cCode">TPU_SIG</code>
</h4><div class="pDefPara"><a name="wp1403055"> </a>
Select unsolicited notification by signals. This flag should be used only with single-threaded, single-contexted applications; it cannot be used when the <code class="cCode">TPMULTICONTEXTS</code> flag is set.
</div>
<h4 class="pDefTerm"><a name="wp1022864"> </a>
<code class="cCode">TPU_DIP</code>
</h4><div class="pDefPara"><a name="wp1403056"> </a>
Select unsolicited notification by dip-in.
</div>
<h4 class="pDefTerm"><a name="wp1216961"> </a>
<code class="cCode">TPU_THREAD</code>
</h4><div class="pDefPara"><a name="wp1403060"> </a>
Select <code class="cCode">THREAD</code> notification in a separate thread managed by the Oracle Tuxedo ATMI system. This flag is allowed only on platforms that support multithreading. If <code class="cCode">TPU_THREAD</code> is specified on a platform that does not support multithreading, it is considered an invalid argument and will result in an error return with <code class="cCode">tperrno</code> set to <code class="cCode">TPEINVAL</code>.
</div>
<h4 class="pDefTerm"><a name="wp1022865"> </a>
<code class="cCode">TPU_IGN</code>
</h4><div class="pDefPara"><a name="wp1403061"> </a>
Ignore unsolicited notification.
</div>
<p class="pBody"><a name="wp1022866"> </a>
Only one of the above flags can be used at a time. If the client does not select a notification method via the flags field, then the application default method will be set in the flags field upon return from <code class="cCode">tpinit()</code>.
</p>
<p class="pBody"><a name="wp1022867"> </a>
For setting the mode of system access, the possible values for <code class="cCode">flags</code> are as follows: 
</p>
<h4 class="pDefTerm"><a name="wp1022868"> </a>
<code class="cCode">TPSA_FASTPATH</code>
</h4><div class="pDefPara"><a name="wp1403062"> </a>
Set system access to fastpath.
</div>
<h4 class="pDefTerm"><a name="wp1022869"> </a>
<code class="cCode">TPSA_PROTECTED</code>
</h4><div class="pDefPara"><a name="wp1403063"> </a>
Set system access to protected.
</div>
<p class="pBody"><a name="wp1022870"> </a>
Only one of the above flags can be used at a time. If the client does not select a notification method or a system access mode via the flags field, then the application default method(s) will be set in the <code class="cCode">flags</code> field upon return from <code class="cCode">tpinit()</code>. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details on both client notification methods and system access modes.
</p>
<p class="pBody"><a name="wp1403382"> </a>
If your application uses multithreading and/or multicontexting, you must set the following flag:
</p>
<h4 class="pDefTerm"><a name="wp1403409"> </a>
<code class="cCode">TPMULTICONTEXTS</code>
</h4><div class="pDefPara"><a name="wp1403413"> </a>
See description in &#8220;<a href="rf3c.html#wp1403380">Single-context Mode Versus Multicontext Mode</a>.&#8221;
</div>
<p class="pBody"><a name="wp1403414"> </a>
<code class="cCode">datalen</code> is the length of the application-specific data that follows. The buffer type switch entry for the <code class="cCode">TPINIT</code> typed buffer sets this field based on the total size passed in for the typed buffer (the application data size is the total size less the size of the <code class="cCode">TPINIT</code> structure itself plus the size of the data placeholder as defined in the structure). <code class="cCode">data</code> is a place holder for variable length data that is forwarded to an application-defined authentication service. It is always the last element of this structure.
</p>
<p class="pBody"><a name="wp1022872"> </a>
A macro, <code class="cCode">TPINITNEED</code>, is available to determine the size <code class="cCode">TPINIT</code> buffer necessary to accommodate a particular desired application specific data length. For example, if 8 bytes of application-specific data are desired, <code class="cCode">TPINITNEED</code>(8) will return the required <code class="cCode">TPINIT</code> buffer size.
</p>
<p class="pBody"><a name="wp1407540"> </a>
A NULL value for <code class="cCode">tpinfo</code> is allowed for applications not making use of the authentication feature of the Oracle Tuxedo ATMI system. Clients using a NULL argument will get: defaults of 0-length strings for <code class="cCode">usrname</code>, <code class="cCode">cltname</code> and <code class="cCode">passwd</code>; no flags set; and no application data.
</p>
<h4 class="pHeading3"><a name="wp1407541"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1774037"> </a>
Upon failure, <code class="cCode">tpinit()</code> leaves the calling process in its original context, returns <code class="cCode">-1</code>, and sets <code class="cCode">tperrno</code> to indicate the error condition. Also, <code class="cCode">tpurcode()</code> is set to the value returned by the <code class="cCode">AUTHSVR</code>(5) server.
</p>
<h4 class="pHeading3"><a name="wp1774038"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1022877"> </a>
Upon failure, <code class="cCode">tpinit()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1022878"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026505"> </a>
Invalid arguments were specified. <code class="cCodeEmphasis">tpinfo</code> is non-NULL and does not point to a typed buffer of type <code class="cCode">TPINIT</code>.
</div>
<h4 class="pDefTerm"><a name="wp1022879"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1026531"> </a>
The client cannot join the application because of space limitations.
</div>
<h4 class="pDefTerm"><a name="wp1022880"> </a>
[<code class="cCode">TPEPERM</code>]
</h4><div class="pDefPara"><a name="wp1026559"> </a>
The client cannot join the application because it does not have permission to do so or because it has not supplied the correct application password. Permission may be denied based on an invalid application password, failure to pass application-specific authentication, or use of restricted names. <code class="cCode">tpurcode()</code> may be set by an application-specific authentication server to explain why the client cannot join the application.
</div>
<h4 class="pDefTerm"><a name="wp1022881"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1026583"> </a>
<code class="cCode">tpinit()</code> has been called improperly. For example: (a) the caller is a server; (b) the <code class="cCode">TPMULTICONTEXTS</code> flag has been specified in single-context mode; or (c) the <code class="cCode">TPMULTICONTEXTS</code> flag has not been specified in multicontext mode.
</div>
<h4 class="pDefTerm"><a name="wp1022882"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1026603"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1022883"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1026623"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1022884"> </a>
Interoperability
</h4>
<p class="pBody"><a name="wp1022885"> </a>
<code class="cCode">tpchkauth()</code> and a non-NULL value for the <code class="cCode">TPINIT</code> typed buffer argument of <code class="cCode">tpinit()</code> are available only on sites running release 4.2 or later.
</p>
<h4 class="pHeading3"><a name="wp1022886"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1022887"> </a>
The interfaces described in <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> are supported on UNIX system, Windows, and MS-DOS operating systems. However, signal-based notification is not supported on 16-bit Windows or MS-DOS platforms. If it is selected at <code class="cCode">tpinit()</code> time, then a <code class="cCode">userlog()</code> message is generated and the method is automatically set to dip-in.
</p>
<h4 class="pHeading3"><a name="wp1022889"> </a>
Environment Variables
</h4>
<h4 class="pDefTerm"><a name="wp1148004"> </a>
<code class="cCode">TUXCONFIG</code>
</h4><div class="pDefPara"><a name="wp1219004"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a native client. It indicates the application to which the client should connect. Note that this environment variable is referenced only when <code class="cCode">tpinit()</code> is called. Subsequent calls make use of the application context.
</div>
<h4 class="pDefTerm"><a name="wp1218974"> </a>
<code class="cCode">WSENVFILE</code>
</h4><div class="pDefPara"><a name="wp1218986"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client. It indicates a file containing environment variable settings that should be set in the caller&#8217;s environment. See <a href="../rf5/rf5.html">compilation(5)</a> for details on environment variable settings necessary for Workstation clients. Note that this file is processed only when <code class="cCode">tpinit()</code> is called and not before.
</div>
<h4 class="pDefTerm"><a name="wp1022890"> </a>
<code class="cCode">WSNADDR</code>
</h4><div class="pDefPara"><a name="wp1219064"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client. It indicates the network addresses of the workstation listener that is to be contacted for access to the application. This variable is required for Workstation clients and is ignored for native clients.
</div>
<div class="pDefParaCont"><a name="wp1403074"> </a>
TCP/IP addresses may be specified in the following forms:
<a name="wp1022892"> </a>
<code class="cCodeEmphasis">//host.name:port_number</code>
<a name="wp1022893"> </a>
<code class="cCodeEmphasis">//#.#.#.#:port_number</code>
<a name="wp1022894"> </a>
In the first format, the domain finds an address for <code class="cCodeEmphasis">hostname</code> using the local name resolution facilities (usually DNS). <code class="cCodeEmphasis">hostname</code> must be the local machine, and the local name resolution facilities must unambiguously resolve <code class="cCodeEmphasis">hostname</code> to the address of the local machine.
<a name="wp1022895"> </a>
In the second format, the string <code class="cCodeEmphasis">#.#.#.# </code>is in dotted-decimal format. In dotted-decimal format, each # should be a number from 0 to 255. This dotted-decimal number represents the IP address of the local machine.
<a name="wp1022896"> </a>
In both of the above formats, <code class="cCodeEmphasis">port_number</code> is the TCP port number at which the domain process will listen for incoming requests. <code class="cCodeEmphasis">port_number</code> can either be a number between 0 and 65535 or a name. If <code class="cCodeEmphasis">port_number</code> is a name, then it must be found in the network services database on your local machine. 
<a name="wp1022897"> </a>
The address can also be specified in hexadecimal format when preceded by the characters <code class="cCode">0x</code>. Each character after the initial <code class="cCode">0x</code> is a number between 0 and 9 or a letter between A and F (case insensitive). The hexadecimal format is useful for arbitrary binary network addresses such as IPX/SPX or TCP/IP. 
<a name="wp1022898"> </a>
The address can also be specified as an arbitrary string. The value should be the same as that specified for the <code class="cCode">NLSADDR</code> parameter in the <code class="cCode">NETWORK</code> section of the configuration file. 
<a name="wp1022899"> </a>
More than one address can be specified if desired by specifying a comma-separated list of pathnames for <code class="cCode">WSNADDR</code>. Addresses are tried in order until a connection is established. Any member of an address list can be specified as a parenthesized grouping of pipe-separated network addresses. For example: 
<a name="wp1022900"> </a>
<code class="cCode">WSNADDR=(//m1.acme.com:3050|//m2.acme.com:3050),//m3.acme.com:3050</code>
<a name="wp1022901"> </a>
For users running under Windows, the address string looks like the following:
<a name="wp1022902"> </a>
<code class="cCode">set WSNADDR=(//m1.acme.com:3050^|//m2.acme.com:3050),//m3.acme.com:3050</code>
<a name="wp1022903"> </a>
Because the pipe symbol (<code class="cCode">|</code>) is considered a special character in Windows, it must be preceded by a carat ( ^ )&#8212;an escape character in the Windows environment&#8212;when it is specified on the command line. However, if <code class="cCode">WSNADDR</code> is defined in an envfile, the Oracle Tuxedo ATMI system gets the values defined by <code class="cCode">WSNADDR</code> through the <a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a> function. In this context, the pipe symbol (<code class="cCode">|</code>) is not considered a special character, so you do not need to escape it with a carat (<code class="cCode">^</code>).
<a name="wp1022904"> </a>
The Oracle Tuxedo ATMI system randomly selects one of the parenthesized addresses. This strategy distributes the load randomly across a set of listener processes. Addresses are tried in order until a connection is established. Use the value specified in the application configuration file for the workstation listener to be called. If the value begins with the characters <code class="cCode">0x</code>, it is interpreted as a string of hex-digits; otherwise, it is interpreted as ASCII characters. 
<a name="wp2457332"> </a>
To configure /WS client to use Sockets Direct Protocol (SDP) on UNIX, the address string is as follows:
<a name="wp2457333"> </a>
<code class="cCode">$ export WSNADDR=sdp://IB_IP:port</code>
<a name="wp2457334"> </a>
To configure /WS client to use IP over InfiniBand (IPoIB) on UNIX, the address string is as follows:
<a name="wp2457335"> </a>
$ export WSNADDR=//IB_IP:<code class="cCode">port</code>
<a name="wp2457336"> </a>
To configure /WS client to use IP over TCP/IP on UNIX, the address string is as follows:
<a name="wp2457310"> </a>
<code class="cCode">$ export WSNADDR=//ETH_IP:port</code>
</div>
<h4 class="pDefTerm"><a name="wp1768217"> </a>
<code class="cCode">WSFADDR</code>
</h4><div class="pDefPara"><a name="wp1771062"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client. It specifies the network address used by the Workstation client when connecting to the workstation listener or workstation handler. This variable, along with the <code class="cCode">WSFRANGE</code> variable, determines the range of TCP/IP ports to which a Workstation client will attempt to bind before making an outbound connection. This address must be a TCP/IP address. The port portion of the TCP/IP address represents the base address from which a range of TCP/IP ports can be bound by the Workstation client. The <code class="cCode">WSFRANGE</code> variable specifies the size of the range. For example, if this address is <code class="cCode">//mymachine.oracle.com:30000</code> and <code class="cCode">WSFRANGE</code> is 200, then all native processes attempting to make outbound connections from this <code class="cCodeEmphasis">LMID</code> will bind a port on <code class="cCode">mymachine.oracle.com</code> between 30000 and 30200. If not set, this variable defaults to the empty string, which implies the operating system chooses a local port randomly. 
</div>
<h4 class="pDefTerm"><a name="wp1771063"> </a>
<code class="cCode">WSFRANGE</code>
</h4><div class="pDefPara"><a name="wp1771064"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client. It specifies the range of TCP/IP ports to which a Workstation client process will attempt to bind before making an outbound connection. The <code class="cCode">WSFADDR</code> parameter specifies the base address of the range. For example, if the <code class="cCode">WSFADDR</code> parameter is set to <code class="cCode">//mymachine.oracle.com:30000</code> and <code class="cCode">WSFRANGE</code> is set to 200, then all native processes attempting to make outbound connections from this <code class="cCodeEmphasis">LMID</code> will bind a port on <code class="cCode">mymachine.oracle.com</code> between 30000 and 30200. The valid range is 1-65535. The default is 1. 
</div>
<h4 class="pDefTerm"><a name="wp1022905"> </a>
<code class="cCode">WSDEVICE</code>
</h4><div class="pDefPara"><a name="wp1219077"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client. It indicates the device name to be used to access the network. This variable is used by Workstation clients and ignored for native clients. Note that certain supported transport level network interfaces do not require a device name; for example, sockets and NetBIOS. Workstation clients supported by such interfaces need not specify <code class="cCode">WSDEVICE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1022906"> </a>
<code class="cCode">WSTYPE</code>
</h4><div class="pDefPara"><a name="wp1219078"> </a>
Used within <code class="cCode">tpinit()</code> when invoked by a Workstation client to negotiate encode/decode responsibilities with the native site. This variable is optional for Workstation clients and ignored for native clients.
</div>
<h4 class="pDefTerm"><a name="wp1022907"> </a>
<code class="cCode">WSRPLYMAX</code>
</h4><div class="pDefPara"><a name="wp1219079"> </a>
Used by <code class="cCode">tpinit()</code> to set the maximum amount of core memory that should be used for buffering application replies before they are dumped to file. The default for this parameter 256,000 bytes. For more information, see the programming documentation for your instantiation. 
</div>
<h4 class="pDefTerm"><a name="wp1022908"> </a>
<code class="cCode">TMMINENCRYPTBITS</code>
</h4><div class="pDefPara"><a name="wp1219080"> </a>
Used to establish the minimum level of encryption required to connect to the Oracle Tuxedo ATMI system. &#8220;0&#8221; means no encryption, while &#8220;56&#8221; and &#8220;128&#8221; specify the encryption key length (in bits). The link-level encryption value of 40 bits is also provided for backward compatibility. If this minimum level of encryption cannot be met, link establishment will fail. The default is &#8220;0&#8221;.
</div>
<h4 class="pDefTerm"><a name="wp1022909"> </a>
<code class="cCode">TMMAXENCRYPTBITS</code>
</h4><div class="pDefPara"><a name="wp1219081"> </a>
Used to negotiate the level of encryption up to this level when connecting to the Oracle Tuxedo ATMI system. &#8220;0&#8221; means no encryption, while &#8220;56&#8221; and &#8220;128&#8221; specify the encryption length (in bits). The link-level encryption value of 40 bits is also provided for backward compatibility. The default is &#8220;128.&#8221;
</div>
<h4 class="pHeading3"><a name="wp1022910"> </a>
Warning
</h4>
<p class="pBody"><a name="wp1022911"> </a>
Signal-based notification is not allowed in multicontext mode. In addition, signal restrictions may prevent the system from using signal-based notification even though it has been selected by a client. When this happens, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. (See the description of the <code class="cCode">NOTIFY</code> parameter in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for a detailed discussion of notification methods.) 
</p>
<p class="pBody"><a name="wp1376510"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1376511"> </a>A native client must be running as an application administrator.</li>
<li><a name="wp1376512"> </a>A Workstation client is not required to be running as the application administrator</li>
</ul></div>
<p class="pBody"><a name="wp1376513"> </a>
The ID for the application administrator is identified as part of the configuration for the application.
</p>
<p class="pBody"><a name="wp1022912"> </a>
If signal-based notification is selected for a client, then certain ATMI calls may fail, returning <code class="cCode">TPGOTSIG</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified.
</p>
<h4 class="pHeading3"><a name="wp1022913"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1022914"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a>, <a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1502326"> </a>
tpkey_close(3c)
</h3>
<h4 class="pHeading3"><a name="wp1260472"> </a>
Name
</h4>
<p class="pBody"><a name="wp1260473"> </a>
<code class="cCode">tpkey_close()</code>&#8212;Closes a previously opened key handle.
</p>
<h4 class="pHeading3"><a name="wp1260474"> </a>
Synopsis
</h4>
<a name="wp1260475"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpkey_close(TPKEY <code class="cCodeEmphasis">hKey</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1260476"> </a>
Description
</h4>
<p class="pBody"><a name="wp1260477"> </a>
<code class="cCode">tpkey_close()</code> releases a previously opened key handle and all resources associated with it. Any sensitive information, such as the principal&#8217;s private key, is erased from memory.
</p>
<p class="pBody"><a name="wp1260478"> </a>
Key handles can be opened in one of two ways:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1260479"> </a>By an explicit call to <code class="cCode">tpkey_open()</code></li>
<li><a name="wp1260480"> </a>As output from <code class="cCode">tpenvelope()</code></li>
</ul></div>
<p class="pBody"><a name="wp1532166"> </a>
It is the application&#8217;s responsibility to release key resources by calling <code class="cCode">tpkey_close()</code>. Once a process closes a key, the process can no longer use the key handle to register a message buffer for digital signature or encryption. If the process opened the key using <code class="cCode">tpkey_open()</code> with the <code class="cCode">TPKEY_AUTOSIGN</code> or <code class="cCode">TPKEY_AUTOENCRYPT</code> flag specified, the key handle no longer applies to future communication operations after the key is closed.
</p>
<p class="pBody"><a name="wp1532197"> </a>
Even though a key is closed, however, the key handle continues to be valid for any associated signature or encryption request registered before the key was closed. When the last buffer associated with a closed key is freed or overwritten, resources attributable to the key are released.
</p>
<p class="pBody"><a name="wp1260482"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and must be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1260483"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1260484"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1260485"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1260486"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1260487"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">hKey</code> is not a valid key.
</div>
<h4 class="pDefTerm"><a name="wp1260488"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1260489"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1260490"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1260491"> </a>
<a href="rf3c.html#wp1257660"><code class="cCode">tpenvelope(3c)</code></a>, <a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>, <a href="rf3c.html#wp1545991"><code class="cCode">tpkey_setinfo(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1260492"> </a>
tpkey_getinfo(3c)
</h3>
<h4 class="pHeading3"><a name="wp1260493"> </a>
Name
</h4>
<p class="pBody"><a name="wp1260494"> </a>
<code class="cCode">tpkey_getinfo()</code>&#8212;Gets information associated with a key handle.
</p>
<h4 class="pHeading3"><a name="wp1260495"> </a>
Synopsis
</h4>
<a name="wp1535804"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpkey_getinfo(TPKEY <code class="cCodeEmphasis">hKey</code>, char *<code class="cCodeEmphasis">attribute_name</code>, void *<code class="cCodeEmphasis">value</code>, long *<code class="cCodeEmphasis">value_len</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1260497"> </a>
Description
</h4>
<p class="pBody"><a name="wp1260498"> </a>
<code class="cCode">tpkey_getinfo()</code> reports information about a key handle. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1714547"> </a>
The key under examination is identified by the <code class="cCodeEmphasis">hKey</code> input parameter. The attribute for which information is desired is identified by the <code class="cCodeEmphasis">attribute_name</code> input parameter. Some attributes are specific to a cryptographic service provider, but the following core set of attributes should be supported by all providers.
</p>
<p class="pGraphic"><a name="wp1714610"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1714550table1714548">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1714550"> </a>
Attribute
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1714552"> </a>
Value
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714554"> </a>
<code class="cCode">PRINCIPAL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714556"> </a>
The name identifying the principal associated with the key (key handle), represented as a NULL-terminated character string.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714558"> </a>
<code class="cCode">PKENCRYPT_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714560"> </a>
An ASN.1 Distinguished Encoding Rules (DER) <em class="cEmphasis">object identifier</em> of the public key algorithm used by the key for public key encryption.
</div>
<div class="pCellBody"><a name="wp1714561"> </a>
The object identifier for RSA is identified in the following table. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714566"> </a>
<code class="cCode">PKENCRYPT_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714568"> </a>
The key length of the public key algorithm (RSA modulus size). The value must be within the range of 512 to 2048 bits, inclusive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714570"> </a>
<code class="cCode">SIGNATURE_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714572"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier</em> of the digital signature algorithm used by the key for digital signature.
</div>
<div class="pCellBody"><a name="wp1714573"> </a>
The object identifiers for RSA and DSA are identified in the following table.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714578"> </a>
<code class="cCode">SIGNATURE_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714580"> </a>
The key length of the digital signature algorithm (RSA modulus size). The value must be within the range of 512 to 2048 bits, inclusive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714582"> </a>
<code class="cCode">ENCRYPT_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714584"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier</em> of the symmetric key algorithm used by the key for bulk data encryption.
</div>
<div class="pCellBody"><a name="wp1714585"> </a>
The object identifiers for AES, DES, 3DES, and RC2 are identified in the following table. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714590"> </a>
<code class="cCode">ENCRYPT_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714592"> </a>
The key length of the symmetric key algorithm. The value must be within the range of 40 to 128 bits, inclusive.
</div>
<div class="pCellBody"><a name="wp1714593"> </a>
When an algorithm with a fixed key length is set in <code class="cCode">ENCRYPT_ALG</code>, the <code class="cCode">ENCRYPT_BITS</code> value is automatically set to the fixed key length. For example, if <code class="cCode">ENCRYPT_ALG</code> is set to DES, the <code class="cCode">ENCRYPT_BITS</code> value is automatically set to 56.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714595"> </a>
<code class="cCode">DIGEST_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714597"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier </em>of the message digest algorithm used by the key for digital signature.
</div>
<div class="pCellBody"><a name="wp1714598"> </a>
The object identifiers for MD5 and SHA-1 are identified in the following table. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714603"> </a>
<code class="cCode">PROVIDER</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714605"> </a>
The name of the cryptographic service provider.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714607"> </a>
<code class="cCode">VERSION</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1714609"> </a>
The version number of the cryptographic service provider&#8217;s software.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1714611"> </a>
The ASN.1 DER algorithm object identifiers supported by the default public key implementation are given in the following table.
</p>
<p class="pGraphic"><a name="wp1714650"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp2291563table1714612">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp2291563"> </a>
ASN.1 DER Algorithm Object Identifier
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2291565"> </a>
Algorithm
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291567"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x02, 0x05 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291569"> </a>
<code class="cCode">MD5</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291571"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x1a }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291573"> </a>
<code class="cCode">SHA1</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291575"> </a>
{ 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291577"> </a>
<code class="cCode">RSA</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291579"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x0c }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291581"> </a>
<code class="cCode">DSA</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291623"> </a>
{ 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x01, 0x02 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291625"> </a>
AES128-cbc
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291627"> </a>
{ 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x01, 0x2a }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291629"> </a>
AES256-cbc
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291587"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x07 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291589"> </a>
<code class="cCode">DES</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291591"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x03, 0x07 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291593"> </a>
<code class="cCode">3DES</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291595"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x03, 0x02 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2291597"> </a>
<code class="cCode">RC2</code>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1560870"> </a>
The information associated with the specified <code class="cCodeEmphasis">attribute_name</code> parameter will be stored in the memory location indicated by <code class="cCodeEmphasis">value</code>. The maximum amount of data that can be stored at this location is specified by the caller in <code class="cCodeEmphasis">value_len</code>.
</p>
<p class="pBody"><a name="wp1589080"> </a>
After <code class="cCode">tpkey_getinfo()</code> completes, <code class="cCodeEmphasis">value_len</code> is set to the size of the data actually returned (including a terminating NULL value for string values). If the number of bytes that need to be returned exceeds <code class="cCodeEmphasis">value_len</code>, <code class="cCode">tpkey_getinfo()</code> fails (with the <code class="cCode">TPELIMIT</code> error code) and sets <code class="cCodeEmphasis">value_len</code> to the required amount of space.
</p>
<p class="pBody"><a name="wp1260539"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and must be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1260540"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1260541"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1260542"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1260543"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1260544"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">hKey</code> is not a valid key.
</div>
<h4 class="pDefTerm"><a name="wp1260545"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1260546"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pDefTerm"><a name="wp1260547"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1260548"> </a>
Insufficient space was provided to hold the requested attribute value.
</div>
<h4 class="pDefTerm"><a name="wp1260549"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1260550"> </a>
The requested attribute is not associated with this key.
</div>
<h4 class="pHeading3"><a name="wp1260551"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1260552"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>, <a href="rf3c.html#wp1545991"><code class="cCode">tpkey_setinfo(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1513266"> </a>
tpkey_open(3c)
</h3>
<h4 class="pHeading3"><a name="wp1513267"> </a>
Name
</h4>
<p class="pBody"><a name="wp1513268"> </a>
<code class="cCode">tpkey_open()</code>&#8212;Opens a key handle for digital signature generation, message encryption, or message decryption.
</p>
<h4 class="pHeading3"><a name="wp1513269"> </a>
Synopsis
</h4>
<a name="wp1513270"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpkey_open(TPKEY *<code class="cCodeEmphasis">hKey</code>, char *<code class="cCodeEmphasis">principal_name</code>, char *<code class="cCodeEmphasis">location</code>, char *<code class="cCodeEmphasis">identity_proof</code>, long <code class="cCodeEmphasis">proof_len</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1513271"> </a>
Description
</h4>
<p class="pBody"><a name="wp1513272"> </a>
<code class="cCode">tpkey_open()</code> makes a key handle available to the calling process. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1539460"> </a>
A key may be used for one or more of the following purposes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1545841"> </a>Generating a digital signature, which protects a typed message buffer&#8217;s content and proves that a specific principal originated the message. (A principal may be a person or a process.) This type of key is a private key and is available only to the key&#8217;s owner.</li>
<p class="pBodyRelative"><a name="wp1545887"> </a>
Calling <code class="cCode">tpkey_open()</code> with the principal&#8217;s name and either the <code class="cCode">TPKEY_SIGNATURE</code> or <code class="cCode">TPKEY_AUTOSIGN</code> flag returns a handle to the principal&#8217;s private key and digital certificate.
</p>
<li><a name="wp1545842"> </a>Verifying a digital signature, which proves that a typed message buffer&#8217;s content remains unaltered and that a specific principal originated the message.</li>
<p class="pBodyRelative"><a name="wp1545940"> </a>
Signature verification does not require a call to <code class="cCode">tpkey_open()</code>; the verifying process uses the public key specified in the digital certificate accompanying the digitally signed message to verify the signature.
</p>
<li><a name="wp1540117"> </a>Encrypting a message buffer destined for a specific principal. This type of key is available to any process with access to the principal&#8217;s public key and digital certificate.</li>
<p class="pBodyRelative"><a name="wp1545895"> </a>
Calling <code class="cCode">tpkey_open()</code> with the principal&#8217;s name and either the <code class="cCode">TPKEY_ENCRYPT</code> or <code class="cCode">TPKEY_AUTOENCRYPT</code> flag returns a handle to the principal&#8217;s public key via the principal&#8217;s digital certificate.
</p>
<li><a name="wp1542692"> </a>Decrypting a message buffer intended for a specific principal. This type of key is a private key and is available only to the key&#8217;s owner.</li>
<p class="pBodyRelative"><a name="wp1545901"> </a>
Calling <code class="cCode">tpkey_open()</code> with the principal&#8217;s name and the <code class="cCode">TPKEY_DECRYPT</code> flag returns a handle to the principal&#8217;s private key and digital certificate.
</p>
</ul></div>
<p class="pBody"><a name="wp1540118"> </a>
The key handle returned by <code class="cCode">tpkey_open()</code> is stored in *<code class="cCodeEmphasis">hKey</code>, the value of which cannot be NULL.
</p>
<p class="pBody"><a name="wp1513277"> </a>
The <code class="cCodeEmphasis">principal_name</code> input parameter specifies the key owner&#8217;s identity. If the value of <code class="cCodeEmphasis">principal_name</code> is a NULL pointer or an empty string, a default identity is assumed. The default identity may be based on the current login session, the current operating system account, or another attribute such as a local hardware device.
</p>
<p class="pBody"><a name="wp1513278"> </a>
The file location of a key may be passed into the <code class="cCodeEmphasis">location</code> parameter. If the underlying key management provider does not require a location parameter, the value of this parameter may be NULL.
</p>
<p class="pBody"><a name="wp1513279"> </a>
To authenticate the identity of <code class="cCodeEmphasis">principal_name</code>, proof material such as a password or pass phrase may be required. If required, the proof material should be referenced by <code class="cCodeEmphasis">identity_proof</code>. Otherwise, the value of this parameter may be NULL.
</p>
<p class="pBody"><a name="wp1589073"> </a>
The length of the proof material (in bytes) is specified by <code class="cCodeEmphasis">proof_len</code>. If <code class="cCodeEmphasis">proof_len</code> is 0, <code class="cCodeEmphasis">identity_proof</code> is assumed to be a NULL-terminated character string.
</p>
<p class="pBody"><a name="wp1714676"> </a>
The type of key access required for a key&#8217;s mode of operation is specified by the <code class="cCodeEmphasis">flags</code> parameter:
</p>
<h4 class="pDefTerm"><a name="wp1513282"> </a>
<code class="cCode">TPKEY_SIGNATURE</code>:
</h4><div class="pDefPara"><a name="wp1513283"> </a>
This private key is available to generate digital signatures.
</div>
<h4 class="pDefTerm"><a name="wp1545968"> </a>
<code class="cCode">TPKEY_AUTOSIGN</code>:
</h4><div class="pDefPara"><a name="wp1545969"> </a>
Whenever this process transmits a message buffer, the public key software uses the signer&#8217;s private key to generate a digital signature and then attaches the digital signature to the buffer. <code class="cCode">TPKEY_SIGNATURE</code> is implied.
</div>
<h4 class="pDefTerm"><a name="wp1513286"> </a>
<code class="cCode">TPKEY_ENCRYPT</code>:
</h4><div class="pDefPara"><a name="wp1513287"> </a>
This public key is available to identify the recipient of an encrypted message.
</div>
<h4 class="pDefTerm"><a name="wp1513290"> </a>
<code class="cCode">TPKEY_AUTOENCRYPT</code>:
</h4><div class="pDefPara"><a name="wp1513291"> </a>
Whenever this process transmits a message buffer, the public key software encrypts the message content, uses the recipient&#8217;s public key to generate an encryption envelope, and then attaches the encryption envelope to the buffer. <code class="cCode">TPKEY_ENCRYPT</code> is implied.
</div>
<h4 class="pDefTerm"><a name="wp1545961"> </a>
<code class="cCode">TPKEY_DECRYPT</code>:
</h4><div class="pDefPara"><a name="wp1545962"> </a>
This private key is available for decryption.
</div>
<p class="pBody"><a name="wp1513292"> </a>
Any combination of one or more of these flag values is allowed. If a key is used only for encryption (<code class="cCode">TPKEY_ENCRYPT</code>), <code class="cCodeEmphasis">identity_proof</code> is not required and may be set to NULL.
</p>
<h4 class="pHeading3"><a name="wp1513293"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1513294"> </a>
Upon successful completion, *<code class="cCodeEmphasis">hKey</code> is set to a value that represents this key, for use by other functions such as <code class="cCode">tpsign()</code> and <code class="cCode">tpseal()</code>.
</p>
<p class="pBody"><a name="wp1513295"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1513296"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1513297"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1513298"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">hKey</code> is NULL or the <code class="cCodeEmphasis">flags</code> parameter is not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1513299"> </a>
[<code class="cCode">TPEPERM</code>]
</h4><div class="pDefPara"><a name="wp1513300"> </a>
Permission failure. The cryptographic service provider was not able to access a private key for this principal, given the proof information and current environment.
</div>
<h4 class="pDefTerm"><a name="wp1513301"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1513302"> </a>
A system error occurred. Consult the systems error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1545979"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1545989"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a>, <a href="rf3c.html#wp1545991"><code class="cCode">tpkey_setinfo(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1545991"> </a>
tpkey_setinfo(3c)
</h3>
<h4 class="pHeading3"><a name="wp1260554"> </a>
Name
</h4>
<p class="pBody"><a name="wp1260555"> </a>
<code class="cCode">tpkey_setinfo()</code>&#8212;Sets optional attribute parameters associated with a key handle.
</p>
<h4 class="pHeading3"><a name="wp1260556"> </a>
Synopsis
</h4>
<a name="wp1260557"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpkey_setinfo(TPKEY <code class="cCodeEmphasis">hKey</code>, char *<code class="cCodeEmphasis">attribute_name</code>, void *<code class="cCodeEmphasis">value</code>, long <code class="cCodeEmphasis">value_len</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1260558"> </a>
Description
</h4>
<p class="pBody"><a name="wp1580148"> </a>
<code class="cCode">tpkey_setinfo()</code> sets an optional attribute parameter for a key handle. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1580149"> </a>
The key for which information is to be modified is identified by the <code class="cCodeEmphasis">hKey</code> input parameter. The attribute for which information is to be modified is identified by the <code class="cCodeEmphasis">attribute_name</code> input parameter. Some attributes may be specific to a certain cryptographic service provider, but the core set of attributes presented on the <a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a> reference page should be supported by all providers.
</p>
<p class="pBody"><a name="wp1260561"> </a>
The information to be associated with the <code class="cCodeEmphasis">attribute_name</code> parameter is stored in the memory location indicated by <code class="cCodeEmphasis">value</code>. If the data content of <code class="cCodeEmphasis">value</code> is self-describing, <code class="cCodeEmphasis">value_len</code> is ignored (and may be 0). Otherwise, <code class="cCodeEmphasis">value_len</code> must contain the length of data in <code class="cCodeEmphasis">value</code>.
</p>
<p class="pBody"><a name="wp1260563"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and must be set to 0. 
</p>
<h4 class="pHeading3"><a name="wp1260564"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1260565"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1260566"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1260567"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1260568"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">hKey</code> is not a valid key or <code class="cCodeEmphasis">attribute_name</code> refers to a read-only value.
</div>
<h4 class="pDefTerm"><a name="wp1260569"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1260570"> </a>
The <code class="cCodeEmphasis">value</code> provided is too large.
</div>
<h4 class="pDefTerm"><a name="wp1260571"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1260572"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pDefTerm"><a name="wp1260573"> </a>
 [<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1260574"> </a>
The requested attribute is not recognized by the key&#8217;s cryptographic service provider.
</div>
<h4 class="pHeading3"><a name="wp1260575"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1260576"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1260492"><code class="cCode">tpkey_getinfo(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1043190"> </a>
tpnotify(3c)
</h3>
<h4 class="pHeading3"><a name="wp1043191"> </a>
Name
</h4>
<p class="pBody"><a name="wp1043192"> </a>
<code class="cCode">tpnotify()</code>&#8212;Routine for sending notification by client identifier.
</p>
<h4 class="pHeading3"><a name="wp1043193"> </a>
Synopsis
</h4>
<a name="wp1043194"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpnotify(CLIENTID *clientid, char *data, long len, long flags) </pre></div><h4 class="pHeading3"><a name="wp1043195"> </a>
Description
</h4>
<p class="pBody"><a name="wp1043196"> </a>
<code class="cCode">tpnotify()</code> allows a client or server to send an unsolicited message to an individual client.
</p>
<p class="pBody"><a name="wp1043197"> </a>
<code class="cCodeEmphasis">clientid</code> is a pointer to a client identifier saved from the <code class="cCode">TPSVCINFO</code> structure of a previous or current service invocation, or passed to a client via some other communications mechanism (for example, retrieved via the administration interface).
</p>
<p class="pBody"><a name="wp1043198"> </a>
The data portion of the request is pointed to by <code class="cCodeEmphasis">data</code>, a buffer previously allocated by <code class="cCode">tpalloc()</code>. <code class="cCodeEmphasis">len</code> specifies how much of <code class="cCodeEmphasis">data</code> to send. Note that if <code class="cCodeEmphasis">data</code> points to a buffer type that does not require a length to be specified, (for example, an <code class="cCode">FML</code> fielded buffer) then <code class="cCodeEmphasis">len</code> is ignored (and may be 0). Also, <code class="cCodeEmphasis">data</code> may be NULL in which case <code class="cCodeEmphasis">len</code> is ignored.
</p>
<p class="pBody"><a name="wp1043199"> </a>
Upon successful return from <code class="cCode">tpnotify()</code>, the message has been delivered to the system for forwarding to the identified client. If the <code class="cCode">TPACK</code> flag was set, a successful return means the message has been received by the client. Furthermore, if the client has registered an unsolicited message handler, the handler will have been called.
</p>
<p class="pBody"><a name="wp1043200"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1043201"> </a>
<code class="cCode">TPACK</code> 
</h4><div class="pDefPara"><a name="wp1043202"> </a>
The request is sent and the caller blocks until an acknowledgement message is received from the target client.
</div>
<h4 class="pDefTerm"><a name="wp1043203"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1043204"> </a>
The request is not sent if a blocking condition exists in sending the notification (for example, the internal buffers into which the message is transferred are full).
</div>
<h4 class="pDefTerm"><a name="wp1043205"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1043206"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1043207"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1043208"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued.
</div>
<div class="pDefParaCont"><a name="wp1148028"> </a>
Unless the <code class="cCode">TPACK</code> flag is set, <code class="cCode">tpnotify()</code> does not wait for the message to be delivered to the client.
</div>
<p class="pBody"><a name="wp1631133"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpnotify()</code>.
</p>
<h4 class="pHeading3"><a name="wp1155890"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1155891"> </a>
Upon failure, <code class="cCode">tpnotify()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. If a call fails with a particular <code class="cCode">tperrno</code> value, a subsequent call to <code class="cCode">tperrordetail()</code>, with no intermediate ATMI calls, may provide more detailed information about the generated error. Refer to the <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a> reference page for more information.
</p>
<h4 class="pHeading3"><a name="wp1155892"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1043213"> </a>
Upon failure, <code class="cCode">tpnotify()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1043214"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1043215"> </a>
Invalid arguments were given (for example, invalid flags).
</div>
<h4 class="pDefTerm"><a name="wp1043216"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1043217"> </a>
The target client does not exist or does not have an unsolicited handler set and the <code class="cCode">TPACK</code> flag is set.
</div>
<h4 class="pDefTerm"><a name="wp1043218"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1849123"> </a>
A blocking timeout occurred and neither <code class="cCode">TPNOBLOCK</code> nor <code class="cCode">TPNOTIME</code> were specified, or <code class="cCode">TPACK</code> was set but no acknowledgment was received and <code class="cCode">TPNOTIME</code> was not specified. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
</div>
<h4 class="pDefTerm"><a name="wp1043220"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1043221"> </a>
A blocking condition was found on the call and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1043222"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1043223"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1043224"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1043225"> </a>
<code class="cCode">tpnotify()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1043226"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1043227"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1043228"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1043229"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1043230"> </a>
[<code class="cCode">TPERELEASE</code>] 
</h4><div class="pDefPara"><a name="wp1043231"> </a>
When the <code class="cCode">TPACK</code> is set and the target is a client from a prior release of Oracle Tuxedo that does not support the acknowledgment protocol. 
</div>
<h4 class="pHeading3"><a name="wp1043232"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1043233"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1039463"><code class="cCode">tpbroadcast(3c)</code></a>, <a href="rf3c.html#wp1040306"><code class="cCode">tpchkunsol(3c)</code></a>, <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>, <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1043391"> </a>
tpopen(3c)
</h3>
<h4 class="pHeading3"><a name="wp1043392"> </a>
Name
</h4>
<p class="pBody"><a name="wp1043393"> </a>
<code class="cCode">tpopen()</code>&#8212;Routine for opening a resource manager.
</p>
<h4 class="pHeading3"><a name="wp1043394"> </a>
Synopsis
</h4>
<a name="wp1043395"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpopen(void) </pre></div><h4 class="pHeading3"><a name="wp1043396"> </a>
Description
</h4>
<p class="pBody"><a name="wp1043397"> </a>
<code class="cCode">tpopen()</code> opens the resource manager to which the caller is linked. At most one resource manager can be linked to the caller. This function is used in place of resource manager-specific <code class="cCode">open()</code> calls and allows a service routine to be free of calls that may hinder portability. Since resource managers differ in their initialization semantics, the specific information needed to open a particular resource manager is placed in a configuration file.
</p>
<p class="pBody"><a name="wp1043398"> </a>
If a resource manager is already open (that is, <code class="cCode">tpopen()</code> is called more than once), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1631141"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpopen()</code>.
</p>
<p class="pBody"><a name="wp2433380"> </a>
If the current server is built with the <code class="cCode">-M</code> option, tpopen will open all of RMs in UBBCONFIG (5) *RMS section configured as <code class="cCode">AUTO=Y</code> related with current server group and set correspond context fields.
</p>
<p class="pBody"><a name="wp2433381"> </a>
If opening any RM fails,<code class="cCode"> tpopen</code> returns <code class="cCode">TPERMERR</code>.
</p>
<h4 class="pHeading3"><a name="wp1043399"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1043400"> </a>
Upon failure, <code class="cCode">tpopen()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1043401"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1043402"> </a>
Upon failure, <code class="cCode">tpopen()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1043403"> </a>
[<code class="cCode">TPERMERR</code>] 
</h4><div class="pDefPara"><a name="wp1043404"> </a>
A resource manager failed to open correctly. More information concerning the reason a resource manager failed to open can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1043405"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1043406"> </a>
<code class="cCode">tpopen()</code> was called in an improper context (for example, by a client that has not joined an Oracle Tuxedo system server group).
</div>
<h4 class="pDefTerm"><a name="wp1043407"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1043408"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1043409"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1043410"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1043411"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1043412"> </a>
<a href="rf3c.html#wp1040568"><code class="cCode">tpclose(3c)</code></a><code class="cCode">,, tprmopen(3c), tprmclose(3c), tprmstart(3c), tprmend(3c)</code>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044210"> </a>
tppost(3c)
</h3>
<h4 class="pHeading3"><a name="wp1044211"> </a>
Name
</h4>
<p class="pBody"><a name="wp1044212"> </a>
<code class="cCode">tppost()</code>&#8212;Posts an event.
</p>
<h4 class="pHeading3"><a name="wp1044213"> </a>
Synopsis
</h4>
<a name="wp1044214"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tppost(char *eventname, char *data, long len, long flags)</pre></div><h4 class="pHeading3"><a name="wp1044215"> </a>
Description
</h4>
<p class="pBody"><a name="wp1044216"> </a>
The caller uses <code class="cCode">tppost()</code> to post an event and any accompanying data. The event is named by <code class="cCodeEmphasis">eventname</code> and <code class="cCodeEmphasis">data</code>, if not NULL, points to the data. The posted event and its data are dispatched by the Oracle Tuxedo ATMI EventBroker to all subscribers whose subscriptions successfully evaluate against <code class="cCodeEmphasis">eventname</code> and whose optional filter rules successfully evaluate against <code class="cCodeEmphasis">data</code>.
</p>
<p class="pBody"><a name="wp1044217"> </a>
<code class="cCodeEmphasis">eventname</code> is a NULL-terminated string of at most 31 characters. <code class="cCodeEmphasis">eventname</code>&#8217;s first character cannot be a dot (&#8220;.&#8221;) as this character is reserved as the starting character for all events defined by the Oracle Tuxedo ATMI system itself.
</p>
<p class="pBody"><a name="wp1044218"> </a>
If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should specify the amount of data in the buffer that should be posted with the event. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified (for example, an FML fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored. If <code class="cCodeEmphasis">data</code> is NULL, <code class="cCodeEmphasis">len</code> is ignored and the event is posted with no data.
</p>
<p class="pBody"><a name="wp1044219"> </a>
When <code class="cCode">tppost()</code> is used within a transaction, the transaction boundary can be extended to include those servers and/or stable-storage message queues notified by the EventBroker. When a transactional posting is made, some of the recipients of the event posting are notified on behalf of the poster&#8217;s transaction (for example, servers and queues), while some are not (for example, clients).
</p>
<p class="pBody"><a name="wp1044220"> </a>
If the poster is within a transaction and the <code class="cCode">TPNOTRAN</code> flag is not set, the posted event goes to the EventBroker in transaction mode such that it dispatches the event as part of the poster&#8217;s transaction. The broker dispatches transactional event notifications only to those service routine and stable-storage queue subscriptions that used the <code class="cCode">TPEVTRAN</code> bit setting in the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq32" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> parameter passed to <code class="cCode">tpsubscribe()</code>. Client notifications, and those service routine and stable-storage queue subscriptions that did not use the <code class="cCode">TPEVTRAN</code> bit setting in the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq33" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> parameter passed to <code class="cCode">tpsubscribe()</code>, are also dispatched by the EventBroker but not as part of the posting process&#8217;s transaction.
</p>
<p class="pBody"><a name="wp1776602"> </a>
If the poster is outside a transaction, <code class="cCode">tppost()</code> is a one-way post with no acknowledgement when the service associated with the event fails. This occurs even when <code class="cCode">TPEVTRAN</code> is set for that event (using the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq34" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> parameter passed to <code class="cCode">tpsubscribe()</code>). If the poster is in a transaction, then <code class="cCode">tppost()</code> returns <code class="cCode">TPESVCFAIL</code> when the associated service fails in the event.
</p>
<p class="pBody"><a name="wp1044221"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1044222"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1044223"> </a>
If the caller is in transaction mode and this flag is set, then the event posting is not made on behalf of the caller&#8217;s transaction. A caller in transaction mode that sets this flag is still subject to the transaction timeout (and no other) when posting events. If the event posting fails, the caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp1044224"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp1044225"> </a>
Informs <code class="cCode">tppost()</code> not to wait for the EventBroker to process all subscriptions for <code class="cCodeEmphasis">eventname</code> before returning. When <code class="cCode">TPNOREPLY</code> is set, <code class="cCode">tpurcode()</code> is set to zero regardless of whether <code class="cCode">tppost()</code> returns successfully or not. When the caller is in transaction mode, this setting cannot be used unless <code class="cCode">TPNOTRAN</code> is also set.
</div>
<h4 class="pDefTerm"><a name="wp1044226"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1044227"> </a>
The event is not posted if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1044228"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1044229"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1044230"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1044231"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tppost()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1631149"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tppost()</code>.
</p>
<h4 class="pHeading3"><a name="wp1044232"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1044233"> </a>
Upon successful return from <code class="cCode">tppost()</code>, <code class="cCode">tpurcode()</code> contains the number of event notifications dispatched by the EventBroker on behalf of <code class="cCodeEmphasis">eventname</code> (that is, postings for those subscriptions whose event expression evaluated successfully against <code class="cCodeEmphasis">eventname</code> and whose filter rule evaluated successfully against <code class="cCodeEmphasis">data</code>). Upon return where <code class="cCode">tperrno</code> is set to <code class="cCode">TPESVCFAIL</code>, <code class="cCode">tpurcode()</code> contains the number of non-transactional event notifications dispatched by the EventBroker on behalf of <code class="cCodeEmphasis">eventname</code>. 
</p>
<p class="pBody"><a name="wp1238079"> </a>
Upon failure, <code class="cCode">tppost()</code> returns -1 sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1044234"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1044235"> </a>
Upon failure, <code class="cCode">tppost()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1044236"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1044237"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">eventname</code> is NULL).
</div>
<h4 class="pDefTerm"><a name="wp1044238"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1044239"> </a>
Cannot access the Oracle Tuxedo User EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1044240"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1044241"> </a>
The caller is in transaction mode, <code class="cCode">TPNOTRAN</code> was not set and <code class="cCode">tppost()</code> contacted an EventBroker that does not support transaction propagation (that is, <a href="../rf5/rf5.html">TMUSREVT(5)</a> is not running in an Oracle Tuxedo ATMI system group that supports transactions).
</div>
<h4 class="pDefTerm"><a name="wp1044242"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854356"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tppost()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854357"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854358"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854359"> </a>
When <code class="cCode">tppost()</code> fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1044244"> </a>
[<code class="cCode">TPESVCFAIL</code>] 
</h4><div class="pDefPara"><a name="wp1044245"> </a>
The EventBroker encountered an error posting a transactional event to either a service routine or to a stable storage queue on behalf of the caller&#8217;s transaction. The caller&#8217;s current transaction is marked abort-only. When this error is returned, <code class="cCode">tpurcode()</code> contains the number of non-transactional event notifications dispatched by the EventBroker on behalf of <code class="cCodeEmphasis">eventname</code>; transactional postings are not counted since their effects will be aborted upon completion of the transaction. Note that so long as the transaction has not timed out, further communication may be performed before aborting the transaction and that any work performed on behalf of the caller&#8217;s transaction will be aborted upon transaction completion (that is, for subsequent communication to have any lasting effect, it should be done with <code class="cCode">TPNOTRAN</code> set).
</div>
<h4 class="pDefTerm"><a name="wp1044246"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1044247"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1044248"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1044249"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1044250"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1044251"> </a>
<code class="cCode">tppost()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1044252"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1044253"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1044254"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1044255"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1044256"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1044257"> </a>
<a href="rf3c.html#wp1045667"><code class="cCode">tpsubscribe(3c)</code></a>, <a href="rf3c.html#wp1045970"><code class="cCode">tpunsubscribe(3c)</code></a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044439"> </a>
tprealloc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1044440"> </a>
Name
</h4>
<p class="pBody"><a name="wp1044441"> </a>
<code class="cCode">tprealloc()</code>&#8212;Routine to change the size of a typed buffer.
</p>
<h4 class="pHeading3"><a name="wp1044442"> </a>
Synopsis
</h4>
<a name="wp1044443"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />char * tprealloc(char *ptr, long size) </pre></div><h4 class="pHeading3"><a name="wp1044444"> </a>
Description
</h4>
<p class="pBody"><a name="wp1044445"> </a>
<code class="cCode">tprealloc</code>() changes the size of the buffer pointed to by <code class="cCodeEmphasis">ptr</code> to <code class="cCodeEmphasis">size</code> bytes and returns a pointer to the new (possibly moved) buffer. Similar to <code class="cCode">tpalloc()</code>, the size of the buffer will be at least as large as the larger of <code class="cCodeEmphasis">size</code> and <code class="cCode">dfltsize</code>, where <code class="cCode">dfltsize</code> is the default buffer size specified in <code class="cCode">tmtype_sw</code>. If the larger of the two is less than or equal to zero, then the buffer is unchanged and NULL is returned. A buffer&#8217;s type remains the same after it is reallocated. After this function returns successfully, the returned pointer should be used to reference the buffer; <code class="cCodeEmphasis">ptr</code> should no longer be used. The buffer&#8217;s contents will not change up to the lesser of the new and old sizes.
</p>
<p class="pBody"><a name="wp1044446"> </a>
Some buffer types require initialization before they can be used. <code class="cCode">tprealloc()</code> reinitializes a buffer (in a communication manager-specific manner) after it is reallocated and before it is returned. Thus, the buffer returned to the caller is ready for use.
</p>
<p class="pBody"><a name="wp1617726"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tprealloc()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1044447"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1044448"> </a>
Upon successful completion, <code class="cCode">tprealloc()</code> returns a pointer to a buffer of the appropriate type aligned on a long word.
</p>
<p class="pBody"><a name="wp1238100"> </a>
Upon failure, <code class="cCode">tprealloc()</code> returns NULL and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1044449"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1044450"> </a>
If the reinitialization function fails, <code class="cCode">tprealloc()</code> fails, returning NULL and the contents of the buffer pointed to by <code class="cCodeEmphasis">ptr</code> may not be valid. Upon failure, <code class="cCode">tprealloc()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1044451"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1044452"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">ptr</code> does not point to a buffer originally allocated by <code class="cCode">tpalloc()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1044453"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1044454"> </a>
<code class="cCode">tprealloc()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1044455"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1044456"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1044457"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1044458"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1044459"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1044460"> </a>
If buffer reinitialization fails, <code class="cCode">tprealloc()</code> fails returning NULL and the contents of the buffer pointed to by <code class="cCodeEmphasis">ptr</code> may not be valid. This function should not be used in concert with <code class="cCode">malloc()</code>, <code class="cCode">realloc()</code> or <code class="cCode">free()</code> in the C library (for example, a buffer allocated with <code class="cCode">tprealloc()</code> should not be freed with <code class="cCode">free()</code>).
</p>
<h4 class="pHeading3"><a name="wp1044461"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1044462"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>, <a href="rf3c.html#wp1045809"><code class="cCode">tptypes(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1022967"> </a>
tprecv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1022968"> </a>
Name
</h4>
<p class="pBody"><a name="wp1022969"> </a>
<code class="cCode">tprecv()</code>&#8212;Routine for receiving a message in a conversational connection.
</p>
<h4 class="pHeading3"><a name="wp1022970"> </a>
Synopsis
</h4>
<a name="wp1022971"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tprecv(int cd, char **data, long *len, long flags, long \ <br />   *revent)</pre></div><h4 class="pHeading3"><a name="wp1022972"> </a>
Description
</h4>
<p class="pBody"><a name="wp1022973"> </a>
<code class="cCode">tprecv()</code> is used to receive data sent across an open connection from another program. <code class="cCode">tprecv()</code>&#8217;s first argument, <code class="cCodeEmphasis">cd</code>, specifies on which open connection to receive data. <code class="cCodeEmphasis">cd</code> is a descriptor returned from either <code class="cCode">tpconnect()</code> or the <code class="cCode">TPSVCINFO</code> parameter to the service. The second argument, <code class="cCodeEmphasis">data</code>, is the address of a pointer to a buffer previously allocated by <code class="cCode">tpalloc()</code>.
</p>
<p class="pBody"><a name="wp1022974"> </a>
<code class="cCodeEmphasis">data</code> must be the address of a pointer to a buffer previously allocated by <code class="cCode">tpalloc()</code> and <code class="cCodeEmphasis">len</code> should point to a long that <code class="cCode">tprecv()</code> sets to the amount of data successfully received. Upon successful return, <code class="cCodeEmphasis">*data </code>points to a buffer containing the reply and <code class="cCodeEmphasis">*len </code>contains the size of the buffer. <code class="cCode">FML</code> and <code class="cCode">FML32</code> buffers often assume a minimum size of 4096 bytes; if the reply is larger than 4096 bytes, the size of the buffer is increased to a size large enough to accommodate the data being returned. 
</p>
<p class="pBody"><a name="wp1022975"> </a>
Buffers on the sending side that may be only partially filled (for example, FML or STRING buffers) will have only the amount that is used sent. The system may then enlarge the received data size by some arbitrary amount. This means that the receiver may receive a buffer that is smaller than what was originally allocated by the sender, yet larger than the data that was sent. 
</p>
<p class="pBody"><a name="wp1022976"> </a>
The receive buffer may grow, or it may shrink, and its address almost invariably changes, as the system swaps buffers around internally. To determine whether (and how much) a reply buffer changed in size, compare its total size before <code class="cCode">tprecv()</code> was issued with <code class="cCodeEmphasis">*len</code>. See <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a> for more information about buffer management.
</p>
<p class="pBody"><a name="wp1022977"> </a>
If <code class="cCodeEmphasis">*len</code> is 0, then no data was received and neither <code class="cCodeEmphasis">*data</code> nor the buffer it points to were modified. It is an error for <code class="cCodeEmphasis">data</code>, <code class="cCodeEmphasis">*data</code> or <code class="cCodeEmphasis">len</code> to be NULL. 
</p>
<p class="pBody"><a name="wp1022978"> </a>
<code class="cCode">tprecv()</code> can be issued only by the program that does not have control of the connection.
</p>
<p class="pBody"><a name="wp1022979"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp1022980"> </a>
<code class="cCode">TPNOCHANGE</code>
</h4><div class="pDefPara"><a name="wp1026655"> </a>
By default, if a buffer is received that differs in type from the buffer pointed to by *<code class="cCodeEmphasis">data</code>, then *<code class="cCodeEmphasis">data</code>&#8217;s buffer type changes to the received buffer&#8217;s type so long as the receiver recognizes the incoming buffer type. When this flag is set, the type of the buffer pointed to by *<code class="cCodeEmphasis">data</code> is not allowed to change. That is, the type and subtype of the received buffer must match the type and subtype of the buffer pointed to by *<code class="cCodeEmphasis">data</code>.
</div>
<h4 class="pDefTerm"><a name="wp1022981"> </a>
<code class="cCode">TPNOBLOCK</code>
</h4><div class="pDefPara"><a name="wp1026659"> </a>
<code class="cCode">tprecv()</code> does not wait for data to arrive. If data is already available to receive, then <code class="cCode">tprecv()</code> gets the data and returns. When this flag is not specified and no data is available to receive, the caller blocks until data arrives.
</div>
<h4 class="pDefTerm"><a name="wp1022982"> </a>
<code class="cCode">TPNOTIME</code>
</h4><div class="pDefPara"><a name="wp1026663"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts will still affect the program.
</div>
<h4 class="pDefTerm"><a name="wp1022983"> </a>
<code class="cCode">TPSIGRSTRT</code>
</h4><div class="pDefPara"><a name="wp1026667"> </a>
If a signal interrupts the underlying receive system call, then the call is reissued.
</div>
<p class="pBody"><a name="wp1022984"> </a>
If an event exists for the descriptor, <code class="cCodeEmphasis">cd</code>, then <code class="cCode">tprecv()</code> will return setting <code class="cCode">tperrno</code> to <code class="cCode">TPEEVENT</code>. The event type is returned in <code class="cCodeEmphasis">revent</code>. Data can be received along with the <code class="cCode">TPEV_SVCSUCC</code>, <code class="cCode">TPEV_SVCFAIL</code>, and <code class="cCode">TPEV_SENDONLY</code> events. Valid events for <code class="cCode">tprecv()</code> are as follows: 
</p>
<h4 class="pDefTerm"><a name="wp1022985"> </a>
<code class="cCode">TPEV_DISCONIMM</code>
</h4><div class="pDefPara"><a name="wp1026671"> </a>
Received by the subordinate of a conversation, this event indicates that the originator of the conversation has either issued an immediate disconnect on the connection via <code class="cCode">tpdiscon()</code>, or it issued <code class="cCode">tpreturn()</code>, <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> with the connection still open. This event is also returned to the originator or subordinate when a connection is broken due to a communications error (for example, a server, machine, or network failure). Because this is an immediate disconnection notification (that is, abortive rather than orderly), data in transit may be lost. If the two programs were participating in the same transaction, then the transaction is marked abort-only. The descriptor used for the connection is no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp1022986"> </a>
<code class="cCode">TPEV_SENDONLY</code>
</h4><div class="pDefPara"><a name="wp1026675"> </a>
The program on the other end of the connection has relinquished control of the connection. The recipient of this event is allowed to send data but cannot receive any data until it relinquishes control.
</div>
<h4 class="pDefTerm"><a name="wp1022987"> </a>
<code class="cCode">TPEV_SVCERR</code>
</h4><div class="pDefPara"><a name="wp1026679"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">tpreturn()</code>. <code class="cCode">tpreturn()</code> encountered an error that precluded the service from returning successfully. For example, bad arguments may have been passed to <code class="cCode">tpreturn()</code> or <code class="cCode">tpreturn()</code> may have been called while the service had open connections to other subordinates. Due to the nature of this event, any application defined data or return code are not available. The connection has been torn down and is no longer a valid descriptor. If this event occurred as part of the <code class="cCodeEmphasis">cd</code> recipient&#8217;s transaction, then the transaction is marked abort-only.
</div>
<h4 class="pDefTerm"><a name="wp1022988"> </a>
<code class="cCode">TPEV_SVCFAIL</code>
</h4><div class="pDefPara"><a name="wp1026683"> </a>
Received by the originator of a conversation, this event indicates that the subordinate service on the other end of the conversation has finished unsuccessfully as defined by the application (that is, it called <code class="cCode">tpreturn()</code> with <code class="cCode">TPFAIL</code> or <code class="cCode">TPEXIT</code>). If the subordinate service was in control of this connection when <code class="cCode">tpreturn()</code> was called, then it can pass an application defined return value and a typed buffer back to the originator of the connection. As part of ending the service routine, the server has torn down the connection. Thus, <code class="cCodeEmphasis">cd</code> is no longer a valid descriptor. If this event occurred as part of the recipient&#8217;s transaction, then the transaction is marked abort-only.
</div>
<h4 class="pDefTerm"><a name="wp1022989"> </a>
<code class="cCode">TPEV_SVCSUCC</code>
</h4><div class="pDefPara"><a name="wp1026687"> </a>
Received by the originator of a conversation, this event indicates that the subordinate service on the other end of the conversation has finished successfully as defined by the application (that is, it called <code class="cCode">tpreturn()</code> with <code class="cCode">TPSUCCESS</code>). As part of ending the service routine, the server has torn down the connection. Thus, <code class="cCodeEmphasis">cd</code> is no longer a valid descriptor. If the recipient is in transaction mode, then it can either commit (if it is also the initiator) or abort the transaction causing the work done by the server (if also in transaction mode) to either commit or abort.
</div>
<p class="pBody"><a name="wp1631170"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tprecv()</code>.
</p>
<h4 class="pHeading3"><a name="wp1022990"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1022991"> </a>
Upon return from <code class="cCode">tprecv()</code> where <code class="cCodeEmphasis">revent</code> is set to either <code class="cCode">TPEV_SVCSUCC</code> or <code class="cCode">TPEV_SVCFAIL</code>, the <code class="cCode">tpurcode</code> global contains an application defined value that was sent as part of <code class="cCode">tpreturn()</code>. 
</p>
<p class="pBody"><a name="wp1238118"> </a>
Upon failure, <code class="cCode">tprecv()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition. If a call fails with a particular <code class="cCode">tperrno</code> value, a subsequent call to <code class="cCode">tperrordetail()</code>, with no intermediate ATMI calls, may provide more detailed information about the generated error. Refer to the <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a> reference page for more information.
</p>
<h4 class="pHeading3"><a name="wp1022992"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1022993"> </a>
Upon failure, <code class="cCode">tprecv()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1022994"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1026691"> </a>
Invalid arguments were given (for example, data is not the address of a pointer to a buffer allocated by <code class="cCode">tpalloc()</code> or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1022995"> </a>
[<code class="cCode">TPEOTYPE</code>]
</h4><div class="pDefPara"><a name="wp1026695"> </a>
Either the type and subtype of the incoming buffer are not known to the caller, or <code class="cCode">TPNOCHANGE</code> was set in <code class="cCodeEmphasis">flags</code> and the type and subtype of <code class="cCodeEmphasis">*data </code>do not match the type and subtype of the incoming buffer. Regardless, neither <code class="cCodeEmphasis">*data</code>, its contents nor <code class="cCodeEmphasis">*len</code> are changed. If the conversation is part of the caller&#8217;s current transaction, then the transaction is marked abort-only because the incoming buffer is discarded.
</div>
<h4 class="pDefTerm"><a name="wp1022996"> </a>
[<code class="cCode">TPEBADDESC</code>]
</h4><div class="pDefPara"><a name="wp1026699"> </a>
<code class="cCodeEmphasis">cd</code> is invalid.
</div>
<h4 class="pDefTerm"><a name="wp1022997"> </a>
[<code class="cCode">TPETIME</code>]
</h4><div class="pDefPara"><a name="wp1854364"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tprecv()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854365"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.) In either case, no changes are made to <code class="cCode">*data</code> or its contents.
<a name="wp1854366"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854367"> </a>
When an ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1022998"> </a>
[<code class="cCode">TPEEVENT</code>]
</h4><div class="pDefPara"><a name="wp1026707"> </a>
An event occurred and its type is available in revent. There is a relationship between the [<code class="cCode">TPETIME</code>] and the [<code class="cCode">TPEEVENT</code>] return codes. While in transaction mode, if the receiving side of a conversation is blocked on <code class="cCode">tprecv</code> and the sending side calls <code class="cCode">tpabort()</code>, then the receiving side gets a return code of [<code class="cCode">TPEVENT</code>] with an event of <code class="cCode">TPEV_DISCONIMM</code>. If, however, the sending side calls <code class="cCode">tpabort()</code> before the receiving side calls <code class="cCode">tprecv()</code>, then the transaction may have already been removed from the GTT, which causes <code class="cCode">tprecv()</code> to fail with the [<code class="cCode">TPETIME</code>] code.
</div>
<h4 class="pDefTerm"><a name="wp1022999"> </a>
[<code class="cCode">TPEBLOCK</code>]
</h4><div class="pDefPara"><a name="wp1026711"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1023000"> </a>
[<code class="cCode">TPGOTSIG</code>]
</h4><div class="pDefPara"><a name="wp1026715"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1023001"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1027205"> </a>
<code class="cCode">tprecv()</code> was called in an improper context (for example, the connection was established such that the calling program can only send data).
</div>
<h4 class="pDefTerm"><a name="wp1023002"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1027280"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1023003"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1027300"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1023004"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1023005"> </a>
A server can pass an application defined return value and typed buffer when calling <code class="cCode">tpreturn()</code>. The return value is available in the global variable <code class="cCodeEmphasis">tpurcode</code> and the buffer is available in <code class="cCodeEmphasis">data</code>.
</p>
<h4 class="pHeading3"><a name="wp1023006"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023007"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1042150"><code class="cCode">tpdiscon(3c)</code></a>, <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>, <a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1023241"><code class="cCode">tpstrerrordetail(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044625"> </a>
tpresume(3c)
</h3>
<h4 class="pHeading3"><a name="wp1044626"> </a>
Name
</h4>
<p class="pBody"><a name="wp1044627"> </a>
<code class="cCode">tpresume()</code>&#8212;Resumes a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1044628"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1044629"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tpresume(TPTRANID *tranid, long flags)</code> 
</p>
<h4 class="pHeading3"><a name="wp1044630"> </a>
Description
</h4>
<p class="pBody"><a name="wp1044631"> </a>
<code class="cCode">tpresume()</code> is used to resume work on behalf of a previously suspended transaction. Once the caller resumes work on a transaction, it must either suspend it with <code class="cCode">tpsuspend()</code>, or complete it with one of <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> at a later time.
</p>
<p class="pBody"><a name="wp1044632"> </a>
The caller must ensure that its linked resource managers have been opened (via <code class="cCode">tpopen()</code>) before it can resume work on any transaction.
</p>
<p class="pBody"><a name="wp1044633"> </a>
<code class="cCode">tpresume()</code> places the caller in transaction mode on behalf of the global transaction identifier pointed to by <code class="cCodeEmphasis">tranid</code>. It is an error for <code class="cCodeEmphasis">tranid</code> to be NULL.
</p>
<p class="pBody"><a name="wp1044634"> </a>
Currently, <code class="cCodeEmphasis">flags</code> are reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1631178"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpresume()</code>.
</p>
<p class="pBody"><a name="wp2436142"> </a>
<code class="cCode">tpresume()</code>can take effect in all participated resource managers including those in a multiple resource mangers server group in a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1044635"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1044636"> </a>
<code class="cCode">tpresume()</code> returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1044637"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1044638"> </a>
Under the following conditions, <code class="cCode">tpresume()</code> fails and sets <code class="cCode">tperrno</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1044639"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1044640"> </a>
Either <code class="cCodeEmphasis">tranid</code> is a NULL pointer, it points to a non-existent transaction identifier (including previously completed or timed-out transactions), or it points to a transaction identifier that the caller is not allowed to resume. The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1044641"> </a>
[<code class="cCode">TPEMATCH</code>] 
</h4><div class="pDefPara"><a name="wp1044642"> </a>
<code class="cCodeEmphasis">tranid</code> points to a transaction identifier that another process has already resumed. The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1044643"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1044644"> </a>
The Oracle Tuxedo system is unable to resume the global transaction because the caller is currently participating in work outside any global transaction with one or more resource managers. All such work must be completed before a global transaction can be resumed. The caller&#8217;s state with respect to the local transaction is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1044645"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1044646"> </a>
<code class="cCode">tpresume()</code> was called in an improper context (for example, the caller is already in transaction mode). The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1044647"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1044648"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1044649"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1044650"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1044651"> </a>
Notes
</h4>
<p class="pBody"><a name="wp1044652"> </a>
XA-compliant resource managers must be successfully opened to be included in the global transaction. (See <a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a> for details.)
</p>
<p class="pBody"><a name="wp1044653"> </a>
A process resuming a suspended transaction must reside on the same logical machine (LMID) as the process that suspended the transaction. For a Workstation client, the workstation handler (WSH) to which it is connected must reside on the same logical machine as the handler for the Workstation client that suspended the transaction.
</p>
<h4 class="pHeading3"><a name="wp1044654"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1044655"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a>, <a href="rf3c.html#wp1045633"><code class="cCode">tpsuspend(3c)</code></a><code class="cCode">, tprmopen(3c), tprmclose(3c), tprmstart(3c), tprmend(3c)</code>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023041"> </a>
tpreturn(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023042"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023043"> </a>
<code class="cCode">tpreturn()</code>&#8212;Returns from an Oracle Tuxedo ATMI system service routine.
</p>
<h4 class="pHeading3"><a name="wp1023044"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1023045"> </a>
<code class="cCode">void tpreturn(int</code><code class="cCodeEmphasis"> rval</code><code class="cCode">, long </code><code class="cCodeEmphasis">rcode</code><code class="cCode">, char *</code><code class="cCodeEmphasis">data</code><code class="cCode">, long</code><code class="cCodeEmphasis"> len</code><code class="cCode">, long \ <br />  </code><code class="cCodeEmphasis">flags</code><code class="cCode">)</code> 
</p>
<h4 class="pHeading3"><a name="wp1023046"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023047"> </a>
<code class="cCode">tpreturn()</code> indicates that a service routine has completed. <code class="cCode">tpreturn()</code> acts like a <code class="cCode">return</code> statement in the C language (that is, when <code class="cCode">tpreturn()</code> is called, the service routine returns to the Oracle Tuxedo ATMI system dispatcher). It is recommended that <code class="cCode">tpreturn()</code> be called from within the service routine dispatched to ensure correct return of control to the Oracle Tuxedo ATMI system dispatcher.
</p>
<p class="pBody"><a name="wp1023048"> </a>
<code class="cCode">tpreturn()</code> is used to send a service&#8217;s reply message. If the program receiving the reply is waiting in either <code class="cCode">tpcall()</code>, <code class="cCode">tpgetrply()</code>, or <code class="cCode">tprecv()</code>, then after a successful call to <code class="cCode">tpreturn()</code>, the reply is available in the receiver&#8217;s buffer.
</p>
<p class="pBody"><a name="wp1023049"> </a>
For conversational services, <code class="cCode">tpreturn()</code> also tears down the connection. That is, the service routine cannot call <code class="cCode">tpdiscon()</code> directly. To ensure correct results, the program that connected to the conversational service should not call <code class="cCode">tpdiscon()</code>; rather, it should wait for notification that the conversational service has completed (that is, it should wait for one of the events, like <code class="cCode">TPEV_SVCSUCC</code> or <code class="cCode">TPEV_SVCFAIL</code>, sent by <code class="cCode">tpreturn()</code>).
</p>
<p class="pBody"><a name="wp1023050"> </a>
If the service routine was in transaction mode, <code class="cCode">tpreturn()</code> places the service&#8217;s portion of the transaction in a state from which it may be either committed or rolled back when the transaction is completed. A service may be invoked multiple times as part of the same transaction so it is not necessarily fully committed or rolled back until either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> is called by the originator of the transaction.
</p>
<p class="pBody"><a name="wp1023051"> </a>
<code class="cCode">tpreturn()</code> should be called after receiving all replies expected from service requests initiated by the service routine. Otherwise, depending on the nature of the service, either a <code class="cCode">TPESVCERR</code> status or a <code class="cCode">TPEV_SVCERR</code> event will be returned to the program that initiated communication with the service routine. Any outstanding replies that are not received will automatically be dropped by the communication manager. In addition, the descriptors for those replies become invalid.
</p>
<p class="pBody"><a name="wp1023052"> </a>
<code class="cCode">tpreturn()</code> should be called after closing all connections initiated by the service. Otherwise, depending on the nature of the service, either a <code class="cCode">TPESVCERR</code> or a <code class="cCode">TPEV_SVCERR</code> event will be returned to the program that initiated communication with the service routine. Also, an immediate disconnect event (that is, <code class="cCode">TPEV_DISCONIMM</code>) is sent over all open connections to subordinates.
</p>
<p class="pBody"><a name="wp1023053"> </a>
Since a conversational service has only one open connection which it did not initiate, the communication manager knows over which descriptor data (and any event) should be sent. For this reason, a descriptor is not passed to <code class="cCode">tpreturn()</code>.
</p>
<p class="pBody"><a name="wp1023054"> </a>
The following is a description of the arguments for <code class="cCode">tpreturn()</code>. <code class="cCodeEmphasis">rval</code> can be set to one of the following: 
</p>
<h4 class="pDefTerm"><a name="wp1023055"> </a>
<code class="cCode">TPSUCCESS</code>
</h4><div class="pDefPara"><a name="wp1027317"> </a>
The service has terminated successfully. If data is present, then it will be sent (barring any failures processing the return). If the caller is in transaction mode, then <code class="cCode">tpreturn()</code> places the caller&#8217;s portion of the transaction in a state such that it can be committed when the transaction ultimately commits. Note that a call to <code class="cCode">tpreturn()</code> does not necessarily finalize an entire transaction. Also, even though the caller indicates success, if there are any outstanding replies or open connections, if any work done within the service caused its transaction to be marked rollback-only, then a failed message is sent (that is, the recipient of the reply receives a <code class="cCode">TPESVCERR</code> indication or a <code class="cCode">TPEV_SVCERR</code> event). Note that if a transaction becomes rollback-only while in the service routine for any reason, then <code class="cCodeEmphasis">rval</code> should be set to <code class="cCode">TPFAIL</code>. If <code class="cCode">TPSUCCESS</code> is specified for a conversational service, a <code class="cCode">TPEV_SVCSUCC</code> event is generated.
</div>
<h4 class="pDefTerm"><a name="wp1023056"> </a>
<code class="cCode">TPFAIL</code>
</h4><div class="pDefPara"><a name="wp1027321"> </a>
The service has terminated unsuccessfully from an application standpoint. An error will be reported to the program receiving the reply. That is, the call to get the reply will fail and the recipient receives a <code class="cCode">TPSVCFAIL</code> indication or a <code class="cCode">TPEV_SVCFAIL</code> event. If the caller is in transaction mode, then <code class="cCode">tpreturn()</code> marks the transaction as rollback-only (note that the transaction may already be marked rollback-only). Barring any failures in processing the return, the caller&#8217;s data is sent, if present. One reason for not sending the caller&#8217;s data is that a transaction timeout has occurred. In this case, the program waiting for the reply will receive an error of <code class="cCode">TPETIME</code>. If <code class="cCode">TPFAIL</code> is specified for a conversational service, a <code class="cCode">TPEV_SVCFAIL</code> event is generated.
</div>
<h4 class="pDefTerm"><a name="wp1023057"> </a>
<code class="cCode">TPEXIT</code>
</h4><div class="pDefPara"><a name="wp1027325"> </a>
This value behaves the same as <code class="cCode">TPFAIL</code> with respect to completing the service, but when <code class="cCode">TPEXIT</code> is returned, the server exits after the transaction is rolled back and the reply is sent back to the requester. 
<a name="wp1405540"> </a>
When specified for a multithreaded process, <code class="cCode">TPEXIT</code> indicates that an entire process (not only a single thread within that process) will be killed.
<a name="wp1405541"> </a>
If the server is restartable, then the server is restarted automatically. 
</div>
<p class="pBody"><a name="wp1023058"> </a>
If <code class="cCodeEmphasis">rval</code> is not set to one of these three values, then it defaults to <code class="cCode">TPFAIL</code>.
</p>
<p class="pBody"><a name="wp1023059"> </a>
An application defined return code, <code class="cCodeEmphasis">rcode</code>, may be sent to the program receiving the service reply. This code is sent regardless of the setting of <code class="cCodeEmphasis">rval</code> as long as a reply can be successfully sent (that is, as long as the receiving call returns success or <code class="cCode">TPESVCFAIL</code>). In addition, for conversational services, this code can be sent only if the service routine has control of the connection when it issues <code class="cCode">tpreturn()</code>. The value of <code class="cCodeEmphasis">rcode</code> is available in the receiver in the variable, <code class="cCode">tpurcode()</code>.
</p>
<p class="pBody"><a name="wp1407637"> </a>
<code class="cCodeEmphasis">data</code> points to the data portion of a reply to be sent. If <code class="cCodeEmphasis">data</code> is non-NULL, it must point to a buffer previously obtained by a call to <code class="cCode">tpalloc()</code>. If this is the same buffer passed to the service routine upon its invocation, then its disposition is up to the Oracle Tuxedo ATMI system dispatcher; the service routine writer does not have to worry about whether it is freed or not. In fact, any attempt by the user to free this buffer will fail. However, if the buffer passed to <code class="cCode">tpreturn()</code> is not the same one with which the service is invoked, then <code class="cCode">tpreturn()</code> frees that buffer. Although the main buffer is freed, any buffers referenced by embedded fields within that buffer are not freed. <code class="cCodeEmphasis">len</code> specifies the amount of the data buffer to be sent. If <code class="cCodeEmphasis">data</code> points to a buffer which does not require a length to be specified, (for example, an FML fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and can be 0).
</p>
<p class="pBody"><a name="wp1023061"> </a>
If <code class="cCodeEmphasis">data</code> is NULL, then <code class="cCodeEmphasis">len</code> is ignored. In this case, if a reply is expected by the program that invoked the service, then a reply is sent with no data. If no reply is expected, then <code class="cCode">tpreturn()</code> frees <code class="cCodeEmphasis">data</code> as necessary and returns sending no reply.
</p>
<p class="pBody"><a name="wp1023062"> </a>
Currently, <code class="cCodeEmphasis">flags</code> is reserved for future use and must be set to 0 (if set to a non-zero value, the recipient of the reply receives a <code class="cCode">TPESVCERR</code> indication or a <code class="cCode">TPEV_SVCERR</code> event).
</p>
<p class="pBody"><a name="wp1023063"> </a>
If the service is conversational, there are two cases where the caller&#8217;s return code and the data portion are not transmitted: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1023064"> </a>If the connection has already been torn down when the call is made (that is, the caller has received <code class="cCode">TPEV_DISCONIMM</code> on the connection), then this call simply ends the service routine and rolls back the current transaction, if one exists.</li>
<li><a name="wp1023065"> </a>If the caller does not have control of the connection, either <code class="cCode">TPEV_SVCFAIL</code> or <code class="cCode">TPEV_SVCERR</code> is sent to the originator of the connection as described above. Regardless of which event the originator receives, no data is transmitted; however, if the originator receives the <code class="cCode">TPEV_SVCFAIL</code> event, the return code is available in the originator&#39;s <code class="cCode">tpurcode()</code> variable.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1023066"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023067"> </a>
A service routine does not return any value to its caller, the Oracle Tuxedo ATMI system dispatcher; thus, it is declared as a <code class="cCode">void</code>. Service routines, however, are expected to terminate using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. A conversational service routine must use <code class="cCode">tpreturn()</code>, and cannot use <code class="cCode">tpforward()</code>. If a service routine returns without using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> (that is, it uses the C language <code class="cCode">return</code> statement or just simply &#8220;falls out of the function&#8221;) or <code class="cCode">tpforward()</code> is called from a conversational server, the server will print a warning message in the log and return a service error to the service requester. In addition, all open connections to subordinates will be disconnected immediately, and any outstanding asynchronous replies will be dropped. If the server was in transaction mode at the time of failure, the transaction is marked rollback-only. Note also that if either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> are used outside of a service routine (for example, in clients, or in <code class="cCode">tpsvrinit()</code> or <code class="cCode">tpsvrdone()</code>), then these routines simply return having no effect.
</p>
<h4 class="pHeading3"><a name="wp1023068"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023069"> </a>
Since <code class="cCode">tpreturn()</code> ends the service routine, any errors encountered either in handling arguments or in processing cannot be indicated to the function&#8217;s caller. Such errors cause <code class="cCode">tperrno</code> to be set to <code class="cCode">TPESVCERR</code> for a program receiving the service&#8217;s outcome via either <code class="cCode">tpcall()</code> or <code class="cCode">tpgetrply()</code>, and cause the event, <code class="cCode">TPEV_SVCERR</code>, to be sent over the conversation to a program using <code class="cCode">tpsend()</code> or <code class="cCode">tprecv()</code>.
</p>
<p class="pBody"><a name="wp1023070"> </a>
If either <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in the <code class="cCode">TM_MIB</code> is non-zero, the event <code class="cCode">TPEV_SVCERR</code> is returned when a service timeout occurs.
</p>
<p class="pBody"><a name="wp1023071"> </a>
<code class="cCode">tperrordetail()</code> and <code class="cCode">tpstrerrordetail()</code> can be used to get additional information about an error produced by the last Oracle Tuxedo ATMI system routine called in the current thread. If an error occurred, <code class="cCode">tperrordetail()</code> returns a numeric value that can be used as an argument to <code class="cCode">trstrerrordetail()</code> to retrieve the text of the error detail.
</p>
<h4 class="pHeading3"><a name="wp1502458"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2437253"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1023105"><code class="cCode">tpsend(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2444274"><code class="cCode">tprmopen(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp1044795"><code class="cCode">tprmclose(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2446395"><code class="cCode">tprmstart(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2440145"><code class="cCode">tprmend(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2437258"> </a>
tpsblktime(3c)
</h3>
<h4 class="pHeading3"><a name="wp2180281"> </a>
Name
</h4>
<p class="pBody"><a name="wp2180282"> </a>
<code class="cCode">tpsblktime()</code> &#8212;Routine for setting blocktime in seconds for the next service call or for all service calls
</p>
<h4 class="pHeading3"><a name="wp2180283"> </a>
Synopsis
</h4>
<a name="wp2180284"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />int <code class="cCode">tpsblktime(int blktime,</code>long flags<code class="cCode">)</code></pre></div><h4 class="pHeading3"><a name="wp2180285"> </a>
Description
</h4>
<p class="pBody"><a name="wp2180286"> </a>
<code class="cCode">tpsblktime()</code> is used to set the blocktime value, in seconds, of a potential blocking<span style="font-style: italic"> </span>API. A <span style="font-style: italic">potential blocking </span>API is defined as: any system API that can use the flag <code class="cCode">TBNOBLOCK</code> as a value. It does not have any effect on transaction timeout values.
</p>
<p class="pBody"><a name="wp2180287"> </a>
The <code class="cCode">blktime</code> range is 0 to 32767. Effective blocktime values are rounded up to the nearest multiple of the <code class="cCode">SCANUNIT</code> value as depicted in the following example:
</p>
<p class="pGraphic"><a name="wp2180307"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp2180290table2180288">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp2180290"> </a>
User Set Blocktime Value
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2180292"> </a>
Scanunit Value
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp2180294"> </a>
Effective Blocktime Value
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180296"> </a>
13
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180298"> </a>
5
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180300"> </a>
15
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180302"> </a>
18
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180304"> </a>
5
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp2180306"> </a>
20
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp2180308"> </a>
A 0 value indicates that any <span style="font-style: italic">previously set</span> blocking time flag value is cancelled, and the blocking time set with a different blocktime flag value prevails. If <code class="cCode">tpsblktime()</code> is not called, the <code class="cCode">BLOCKTIME</code> value in the <code class="cCode">*SERVICES</code> section or the default <code class="cCode">*RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file is used. 
</p>
<a name="wp2180309"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Blocking timeouts set with <code class="cCode">tpsblktime()</code> take precedence over the <code class="cCode">BLOCKTIME parameter</code> set in the <code class="cCode">SERVICES</code> and <code class="cCode">RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file. The precedence for blocktime checking is as follows:<br /><code class="cCode">tpsblktime(TPBLK_NEXT)</code>, <code class="cCode">tpsblktime(TPBLK_ALL)</code>, <code class="cCode">*SERVICES</code>, <code class="cCode">*RESOURCES</code></td>
</tr>
</table>

<p class="pBody"><a name="wp2180733"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>:
</p>
<h4 class="pDefTerm"><a name="wp2180734"> </a>
<code class="cCode">TPBLK_NEXT</code>
</h4><div class="pDefPara"><a name="wp2180735"> </a>
This flag sets the blocktime value, in seconds, for the <span style="font-style: italic">next</span> potential blocking API. <br />Any API that is called containing the <code class="cCode">TPNOBLOCK</code> flag is not effected by <code class="cCode">tpsblktime (TPBLK_NEXT)</code>and continues to be non-blocking.
</div>
<div class="pDefParaCont"><a name="wp2180736"> </a>
A <code class="cCode">TPBLK_NEXT</code> flag value overrides a <code class="cCode">TPBLK_ALL</code> flag value for those API calls that immediately follow it. For example:
<a name="wp2181674"> </a><div class="pPreformattedRelative"><pre><code class="cCode">tpsblktime(50,TPBLK_ALL)<br />tpcall(one)<br />tpsblktime(30,TPBLK_NEXT)<br />tpcall(two) <br />tpcall(three)</code></pre></div><a name="wp2181685"> </a>
<code class="cCode">tpcall(two) will</code> have a 30 second blocking timeout based on <code class="cCode">tpsblktime(30,TPBLK_NEXT)</code>. <code class="cCode">tpcall(one)</code> and <code class="cCode">tpcall(three) will</code> have a 50 second blocking timeout based on <code class="cCode">tpsblktime(50,TPBLK_ALL)</code>.
<a name="wp2180741"> </a>
<code class="cCode">tpsblktime(TPBLK_NEXT)</code> operates on a <span style="font-style: italic">per-thread</span> basis. Therefore, it is not necessary for applications to use any mutex around the <code class="cCode">tpsblktime(TPBLK_NEXT)</code>call and the subsequent API call which it affects.
</div>
<h4 class="pDefTerm"><a name="wp2181175"> </a>
<code class="cCode">TPBLK_ALL</code>
</h4><div class="pDefPara"><a name="wp2181176"> </a>
This flag sets the blocktime value, in seconds, for the <span style="font-style: italic">all </span>subsequent<span style="font-style: italic"> </span>potential blocking APIs until the next <code class="cCode">tpsblktime()</code> is called within that context. Any API that is called containing the <code class="cCode">TPNOBLOCK</code> flag is not effected by <code class="cCode">tpsblktime(TPBLK_ALL)</code> and continues to be non-blocking.
</div>
<div class="pDefParaCont"><a name="wp2181177"> </a>
<code class="cCode">tpsblktime(TPBLK_ALL)</code> operates on a <span style="font-style: italic">per-context</span> basis. Therefore, it is necessary to call <code class="cCode">tpsblktime(TPBLK_ALL)</code> in only one thread of context that is used in multiple threads.
<a name="wp2181181"> </a>
<code class="cCode">tpsblktime(TPBLK_ALL)</code>will not affect any context that follows after <a href="rf3c.html#wp1219084">tpterm(3c)</a> is called.
<a name="wp2181706"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In order to perform blocking time values that are not affected by thread timing dependencies, it is best that <code class="cCode">tpsblktime(TPBLK_ALL)</code> is called in a multi-threaded context immediately after <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a> using the <code class="cCode">TPMULTICONTEXTS</code> flag and before the return value of <a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a> is made available to other threads.</td>
</tr>
</table>

</div>
<a name="wp2181192"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>When <code class="cCode">tpsblktime(TPBLK_ALL)</code> is called in a service on a multi-threaded server, it will affect the <span style="font-style: italic">currently </span>executed thread only. To set the blocktime for all services, it is best to use <code class="cCode">tpsblktime(TPBLK_ALL)</code> with <a href="rf3c.html#wp1023306"><code class="cCode">tpsvrinit(3c)</code></a> or <a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>.</td>
</tr>
</table>
<h4 class="pHeading3"><a name="wp2181199"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2181200"> </a>
<code class="cCode">tpsblktime()</code>returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2181201"> </a>
Error
</h4>
<p class="pBody"><a name="wp2181202"> </a>
Upon failure, <code class="cCode">tpsblktime()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2181203"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp2181204"> </a>
Invalid arguments were given. For example, the value of <code class="cCodeEmphasis">blktime</code> is negative or more than one <code class="cCode">TPBLK_NEXT</code> and <code class="cCode">TPBLK_ALL</code> blocktime flag value is specified.
</div>
<h4 class="pDefTerm"><a name="wp2181205"> </a>
[<code class="cCode">TPERELEASE</code>]
</h4><div class="pDefPara"><a name="wp2181206"> </a>
<code class="cCode">tpsblktime() </code>was called in a client attached to a workstation handler running an earlier Tuxedo release.
</div>
<h4 class="pDefTerm"><a name="wp2181207"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2181208"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp2181640"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2181656"> </a>
<a href="rf3c.html#wp1021731">tpcall(3c)</a>, <a href="rf3c.html#wp1040811">tpcommit(3c)</a>, <a href="rf3c.html#wp1022967">tprecv(3c)</a>, <a href="rf3c.html#wp2178582">tpgblktime(3c)</a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044795"> </a>
tprmclose(3c)
</h3>
<h4 class="pHeading3"><a name="wp2440271"> </a>
Name
</h4>
<p class="pBody"><a name="wp2440272"> </a>
<code class="cCode">tprmclose()</code> - Routine that closes a specified RM configured in a multiple RMs server group.
</p>
<h4 class="pHeading3"><a name="wp2440274"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2440275"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tprmclose(char *rmname, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp2440278"> </a>
Description
</h4>
<p class="pBody"><a name="wp2440279"> </a>
<code class="cCode">tprmclose()</code> closes a specified resource manager by the argument rmname. If current context is in a transaction context, this routine does nothing and returns error to caller. If current RM is still not opened or already closed (that is,<code class="cCode"> tprmclose() </code>is called more than once), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp2440280"> </a>
<code class="cCode">tprmclose() </code>can only close those resource manager opened via <code class="cCode">tprmopen()</code> routine.
</p>
<p class="pBody"><a name="wp2440281"> </a>
The first parameter <code class="cCode">rmname</code> currently must be a value which is configured in the <code class="cCode">*RMS</code> section of UBBCONFIG. The flags must be 0.
</p>
<h4 class="pHeading3"><a name="wp2440283"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2440284"> </a>
Upon failure, <code class="cCode">tprmclose() </code>returns -1 and sets the tperrno to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2440286"> </a>
Error
</h4>
<p class="pBody"><a name="wp2440287"> </a>
Upon failure, <code class="cCode">tprmclose()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2440288"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp2440289"> </a>
A resource manager failed to close correctly. More information concerning the reason a resource manager failed to close can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp2440291"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2440292"> </a>
<code class="cCode">tprmclose()</code> was called in a improper context. For example, it was invoked by a server which is not built specified using the <code class="cCode">-M </code>option when executing buildserver, it was executed in an ongoing transaction context.
</div>
<h4 class="pDefTerm"><a name="wp2440295"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2440296"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">rmname</code> is NULL or not a valid resource manager name configured in current <code class="cCode">*RMS</code> section which is associated with a multiple resource managers server group).
</div>
<h4 class="pDefTerm"><a name="wp2440298"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2440299"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2440301"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2440302"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp2440304"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2440305"> </a>
<a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a>, <a href="rf3c.html#wp1040568"><code class="cCode">tpclose(3c)</code></a><code class="cCode">)</code>, <a href="rf3c.html#wp2444274"><code class="cCode">tprmopen(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2440145"> </a>
tprmend(3c)
</h3>
<h4 class="pHeading3"><a name="wp2442324"> </a>
Name
</h4>
<p class="pBody"><a name="wp2442325"> </a>
<code class="cCode">tprmend()</code> - Routine for ending current work performed on behalf of a transaction branch in a specified RM.
</p>
<h4 class="pHeading3"><a name="wp2442327"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2442328"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tprmend (char *rmname, long flags);</code>
</p>
<h4 class="pHeading3"><a name="wp2442331"> </a>
Description
</h4>
<p class="pBody"><a name="wp2442332"> </a>
<code class="cCode">tprmend() </code>ends current work performed on behalf of a transaction branch in a specified RM. This routine informs the resource manager to disassociate with the transaction branch. If current RM is still not opened or current context is not in a transaction state, <code class="cCode">tprmend()</code> does nothing and return success to caller. 
</p>
<p class="pBody"><a name="wp2442333"> </a>
The first parameter <code class="cCode">rmid</code> currently must be a value which is configured in UBBCONFIG of this multiple resource manager group. The flags must be 0.
</p>
<h4 class="pHeading3"><a name="wp2442335"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2442336"> </a>
Upon failure, <code class="cCode">tprmend()</code> returns -1 and sets the tperrno to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2442338"> </a>
Error
</h4>
<p class="pBody"><a name="wp2442339"> </a>
Upon failure,<code class="cCode"> tprmend() </code>sets tperrno to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2442340"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp2442341"> </a>
An error occurred in dissociating the transaction branch operation. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp2442343"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2442344"> </a>
<code class="cCode">tprmend()</code> was called in a improper context (for example, it war invoked in a server which was not specified with <code class="cCode">-M </code>option when executing buildserver). 
</div>
<h4 class="pDefTerm"><a name="wp2442346"> </a>
<code class="cCode">[TPETRAN]</code>
</h4><div class="pDefPara"><a name="wp2442347"> </a>
<code class="cCode">tprmend()</code> was called in a non-transaction context. 
</div>
<h4 class="pDefTerm"><a name="wp2442349"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2442350"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">rmname</code> parameter is NULL or not a valid resource manager name configured in current multiple resource managers server group).
</div>
<h4 class="pDefTerm"><a name="wp2442352"> </a>
[<code class="cCode">TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2442353"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2442355"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2442356"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp2442358"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2444272"> </a>
<code class="cCode">tprmstart(3c)</code>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2444274"> </a>
tprmopen(3c)
</h3>
<h4 class="pHeading3"><a name="wp2444299"> </a>
Name
</h4>
<p class="pBody"><a name="wp2444300"> </a>
<code class="cCode">tprmopen()</code> - Routines for open a specified RM configured in the UBBCONFIG <code class="cCode">*RMS</code> section which is associated with a multiple RMs server group.
</p>
<h4 class="pHeading3"><a name="wp2444302"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2444303"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tprmopen(char *rmname, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp2444306"> </a>
Description
</h4>
<p class="pBody"><a name="wp2444307"> </a>
<code class="cCode">tprmopen()</code> opens a specific resource manager by name configured in the UBBCONFIG <code class="cCode">*RMS</code> section and associated with a multiple resource managers server group. If the resource manager specified by <code class="cCode">rmname</code> is already open (that is, <code class="cCode">tprmopen()</code> is called more than once with this r<code class="cCode">mname</code>, or the <code class="cCode">rmname</code> has been opened by <code class="cCode">tpopen()</code>), no action is taken and success is returned. 
</p>
<p class="pBody"><a name="wp2444308"> </a>
The first parameter <code class="cCode">rmname</code> currently must be a value which is configured in UBBCONFIG of this multiple resource manager group. The flags must be 0.
</p>
<h4 class="pHeading3"><a name="wp2444310"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2444311"> </a>
Upon failure, <code class="cCode">tprmopen()</code> returns <code class="cCode">-1</code> and sets the tperrno to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2444313"> </a>
Error
</h4>
<p class="pBody"><a name="wp2444314"> </a>
Upon failure,<code class="cCode"> tprmopen()</code> sets tperrno to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2444315"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp2444316"> </a>
A resource manager failed to open correctly. More information concerning the reason a resource manager failed to open can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp2444318"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2444319"> </a>
<code class="cCode">tprmopen()</code> was called in a improper context(for example, it was invoked by a server which is not built with <code class="cCode">-M</code> option by buildserver, it was invoked by a client process).
</div>
<h4 class="pDefTerm"><a name="wp2444321"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2444322"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">rmname</code> is null or not a valid resource manager name configured in the UBBCONFIG <code class="cCode">*RMS</code> section associated with an Multiple RMs server group). 
</div>
<div class="pDefParaCont"><a name="wp2444323"> </a>
The other case is this RM is not a CAE specification of RM.
</div>
<h4 class="pDefTerm"><a name="wp2444325"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2444326"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2444328"> </a>
<code class="cCode">[TPEOS]</code>
</h4><p class="pBody"><a name="wp2444329"> </a>
An operating system error has occurred.
</p>
<h4 class="pHeading3"><a name="wp2444331"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2446393"> </a>
<a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp1040568"><code class="cCode">tpclose(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp1044795"><code class="cCode">tprmclose(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2446395"> </a>
tprmstart(3c)
</h3>
<h4 class="pHeading3"><a name="wp2446453"> </a>
Name
</h4>
<p class="pBody"><a name="wp2446454"> </a>
<code class="cCode">tprmstart() </code>- Routine that starts work on behalf of a transaction branch of a specified RM in a MRM server.
</p>
<h4 class="pHeading3"><a name="wp2446456"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2446457"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tprmstart (char *rmname, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp2446460"> </a>
Description
</h4>
<p class="pBody"><a name="wp2446461"> </a>
<code class="cCode">tprmstart() </code>informs the opened RM to join this transaction work unit on behalf of a transaction branch. If current RM is already in started state, then this routine skips the operation. If current RM is still not opened, <code class="cCode">tprmstart()</code> does nothing and return error to caller. 
</p>
<p class="pBody"><a name="wp2446462"> </a>
The first parameter <code class="cCode">rmname</code> currently must be a value which is configured in UBBCONFIG of this multiple resource manager group. The flags must be 0.
</p>
<p class="pBody"><a name="wp2446463"> </a>
<code class="cCode">tprmstart()</code> does not support old preliminary specification type of RM.
</p>
<h4 class="pHeading3"><a name="wp2446465"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2446466"> </a>
Upon failure, <code class="cCode">tprmstart()</code> returns <code class="cCode">-1</code> and sets the tperrno to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2446468"> </a>
Error
</h4>
<p class="pBody"><a name="wp2446469"> </a>
Upon failure, <code class="cCode">tprmopen()</code> sets tperrno to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp2446470"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp2446471"> </a>
A resource manager failed to start correctly. More information concerning the reason a resource manager failed to start can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp2446473"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2446474"> </a>
<code class="cCode">tprmstart()</code> was called in a improper context (for example, it was invoked by a server which is not in a Multiple RMs server group or current process was not built with <code class="cCode">-M</code> option in buildserver, the current RM is still not open).
</div>
<h4 class="pDefTerm"><a name="wp2446476"> </a>
<code class="cCode">[TPETRAN]</code>
</h4><div class="pDefPara"><a name="wp2446477"> </a>
<code class="cCode">tprmstart()</code> was called in a non-transaction context.
</div>
<h4 class="pDefTerm"><a name="wp2446479"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2446480"> </a>
Invalid parameters were given (for example, the flags value is not 0, or <code class="cCode">rmname</code> is NULL or not a valid resource manager name configured in the <code class="cCode">*RM</code>S section which is associated with a multiple resource managers server group).
</div>
<h4 class="pDefTerm"><a name="wp2446482"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2446483"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp2446485"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2446486"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp2446488"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2446489"> </a>
<a href="rf3c.html#wp2440145"><code class="cCode">tprmend(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2446410"> </a>
tpscmt(3c)
</h3>
<h4 class="pHeading3"><a name="wp2446396"> </a>
Name
</h4>
<p class="pBody"><a name="wp1044797"> </a>
<code class="cCode">tpscmt()</code>&#8212;Routine for setting when <code class="cCode">tpcommit()</code> should return.
</p>
<h4 class="pHeading3"><a name="wp1044798"> </a>
Synopsis
</h4>
<a name="wp1044799"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpscmt(long flags) </pre></div><h4 class="pHeading3"><a name="wp1044800"> </a>
Description
</h4>
<p class="pBody"><a name="wp1044801"> </a>
<code class="cCode">tpscmt()</code> sets the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic to the value specified in <code class="cCodeEmphasis">flags</code>. The <code class="cCode">TP_COMMIT_CONTROL</code> characteristic affects the way <code class="cCode">tpcommit()</code> behaves with respect to returning control to its caller. A program can call <code class="cCode">tpscmt()</code> regardless of whether it is in transaction mode or not. Note that if the caller is participating in a transaction that another program must commit, then its call to <code class="cCode">tpscmt()</code> does not affect that transaction. Rather, it affects subsequent transactions that the caller will commit.
</p>
<p class="pBody"><a name="wp1044802"> </a>
In most cases, a transaction is committed only when an Oracle Tuxedo ATMI system thread of control calls <code class="cCode">tpcommit()</code>. There is one exception: when a service is dispatched in transaction mode because the <code class="cCode">AUTOTRAN</code> variable in the <code class="cCode">*SERVICES</code> section of the <code class="cCode">UBBCONFIG</code> file is enabled, then the transaction completes upon calling <code class="cCode">tpreturn()</code>. If <code class="cCode">tpforward()</code> is called, then the transaction will be completed by the server ultimately calling <code class="cCode">tpreturn()</code>. Thus, the setting of the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic in the service that calls <code class="cCode">tpreturn()</code> determines when <code class="cCode">tpcommit()</code> returns control within a server. If <code class="cCode">tpcommit()</code> returns a heuristic error code, the server will write a message to a log file.
</p>
<p class="pBody"><a name="wp1044803"> </a>
When a client joins an Oracle Tuxedo ATMI system application, the initial setting for this characteristic comes from a configuration file. (See the <code class="cCode">CMTRET</code> variable in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>)
</p>
<p class="pBody"><a name="wp1044804"> </a>
The following are the valid settings for <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1044805"> </a>
<code class="cCode">TP_CMT_LOGGED</code> 
</h4><div class="pDefPara"><a name="wp1044806"> </a>
This flag indicates that <code class="cCode">tpcommit()</code> should return after the commit decision has been logged by the first phase of the two-phase commit protocol but before the second phase has completed. This setting allows for faster response to the caller of <code class="cCode">tpcommit()</code> although there is a risk that a transaction participant might decide to heuristically complete (that is, abort) its work due to timing delays waiting for the second phase to complete. If this occurs, there is no way to indicate this situation to the caller since <code class="cCode">tpcommit()</code> has already returned (although the Oracle Tuxedo ATMI system writes a message to a log file when a resource manager takes a heuristic decision). Under normal conditions, participants that promise to commit during the first phase will do so during the second phase. Typically, problems caused by network or site failures are the sources for heuristic decisions being made during the second phase.
</div>
<h4 class="pDefTerm"><a name="wp1044807"> </a>
<code class="cCode">TP_CMT_COMPLETE</code> 
</h4><div class="pDefPara"><a name="wp1044808"> </a>
This flag indicates that <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a> should return after the two-phase commit protocol has finished completely. This setting allows for <code class="cCode">tpcommit()</code> to return an indication that a heuristic decision occurred during the second phase of commit.
</div>
<p class="pBody"><a name="wp1631186"> </a>
In a multi-threaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpscmt()</code>.
</p>
<h4 class="pHeading3"><a name="wp1044809"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1044810"> </a>
Upon success, <code class="cCode">tpscmt()</code> returns the previous value of the <code class="cCode">TP_COMMIT_CONTROL</code> characteristic.
</p>
<p class="pBody"><a name="wp1238127"> </a>
Upon failure, <code class="cCode">tpscmt()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1044811"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1044812"> </a>
Upon failure, <code class="cCode">tpscmt()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1044813"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1044814"> </a>
<code class="cCodeEmphasis">flags</code> is not one of <code class="cCode">TP_CMT_LOGGED</code> or <code class="cCode">TP_CMT_COMPLETE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1044815"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1044816"> </a>
<code class="cCode">tpscmt()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1044817"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1044818"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1044819"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1044820"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1044821"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1044822"> </a>
When using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code> and <code class="cCode">tpabort()</code> to delineate an Oracle Tuxedo ATMI system transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI system transaction.
</p>
<h4 class="pHeading3"><a name="wp1044823"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1044824"> </a>
<a href="rf3c.html#wp1036832"><code class="cCode">tpabort(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1040811"><code class="cCode">tpcommit(3c)</code></a>, <a href="rf3c.html#wp1225812"><code class="cCode">tpgetlev(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1261252"> </a>
tpseal(3c)
</h3>
<h4 class="pHeading3"><a name="wp1261253"> </a>
Name
</h4>
<p class="pBody"><a name="wp1261254"> </a>
<code class="cCode">tpseal()</code>&#8212;Marks a typed message buffer for encryption. 
</p>
<h4 class="pHeading3"><a name="wp1261255"> </a>
Synopsis
</h4>
<a name="wp1261256"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpseal(char *<code class="cCodeEmphasis">data</code>, TPKEY <code class="cCodeEmphasis">hKey</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1261257"> </a>
Description
</h4>
<p class="pBody"><a name="wp1261258"> </a>
<code class="cCode">tpseal()</code> marks, or registers, a message buffer for encryption. The principal who owns <code class="cCodeEmphasis">hKey</code> can decrypt this buffer and access its content. A buffer may be sealed for more than one recipient principal by making several calls to <code class="cCode">tpseal()</code>. 
</p>
<p class="pBody"><a name="wp1261259"> </a>
<code class="cCodeEmphasis">data</code> must point to a valid typed message buffer either (1) previously allocated by a process calling <code class="cCode">tpalloc()</code> or (2) delivered by the system to a receiving process. The content of the buffer may be modified after <code class="cCode">tpseal()</code> is invoked.
</p>
<p class="pBody"><a name="wp1583431"> </a>
When the message buffer pointed to by <code class="cCodeEmphasis">data</code> is transmitted from a process, the public key software encrypts the message content and attaches an encryption envelope to the message buffer for each encryption registration request. An encryption envelope enables a receiving process to decrypt the message.
</p>
<p class="pBody"><a name="wp1261260"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and must be set to 0. 
</p>
<h4 class="pHeading3"><a name="wp1261261"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1261262"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1261263"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1261264"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1261265"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">hKey</code> is not a valid key for encrypting or <code class="cCodeEmphasis">data</code> is NULL.
</div>
<h4 class="pDefTerm"><a name="wp1261266"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1261267"> </a>
An error has occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1261268"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1261269"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023105"> </a>
tpsend(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023106"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023107"> </a>
<code class="cCode">tpsend()</code>&#8212;Routine for sending a message in a conversational connection.
</p>
<h4 class="pHeading3"><a name="wp1023108"> </a>
Synopsis
</h4>
<a name="wp1023109"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;atmi.h&gt;<br />int tpsend(int </code><code class="cCodeEmphasis">cd</code><code class="cCode">, char *</code><code class="cCodeEmphasis">data</code><code class="cCode">, long </code><code class="cCodeEmphasis">len</code><code class="cCode">, long </code><code class="cCodeEmphasis">flags</code><code class="cCode">, long *</code><code class="cCodeEmphasis">revent</code><code class="cCode">)</code></pre></div><h4 class="pHeading3"><a name="wp1023110"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023111"> </a>
<code class="cCode">tpsend()</code> is used to send data across an open connection to another program. The caller must have control of the connection. <code class="cCode">tpsend()</code>&#8217;s first argument, <code class="cCodeEmphasis">cd</code>, specifies the open connection over which data is sent. <code class="cCodeEmphasis">cd</code> is a descriptor returned from either <code class="cCode">tpconnect()</code> or the <code class="cCode">TPSVCINFO</code> parameter passed to a conversational service.
</p>
<p class="pBody"><a name="wp1023112"> </a>
The second argument, <code class="cCodeEmphasis">data</code>, must point to a buffer previously allocated by <code class="cCode">tpalloc()</code>. <code class="cCodeEmphasis">len</code> specifies how much of the buffer to send. Note that if <code class="cCodeEmphasis">data</code> points to a buffer of a type that does not require a length to be specified (for example, an <code class="cCode">FML</code> fielded buffer), then <code class="cCodeEmphasis">len</code> is ignored (and may be 0). Also, <code class="cCodeEmphasis">data</code> can be NULL in which case <code class="cCodeEmphasis">len</code> is ignored (no application data is sent&#8212;this might be done, for instance, to grant control of the connection without transmitting any data). The type and subtype of <code class="cCodeEmphasis">data</code> must match one of the types and subtypes recognized by the other end of the connection.
</p>
<p class="pBody"><a name="wp1023113"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1023114"> </a>
<code class="cCode">TPRECVONLY</code>
</h4><div class="pDefPara"><a name="wp1027330"> </a>
This flag signifies that, after the caller&#8217;s data is sent, the caller gives up control of the connection (that is, the caller can not issue any more <code class="cCode">tpsend</code>() calls). When the receiver on the other end of the connection receives the data sent by <code class="cCode">tpsend()</code>, it will also receive an event (<code class="cCode">TPEV_SENDONLY</code>) indicating that it has control of the connection (and can not issue more any <code class="cCode">tprecv()</code> calls).
</div>
<h4 class="pDefTerm"><a name="wp1023115"> </a>
<code class="cCode">TPNOBLOCK</code>
</h4><div class="pDefPara"><a name="wp1027334"> </a>
The data and any events are not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1023116"> </a>
<code class="cCode">TPNOTIME</code>
</h4><div class="pDefPara"><a name="wp1027338"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1023117"> </a>
<code class="cCode">TPSIGRSTRT</code>
</h4><div class="pDefPara"><a name="wp1027342"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued.
</div>
<p class="pBody"><a name="wp1023118"> </a>
If an event exists for the descriptor, <code class="cCodeEmphasis">cd</code>, then <code class="cCode">tpsend()</code> will fail without sending the caller&#8217;s data. The event type is returned in <code class="cCodeEmphasis">revent</code>. Valid events for <code class="cCode">tpsend()</code> are as follows:
</p>
<h4 class="pDefTerm"><a name="wp1023119"> </a>
<code class="cCode">TPEV_DISCONIMM</code>
</h4><div class="pDefPara"><a name="wp1027347"> </a>
Received by the subordinate of a conversation, this event indicates that the originator of the conversation has issued an immediate disconnect on the connection via <code class="cCode">tpdiscon()</code>, or it issued <code class="cCode">tpreturn()</code>, <code class="cCode">tpcommit()</code> or <code class="cCode">tpabort()</code> with the connection still open. This event is also returned to the originator or subordinate when a connection is broken due to a communications error (for example, a server, machine, or network failure).
</div>
<h4 class="pDefTerm"><a name="wp1023120"> </a>
<code class="cCode">TPEV_SVCERR</code>
</h4><div class="pDefPara"><a name="wp1027363"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">tpreturn()</code> without having control of the conversation. In addition, <code class="cCode">tpreturn()</code> has been issued in a manner different from that described for <code class="cCode">TPEV_SVCFAIL</code> below. This event can be caused by an ACL permissions violation; that is, the originator does not have permission to connect to the receiving process. This event is not returned at the time the <code class="cCode">tpconnect()</code> is issued, but is returned with the first <code class="cCode">tpsend()</code> (following a <code class="cCode">tpconnect()</code> with flag <code class="cCode">TPSENDONLY</code>) or <code class="cCode">tprecv()</code> (following a <code class="cCode">tpconnect()</code> with flag <code class="cCode">TPRECVONLY</code>). A system event and a log message are also generated.
</div>
<h4 class="pDefTerm"><a name="wp1023121"> </a>
<code class="cCode">TPEV_SVCFAIL</code>
</h4><div class="pDefPara"><a name="wp1027376"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">tpreturn()</code> without having control of the conversation. In addition, <code class="cCode">tpreturn()</code> was issued with the <code class="cCodeEmphasis">rval</code> set to <code class="cCode">TPFAIL</code> or <code class="cCode">TPEXIT</code> and <code class="cCodeEmphasis">data</code> to NULL.
</div>
<p class="pBody"><a name="wp1023122"> </a>
Because each of these events indicates an immediate disconnection notification (that is, abortive rather than orderly), data in transit may be lost. The descriptor used for the connection is no longer valid. If the two programs were participating in the same transaction, then the transaction has been marked abort-only.
</p>
<p class="pBody"><a name="wp1023123"> </a>
If the value of either <code class="cCode">SVCTIMEOUT</code> in the <code class="cCode">UBBCONFIG</code> file or <code class="cCode">TA_SVCTIMEOUT</code> in the <code class="cCode">TM_MIB</code> is non-zero, <code class="cCode">TPESVCERR</code> is returned when a service timeout occurs.
</p>
<p class="pBody"><a name="wp1631703"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpsend()</code>.
</p>
<h4 class="pHeading3"><a name="wp1023124"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023125"> </a>
Upon return from <code class="cCode">tpsend()</code> where <code class="cCodeEmphasis">revent</code> is set to either <code class="cCode">TPEV_SVCSUCC</code> or <code class="cCode">TPEV_SVCFAIL</code>, the <code class="cCode">tpurcode()</code> global contains an application-defined value that was sent as part of <code class="cCode">tpreturn()</code>. The function <code class="cCode">tpsend()</code> returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition. Also, if an event exists and no errors were encountered, <code class="cCode">tpsend()</code> returns -1 and <code class="cCode">tperrno</code> is set to <code class="cCode">[TPEEVENT]</code>.
</p>
<h4 class="pHeading3"><a name="wp1023126"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023127"> </a>
Upon failure, <code class="cCode">tpsend()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1023128"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1535553"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">data</code> does not point to a buffer allocated by <code class="cCode">tpalloc()</code> or <code class="cCodeEmphasis">flags</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1535554"> </a>
[<code class="cCode">TPEBADDESC</code>]
</h4><div class="pDefPara"><a name="wp1027409"> </a>
<code class="cCodeEmphasis">cd</code> is invalid.
</div>
<h4 class="pDefTerm"><a name="wp1023130"> </a>
[<code class="cCode">TPETIME</code>]
</h4><div class="pDefPara"><a name="wp1854374"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpsend()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854375"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854376"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854377"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1850606"> </a>
[<code class="cCode">TPEEVENT</code>]
</h4><div class="pDefPara"><a name="wp1027417"> </a>
An event occurred. <code class="cCodeEmphasis">data</code> is not sent when this error occurs. The event type is returned in <code class="cCodeEmphasis">revent</code>.
</div>
<h4 class="pDefTerm"><a name="wp1023132"> </a>
[<code class="cCode">TPEBLOCK</code>]
</h4><div class="pDefPara"><a name="wp1027421"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1023133"> </a>
[<code class="cCode">TPGOTSIG</code>]
</h4><div class="pDefPara"><a name="wp1027425"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1023134"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1027429"> </a>
<code class="cCode">tpsend()</code> was called in an improper context (for example, the connection was established such that the calling program can only receive data).
</div>
<h4 class="pDefTerm"><a name="wp1023135"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1027433"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1023136"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1027437"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1023137"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023138"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp1042150"><code class="cCode">tpdiscon(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044944"> </a>
tpservice(3c)
</h3>
<h4 class="pHeading3"><a name="wp1044945"> </a>
Name
</h4>
<p class="pBody"><a name="wp1044946"> </a>
<code class="cCode">tpservice()</code>&#8212;Template for service routines.
</p>
<h4 class="pHeading3"><a name="wp1044947"> </a>
Synopsis
</h4>
<a name="wp1044948"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;                   /* C interface */  <br />void tpservice(TPSVCINFO *svcinfo)  /* C++ interface - must have<br />                                     * C linkage */  <br />extern &#8220;C&#8221; void tpservice(TPSVCINFO *svcinfo) </pre></div><h4 class="pHeading3"><a name="wp1044949"> </a>
Description
</h4>
<p class="pBody"><a name="wp1044950"> </a>
<code class="cCode">tpservice()</code> is the template for writing service routines. This template is used for services that receive requests via <code class="cCode">tpcall()</code>, <code class="cCode">tpacall()</code> or <code class="cCode">tpforward()</code> routines as well as by services that communicate via <code class="cCode">tpconnect()</code>, <code class="cCode">tpsend()</code> and <code class="cCode">tprecv()</code> routines.
</p>
<p class="pBody"><a name="wp1044951"> </a>
Service routines processing requests made via either <code class="cCode">tpcall()</code> or <code class="cCode">tpacall()</code> receive at most one incoming message (in the <code class="cCodeEmphasis">data</code> element of <code class="cCodeEmphasis">svcinfo</code>) and send at most one reply (upon exiting the service routine with <code class="cCode">tpreturn()</code>).
</p>
<p class="pBody"><a name="wp1044952"> </a>
Conversational services, on the other hand, are invoked by connection requests with at most one incoming message along with a means of referring to the open connection. When a conversational service routine is invoked, either the connecting program or the conversational service may send and receive data as defined by the application. The connection is half-duplex in nature meaning that one side controls the conversation (that is, it sends data) until it explicitly gives up control to the other side of the connection.
</p>
<p class="pBody"><a name="wp1044953"> </a>
Concerning transactions, service routines can participate in at most one transaction if invoked in transaction mode. As far as the service routine writer is concerned, the transaction ends upon returning from the service routine. If the service routine is not invoked in transaction mode, then the service routine may originate as many transactions as it wants using <code class="cCode">tpbegin()</code>, <code class="cCode">tpcommit()</code>, and <code class="cCode">tpabort()</code>. Note that <code class="cCode">tpreturn()</code> is not used to complete a transaction. Thus, it is an error to call <code class="cCode">tpreturn()</code> with an outstanding transaction that originated within the service routine.
</p>
<p class="pBody"><a name="wp1044954"> </a>
Service routines are invoked with one argument: <code class="cCodeEmphasis">svcinfo</code>, a pointer to a service information structure. This structure includes the following members:
</p>
<a name="wp1097151"> </a><div class="pPreformatted"><pre>char        name[128];<br />char        *data;<br />long        len;  <br />long        flags;  <br />int         cd;  <br />long        appkey;  <br />CLIENTID     cltid;</pre></div><p class="pBody"><a name="wp1097152"> </a>
<code class="cCode">name</code> is populated with the service name that the requester used to invoke the service.
</p>
<p class="pBody"><a name="wp1097153"> </a>
The setting of <code class="cCodeEmphasis">flags</code> upon entrance to a service routine indicates attributes which the service routine may want to note. The following are the possible values for <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1044958"> </a>
<code class="cCode">TPCONV</code> 
</h4><div class="pDefPara"><a name="wp1044959"> </a>
A connection request for a conversation has been accepted and the descriptor for the conversation is available in <code class="cCodeEmphasis">cd</code>. If not set, then this is a request/response service and <code class="cCodeEmphasis">cd</code> is not valid.
</div>
<h4 class="pDefTerm"><a name="wp1044960"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp1044961"> </a>
The service routine is in transaction mode.
</div>
<h4 class="pDefTerm"><a name="wp1044962"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp1044963"> </a>
The caller is not expecting a reply. This option will not be set if <code class="cCode">TPCONV</code> is set.
</div>
<h4 class="pDefTerm"><a name="wp1044964"> </a>
<code class="cCode">TPSENDONLY</code> 
</h4><div class="pDefPara"><a name="wp1044965"> </a>
The service is invoked such that it can only send data across the connection and the program on the other end of the connection can only receive data. This flag is mutually exclusive with <code class="cCode">TPRECVONLY</code> and may be set only when <code class="cCode">TPCONV</code> is also set.
</div>
<h4 class="pDefTerm"><a name="wp1044966"> </a>
<code class="cCode">TPRECVONLY</code> 
</h4><div class="pDefPara"><a name="wp1044967"> </a>
The service is invoked such that it can only receive data from the connection and the program on the other end of the connection can only send data. This flag is mutually exclusive with <code class="cCode">TPSENDONLY</code> and may be set only when <code class="cCode">TPCONV</code> is also set.
</div>
<p class="pBody"><a name="wp1044968"> </a>
<code class="cCodeEmphasis">data</code> points to the data portion of a request message and <code class="cCodeEmphasis">len</code> is the length of the data. The buffer pointed to by <code class="cCodeEmphasis">data</code> was allocated by <code class="cCode">tpalloc()</code> in the communication manager. This buffer may be grown by the user with <code class="cCode">tprealloc()</code>; however, it cannot be freed by the user. It is recommended that this buffer be the one passed to either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> when the service ends. If a different buffer is passed to those routines, then that buffer is freed by them. Note that the buffer pointed to by <code class="cCodeEmphasis">data</code> will be overwritten by the next service request even if this buffer is not passed to <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. <code class="cCodeEmphasis">data</code> may be NULL if no data accompanied the request. In this case, <code class="cCodeEmphasis">len</code> will be 0.
</p>
<p class="pBody"><a name="wp1044969"> </a>
When <code class="cCode">TPCONV</code> is set in <code class="cCodeEmphasis">flags</code>, <code class="cCodeEmphasis">cd</code> is the connection descriptor that can be used with <code class="cCode">tpsend()</code> and <code class="cCode">tprecv()</code> to communicate with the program that initiated the conversation.
</p>
<p class="pBody"><a name="wp1044970"> </a>
<code class="cCodeEmphasis">appkey</code> is set to the application key assigned to the requesting client by the application defined authentication service. This key value is passed along with any and all service requests made while within this invocation of the service routine. <code class="cCodeEmphasis">appkey</code> will have a value of -1 for originating clients that do not pass through the application authentication service.
</p>
<p class="pBody"><a name="wp1044971"> </a>
<code class="cCodeEmphasis">cltid</code> is the unique client identifier for the originating client associated with this service request. The definition of this structure is made available to the application in <code class="cCode">atmi.h</code> solely so that client identifiers may be passed between application servers if necessary. Therefore, the semantics of the fields defined below are not documented and applications should not manipulate the contents of <code class="cCode">CLIENTID</code> structures. Doing so will invalidate the structures. The <code class="cCode">CLIENTID</code> structure includes the following member:
</p>
<p class="pBody"><a name="wp1044972"> </a>
<code class="cCode">long        clientdata[4];</code>
</p>
<p class="pBody"><a name="wp1044973"> </a>
Note that for C++, the service function must have C linkage. This is done by declaring the function as extern &#8220;C.&#8221;&#8217;
</p>
<h4 class="pHeading3"><a name="wp1044974"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1044975"> </a>
A service routine does not return any value to its caller, the communication manager dispatcher; thus, it is declared as a void. Service routines, however, are expected to terminate using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code>. A conversational service routine must use <code class="cCode">tpreturn()</code>, and cannot use <code class="cCode">tpforward()</code>. If a service routine returns without using either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> (that is, it uses the C language <code class="cCode">return</code> statement or just simply &#8220;falls out of the function&#8221;) or <code class="cCode">tpforward()</code> is called from a conversational server, the server will print a warning message in a log file and return a service error to the originator or requester. All open connections to subordinates will be disconnected immediately, and any outstanding asynchronous replies will be marked stale. If the server was in transaction mode at the time of failure, the transaction is marked abort-only. Note also that if either <code class="cCode">tpreturn()</code> or <code class="cCode">tpforward()</code> are used outside of a service routine (for example, in clients, or in <code class="cCode">tpsvrinit()</code> or <code class="cCode">tpsvrdone()</code>), then these routines simply return having no effect.
</p>
<h4 class="pHeading3"><a name="wp1044976"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1044977"> </a>
Since <code class="cCode">tpreturn()</code> ends the service routine, any errors encountered either in handling arguments or in processing cannot be indicated to the function&#8217;s caller. Such errors cause <code class="cCode">tperrno</code> to be set to <code class="cCode">TPESVCERR</code> for a program receiving the service&#8217;s outcome via either <code class="cCode">tpcall()</code> or <code class="cCode">tpgetrply()</code>, and cause the event, <code class="cCode">TPEV_SVCERR</code>, to be sent over the conversation to a program using <code class="cCode">tpsend()</code> or <code class="cCode">tprecv()</code>.
</p>
<h4 class="pHeading3"><a name="wp1044978"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1044979"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>, <a href="rf3c.html#wp1041087"><code class="cCode">tpconnect(3c)</code></a>, <a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="../rf5/rf5.html">servopts(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1223538"> </a>
tpsetctxt(3c)
</h3>
<h4 class="pHeading3"><a name="wp1223539"> </a>
Name
</h4>
<p class="pBody"><a name="wp1223540"> </a>
<code class="cCode">tpsetctxt()</code>&#8212;Sets a context identifier for the current application association.
</p>
<h4 class="pHeading3"><a name="wp1223541"> </a>
Synopsis
</h4>
<a name="wp1223542"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpsetctxt(TPCONTEXT_T <code class="cCodeEmphasis">context</code>, long <code class="cCodeEmphasis">flags</code><code class="cCode">)</code></pre></div><h4 class="pHeading3"><a name="wp1223544"> </a>
Description
</h4>
<p class="pBody"><a name="wp1223545"> </a>
<code class="cCode">tpsetctxt()</code> defines the context in which the current thread operates. This function operates on a per-thread basis in a multithreaded environment, and on a per-process basis in a non-threaded environment.
</p>
<p class="pBody"><a name="wp1407619"> </a>
Subsequent Oracle Tuxedo ATMI calls made in this thread reference the application indicated by context. The context should have been provided by a previous call to <code class="cCode">tpgetctxt()</code> in one of the threads of the same process. If the value of <code class="cCodeEmphasis">context</code> is <code class="cCode">TPNULLCONTEXT</code>, then the current thread is disassociated from any Oracle Tuxedo ATMI context.
</p>
<p class="pBody"><a name="wp1618352"> </a>
You can put an individual thread in a process operating in multicontext mode into the <code class="cCode">TPNULLCONTEXT</code> state by issuing the following call:
</p>
<a name="wp1618356"> </a><div class="pPreformatted"><pre>tpsetctxt(TPNULLCONTEXT, 0)</pre></div><p class="pBody"><a name="wp1618353"> </a>
<code class="cCode">TPINVALIDCONTEXT</code> is not a valid input value for <code class="cCodeEmphasis">context</code>.
</p>
<p class="pBody"><a name="wp1617741"> </a>
A thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is prohibited from issuing calls to most ATMI functions. (For a complete list of the functions that may and may not be called, see <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface.</a>.) Therefore, you may sometimes need to move a thread out of the <code class="cCode">TPINVALIDCONTEXT</code> state. To do so, call <code class="cCode">tpsetctxt()</code> with context set to <code class="cCode">TPNULLCONTEXT</code> or another valid context. (It is also allowable to call the <code class="cCode">tpterm()</code> function to exit from the <code class="cCode">TPINVALIDCONTEXT</code> state.)
</p>
<p class="pBody"><a name="wp1618363"> </a>
The second argument, <code class="cCodeEmphasis">flags</code>, is not currently used and must be set to 0.
</p>
<p class="pBody"><a name="wp1617748"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpsetctxt()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1617742"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1617743"> </a>
Upon successful completion, <code class="cCode">tpsetctxt()</code> returns a non-negative value.
</p>
<p class="pBody"><a name="wp1223549"> </a>
Upon failure, it leaves the calling process in its original context, returns a value of -1, and sets <code class="cCode">tperrno</code> to indicate the error condition. 
</p>
<h4 class="pHeading3"><a name="wp1223550"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1223551"> </a>
Upon failure, <code class="cCode">tpsetctxt()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1539320"> </a>
 [<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1539321"> </a>
Invalid arguments have been given. For example, <code class="cCodeEmphasis">flags</code> has been set to a value other than 0 or the context is <code class="cCode">TPINVALIDCONTEXT</code>.
</div>
<h4 class="pDefTerm"><a name="wp1223554"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1223555"> </a>
The value of <code class="cCodeEmphasis">context</code> is not a valid context.
</div>
<h4 class="pDefTerm"><a name="wp1223556"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1223557"> </a>
<code class="cCode">tpsetctxt()</code> has been called in an improper context. For example: (a) it has been called in a server-dispatched thread; (b) it has been called in a process that has not called <code class="cCode">tpinit()</code>; (c) it has been called in a process that has called <code class="cCode">tpinit()</code> without specifying the <code class="cCode">TPMULTICONTEXTS</code> flag; or (d) it has been called from more than one thread in a process where the <code class="cCode">TMNOTHREADS</code> environment variable has been turned on.
</div>
<h4 class="pDefTerm"><a name="wp1223558"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1223559"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error has been written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1223560"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1223561"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1223562"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1223563"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1930111"> </a>
tpsetmbenc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1930112"> </a>
Name
</h4>
<p class="pBody"><a name="wp1930113"> </a>
<code class="cCode">tpsetmbenc()</code>&#8212;Sets the code-set encoding name for a typed buffer.
</p>
<h4 class="pHeading3"><a name="wp1930114"> </a>
Synopsis
</h4>
<a name="wp1937148"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br /><br />int<br />tpsetmbenc(char *bufp, char *enc_name, long flags)</pre></div><h4 class="pHeading3"><a name="wp1930115"> </a>
Description
</h4>
<p class="pBody"><a name="wp1937169"> </a>
This function is used for setting or resetting the codeset encoding name. The encoding name is sent along with the input typed buffer. A process receiving these message can use <code class="cCode">tpgetmbenc()</code> to retrieve this encoding name. 
</p>
<p class="pBody"><a name="wp1937170"> </a>
<code class="cCode">tpsetmbenc()</code> sets the codeset encoding name to be included with a Tuxedo system request. Once this function sets a non-NULL encoding name in the caller&#39;s buffer, all requests sent (via <code class="cCode">tpcall()</code>, <code class="cCode">tpsend()</code>) include this string until reset or unset. An initial codeset encoding name is applied to a MBSTRING buffer, during <code class="cCode">tpalloc()</code>, using the TPMBENC environment variable. An MBSTRING buffer without an encoding name defined is invalid.
</p>
<p class="pBody"><a name="wp1937171"> </a>
The <code class="cCodeEmphasis">bufp</code> argument is a valid pointer to a typed buffer with an encoding name.
</p>
<p class="pBody"><a name="wp1937172"> </a>
The <code class="cCodeEmphasis">enc_name</code> argument is the encoding name to use to identify the codeset encoding. 
</p>
<p class="pBody"><a name="wp1937173"> </a>
The <code class="cCodeEmphasis">flags</code> argument is 0 or RM_ENC. For RM_ENC the encoding name will be removed from the MBSTRING buffer and the <code class="cCodeEmphasis">enc_name</code> argument will be ignored. Note that an MBSTRING buffer without an encoding name will fail the _tmconvmb() conversion.
</p>
<h4 class="pHeading3"><a name="wp1937164"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1937180"> </a>
Upon success, <code class="cCode">tpsetmbenc()</code> returns a 0 value otherwise it returns a non-zero on error and sets <code class="cCode">tperrno</code> to indicate the error condition. This function may fail for the following reasons. 
</p>
<h4 class="pDefTerm"><a name="wp1937181"> </a>
 [<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1937182"> </a>
<code class="cCodeEmphasis">buf</code>, <code class="cCodeEmphasis">enc_name</code> argument is NULL or <code class="cCodeEmphasis">enc_name</code> is not a valid name to use.
</div>
<h4 class="pDefTerm"><a name="wp1937183"> </a>
 [<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1937184"> </a>
A Tuxedo system error has occurred. (e.g. bufp does not correspond to a valid Tuxedo buffer, could not add or remove the encoding name from the buffer)
</div>
<h4 class="pHeading3"><a name="wp1930116"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1930132"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1928689"><code class="cCode">tpconvmb(3c)</code></a>, <a href="rf3c.html#wp1930050"><code class="cCode">tpgetmbenc(3c)</code></a>, <a href="rf3c.html#wp1044944"><code class="cCode">tpservice(3c)</code></a>, <a href="rf3c.html#wp1928257"><code class="cCode">tuxsetmbenc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2183851"> </a>
tpsetrepos(3c)
</h3>
<h4 class="pHeading3"><a name="wp2183852"> </a>
Name
</h4>
<p class="pBody"><a name="wp2183853"> </a>
<code class="cCode">tpsetrepos()</code> - adds, edits, or deletes service parameter information from a Tuxedo Service Metadata repository file
</p>
<h4 class="pHeading3"><a name="wp2183854"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2183855"> </a>
<code class="cCode">int tpsetrepos(char</code> <code class="cCode">*reposfile,</code> <code class="cCode">FBFR32*</code> <code class="cCode">idata,</code> <code class="cCode">FBFR32**</code> <code class="cCode">odata)</code>
</p>
<h4 class="pHeading3"><a name="wp2183856"> </a>
Description
</h4>
<p class="pBody"><a name="wp2183857"> </a>
tpsetrepos() provides an alternative repository access interface to the <code class="cCode">.TMMETAREPOS</code> service provided by <a href="../rf5/rf5.html">TMMETADATA(5)</a><code class="cCode">.</code> It adds, edits, or deletes parameter information from a Tuxedo Service Metadata repository file. To use tpsetrepos(), the metadata repository file must reside on the native client or server that initiates the request. This allows for repository information access even when <a href="../rf5/rf5.html">TMMETADATA(5)</a>has not been booted.
</p>
<p class="pBody"><a name="wp2183864"> </a>
tpsetrepos() is available in processes linked with the Oracle Tuxedo native libraries, but is not available in processes linked with the Oracle Tuxedo workstation libraries.
</p>
<a name="wp2183865"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>tpsetrepos() cannot be used to add, edit, or delete service parameter information in a JOLT Repository file.</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp2183866"> </a>
<code class="cCode">reposfile</code>
</h4><div class="pDefPara"><a name="wp2183867"> </a>
specifies the path name of a file accessible on the current machine where the Tuxedo Metadata Repository is located. The user must have read and write permissions for this file.
</div>
<h4 class="pDefTerm"><a name="wp2183868"> </a>
<code class="cCode">idata</code> 
</h4><div class="pDefPara"><a name="wp2183869"> </a>
specifies what type of service information is added, edited, or deleted, and points to an FML32 buffer.
</div>
<h4 class="pDefTerm"><a name="wp2183870"> </a>
*<code class="cCode">odata</code>
</h4><div class="pDefPara"><a name="wp2183871"> </a>
On output, points to an FML32 buffer containing the retrieved service information and operation status.
</div>
<p class="pBody"><a name="wp2183872"> </a>
<a href="../rf5/rf5.html">METAREPOS(5)</a>describes the FML32 buffer format tpsetrepos()uses. It is similar to the format used by <a href="../rf5/rf5.html">MIB(5)</a>.
</p>
<h4 class="pHeading3"><a name="wp2184225"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2184226"> </a>
tpsetrepos() returns 0 on success. On failure, it sets tperrno and returns -1. On most failure conditions, the <code class="cCode">TA_ERROR</code> field in <code class="cCode">*odata</code> is populated with information about the specific error, as is done by the Tuxedo MIB.
</p>
<h4 class="pHeading3"><a name="wp2217742"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2217743"> </a>
Upon failure, <code class="cCode">tpsetrepos()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<a name="wp2217744"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Except for <code class="cCode">TPEINVAL</code>, <code class="cCode">odata</code> is modified to include <code class="cCode">TA_ERROR</code>, <code class="cCode">TA_STATUS</code> for each service entry to further qualify the error condition.</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp2217745"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2217746"> </a>
Invalid arguments were specified. The reposfile value is invalid or <code class="cCode">idata</code> or <code class="cCode">odata</code> are not pointers to <code class="cCode">FML32</code> typed buffers.
</div>
<h4 class="pDefTerm"><a name="wp2217747"> </a>
<code class="cCode">[TPEMIB]</code>
</h4><div class="pDefPara"><a name="wp2217748"> </a>
The <code class="cCode">MIB</code>-like request failed. odata is updated and returned to the caller with <code class="cCode">FML32</code> fields indicating the cause of the error as discussed in <code class="cCode">MIB(5)</code>.
</div>
<h4 class="pDefTerm"><a name="wp2217749"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp2217750"> </a>
<code class="cCode">tpsetrepos()</code> was improperly called. The reposfile file argument given is not a valid repository file.
</div>
<h4 class="pDefTerm"><a name="wp2218147"> </a>
<code class="cCode">[TPEPERM]</code>
</h4><div class="pDefPara"><a name="wp2218148"> </a>
A Jolt repository file is specified. <code class="cCode">tpsetrepos()</code> cannot be applied to a Jolt repository file.
</div>
<h4 class="pDefTerm"><a name="wp2217751"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp2217752"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in <code class="cCode">Uunixerr</code>.
</div>
<h4 class="pDefTerm"><a name="wp2217753"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp2217754"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is reported in <code class="cCode">userlog()</code>.
</div>
<h4 class="pHeading3"><a name="wp2217755"> </a>
Portability
</h4>
<p class="pBody"><a name="wp2217756"> </a>
This interface is available only on Oracle Tuxedo release 9.0 or later.
</p>
<h4 class="pHeading3"><a name="wp2217757"> </a>
Files
</h4>
<p class="pBody"><a name="wp2217758"> </a>
The following library files are required:
</p>
<p class="pBody"><a name="wp2217759"> </a>
<code class="cCode">${TUXDIR}/lib/libtrep.a<br />${TUXDIR}/lib/libtrep.so.&lt;rel&gt;<br />${TUXDIR}/lib/libtrep.lib</code>
</p>
<p class="pBody"><a name="wp2217760"> </a>
The libraries must be linked manually when using buildclient. The user must use: <code class="cCode">-L${TUXDIR}/lib -ltrep</code>
</p>
<h4 class="pHeading3"><a name="wp2184227"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2184242"> </a>
<a href="rf3c.html#wp2179461"><code class="cCode">tpgetrepos(3c)</code></a>, <a href="../rfcm/rfcmd.html">tmloadrepos(1)</a>, <a href="../rfcm/rfcmd.html">tmunloadrepos(1)</a>, <a href="../rf5/rf5.html">TMMETADATA(5)</a>, <span class="cHyperlink">
<a href="../ads/admrp.html">Managing The Tuxedo Service Metadata Repository</a></span> in <em class="cEmphasis">Setting Up an Oracle Tuxedo Application</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1223138"> </a>
tpsetunsol(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045106"> </a>
Name
</h4>
<p class="pBody"><a name="wp1157994"> </a>
<code class="cCode">tpsetunsol()</code>&#8212;Sets the method for handling unsolicited messages.
</p>
<h4 class="pHeading3"><a name="wp1157995"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1158054"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />void (*tpsetunsol (void (_TMDLLENTRY *)(*disp) (char *data, long len, long flags))) (char *data, long len, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp1045110"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045111"> </a>
<code class="cCode">tpsetunsol()</code> allows a client to identify the routine that should be invoked when an unsolicited message is received by the Oracle Tuxedo ATMI system libraries. Before the first call to <code class="cCode">tpsetunsol()</code>, any unsolicited messages received by the Oracle Tuxedo ATMI system libraries on behalf of the client are logged and ignored. A call to <code class="cCode">tpsetunsol()</code> with a NULL function pointer has the same effect. The method used by the system for notification and detection is determined by the application default, which can be overridden on a per-client basis (see <a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>).
</p>
<p class="pBody"><a name="wp2302669"> </a>
The function pointer passed on the call to tpsetunsol() must conform to the parameter definition given. The <code class="cCode">_TMDLLENTRY</code> macro is required for Windows-based operating systems to obtain the proper calling conventions between the Tuxedo libraries and your code. On Unix systems, the <code class="cCode">_TMDLLENTRY</code> macro is not required because it expands to the null string.
</p>
<p class="pBody"><a name="wp2302670"> </a>
<code class="cCodeEmphasis">data</code> points to the typed buffer received and <code class="cCodeEmphasis">len </code>is the length of the data. <code class="cCodeEmphasis">flags</code> are currently unused. <code class="cCodeEmphasis">data</code> can be NULL if no data accompanied the notification. <code class="cCodeEmphasis">data</code> may be of a buffer type/subtype that is not known by the client, in which case the message data is unintelligible.
</p>
<p class="pBody"><a name="wp1045113"> </a>
<code class="cCodeEmphasis">data</code> cannot be freed by application code. However, the system frees it and invalidates the data area following return.
</p>
<p class="pBody"><a name="wp1045114"> </a>
Processing within the application&#8217;s unsolicited message handling routine is restricted to the following Oracle Tuxedo ATMI functions: <code class="cCode">tpalloc()</code>, <code class="cCode">tpfree()</code>,<code class="cCode"> tpgetctxt()</code>, <code class="cCode">tpgetlev()</code>, <code class="cCode">tprealloc()</code>, and <code class="cCode">tptypes()</code>.
</p>
<p class="pBody"><a name="wp1217071"> </a>
Note that in a multithreaded programming environment, it is possible for an unsolicited message handling routine to call <code class="cCode">tpgetctxt()</code>, create another thread, have that thread call <code class="cCode">tpsetctxt()</code> to the appropriate context, and have the new thread use the full set of ATMI functions that are available to clients. 
</p>
<p class="pBody"><a name="wp1217050"> </a>
If <code class="cCode">tpsetunsol()</code> is called from a thread that is not currently associated with a context, this establishes a per-process default unsolicited message handler for all new <code class="cCode">tpinit()</code> contexts created. It has no effect on contexts already associated with the system. A specific context may change this default unsolicited message handler by calling <code class="cCode">tpsetunsol()</code> again when the context is active. The per-process default unsolicited message handler may be changed by again calling <code class="cCode">tpsetunsol()</code> in a thread not currently associated with a context.
</p>
<p class="pBody"><a name="wp1631725"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpsetunsol()</code>.
</p>
<h4 class="pHeading3"><a name="wp1045115"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045116"> </a>
Upon success, <code class="cCode">tpsetunsol()</code> returns the previous setting for the unsolicited message handling routine. (NULL is a successful return indicating that no message handling function had been set previously.)
</p>
<p class="pBody"><a name="wp1230920"> </a>
Upon failure, it returns <code class="cCode">TPUNSOLERR</code> and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045117"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045118"> </a>
Upon failure, <code class="cCode">tpsetunsol()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1045119"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045120"> </a>
<code class="cCode">tpsetunsol()</code> has been called in an improper context. For example, it has been called from within a server.
</div>
<h4 class="pDefTerm"><a name="wp1045121"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045122"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045123"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045124"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045125"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1045126"> </a>
The interfaces described in <a href="rf3c.html#wp1043190"><code class="cCode">tpnotify(3c)</code></a> are supported on native site UNIX-based and Windows processors. In addition, the routines <code class="cCode">tpbroadcast()</code> and <code class="cCode">tpchkunsol()</code>, as well as the function <code class="cCode">tpsetunsol()</code>, are supported on UNIX and MS-DOS workstation processors.
</p>
<h4 class="pHeading3"><a name="wp1045127"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045128"> </a>
<a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp1219084"><code class="cCode">tpterm(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1261719"> </a>
tpsign(3c)
</h3>
<h4 class="pHeading3"><a name="wp1261720"> </a>
Name
</h4>
<p class="pBody"><a name="wp1261721"> </a>
<code class="cCode">tpsign()</code>&#8212;Marks a typed message buffer for digital signature.
</p>
<h4 class="pHeading3"><a name="wp1261722"> </a>
Synopsis
</h4>
<a name="wp1261723"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpsign(char *<code class="cCodeEmphasis">data</code>, TPKEY <code class="cCodeEmphasis">hKey</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1583462"> </a>
Description
</h4>
<p class="pBody"><a name="wp1261725"> </a>
<code class="cCode">tpsign()</code> marks, or registers, a message buffer for digital signature on behalf of the principal associated with <code class="cCodeEmphasis">hKey</code>.
</p>
<p class="pBody"><a name="wp1261726"> </a>
<code class="cCodeEmphasis">data</code> must point to a valid typed message buffer either (1) previously allocated by a process calling <code class="cCode">tpalloc()</code> or (2) delivered by the system to a receiving process. The content of the buffer may be modified after <code class="cCode">tpsign()</code> is invoked.
</p>
<p class="pBody"><a name="wp1583912"> </a>
When the buffer pointed to by <code class="cCodeEmphasis">data</code> is transmitted from a process, the public key software generates and attaches a digital signature to the message buffer for each digital-signature registration request. A digital signature enables a receiving process to verify the signer (originator) of the message.
</p>
<p class="pBody"><a name="wp1261727"> </a>
The <code class="cCodeEmphasis">flags</code> argument is reserved for future use and must be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1261728"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1261729"> </a>
On failure, this function returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1261730"> </a>
Errors
</h4>
<h4 class="pDefTerm"><a name="wp1261731"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1261732"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">hKey</code> is not a valid key for signing or the value of <code class="cCodeEmphasis">data</code> is NULL.
</div>
<h4 class="pDefTerm"><a name="wp1261733"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1261734"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1261735"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1261736"> </a>
<a href="rf3c.html#wp1502326"><code class="cCode">tpkey_close(3c)</code></a>, <a href="rf3c.html#wp1513266"><code class="cCode">tpkey_open(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045232"> </a>
tpsprio(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045233"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045234"> </a>
<code class="cCode">tpsprio()</code>&#8212;Sets the service request priority.
</p>
<h4 class="pHeading3"><a name="wp1045235"> </a>
Synopsis
</h4>
<a name="wp1045236"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpsprio(prio, flags)</pre></div><h4 class="pHeading3"><a name="wp1045237"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045238"> </a>
<code class="cCode">tpsprio()</code> sets the priority for the next request sent or forwarded by the current thread in the current context. The priority set affects only the next request sent. Priority can also be set for messages enqueued or dequeued by <code class="cCode">tpenqueue()</code> or <code class="cCode">tpdequeue()</code>, if the queued message facility is installed. By default, the setting of <code class="cCodeEmphasis">prio</code> increments or decrements a service&#8217;s default priority up to a maximum of 100 or down to a minimum of 1, depending on its sign, where 100 is the highest priority. The default priority for a request is determined by the service to which the request is being sent. This default may be specified administratively (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a>), or take the system default of 50. <code class="cCode">tpsprio()</code> has no effect on messages sent via <code class="cCode">tpconnect()</code> or <code class="cCode">tpsend()</code>.
</p>
<p class="pBody"><a name="wp1372990"> </a>
A lower priority message does not remain enqueued forever because every tenth message is retrieved on a &#8220;first in, first out&#8221; (FIFO) basis. Response time should not be a concern of the lower priority interface or service.
</p>
<p class="pBody"><a name="wp1407613"> </a>
In a multithreaded application <code class="cCode">tpsprio()</code> operates on a per-thread basis.
</p>
<p class="pBody"><a name="wp1045239"> </a>
The following is a list of valid flags: 
</p>
<h4 class="pDefTerm"><a name="wp1045240"> </a>
<code class="cCode">TPABSOLUTE</code> 
</h4><div class="pDefPara"><a name="wp1045241"> </a>
The priority of the next request should be sent out at the absolute value of <code class="cCodeEmphasis">prio</code>. The absolute value of <code class="cCodeEmphasis">prio</code> must be within the range 1 and 100, inclusive, with 100 being the highest priority. Any value outside of this range causes a default value to be used.
</div>
<p class="pBody"><a name="wp1631740"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpsprio()</code>.
</p>
<h4 class="pHeading3"><a name="wp1045242"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045243"> </a>
Upon failure, <code class="cCode">tpsprio()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045244"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045245"> </a>
Upon failure, <code class="cCode">tpsprio()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1045246"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1045247"> </a>
<code class="cCodeEmphasis">flags</code> are invalid.
</div>
<h4 class="pDefTerm"><a name="wp1045248"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045249"> </a>
<code class="cCode">tpsprio()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1045250"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045251"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045252"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045253"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045254"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045255"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp1021731"><code class="cCode">tpcall(3c)</code></a>,<a href="rf3c.html#wp1041783"><code class="cCode">tpdequeue(3c)</code></a>, <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>, <a href="rf3c.html#wp1042995"><code class="cCode">tpgprio(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023204"> </a>
tpstrerror(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023205"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023206"> </a>
<code class="cCode">tpstrerror()</code>&#8212;Gets error message string for an Oracle Tuxedo ATMI system error.
</p>
<h4 class="pHeading3"><a name="wp1023207"> </a>
Synopsis
</h4>
<a name="wp1023208"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />char *  <br />tpstrerror(int <code class="cCodeEmphasis">err</code>)</pre></div><h4 class="pHeading3"><a name="wp1023209"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023210"> </a>
<code class="cCode">tpstrerror()</code> is used to retrieve the text of an error message from <code class="cCode">LIBTUX_CAT</code>. <code class="cCodeEmphasis">err</code> is the error code set in <code class="cCode">tperrno</code> when an Oracle Tuxedo ATMI system function call returns a -1 or other failure value.
</p>
<p class="pBody"><a name="wp1023211"> </a>
You can use the pointer returned by <code class="cCode">tpstrerror()</code> as an argument to <code class="cCode">userlog()</code> or the UNIX function <code class="cCode">fprintf()</code>.
</p>
<p class="pBody"><a name="wp1617756"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpstrerror()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1023212"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023213"> </a>
Upon success, <code class="cCode">tpstrerror()</code> returns a pointer to a string that contains the error message text.
</p>
<p class="pBody"><a name="wp1233084"> </a>
If <code class="cCodeEmphasis">err</code> is an invalid error code, <code class="cCode">tpstrerror()</code> returns a NULL. 
</p>
<h4 class="pHeading3"><a name="wp1023214"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023215"> </a>
Upon failure, <code class="cCode">tpstrerror()</code> returns a NULL but does not set <code class="cCode">tperrno</code>.
</p>
<h4 class="pHeading3"><a name="wp1023216"> </a>
Example
</h4>
<a name="wp1023217"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />.<br />.<br />.<br />  char *p;<br />  if (tpbegin(10,0) == -1) {<br />    p = tpstrerror(tperrno); <br />    userlog(&#8220;%s&#8221;, p); <br />    (void)tpabort(0); <br />    (void)tpterm(); <br />    exit(1);<br />  }</pre></div><h4 class="pHeading3"><a name="wp1023218"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023219"> </a>
<a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>, <a href="../rf3fml/rf3fml.html">Fstrerror, Fstrerr</a><a href="../rf3fml/rf3fml.html">or32(3fml)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023241"> </a>
tpstrerrordetail(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023242"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023243"> </a>
<code class="cCode">tpstrerrordetail()</code>&#8212;Gets error detail message string for an Oracle Tuxedo ATMI system error.
</p>
<h4 class="pHeading3"><a name="wp1023244"> </a>
Synopsis
</h4>
<a name="wp1023245"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />char * tpstrerrordetail(int <code class="cCodeEmphasis">err</code>, long <code class="cCodeEmphasis">flags</code>)</pre></div><h4 class="pHeading3"><a name="wp1023246"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023247"> </a>
<code class="cCode">tpstrerrordetail()</code> is used to retrieve the text of an error detail of an Oracle Tuxedo ATMI system error. <code class="cCodeEmphasis">err</code> is the value returned by <code class="cCode">tperrordetail()</code>.
</p>
<p class="pBody"><a name="wp1023248"> </a>
The user can use the pointer returned by <code class="cCode">tpstrerrordetail()</code> as an argument to <code class="cCode">userlog()</code> or the UNIX function <code class="cCode">fprintf()</code>.
</p>
<p class="pBody"><a name="wp1023249"> </a>
Currently <code class="cCodeEmphasis">flags</code> is reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1617762"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpstrerrordetail()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1023250"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023251"> </a>
Upon success, the function returns a pointer to a string that contains the error detail message text.
</p>
<p class="pBody"><a name="wp1233093"> </a>
Upon failure (that is, if <code class="cCodeEmphasis">err</code> is an invalid error code), <code class="cCode">tpstrerrordetail()</code> returns a NULL. 
</p>
<h4 class="pHeading3"><a name="wp1023252"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1023253"> </a>
Upon failure, <code class="cCode">tpstrerrordetail()</code> returns a NULL but does not set <code class="cCode">tperrno</code>.
</p>
<h4 class="pHeading3"><a name="wp1023254"> </a>
Example
</h4>
<a name="wp1791014"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; .  .  .  <br />int ret;<br />char *p;<br /><br />if (tpbegin(10,0) == -1) {<br />       ret = tperrordetail(0);<br />       if (ret == -1) {<br />              (void) fprintf(stderr, &#8220;tperrordetail() failed!\n&#8221;);<br />              (void) fprintf(stderr, &#8220;tperrno = %d, %s\n&#8221;,<br />                     tperrno, tpstrerror(tperrno));<br />       }</pre></div><a name="wp1791015"> </a><div class="pPreformatted"><pre><br />       else if (ret != 0) {<br />              (void) fprintf(stderr, &#8220;errordetail:%s\n&#8221;,<br />                             tpstrerrordetail(ret, 0));<br />       }<br />       .<br />       .<br />       .<br />}</pre></div><h4 class="pHeading3"><a name="wp1023256"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023257"> </a>
<a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>, <a href="rf3c.html#wp1021798"><code class="cCode">tperrordetail(3c)</code></a>, <a href="rf3c.html#wp1023204"><code class="cCode">tpstrerror(3c)</code></a>, <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>, <a href="../rf5/rf5.html">tperrno(5)</a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045667"> </a>
tpsubscribe(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045668"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045669"> </a>
<code class="cCode">tpsubscribe()</code>&#8212;Subscribes to an event.
</p>
<h4 class="pHeading3"><a name="wp1045670"> </a>
Synopsis
</h4>
<a name="wp1045671"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />long tpsubscribe(char *eventexpr, char *filter, TPEVCTL *ctl, long flags)</pre></div><h4 class="pHeading3"><a name="wp1045672"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045673"> </a>
The caller uses <code class="cCode">tpsubscribe()</code> to subscribe to an event or set of events named by <code class="cCodeEmphasis">eventexpr</code>. Subscriptions are maintained by the Oracle Tuxedo ATMI EventBroker, <a href="../rf5/rf5.html">TMUSREVT(5)</a>, and are used to notify subscribers when events are posted via <code class="cCode">tppost()</code>. Each subscription specifies a notification method which can take one of three forms: client notification, service calls, or message enqueuing to stable-storage queues. Notification methods are determined by the subscriber&#8217;s process type and the arguments passed to <code class="cCode">tpsubscribe()</code>.
</p>
<p class="pBody"><a name="wp1045674"> </a>
The event or set of events being subscribed to is named by <code class="cCodeEmphasis">eventexpr</code>, a NULL-terminated string of at most 255 characters containing a regular expression. For example, if <code class="cCodeEmphasis">eventexpr</code> is &#8220;<code class="cCode">\e\e..*</code>&#8221;, the caller is subscribing to all system-generated events; if <code class="cCodeEmphasis">eventexpr</code> is &#8220;<code class="cCode">\e\e.SysServer.*</code>&#8221;, the caller is subscribing to all system-generated events related to servers. If <code class="cCodeEmphasis">eventexpr</code> is &#8220;<code class="cCode">[A-Z].*</code>&#8221;, the caller is subscribing to all user events starting with A-Z; if <code class="cCodeEmphasis">eventexpr</code> is &#8220;<code class="cCode">.*(ERR|err).*</code>&#8221;, the caller is subscribing to all user events containing either the substring <code class="cCode">ERR</code> or the substring <code class="cCode">err</code> in the event name. Events called <code class="cCode">account_error</code> and <code class="cCode">ERROR_STATE</code>, for example, would both qualify. For more information on regular expressions, see <a href="rf3c.html#wp1830957">Regular Expressions</a>.
</p>
<p class="pBody"><a name="wp1045675"> </a>
If present, <code class="cCodeEmphasis">filter</code> is a string containing a Boolean filter rule that must be evaluated successfully before the EventBroker posts the event. Upon receiving an event to be posted, the EventBroker applies the filter rule, if one exists, to the posted event&#8217;s data. If the data passes the filter rule, the EventBroker invokes the notification method; otherwise, the broker does not invoke the associated notification method. The caller can subscribe to the same event multiple times with different filter rules.
</p>
<p class="pBody"><a name="wp1045676"> </a>
Filter rules are specific to the typed buffers to which they are applied. For FML and view buffers, the filter rule is a string that can be passed to each&#8217;s Boolean expression compiler (see <code class="cCode">Fboolco</code>(3fml) and <code class="cCode">Fvboolco</code>(3fml), respectively) and evaluated against the posted buffer (see <code class="cCode">Fboolev</code>(3fml) and <code class="cCode">Fvboolev</code>(3fml), respectively). For <code class="cCode">STRING</code> buffers, the filter rule is a regular expression. All other buffer types require customized filter evaluators (see <a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a> and <a href="../rf5/rf5.html">typesw(5)</a> for details on adding customized filter evaluators). <code class="cCodeEmphasis">filter</code> is a NULL-terminated string of at most 255 characters.
</p>
<p class="pBody"><a name="wp1045677"> </a>
If the subscriber is an Oracle Tuxedo ATMI system client process and <code class="cCodeEmphasis">ctl</code> is NULL, then the EventBroker sends an unsolicited message to the subscriber when the event to which it subscribed is posted. That is, when an event name is posted that evaluates successfully against <code class="cCodeEmphasis">eventexpr</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCodeEmphasis">eventexpr</code>. If the data passes the filter rule or if there is no filter rule for the event, then the subscriber receives an unsolicited notification along with any data posted with the event. In order to receive unsolicited notifications, the client must register (via <code class="cCode">tpsetunsol()</code>) an unsolicited message handling routine. If an Oracle Tuxedo ATMI system server process calls <code class="cCode">tpsubscribe()</code> with a NULL <code class="cCodeEmphasis">ctl</code> parameter, then <code class="cCode">tpsubscribe()</code> fails setting <code class="cCode">tperrno</code> to <code class="cCode">TPEPROTO</code>.
</p>
<p class="pBody"><a name="wp1045678"> </a>
Clients receiving event notification via unsolicited messages should remove their subscriptions from the EventBroker&#8217;s list of active subscriptions before exiting (see <a href="rf3c.html#wp1045970"><code class="cCode">tpunsubscribe(3c)</code></a> for details). Using <code class="cCode">tpunsubscribe()</code>&#8217;s wildcard handle, -1, clients can conveniently remove all of their &#8220;non-persistent&#8221; subscriptions which include those associated with the unsolicited notification method (see the description of <code class="cCode">TPEVPERSIST</code> below for subscriptions and their associated notification methods that persist after a process exits). If a client exits without removing its non-persistent subscriptions, then the EventBroker will remove them when it detects that the client is no longer accessible.
</p>
<p class="pBody"><a name="wp1045679"> </a>
If the subscriber (regardless of process type) wants event notifications to go to service routines or to stable-storage queues, then the <code class="cCodeEmphasis">ctl</code> parameter must point to a valid <code class="cCode">TPEVCTL</code> structure. This structure contains the following elements: 
</p>
<a name="wp2266738"> </a><div class="pPreformatted"><pre>long    flags;  <br />char    name1[128];  <br />char    name2[128];  <br />TPQCTL  qctl;</pre></div><a name="wp2266773"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The service name length limit is 127 bytes. If the service name length exceeds 127 bytes, <code class="cCode">TPEINVAL</code> is returned.</td>
</tr>
</table>

<p class="pBody"><a name="wp2266740"> </a>
The following is a list of valid bits for the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq35" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> element controlling options for event subscriptions: 
</p>
<h4 class="pDefTerm"><a name="wp1045682"> </a>
<code class="cCode">TPEVSERVICE</code> 
</h4><div class="pDefPara"><a name="wp1045683"> </a>
Setting this flag indicates that the subscriber wants event notifications to be sent to the Oracle Tuxedo ATMI system service routine named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq36" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code>. That is, when an event name is posted that evaluates successfully against <code class="cCodeEmphasis">eventexpr</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCodeEmphasis">eventexpr</code>. If the data passes the filter rule or if there is no filter rule for the event, then a service request is sent to <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq37" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code> along with any data posted with the event. The service name in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq38" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code> can be any valid Oracle Tuxedo ATMI system service name and it may or may not be active at the time the subscription is made. Service routines invoked by the EventBroker should return with no reply data. That is, they should call <code class="cCode">tpreturn()</code> with a NULL data argument. Any data passed to <code class="cCode">tpreturn()</code> will be dropped. <code class="cCode">TPEVSERVICE</code> and <code class="cCode">TPEVQUEUE</code> are mutually exclusive flags.
</div>
<div class="pDefParaCont"><a name="wp1045684"> </a>
If <code class="cCode">TPEVTRAN</code> is also set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq39" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code>, then if the process calling <code class="cCode">tppost()</code> is in transaction mode, the EventBroker calls the subscribed service routine such that it will be part of the poster&#8217;s transaction. Both the EventBroker, <a href="../rf5/rf5.html">TMUSREVT(5)</a>, and the subscribed service routine must belong to server groups that support transactions (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details). If <code class="cCode">TPEVTRAN</code> is not set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq40" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code>, then the EventBroker calls the subscribed service routine such that it will not be part of the poster&#8217;s transaction.
</div>
<h4 class="pDefTerm"><a name="wp1045685"> </a>
<code class="cCode">TPEVQUEUE</code> 
</h4><div class="pDefPara"><a name="wp1045686"> </a>
Setting this flag indicates that the subscriber wants event notifications to be enqueued to the queue space named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq41" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code> and the queue named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq42" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name2</code>. That is, when an event name is posted that evaluates successfully against <code class="cCodeEmphasis">eventexpr</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCodeEmphasis">eventexpr</code>. If the data passes the filter rule or if there is no filter rule for the event, then the EventBroker enqueues a message to the queue space named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq43" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code> and the queue named in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq44" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name2</code> along with any data posted with the event. The queue space and queue name can be any valid Oracle Tuxedo ATMI system queue space and queue name, either of which may or may not exist at the time the subscription is made.
</div>
<div class="pDefParaCont"><a name="wp1045687"> </a>
<code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq45" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">qctl</code> can contain options further directing the EventBroker&#8217;s enqueuing of the posted event. If no options are specified, then <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq46" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">qctl.flags</code> should be set to <code class="cCode">TPNOFLAGS</code>. Otherwise, options can be set as described in the &#8220;Control Parameter&#8221; subsection of <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a> (specifically, see the section describing the valid list of flags controlling input information for <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>). <code class="cCode">TPEVSERVICE</code> and <code class="cCode">TPEVQUEUE</code> are mutually exclusive flags.
<a name="wp1045688"> </a>
If <code class="cCode">TPEVTRAN</code> is also set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq47" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code>, then if the process calling <code class="cCode">tppost()</code> is in transaction mode, the EventBroker enqueues the posted event and its data such that it will be part of the poster&#8217;s transaction. The EventBroker, <a href="../rf5/rf5.html">TMUSREVT(5)</a>, must belong to a server group that supports transactions (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details). If <code class="cCode">TPEVTRAN</code> is not set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq48" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code>, then the EventBroker enqueues the posted event and its data such that it will not be part of the poster&#8217;s transaction.
</div>
<h4 class="pDefTerm"><a name="wp1045689"> </a>
<code class="cCode">TPEVTRAN</code> 
</h4><div class="pDefPara"><a name="wp1045690"> </a>
Setting this flag indicates that the subscriber wants the event notification for this subscription to be included in the poster&#8217;s transaction, if one exists. If the poster is not a transaction, then a transaction is started for this event notification. If this flag is not set, then any events posted for this subscription will not be done on behalf of any transaction in which the poster is participating. This flag can be used with either <code class="cCode">TPEVSERVICE</code> or <code class="cCode">TPEVQUEUE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1045691"> </a>
<code class="cCode">TPEVPERSIST</code> 
</h4><div class="pDefPara"><a name="wp1045692"> </a>
By default, the Oracle Tuxedo EventBroker deletes subscriptions when the resource to which it is posting is not available (for example, the EventBroker cannot access a service routine and/or a queue space/queue name associated with an event subscription). Setting this flag indicates that the subscriber wants this subscription to persist across such errors (usually because the resource will become available again in the future). When this flag is not used, the EventBroker will remove this subscription if it encounters an error accessing either the service name or queue space/queue name designated in this subscription.
</div>
<div class="pDefParaCont"><a name="wp1045693"> </a>
If this flag is used with <code class="cCode">TPEVTRAN</code> and the resource is not available at the time of event notification, then the EventBroker will return to the poster such that its transaction must be aborted. That is, even though the subscription remains intact, the resource&#8217;s unavailability will cause the poster&#8217;s transaction to fail.
</div>
<p class="pBody"><a name="wp1045694"> </a>
If the EventBroker&#8217;s list of active subscriptions already contains a subscription that matches the one being requested by <code class="cCode">tpsubscribe()</code>, then the function fails setting <code class="cCode">tperrno</code> to <code class="cCode">TPEMATCH</code>. For a subscription to match an existing one, both <code class="cCodeEmphasis">eventexpr</code> and <code class="cCodeEmphasis">filter</code> must match those of a subscription already in the EventBroker&#8217;s active list of subscriptions. In addition, depending on the notification method, other criteria are used to determine matches.
</p>
<p class="pBody"><a name="wp1045695"> </a>
If the subscriber is an Oracle Tuxedo ATMI system client process and <code class="cCodeEmphasis">ctl</code> is NULL (such that the caller receives unsolicited notifications when events are posted), then its system-defined client identifier (known as a <code class="cCode">CLIENTID</code>) is also used to detect matches. That is, <code class="cCode">tpsubscribe()</code> fails if <code class="cCodeEmphasis">eventexpr</code>, <code class="cCodeEmphasis">filter</code>, and the caller&#8217;s <code class="cCode">CLIENTID</code> match those of a subscription already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1045696"> </a>
If the caller has set <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq49" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> to <code class="cCode">TPEVSERVICE</code>, then <code class="cCode">tpsubscribe()</code> fails if <code class="cCodeEmphasis">eventexpr</code>, <code class="cCodeEmphasis">filter</code>, and the service name set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq50" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code> match those of a subscription already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1045697"> </a>
For subscriptions to stable-storage queues, the queue space, queue name, and correlation identifier are used, in addition to <code class="cCodeEmphasis">eventexpr</code> and <code class="cCodeEmphasis">filter</code>, when determining matches. The correlation identifier can be used to differentiate among several subscriptions for the same event expression and filter rule, destined for the same queue. Thus, if the caller has set <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq51" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> to <code class="cCode">TPEVQUEUE</code>, and <code class="cCode">TPQCOORID</code> is not set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq52" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">qctl.flags</code>, then <code class="cCode">tpsubscribe()</code> fails if <code class="cCodeEmphasis">eventexpr</code>, <code class="cCodeEmphasis">filter</code>, the queue space name set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq53" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code>, and the queue name set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq54" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name2</code> match those of a subscription (which also does not have a correlation identifier specified) already known to the EventBroker. Further, if <code class="cCode">TPQCOORID</code> is set in <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq55" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">qctl.flags</code>, then <code class="cCode">tpsubscribe()</code> fails if <code class="cCodeEmphasis">eventexpr</code>, <code class="cCodeEmphasis">filter</code>, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq56" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name1</code>, <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq57" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">name2</code>, and <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq58" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">qctl.corrid</code> match those of a subscription (which has the same correlation identifier specified) already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1045698"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code> for <code class="cCode">tpsubscribe()</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1045699"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1045700"> </a>
The subscription is not made if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1045701"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1045702"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1045703"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1045704"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tpsubscribe()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1631748"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpsubscribe()</code>.
</p>
<h4 class="pHeading3"><a name="wp1830957"> </a>
Regular Expressions
</h4>
<p class="pBody"><a name="wp1830958"> </a>
The regular expressions described in <a href="rf3c.html#wp1830962">Table&#160;12</a> are much like those used in the UNIX system editor, <code class="cCode">ed</code>(1). The alternation operator, (<code class="cCode">|</code>), has been added along with some other practical things. In general, however, there should be few surprises.
</p>
<p class="pBody"><a name="wp1830959"> </a>
Regular expressions (REs) are constructed by applying any of the following production rules one or more times.
</p>
<p class="pGraphic"><a name="wp1831045"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1830962table1830960"><caption><a name="wp1830962"> </a>
Table&#160;12  Regular Expressions&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1830966"> </a>
Rule
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1830968"> </a>
Matching Text
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1830970"> </a>
character
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1830972"> </a>
Itself (<span style="font-style: italic">character</span> is any ASCII character except the special ones mentioned below).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1830974"> </a>
<code class="cCode">\ character</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1830976"> </a>
Itself except as follows:
</div>
<div class="pSmartList1TableBullet"><ul class="SmartList1TableBullet">
<li><a name="wp1830977"> </a>\\&#8212;newline </li>
<li><a name="wp1830978"> </a>\\t&#8212;tab</li>
<li><a name="wp1830979"> </a>\\b&#8212;backspace</li>
<li><a name="wp1830980"> </a>\\r&#8212;carriage return</li>
<li><a name="wp1830981"> </a>\\f&#8212;formfeed</li>
</ul></div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="straddledcells" colspan="1" rowspan="4"><div class="pCellBody"><a name="wp1830983"> </a>
<code class="cCode">\ special-character</code>
</div>
</td>
    <td class="straddledcells" colspan="1" rowspan="4"><div class="pCellBody"><a name="wp1838132"> </a>
Its <span style="font-style: italic">un</span>special self. The special characters are . * + ? | ( ) [ { and \\.
</div>
<div class="pCellBody"><a name="wp1838133"> </a>
.&#8212;Any character except the end-of-line character (usually newline or NULL).
</div>
<div class="pCellBody"><a name="wp1838134"> </a>
^&#8212;Beginning of the line.
</div>
<div class="pCellBody"><a name="wp1830988"> </a>
$&#8212;End-of-line character.
</div>
</td>
</tr>
  <tr align="left" valign="top"></tr>
  <tr align="left" valign="top"></tr>
  <tr align="left" valign="top"></tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831002"> </a>
<code class="cCode">[class]</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831004"> </a>
any character in the class denoted by a sequence of characters and/or ranges. A range is given by the construct <span style="font-style: italic">character</span>-<span style="font-style: italic">character</span>. For example, the character class, [a-zA-Z0-9_], will match any alphameric character or &#8220;_&#8221;. To be included in the class, a hyphen, &#8220;-&#8221;, must be escaped (preceded by a &#8220;\\&#8221;) or appear first or last in the class. A literal &#8220;]&#8221; must be escaped or appear first in the class. A literal &#8220;^&#8221; must be escaped if it appears first in the class.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831006"> </a>
[<code class="cCode">^ class</code> ] 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831008"> </a>
Any character in the complement of the class with respect to the ASCII character set, excluding the end-of-line character.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831010"> </a>
<code class="cCode">RE RE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831012"> </a>
The sequence. (catenation)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831014"> </a>
<code class="cCode">RE | RE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831016"> </a>
Either the left RE or the right RE. (left to right alternation)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831018"> </a>
<code class="cCode">RE *</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831020"> </a>
Zero or more occurrences of RE.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831022"> </a>
<code class="cCode">RE +</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831024"> </a>
One or more occurrences of RE.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831026"> </a>
<code class="cCode">RE ?</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831028"> </a>
Zero or one occurrences of RE.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831030"> </a>
<code class="cCode">RE { n }</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831032"> </a>
<code class="cCodeEmphasis">n</code> occurrences of RE. <code class="cCodeEmphasis">n</code> must be between 0 and 255, inclusive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831034"> </a>
<code class="cCode">RE { m, n }</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831036"> </a>
<code class="cCode">m </code>through <code class="cCode">n</code> occurrences of RE, inclusive. A missing <code class="cCodeEmphasis">m</code> is taken to be zero. A missing <code class="cCodeEmphasis">n</code> denotes <code class="cCodeEmphasis">m</code> or more occurrences of <code class="cCode">RE</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831038"> </a>
<code class="cCode">( RE )</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831040"> </a>
Explicit precedence/grouping.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831042"> </a>
<code class="cCode">( RE ) $ n</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1831044"> </a>
The text matching <code class="cCode">RE</code> is copied into the <span style="font-style: italic">nth</span> user buffer. <code class="cCodeEmphasis">n</code> may be 0 through 9. User buffers are cleared before matching begins and loaded only if the entire pattern is matched.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1831046"> </a>
There are three levels of precedence. In order of decreasing binding strength they are: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1831047"> </a><code class="cCode">catenation closure (*,+,?,{...})</code></li>
<li><a name="wp1831048"> </a><code class="cCode">catenation</code></li>
<li><a name="wp1831049"> </a><code class="cCode">alternation (|)</code></li>
</ul></div>
<p class="pBody"><a name="wp1831050"> </a>
As indicated above, parentheses are used to give explicit precedence.
</p>
<h4 class="pHeading3"><a name="wp1045705"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045706"> </a>
Upon successful completion, <code class="cCode">tpsubscribe()</code> returns a handle that can be used to remove this subscription from the EventBroker&#8217;s list of active subscriptions. The subscriber or any other process is allowed to use the returned handle to delete this subscription. 
</p>
<p class="pBody"><a name="wp1233108"> </a>
Upon failure, <code class="cCode">tpsubscribe()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045707"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045708"> </a>
Upon failure, <code class="cCode">tpsubscribe()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1045709"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1045710"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">eventexpr</code> is NULL).
</div>
<h4 class="pDefTerm"><a name="wp1045711"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1045712"> </a>
Cannot access the Oracle Tuxedo EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1045713"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp1045714"> </a>
The subscription failed because the EventBroker&#8217;s maximum number of subscriptions has been reached.
</div>
<h4 class="pDefTerm"><a name="wp1045715"> </a>
[<code class="cCode">TPEMATCH</code>] 
</h4><div class="pDefPara"><a name="wp1045716"> </a>
The subscription failed because it matched one already listed with the EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1773521"> </a>
[<code class="cCode">TPEPERM</code>] 
</h4><div class="pDefPara"><a name="wp1045717"> </a>
The client is not attached as <code class="cCode">tpsysadm</code> and the subscription action is either a service call or the enqueuing of a message.
</div>
<h4 class="pDefTerm"><a name="wp1773515"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854382"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpsubscribe()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854383"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854384"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854385"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1045719"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1045720"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1045721"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1045722"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1045723"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045724"> </a>
<code class="cCode">tpsubscribe()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1045725"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045726"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045727"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045728"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1502600"> </a>
See Also
</h4>
<p class="pBody"><a name="wp2297513"> </a>
<a href="rf3c.html#wp1021456"><code class="cCode">buffer(3c)</code></a>, <a href="rf3c.html#wp1042179"><code class="cCode">tpenqueue(3c)</code></a>, <a href="rf3c.html#wp1044210"><code class="cCode">tppost(3c)</code></a>, <a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>, <a href="rf3c.html#wp1045970"><code class="cCode">tpunsubscribe(3c)</code></a>, <a href="../rf3fml/rf3fml.html">Fboolco, Fbool</a><a href="../rf3fml/rf3fml.html">co32, Fvbo</a><a href="../rf3fml/rf3fml.html">olco, Fvboolco3</a><a href="../rf3fml/rf3fml.html">2(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fboolev,&#160;Fboo</a><a href="../rf3fml/rf3fml.html">lev32, Fvbo</a><a href="../rf3fml/rf3fml.html">olev, Fvboo</a><a href="../rf3fml/rf3fml.html">lev32(3fml)</a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">EVENT_MIB(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a>, <a href="../rf5/rf5.html">tuxtypes(5)</a>, <a href="../rf5/rf5.html">typesw(5)</a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045633"> </a>
tpsuspend(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045634"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045635"> </a>
<code class="cCode">tpsuspend()</code>&#8212;Suspends a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1045636"> </a>
Synopsis
</h4>
<a name="wp1045637"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpsuspend(TPTRANID *tranid, long flags) </pre></div><h4 class="pHeading3"><a name="wp1045638"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045639"> </a>
<code class="cCode">tpsuspend()</code> is used to suspend the transaction active in the caller&#8217;s process. A transaction begun with <code class="cCode">tpbegin()</code> may be suspended with <code class="cCode">tpsuspend()</code>. Either the suspending process or another process may use <code class="cCode">tpresume()</code> to resume work on a suspended transaction. When <code class="cCode">tpsuspend()</code> returns, the caller is no longer in transaction mode. However, while a transaction is suspended, all resources associated with that transaction (such as database locks) remain active. Like an active transaction, a suspended transaction is susceptible to the transaction timeout value that was assigned when the transaction first began.
</p>
<p class="pBody"><a name="wp1045640"> </a>
For the transaction to be resumed in another process, the caller of <code class="cCode">tpsuspend()</code> must have been the initiator of the transaction by explicitly calling <code class="cCode">tpbegin()</code>. <code class="cCode">tpsuspend()</code> may also be called by a process other than the originator of the transaction (for example, a server that receives a request in transaction mode). In the latter case, only the caller of <code class="cCode">tpsuspend()</code> may call <code class="cCode">tpresume()</code> to resume that transaction. This case is allowed so that a process can temporarily suspend a transaction to begin and do some work in another transaction before completing the original transaction (for example, to run a transaction to log a failure before rolling back the original transaction).
</p>
<p class="pBody"><a name="wp1045641"> </a>
<code class="cCode">tpsuspend()</code> returns in the space pointed to by <code class="cCodeEmphasis">tranid</code> the transaction identifier being suspended. The caller is responsible for allocating the space to which <code class="cCodeEmphasis">tranid</code> points. It is an error for <code class="cCodeEmphasis">tranid</code> to be NULL.
</p>
<p class="pBody"><a name="wp1045642"> </a>
To ensure success, the caller must have completed all outstanding transactional communication with servers before issuing <code class="cCode">tpsuspend()</code>. That is, the caller must have received all replies for requests sent with <code class="cCode">tpacall()</code> that were associated with the caller&#8217;s transaction. Also, the caller must have closed all connections with conversational services associated with the caller&#8217;s transaction (that is, <code class="cCode">tprecv()</code> must have returned the <code class="cCode">TPEV_SVCSUCC</code> event). If either rule is not followed, then <code class="cCode">tpsuspend()</code> fails, the caller&#8217;s current transaction is not suspended and all transactional communication descriptors remain valid. Communication descriptors not associated with the caller&#8217;s transaction remain valid regardless of the outcome of <code class="cCode">tpsuspend()</code>.
</p>
<p class="pBody"><a name="wp1045643"> </a>
Currently, <code class="cCodeEmphasis">flags</code> are reserved for future use and must be set to 0.
</p>
<p class="pBody"><a name="wp1632120"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpsuspend()</code>.
</p>
<p class="pBody"><a name="wp2435554"> </a>
<code class="cCode">tpsuspend()</code>can take effect in all participated resource managers including those in a multiple resource mangers server group in a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1045644"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1045645"> </a>
<code class="cCode">tpsuspend()</code> returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045646"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045647"> </a>
Under the following conditions, <code class="cCode">tpsuspend()</code> fails and sets <code class="cCode">tperrno</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1045648"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1045649"> </a>
<code class="cCodeEmphasis">tranid</code> is a NULL pointer or <code class="cCodeEmphasis">flags</code> is not 0. The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1045650"> </a>
[<code class="cCode">TPEABORT</code>] 
</h4><div class="pDefPara"><a name="wp1045651"> </a>
The caller&#8217;s active transaction has been aborted. All communication descriptors associated with the transaction are no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp1045652"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045653"> </a>
<code class="cCode">tpsuspend()</code> was called in an improper context (for example, the caller is not in transaction mode). The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1045654"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045655"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045656"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045657"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045658"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045659"> </a>
<a href="rf3c.html#wp1037129"><code class="cCode">tpacall(3c)</code></a>, <a href="rf3c.html#wp2305391"><code class="cCode">tpbegin(3c)</code></a>, <a href="rf3c.html#wp1022967"><code class="cCode">tprecv(3c)</code></a>, <a href="rf3c.html#wp1044625"><code class="cCode">tpresume(3c)</code></a><code class="cCode">, tprmopen(3c), tprmclose(3c), tprmstart(3c), tprmend(3c)</code>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023279"> </a>
tpsvrdone(3c)
</h3>
<h4 class="pHeading3"><a name="wp1838137"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023280"> </a>
<code class="cCode">tpsvrdone()</code>&#8212;Terminates an Oracle Tuxedo ATMI system server.
</p>
<h4 class="pHeading3"><a name="wp1023281"> </a>
Synopsis
</h4>
<a name="wp1023282"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />void tpsvrdone(void) </pre></div><h4 class="pHeading3"><a name="wp1023283"> </a>
Description
</h4>
<p class="pBody"><a name="wp1218811"> </a>
The Oracle Tuxedo ATMI system server abstraction calls <code class="cCode">tpsvrdone()</code> after it has finished processing service requests but before it exits. When this routine is invoked, the server is still part of the system but its own services have been unadvertised. Thus, Oracle Tuxedo ATMI system communication can be performed and transactions can be defined in this routine. However, if <code class="cCode">tpsvrdone()</code> returns with open connections, asynchronous replies pending or while still in transaction mode, the Oracle Tuxedo ATMI system will close its connections, ignore any pending replies, and abort the transaction before the server exits.
</p>
<p class="pBody"><a name="wp1218812"> </a>
If a server is shut down by the invocation of <code class="cCode">tmshutdown -y</code>, services are suspended and the ability to perform communication or to begin transactions in <code class="cCode">tpsvrdone()</code> is limited.
</p>
<p class="pBody"><a name="wp1230836"> </a>
If an application does not provide this routine in a server, then the default version provided by the Oracle Tuxedo ATMI system is called instead. If a server has been defined as a single-threaded server, the default <code class="cCode">tpsvrdone()</code> calls <code class="cCode">tpsvrthrdone()</code>, and the default version of <code class="cCode">tpsvrthrdone()</code> calls <code class="cCode">tx_close()</code>. If a server has been defined as a multithreaded server, <code class="cCode">tpsvrthrdone()</code> is called in each server dispatch thread, but is not called from <code class="cCode">tpsvrdone()</code>. Regardless of whether the server is multithreaded, the default <code class="cCode">tpsvrdone()</code> calls <code class="cCode">userlog</code> to indicate that the server is about to exit.
</p>
<h4 class="pHeading3"><a name="wp1023286"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1023287"> </a>
When called in <code class="cCode">tpsvrdone()</code>, the <code class="cCode">tpreturn()</code> and <code class="cCode">tpforward()</code> functions simply return with no effect.
</p>
<h4 class="pHeading3"><a name="wp1023288"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1368360"> </a>
<a href="rf3c.html#wp1221377"><code class="cCode">tpsvrthrdone(3c)</code></a>, <a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>, <a href="../rf5/rf5.html">servopts(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023306"> </a>
tpsvrinit(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023307"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023308"> </a>
<code class="cCode">tpsvrinit()</code>&#8212;Initializes an Oracle Tuxedo system server.
</p>
<h4 class="pHeading3"><a name="wp1023309"> </a>
Synopsis
</h4>
<a name="wp1023310"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpsvrinit(int <code class="cCodeEmphasis">argc</code>, char **<code class="cCodeEmphasis">argv</code>) </pre></div><h4 class="pHeading3"><a name="wp1023311"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023312"> </a>
The Oracle Tuxedo ATMI system server abstraction calls <code class="cCode">tpsvrinit()</code> during its initialization. This routine is called after the thread of control has become a server but before it handles any service requests; thus, Oracle Tuxedo ATMI system communication may be performed and transactions may be defined in this routine. However, if <code class="cCode">tpsvrinit()</code> returns with either open connections or asynchronous replies pending, or while still in transaction mode, the Oracle Tuxedo ATMI system closes the connections, ignores any pending replies, and aborts the transaction before the server exits.
</p>
<p class="pBody"><a name="wp1023313"> </a>
If an application does not provide this routine in a server, then the default version provided by the Oracle Tuxedo ATMI system is called, instead. 
</p>
<p class="pBody"><a name="wp1023314"> </a>
If a server has been defined as a single-threaded server, the default <code class="cCode">tpsvrinit()</code> calls <code class="cCode">tpsvrthrinit()</code>, and the default version of <code class="cCode">tpsvrthrinit()</code> calls <code class="cCode">tx_open()</code>. If a server has been defined as a multithreaded server, <code class="cCode">tpsvrthrinit()</code> is called in each server dispatch thread, but is not called from <code class="cCode">tpsvrinit()</code>. Regardless of whether the server is single-threaded or multithreaded, the default version of <code class="cCode">tpsvrinit()</code> calls <code class="cCode">userlog()</code> to indicate that the server started successfully.
</p>
<p class="pBody"><a name="wp1217135"> </a>
Application-specific options can be passed into a server and processed in <code class="cCode">tpsvrinit()</code> (see <a href="../rf5/rf5.html">servopts(5)</a>). The options are passed through <code class="cCodeEmphasis">argc</code> and <code class="cCodeEmphasis">argv</code>. Since <code class="cCode">getopt()</code> is used in an Oracle Tuxedo ATMI system server abstraction, <code class="cCode">optarg()</code>, <code class="cCode">optind()</code>, and <code class="cCode">opterr()</code> may be used to control option parsing and error detection in <code class="cCode">tpsvrinit()</code>.
</p>
<a name="wp2215297"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>When invoking tpsvrinit() in your code, avoid long blocking actions. Otherwise, when one remote server in an MP configuration has trouble with tpsvrinit() processing, then tmboot fails to boot the other servers on that node.</td>
</tr>
</table>

<p class="pBody"><a name="wp1023315"> </a>
If an error occurs in <code class="cCode">tpsvrinit()</code>, the application can cause the server to exit gracefully (and not take any service requests) by returning -1. The application itself should not call <code class="cCode">exit()</code>.
</p>
<p class="pBody"><a name="wp1841235"> </a>
When <code class="cCode">tpsvrinit()</code> returns -1, the system does not restart the server. Instead, the administrator must run <code class="cCode">tmboot</code> to restart the server.
</p>
<h4 class="pHeading3"><a name="wp1023316"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023317"> </a>
A negative return value causes the server to exit gracefully.
</p>
<h4 class="pHeading3"><a name="wp1023318"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1023319"> </a>
When used outside a service routine (for example, in clients, in <code class="cCode">tpsvrinit()</code>, or in <code class="cCode">tpsvrdone()</code>), the <code class="cCode">tpreturn()</code> and <code class="cCode">tpforward()</code> functions simply return with no effect.
</p>
<h4 class="pHeading3"><a name="wp1502655"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1502656"> </a>
<a href="rf3c.html#wp1043391"><code class="cCode">tpopen(3c)</code></a>, <a href="rf3c.html#wp1023279"><code class="cCode">tpsvrdone(3c)</code></a>, <a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>, <a href="../rf5/rf5.html">servopts(5)<br /></a><code class="cCode">getopt</code>(3) in a C language reference manual
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1221377"> </a>
tpsvrthrdone(3c)
</h3>
<h4 class="pHeading3"><a name="wp1221378"> </a>
 Name
</h4>
<p class="pBody"><a name="wp1221379"> </a>
<code class="cCode">tpsvrthrdone()</code>&#8212;Terminates an Oracle Tuxedo ATMI server thread.
</p>
<h4 class="pHeading3"><a name="wp1221380"> </a>
Synopsis
</h4>
<a name="wp1221381"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />void tpsvrthrdone(void)</pre></div><h4 class="pHeading3"><a name="wp1221383"> </a>
Description
</h4>
<p class="pBody"><a name="wp1221384"> </a>
The Oracle Tuxedo ATMI server abstraction calls <code class="cCode">tpsvrthrdone()</code> during the termination of each thread that has been started to handle dispatched service requests. In other words, even if a thread is terminated before it has handled a request, the <code class="cCode">tpsvrdone()</code> function is called. When this routine is called, the thread of control is still part of the Oracle Tuxedo ATMI server, but the thread has finished processing all service requests. Thus, Oracle Tuxedo ATMI communication may be performed and transactions may be defined in this routine. However, if <code class="cCode">tpsvrthrdone()</code> returns with either open connections or asynchronous replies pending, or while still in transaction mode, the Oracle Tuxedo ATMI system closes the connections, ignores any pending replies, and aborts the transaction before the server dispatch thread exits. 
</p>
<p class="pBody"><a name="wp1221385"> </a>
If an application does not provide this routine in a server, then the default version of <code class="cCode">tpsvrthrdone()</code> provided by the Oracle Tuxedo ATMI system is called instead. The default version of <code class="cCode">tpsvrthrdone()</code> calls <code class="cCode">tx_close()</code>.
</p>
<p class="pBody"><a name="wp1221386"> </a>
<code class="cCode">tpsvrthrdone()</code> is called even in single-threaded servers. In a single-threaded server, <code class="cCode">tpsvrthrdone()</code> is called from the default version of <code class="cCode">tpsvrdone()</code>. In a server with the potential for multiple dispatch threads, <code class="cCode">tpsvrdone()</code> does not call <code class="cCode">tpsvrthrdone()</code>.
</p>
<h4 class="pHeading3"><a name="wp1221387"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1221388"> </a>
When called from <code class="cCode">tpsvrthrdone()</code>, the <code class="cCode">tpreturn()</code> and <code class="cCode">tpforward()</code> functions simply return with no effect.
</p>
<h4 class="pHeading3"><a name="wp1221389"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1221390"> </a>
<a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1023279"><code class="cCode">tpsvrdone(3c)</code></a>, <a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>, <a href="rf3c.html#wp1046217"><code class="cCode">tx_close(3c)</code></a>, <a href="../rf5/rf5.html">servopts(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1221041"> </a>
tpsvrthrinit(3c)
</h3>
<h4 class="pHeading3"><a name="wp1219399"> </a>
Name
</h4>
<p class="pBody"><a name="wp1219400"> </a>
<code class="cCode">tpsvrthrinit()</code>&#8212;Initializes an Oracle Tuxedo ATMI server thread.
</p>
<h4 class="pHeading3"><a name="wp1219401"> </a>
Synopsis
</h4>
<a name="wp1219402"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />int tpsvrthrinit(int <code class="cCodeEmphasis">argc</code>, char **<code class="cCodeEmphasis">argv</code>)</pre></div><h4 class="pHeading3"><a name="wp1219404"> </a>
Description
</h4>
<p class="pBody"><a name="wp1219405"> </a>
The Oracle Tuxedo ATMI server abstraction calls <code class="cCode">tpsvrthrinit()</code> during the initialization of each thread that handles dispatched service requests. This routine is called after the thread of control has become part of the Oracle Tuxedo ATMI server but before the thread handles any service requests. Thus, Oracle Tuxedo ATMI communication may be performed and transactions may be defined in this routine. However, if <code class="cCode">tpsvrthrinit()</code> returns with either open connections or asynchronous replies pending, or while still in transaction mode, the Oracle Tuxedo ATMI system closes the connections, ignores any pending replies, and aborts the transaction before the server dispatch thread exits.
</p>
<p class="pBody"><a name="wp1219406"> </a>
If an application does not provide this routine in a server, then the default version of <code class="cCode">tpsvrthrinit()</code> provided by the Oracle Tuxedo ATMI system is called instead. The default version of <code class="cCode">tpsvrthrinit()</code> calls <code class="cCode">tx_open()</code>. 
</p>
<p class="pBody"><a name="wp1219407"> </a>
<code class="cCode">tpsvrthrinit()</code> is called even in single-threaded servers. In a single-threaded server, <code class="cCode">tpsvrthrinit()</code> is called from the default version of <code class="cCode">tpsvrinit()</code>. In a server with the potential for multiple dispatch threads, <code class="cCode">tpsvrinit()</code> does not call <code class="cCode">tpsvrthrinit()</code>.
</p>
<p class="pBody"><a name="wp1219408"> </a>
Application-specific options can be passed into a server and processed in <code class="cCode">tpsvrthrinit()</code>. For more information about options, see <a href="../rf5/rf5.html">servopts(5)</a>. The options are passed <code class="cCodeEmphasis">argc</code> and <code class="cCodeEmphasis">argv</code>. Because <code class="cCode">getopt()</code> is used in an Oracle Tuxedo ATMI server abstraction, <code class="cCode">optarg()</code>, <code class="cCode">optind()</code>, and <code class="cCode">opterr()</code> may be used to control option parsing and error detection in <code class="cCode">tpsvrthrinit()</code>.
</p>
<p class="pBody"><a name="wp1219409"> </a>
If an error occurs in <code class="cCode">tpsvrthrinit()</code>, the application can cause the server dispatch thread to exit gracefully (and not take any service requests) by returning -1. The application should not call <code class="cCode">exit()</code> or any operating system thread exit function.
</p>
<h4 class="pHeading3"><a name="wp1219410"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1219411"> </a>
A negative return value will cause the server dispatch thread to exit gracefully.
</p>
<h4 class="pHeading3"><a name="wp1219412"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1238733"> </a>
When used outside a service routine (for example, when used in a client or in <code class="cCode">tpsvrinit()</code>, <code class="cCode">tpsvrdone()</code>, <code class="cCode">tpsvrthrinit()</code>, or <code class="cCode">tpsvrthrdone()</code>), the <code class="cCode">tpreturn()</code> and <code class="cCode">tpforward()</code> functions simply return with no effect.
</p>
<h4 class="pHeading3"><a name="wp1238734"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1238735"> </a>
<a href="rf3c.html#wp2006034"><code class="cCode">tpforward(3c)</code></a>, <a href="rf3c.html#wp1023041"><code class="cCode">tpreturn(3c)</code></a>, <a href="rf3c.html#wp1221377"><code class="cCode">tpsvrthrdone(3c)</code></a>, <a href="rf3c.html#wp1221041"><code class="cCode">tpsvrthrinit(3c)</code></a>, <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>, <a href="../rf5/rf5.html">servopts(5)</a> 
</p>
<p class="pBody"><a name="wp1270420"> </a>
<code class="cCode">getopt</code>(3) in a C language reference manual 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1219084"> </a>
tpterm(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045733"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045734"> </a>
<code class="cCode">tpterm()</code>&#8212;Leaves an application.
</p>
<h4 class="pHeading3"><a name="wp1045735"> </a>
Synopsis
</h4>
<a name="wp1045736"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpterm(void) </pre></div><h4 class="pHeading3"><a name="wp1045737"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045738"> </a>
<code class="cCode">tpterm()</code> removes a client from an Oracle Tuxedo ATMI system application. If the client is in transaction mode, then the transaction is rolled back. When <code class="cCode">tpterm()</code> returns successfully, the caller can no longer perform Oracle Tuxedo ATMI client operations. Any outstanding conversations are immediately disconnected.
</p>
<p class="pBody"><a name="wp1045739"> </a>
If <code class="cCode">tpterm()</code> is called more than once (that is, if it is called after the caller has already left the application), no action is taken and success is returned.
</p>
<h5 class="pHeading4"><a name="wp1405574"> </a>
Multithreading and Multicontexting Issues
</h5>
<p class="pBody"><a name="wp1403678"> </a>
In good programming practice, all threads but one should either exit or switch context before the single remaining thread issues a call to <code class="cCode">tpterm()</code>. If this is not done, then the remaining threads are put in a <code class="cCode">TPINVALIDCONTEXT</code> context. A description of the semantics of this context follows.
</p>
<p class="pBody"><a name="wp1405803"> </a>
When invoked by one thread in a context with which multiple threads are associated, <code class="cCode">tpterm()</code>:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1405582"> </a>Operates on all threads in a context, but not on all contexts in a process</li>
<li><a name="wp1405583"> </a>Executes immediately, even if other threads in the same process are still associated with that context</li>
</ul></div>
<p class="pBody"><a name="wp1405130"> </a>
Any thread blocked in an ATMI call when another thread terminates its context will return from the ATMI call with a failure return; <code class="cCode">tperrno</code> is set to <code class="cCode">TPESYSTEM</code>. In addition, if <code class="cCode">tperrordetail()</code> is invoked after such a failure return, it returns <code class="cCode">TPED_INVALIDCONTEXT</code>.
</p>
<p class="pBody"><a name="wp1405433"> </a>
In a single-context application, whenever a single thread calls <code class="cCode">tpterm()</code>, the context state for all threads is set to <code class="cCode">TPNULLCONTEXT</code>.
</p>
<p class="pBody"><a name="wp1678047"> </a>
In a multicontexted application, however, when <code class="cCode">tpterm()</code> is invoked by one thread, all other threads in the same context are placed in a state such that if they subsequently call most ATMI functions, those functions will, instead, return failure with <code class="cCode">tperrno </code>set to <code class="cCode">TPEPROTO</code>. Lists of the functions that are allowed and disallowed in such an invalid context state are provided in <a href="rf3c.html#wp1448392">Introduction to the C Language Application-to-Transaction Monitor Interface</a>. If a thread in the invalid context state (<code class="cCode">TPINVALIDCONTEXT</code>) calls the <code class="cCode">tpgetctxt()</code> function, <code class="cCode">tpgetctxt()</code> sets the context parameter to <code class="cCode">TPINVALIDCONTEXT</code>. 
</p>
<p class="pBody"><a name="wp1405599"> </a>
A thread may exit from the <code class="cCode">TPINVALIDCONTEXT</code> state by calling one of the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1405806"> </a><code class="cCode">tpsetctxt()</code> with the <code class="cCode">TPNULLCONTEXT</code> context or another valid context </li>
<li><a name="wp1405807"> </a><code class="cCode">tpterm()</code></li>
</ul></div>
<p class="pBody"><a name="wp1838498"> </a>
It is forbidden to call <code class="cCode">tpsetctxt()</code> with a context of <code class="cCode">TPINVALIDCONTEXT</code>; doing so results in failure with <code class="cCode">tperrno</code> set to <code class="cCode">TPEPROTO</code>. When a thread invokes ATMI functions other than <code class="cCode">tpsetunsol()</code>that do not require the caller to be associated with an application, these functions behave as if they were invoked in the NULL context. Client applications using unsolicited thread notification should explicitly call <code class="cCode">tpterm()</code> to terminate the unsolicited notification thread.
</p>
<p class="pBody"><a name="wp1405446"> </a>
After invoking <code class="cCode">tpterm()</code>, a thread is placed in the <code class="cCode">TPNULLCONTEXT</code> context. Most ATMI functions invoked by a thread in the <code class="cCode">TPNULLCONTEXT</code> context perform an implicit <code class="cCode">tpinit()</code>. Whether or not the call to <code class="cCode">tpinit()</code> succeeds depends on the usual determining factors, unrelated to context-specific or thread-specific issues.
</p>
<p class="pBody"><a name="wp1618155"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tpterm()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1045740"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045741"> </a>
Upon success in a single-context application, all threads in the application&#8217;s current context are placed in the <code class="cCode">TPNULLCONTEXT</code> state.
</p>
<p class="pBody"><a name="wp1632374"> </a>
Upon success in a multicontexted application, the calling thread is placed in the <code class="cCode">TPNULLCONTEXT</code> state and all other threads in the same context as the calling thread are placed in the <code class="cCode">TPINVALIDCONTEXT</code> state. The user may change the context state of the latter threads by running <code class="cCode">tpsetctxt()</code> with the <code class="cCodeEmphasis">context</code> argument set to <code class="cCode">TPNULLCONTEXT</code> or another valid context.
</p>
<p class="pBody"><a name="wp1257656"> </a>
Upon failure, <code class="cCode">tpterm()</code> leaves the calling process in its original context state, returns -1, and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045742"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045743"> </a>
Upon failure, <code class="cCode">tpterm()</code> sets <code class="cCode">tperrno</code> to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1045744"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045745"> </a>
<code class="cCode">tpterm()</code> was called in an improper context (for example, the caller is a server).
</div>
<h4 class="pDefTerm"><a name="wp1045746"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045747"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045748"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045749"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1679172"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1679182"> </a>
<a href="rf3c.html#wp1022852"><code class="cCode">tpinit(3c)</code></a>, <a href="rf3c.html#wp2272018"><code class="cCode">tpgetctxt(3c)</code></a>, <a href="rf3c.html#wp1223538"><code class="cCode">tpsetctxt(3c)</code></a>, <a href="rf3c.html#wp1223138"><code class="cCode">tpsetunsol(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045809"> </a>
tptypes(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045810"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045811"> </a>
<code class="cCode">tptypes()</code>&#8212;Routine to determine information about a typed buffer.
</p>
<h4 class="pHeading3"><a name="wp1045812"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1045813"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />long tptypes(char *ptr, char *type, char *subtype)</code> 
</p>
<h4 class="pHeading3"><a name="wp1045814"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045815"> </a>
<code class="cCode">tptypes()</code> takes as its first argument a pointer to a data buffer and returns the type and subtype of that buffer in its second and third arguments, respectively. <code class="cCodeEmphasis">ptr</code> must point to a buffer gotten from <code class="cCode">tpalloc()</code>. If <code class="cCodeEmphasis">type</code> and <code class="cCodeEmphasis">subtype</code> are non-NULL, then the function populates the character arrays to which they point with the names of the buffer&#8217;s type and subtype, respectively. If the names are of their maximum length (8 for <code class="cCodeEmphasis">type</code>, 16 for <code class="cCodeEmphasis">subtype</code>), the character array is not NULL-terminated. If no subtype exists, then the array pointed to by <code class="cCodeEmphasis">subtype</code> will contain a NULL string.
</p>
<p class="pBody"><a name="wp1045816"> </a>
Note that only the first eight bytes of <code class="cCodeEmphasis">type</code> and the first 16 bytes of <code class="cCodeEmphasis">subtype</code> are populated.
</p>
<p class="pBody"><a name="wp1618167"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tptypes()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1045817"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045818"> </a>
Upon success, <code class="cCode">tptypes()</code> returns the size of the buffer; 
</p>
<p class="pBody"><a name="wp1233181"> </a>
Upon failure, it returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045819"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045820"> </a>
Upon failure, <code class="cCode">tptypes()</code> sets tperrno to one of the following values: 
</p>
<h4 class="pDefTerm"><a name="wp1045821"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1345056"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">ptr</code> does not point to a buffer gotten from <code class="cCode">\% tpalloc()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1345057"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045824"> </a>
<code class="cCode">tptypes()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1045825"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045826"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045827"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045828"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045829"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045830"> </a>
<a href="rf3c.html#wp1021676"><code class="cCode">tpalloc(3c)</code></a>, <a href="rf3c.html#wp1042579"><code class="cCode">tpfree(3c)</code></a>, <a href="rf3c.html#wp1044439"><code class="cCode">tprealloc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045888"> </a>
tpunadvertise(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045889"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045890"> </a>
<code class="cCode">tpunadvertise()</code>&#8212;Routine for unadvertising a service name.
</p>
<h4 class="pHeading3"><a name="wp1045891"> </a>
Synopsis
</h4>
<a name="wp1045892"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpunadvertise(char *svcname)</pre></div><h4 class="pHeading3"><a name="wp1045893"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045894"> </a>
<code class="cCode">tpunadvertise()</code> allows a server to unadvertise a service that it offers. By default, a server&#8217;s services are advertised when it is booted and they are unadvertised when it is shut down.
</p>
<p class="pBody"><a name="wp1045895"> </a>
All servers belonging to a Multiple Server, Single Queue (MSSQ) set must offer the same set of services. These routines enforce this rule by affecting the advertisements of all servers sharing an MSSQ set.
</p>
<p class="pBody"><a name="wp1045896"> </a>
<code class="cCode">tpunadvertise()</code> removes <code class="cCodeEmphasis">svcname</code> as an advertised service for the server (or the set of servers sharing the caller&#8217;s MSSQ set). <code class="cCodeEmphasis">svcname</code> cannot be NULL or the NULL string (&#8220;&#8221;). Also, <code class="cCodeEmphasis">svcname</code> should be 127 characters or less. (See the *SERVICES section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>). Longer names will be accepted and truncated to 127 characters. Care should be taken such that truncated names do not match other service names.
</p>
<h4 class="pHeading3"><a name="wp1045897"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045898"> </a>
Upon failure, <code class="cCode">tpunadvertise()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045899"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045900"> </a>
Upon failure, <code class="cCode">tpunadvertise()</code> sets <code class="cCode">tperrno</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1045901"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1045902"> </a>
<code class="cCodeEmphasis">svcname</code> is NULL or the NULL string (&#8220;&#8221;).
</div>
<h4 class="pDefTerm"><a name="wp1045903"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1045904"> </a>
<code class="cCodeEmphasis">svcname</code> is not currently advertised by the server.
</div>
<h4 class="pDefTerm"><a name="wp1045905"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1045906"> </a>
<code class="cCode">tpunadvertise()</code> was called in an improper context (for example, by a client).
</div>
<h4 class="pDefTerm"><a name="wp1045907"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045908"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045909"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045910"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045911"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045912"> </a>
<a href="rf3c.html#wp1021630"><code class="cCode">tpadvertise(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045970"> </a>
tpunsubscribe(3c)
</h3>
<h4 class="pHeading3"><a name="wp1045971"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045972"> </a>
<code class="cCode">tpunsubscribe()</code>&#8212;Unsubscribes to an event.
</p>
<h4 class="pHeading3"><a name="wp1045973"> </a>
Synopsis
</h4>
<a name="wp1045974"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tpunsubscribe(long subscription, long flags)</pre></div><h4 class="pHeading3"><a name="wp1045975"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045976"> </a>
The caller uses <code class="cCode">tpunsubscribe()</code> to remove an event subscription or a set of event subscriptions from the Oracle Tuxedo EventBroker&#8217;s list of active subscriptions. <code class="cCodeEmphasis">subscription</code> is an event subscription handle returned by <code class="cCode">tpsubscribe()</code>. Setting <code class="cCodeEmphasis">subscription</code> to the wildcard value, -1, directs <code class="cCode">tpunsubscribe()</code> to unsubscribe to all non-persistent subscriptions previously made by the calling process. Non-persistent subscriptions are those made without the <code class="cCode">TPEVPERSIST</code> bit setting in the <code class="cCodeEmphasis">ctl</code><span class="arrow"><img id="LongDescNotReq59" src="/global_resources/images/arrwrite.gif" alt="Arrow symbol"/></span><code class="cCodeEmphasis">flags</code> parameter of <code class="cCode">tpsubscribe()</code>. Persistent subscriptions can be deleted only by using the handle returned by <code class="cCode">tpsubscribe()</code>.
</p>
<p class="pBody"><a name="wp1045977"> </a>
Note that the -1 handle removes only those subscriptions made by the calling process and not any made by previous instantiations of the caller (for example, a server that dies and restarts cannot use the wildcard to unsubscribe to any subscriptions made by the original server).
</p>
<p class="pBody"><a name="wp1045978"> </a>
The following is a list of valid <code class="cCodeEmphasis">flags</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1045979"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1045980"> </a>
The subscription is not removed if a blocking condition exists. If such a condition occurs, the call fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPEBLOCK</code>. When <code class="cCode">TPNOBLOCK</code> is not specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout).
</div>
<h4 class="pDefTerm"><a name="wp1045981"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1045982"> </a>
This flag signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur.
</div>
<h4 class="pDefTerm"><a name="wp1045983"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1045984"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. When <code class="cCode">TPSIGRSTRT</code> is not specified and a signal interrupts a system call, then <code class="cCode">tpunsubscribe()</code> fails and <code class="cCode">tperrno</code> is set to <code class="cCode">TPGOTSIG</code>.
</div>
<p class="pBody"><a name="wp1632128"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tpunsubscribe()</code>.
</p>
<h4 class="pHeading3"><a name="wp1045985"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045986"> </a>
Upon completion of <code class="cCode">tpunsubscribe()</code>, <code class="cCode">tpurcode()</code> contains the number of subscriptions deleted (zero or greater) from the EventBroker&#8217;s list of active subscriptions. <code class="cCode">tpurcode()</code> may contain a number greater than 1 only when the wildcard handle, -1, is used. Also, <code class="cCode">tpurcode()</code> may contain a number greater than 0 even when <code class="cCode">tpunsubscribe()</code> completes unsuccessfully (that is, when the wildcard handle is used, the EventBroker may have successfully removed some subscriptions before it encountered an error deleting others). 
</p>
<p class="pBody"><a name="wp1233201"> </a>
Upon failure, <code class="cCode">tpunsubscribe()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1045987"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045988"> </a>
Upon failure, <code class="cCode">tpunsubscribe()</code> sets <code class="cCode">tperrno</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1045989"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1045990"> </a>
Invalid arguments were given (for example, <code class="cCodeEmphasis">subscription</code> is an invalid subscription handle).
</div>
<h4 class="pDefTerm"><a name="wp1045991"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1045992"> </a>
Cannot access the Oracle Tuxedo EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1045993"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1854392"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">tpunsubscribe()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1854393"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout cannot occur if <code class="cCode">TPNOBLOCK</code> and/or <code class="cCode">TPNOTIME</code> is specified.)
<a name="wp1854394"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">tpacall()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1854395"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1045995"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1045996"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1045997"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1045998"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1045999"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1046000"> </a>
<code class="cCode">tpunsubscribe()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1046001"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1046002"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1046003"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1046004"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1046005"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046006"> </a>
<a href="rf3c.html#wp1044210"><code class="cCode">tppost(3c)</code></a>, <a href="rf3c.html#wp1045667"><code class="cCode">tpsubscribe(3c)</code></a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">EVENT_MIB(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2186264"> </a>
tputrace(3c)
</h3>
<h4 class="pHeading3"><a name="wp2186265"> </a>
Name
</h4>
<p class="pBody"><a name="wp2186266"> </a>
<code class="cCode">tputrace()</code>&#8212;User-defined trace information application.
</p>
<h4 class="pHeading3"><a name="wp2186267"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp2186268"> </a>
<code class="cCode">#include &lt;atmi.h&gt;<br />int tputrace (char *trrec, int nest, char *category, char *funcname, int utrtype, va_list args)</code>
</p>
<h4 class="pHeading3"><a name="wp2186269"> </a>
Description
</h4>
<p class="pBody"><a name="wp2186270"> </a>
<code class="cCode">tputrace(3c)</code>is a <span style="font-style: italic">user-defined</span> API the allows flexibility in monitoring and obtaining detailed trace output information (such as full user data content that is passed to or returned from ATMI functions) and defines how and where this information is output. By default, <code class="cCode">tputrace()</code> outputs trace record information to <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a> if the user does not update or modify otherwise.
</p>
<p class="pBody"><a name="wp2186274"> </a>
<code class="cCode">tputrace(3c)</code> is called exclusively by specifying the <code class="cCode">utrace</code> receiver with <code class="cCode">TMTRACE</code>. For example: <code class="cCode">TMTRACE=atmi:utrace. </code>Specifying the <code class="cCode">utrace</code> receiver automatically invokes <code class="cCode">tputrace(3c)</code>and applies it only to atmi trace category records for output. For more <code class="cCode">TMTRACE</code> and <code class="cCode">utrace</code> receiver information, see <a href="../rf5/rf5.html">tmtrace(5)</a> in the <em class="cEmphasis">File Formats, Data Descriptions, MIBs, and System Processes Reference</em>.
</p>
<p class="pBody"><a name="wp2186350"> </a>
Valid <code class="cCode">tputrace(3c)</code> arguments are:
</p>
<h4 class="pDefTerm"><a name="wp2186351"> </a>
<code class="cCode">trrec</code>
</h4><div class="pDefPara"><a name="wp2186352"> </a>
Trace information record defined by user. <code class="cCode">ttrec</code> is <span style="font-style: italic">always</span> specified as the first argument in <code class="cCode">tputrace(3c)</code>. Outputting <code class="cCode">trrec</code> to the userlog, produces the same results as <a href="../rf5/rf5.html">tmtrace(5)</a>.
</div>
<h4 class="pDefTerm"><a name="wp2186353"> </a>
<code class="cCode">nest</code>
</h4><div class="pDefPara"><a name="wp2186354"> </a>
Defines the nesting level. Use this if indentations are added to the <code class="cCode">tputrace(3c)</code> output lines.
</div>
<h4 class="pDefTerm"><a name="wp2186355"> </a>
<code class="cCode">category</code>
</h4><div class="pDefPara"><a name="wp2186356"> </a>
Defines the ATMI function category, for example &quot;<code class="cCode">atmi</code>&quot;, &quot;<code class="cCode">iatmi</code>&quot; or &quot;<code class="cCode">xa</code>&quot;.
</div>
<h4 class="pDefTerm"><a name="wp2186357"> </a>
<code class="cCode">funcname</code>
</h4><div class="pDefPara"><a name="wp2186358"> </a>
Defines the function name. For example, &quot;<code class="cCode">tpcall</code>&quot; or &quot;<code class="cCode">tconnect</code>&quot;.
</div>
<h4 class="pDefTerm"><a name="wp2186359"> </a>
<code class="cCode">utrtype</code>
</h4><div class="pDefPara"><a name="wp2186360"> </a>
Indicates whether <code class="cCode">tputrace(3c)</code> is called when entering or leaving an ATMI function. Set values as follows: <code class="cCode">0</code> = entering, <code class="cCode">1</code> = leaving.
</div>
<h4 class="pDefTerm"><a name="wp2186361"> </a>
<code class="cCode">args</code>
</h4><div class="pDefPara"><a name="wp2202220"> </a>
Define arguments passed to the <code class="cCode">tputrace(3c)</code> output function. This includes user data or flags passed to ATMI functions. The list of the arguments for each ATMI functions are defined in the <code class="cCode">tputrace()</code> example implementation in the <a href="rf3c.html#wp2202234">Example(s)</a> section. The argument list is also available from <a href="../rf5/rf5.html">tmtrace(5)</a> trace information output.
</div>
<h4 class="pHeading3"><a name="wp2202228"> </a>
Libutrace Library
</h4>
<p class="pBody"><a name="wp2202365"> </a>
A separate Tuxedo library, <code class="cCode">libutrace</code>, is used in conjunction with <code class="cCode">tputrace()</code>. The default <code class="cCode">libutrace</code> is installed in the Tuxedo system shared library directory (<code class="cCode">$TUXDIR/lib</code> in UNIX and <code class="cCode">%TUXDIR%\bin</code> in Windows). 
</p>
<p class="pBody"><a name="wp2202882"> </a>
Users can also write their own their own custom <code class="cCode">libutrace</code> library and can install it in either:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2203073"> </a>the Tuxedo system shared library directory, or </li>
<li><a name="wp2202883"> </a>the Tuxedo application directory (<code class="cCode">$APPDIR</code> in UNIX and <code class="cCode">%APPDIR%</code> in Windows).</li>
</ul></div>
<p class="pBody"><a name="wp2202845"> </a>
If the custom <code class="cCode">libutrace</code> library is installed in the system directory, it replaces the default <code class="cCode">libutrace</code> and is used by all Tuxedo clients and servers on the machine. If the custom <code class="cCode">libutrace</code> library is installed in the application directory, it is used only by the clients and the servers in the application.
</p>
<p class="pBody"><a name="wp2202722"> </a>
Whenever <code class="cCode">tputrace()</code> is modified, the <code class="cCode">libutrace</code> library <span style="font-style: italic">must</span> be recompiled and linked to Tuxedo 9.0 or later. A sample <code class="cCode">tputrace()</code> source file is located in the <code class="cCode">$TUXDIR/samples/atmi/libutrace</code> directory.
</p>
<p class="pBody"><a name="wp2202709"> </a>
The <a href="rf3c.html#wp2202234">Example(s)</a> section further illustrates how to customize <code class="cCode">tputrace()</code>. 
</p>
<a name="wp2203129"> </a>
<table class="Note">
<tr>
<td valign="top"><strong>WARNING:</strong></td>
<td>The default or custom <code class="cCode">libutrace</code> library is loaded into <span style="font-style: italic">every</span> Tuxedo application process, including system servers such as BBL or WSL. This being the case, all Tuxedo system servers consume some amount of memory for loading <code class="cCode">libutrace</code>. The <span style="font-style: italic">default</span> <code class="cCode">libutrace</code> library is very small so memory consumption is negligible. But a <span style="font-style: italic">custom</span> libutrace can consume a larger amount of memory depending on how much functionality the user adds.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp2202234"> </a>
Example(s)
</h4>
<p class="pBody"><a name="wp2200535"> </a>
This is example shows the user-level trace information userlog output for the <code class="cCode">simpcl</code> execution of the Tuxedo <code class="cCode">simpapp</code> sample program.
</p>
<p class="pBody"><a name="wp2200536"> </a>
In order to customize user-level trace information and output, you must do the following:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp2200537"> </a>Modify <code class="cCode">tputrace()</code>.</li>
<li><a name="wp2200538"> </a>Re-compile the <code class="cCode">libutrace</code> library and link to Tuxedo.</li>
</ol></div>
<h4 class="pHeading3"><a name="wp2200333"> </a>
For this example, when <code class="cCode">TMTRACE=atmi:utrace </code>is specified it writes the contents of the user data and flags passed to the ATMI functions to the Tuxedo userlog.
</h4>
<div class="pCodeTitle"><a name="wp2200702"> </a>
Listing&#160;1	   Simpapp Sample User-Level Trace Information Userlog Output 
</div> <a name="wp2201925"> </a><div class="pPreformatted"><pre>091206.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpinit = 1<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpalloc(&quot;STRING&quot;, &quot;&quot;, 7)<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpalloc = 0x86a8e8<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpalloc(&quot;STRING&quot;, &quot;&quot;, 7)<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpalloc = 0x87fa20<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpcall(<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:      svc=&quot;TOUPPER&quot;<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:      idata=(0x86a8e8){<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:        len=0<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:        type=&quot;STRING&quot;<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:        value=&quot;abcdef&quot;<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:      }<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:      odata=(0x12ff48){<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:        data=(0x87fa20){<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:          len=0<br />091206.HOST1!?proc.1560.1520.0: UTRAC:at:          type=&quot;STRING&quot;<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:        }<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:        len=(0x12ff44)0<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:      }<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:      flags=&lt;none&gt;<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:    )<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:  { tpservice(<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:      svcinfo=(0x5e1518){<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        name=&quot;TOUPPER&quot;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        flags=&lt;none&gt;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        data=(0x602820){<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          len=7<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          type=&quot;STRING&quot;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          value=&quot;abcdef&quot;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        }<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        cd=0<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        appkey=0<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at: cltid=(0x5e154c){1095811926,0,12,0}<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:      }<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:    )<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:    { tpreturn(<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        rval=TPSUCCESS<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        rcode=0<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        data=(0x602820){<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          len=0<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          type=&quot;STRING&quot;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:          value=&quot;ABCDEF&quot;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        }<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:        flags=&lt;none&gt;<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:      )<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpcall(<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:      ret=0<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:      odata=(0x12ff48){<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:        data=(0x881690){<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:          len=7<br />|091207.HOST1!?proc.1560.1520.0: UTRAC:at:          type=&quot;STRING&quot;<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:          value=&quot;ABCDEF&quot;<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:        }<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:        len=(0x12ff44)7<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:    } tpreturn [long jump]<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:      }<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:    )<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpfree(0x86a8e8)<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpfree<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpfree(0x881690)<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpfree<br />091207.HOST1!simpserv.760.2188.0: UTRAC:at:  } tpservice<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  { tpterm()<br />091207.HOST1!?proc.1560.1520.0: UTRAC:at:  } tpterm = 1<br />091207.HOST1!?proc.1560.1520.-2: UTRAC:at:  { tpterm()<br />091207.HOST1!?proc.1560.1520.-2: UTRAC:at:  } tpterm = 1</pre></div><h4 class="pHeading3"><a name="wp2200486"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2200334"> </a>
<code class="cCode">tmutrace(3c)</code> returns <code class="cCode">0</code> when run successfully, and return <code class="cCode">-1</code> when a failure occurs.
</p>
<h4 class="pHeading3"><a name="wp2186371"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2199967"> </a>
Failure depends on the <code class="cCode">tputrace()</code> user-level implementation/customization. The default <code class="cCode">tputrace()</code> implementation included in Tuxedo 9.0 or later does not cause failure.
</p>
<h4 class="pHeading3"><a name="wp2186615"> </a>
See Also
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2186622"> </a><a href="../rf5/rf5.html">tmtrace(5)</a></li>
<li><a name="wp2186959"> </a><a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a></li>
<li><a name="wp2186625"> </a><span style="font-style: italic">Using the Run-time and User-level tracing utilities</span> in<span style="font-style: italic"> </span><span class="cHyperlink">
<a href="../ada/admon.html">Monitoring Your Oracle Tuxedo Application</a></span> in <em class="cEmphasis">Administering an Oracle Tuxedo Application at Run Time</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2009111"> </a>
tpxmltofml32(3c)
</h3>
<h4 class="pHeading3"><a name="wp2009112"> </a>
Name
</h4>
<p class="pBody"><a name="wp2009117"> </a>
<code class="cCode">tpxmltofml32()</code>&#8212;Converts XML data to FML32 buffers
</p>
<h4 class="pHeading3"><a name="wp2009158"> </a>
Synopsis
</h4>
<a name="wp2186964"> </a><div class="pPreformatted"><pre>#include &lt;fml32.h&gt;<br />int tpxmltofml32 (char *xmlbufp, char *vfile, FBFR32 **fml32bufp, char **rtag, long flags)</pre></div><h4 class="pHeading3"><a name="wp2009209"> </a>
Description
</h4>
<p class="pBody"><a name="wp2186971"> </a>
This function is used to convert XML buffers to FML32 buffers. It supports the following valid arguments:
</p>
<h4 class="pDefTerm"><a name="wp2186972"> </a>
<code class="cCode">xmlbufp</code>
</h4><div class="pDefPara"><a name="wp2186973"> </a>
This argument is a pointer to valid XML typed buffer input. 
</div>
<h4 class="pDefTerm"><a name="wp2186974"> </a>
<code class="cCode">vfile</code>
</h4><div class="pDefPara"><a name="wp2186975"> </a>
The argument is the fully qualified path name of an XML Schema file used to validate XML input. To use this argument, you must set the <code class="cCode">TPXPARSNSPACE</code> and <code class="cCode">TPXPARSDOSCHE</code> flags and <span style="font-style: italic">not </span>set the <code class="cCode">TPXPARSNEVER</code> flag.
</div>
<h4 class="pDefTerm"><a name="wp2186976"> </a>
<code class="cCode">fml32bufp</code>
</h4><div class="pDefPara"><a name="wp2186977"> </a>
This argument is a pointer to an output FML32 typed buffer created from the input XML. 
</div>
<h4 class="pDefTerm"><a name="wp2194781"> </a>
<code class="cCode">rtag</code> 
</h4><div class="pDefPara"><a name="wp2194782"> </a>
This argument is a pointer that stores the root element name from the input XML document.
</div>
<h4 class="pDefTerm"><a name="wp2186980"> </a>
<code class="cCode">flags</code>
</h4><div class="pDefPara"><a name="wp2186981"> </a>
This argument is used in XML to FML/FML32 conversion to map to a Tuxedo 9.x subset of Xerces parser classes (see, <span class="cHyperlink">
<a href="../xmlparser/html/apiDocs/index.html">XercesParser 2.5 documentation</a></span>). The following is a list of Tuxedo 9.x valid Xerces parser <code class="cCode">flags</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194786"> </a>
<code class="cCode">TPXPARSNEVER</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194787"> </a>
Sets <code class="cCode">setValidationScheme</code> to <code class="cCode">Val_Never</code>. The parser will not report Schema validation errors.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194788"> </a>
<code class="cCode">TPXPARSALWAYS</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194789"> </a>
Sets <code class="cCode">setValidationScheme</code> to <code class="cCode">Val_Always</code>. The parser will always report Schema validation errors.
</div><a name="wp2194790"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">TPXPARSNEVER</code> takes precedent over <code class="cCode">TPXPARSALWAYS</code> if both arguments are used at the same time. </td>
</tr>
</table>

<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194791"> </a>
<code class="cCode">TPXPARSSCHFULL</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194792"> </a>
Sets <code class="cCode">setValidationSchemaFullChecking</code> to true. This flag allows the user to turn full Schema constraint checking on/off. Only takes effect if Schema validation is enabled. If turned off, partial constraint checking is done. Full schema constraint checking includes those checking that may be time-consuming or memory intensive. Currently, particle unique attribution constraint checking and particle derivation restriction checking are controlled by this option.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194793"> </a>
<code class="cCode">TPXPARSCONFATAL</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194794"> </a>
Sets <code class="cCode">setValidationConstraintFatal</code> to true. This flag allows users to set the parser&#8217;s behavior when it encounters a validation constraint error. If set to true, and the parser will treat validation error as fatal and will exit depends on the state of <code class="cCode">getExitOnFirstFatalError</code>. If false, then it will report the error and continue processing.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194800"> </a>
<code class="cCode">TPXPARSNSPACE</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194801"> </a>
Sets <code class="cCode">setDoNamespaces</code> to true. This flag allows users to enable or disable the parser&#8217;s namespace processing. When set to true, parser starts enforcing all the constraints and rules specified by the <code class="cCode">NameSpace</code> specification.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194802"> </a>
<code class="cCode">TPXPARSDOSCH</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194803"> </a>
Sets <code class="cCode">setDoSchema</code> to true. This flag allows users to enable or disable the parser&#8217;s schema processing. When set to false, parser will not process any schema found.
</div><a name="wp2194804"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If set to true, namespace processing must also be turned on.</td>
</tr>
</table>

<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194805"> </a>
<code class="cCode">TPXPARSEREFN</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194806"> </a>
Sets <code class="cCode">setCreateEntityReferencNodes</code><span style="font-style: normal"> to false. This flag allows the user to specify whether the parser should create entity reference nodes in the DOM tree being produced. When the </span><span style="font-style: italic">create</span><span style="font-style: normal"> flag is true, the parser will create EntityReference nodes in the DOM tree. The EntityReference nodes and their child nodes will be read-only. When the </span><span style="font-style: italic">create</span> flag is false, no EntityReference nodes will be created.The replacement text of the entity is included in either case, either as a child of the Entity Reference node or in place at the location of the reference.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194807"> </a>
<code class="cCode">TPXPARSNOEXIT</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194808"> </a>
Sets <code class="cCode">setExitOnFirstFatalError</code> to false. This flag allows users to set the parser&#8217;s behavior when it encounters the first fatal error. If set to true, the parser will exit at the first fatal error. If false, then it will report the error and continue processing.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194809"> </a>
<code class="cCode">TPXPARSNOINCWS</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194810"> </a>
Sets <code class="cCode">setIncludeIgnorableWhitespace</code> to false. This flag allows the user to specify whether a validating parser should include ignorable whitespaces as text nodes. It has no effect on non-validating parsers which always include non-markup text.
</div><div class="pDefPara2"><a name="wp2194811"> </a>
When set to false, all ignorable whitespace will be discarded and no text node is added to the DOM tree. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194812"> </a>
<code class="cCode">TPXPARSCACHESET</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194813"> </a>
Sets <code class="cCode">setcacheGrammarFromParse</code><span style="font-style: normal"> to true. This flag allows users to enable or disable caching of grammar when parsing XML documents. When set to true, the parser will cache the resulting grammar for use in subsequent parses. If the flag is set to true, the </span><span style="font-style: italic">Use cached grammar </span>flag will also be set to true.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194814"> </a>
<code class="cCode">TPXPARSCACHERESET</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194815"> </a>
Resets <code class="cCode">resetCachedGrammarPool</code>. Resets the documents vector pool and release all the associated memory back to the system.
</div><div class="pDefPara2"><a name="wp2194816"> </a>
When parsing a document using a DOM parser, all memory allocated for a DOM tree is associated to the DOM document.
</div><div class="pDefPara2"><a name="wp2194824"> </a>
If you do multiple parse using the same DOM parser instance, then multiple DOM documents will be generated and saved in a vector pool. All these documents (and thus all the allocated memory) won&#39;t be deleted until the parser instance is destroyed.
</div><div class="pDefPara2"><a name="wp2194825"> </a>
If you do not need these DOM documents anymore and do not want to destroy the DOM parser instance at this moment, then you can call this method to reset the document vector pool and release all the allocated memory back to the system. It is an error to call this method if you are in the middle of a parse (for example, a mid progressive parse).
</div><h4 class="pHeading3"><a name="wp2194826"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2194827"> </a>
Upon success, <code class="cCode">tpxmltofml32 ()</code> returns <code class="cCode">0</code>. This function returns <code class="cCode">-1</code> on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2194916"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2194917"> </a>
The function may fail for the following reasons:
</p>
<h4 class="pDefTerm"><a name="wp2194918"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp2223076"> </a>
Either <code class="cCode">fml32bufp</code> or <code class="cCode">xmlbufp</code> is not a valid typed buffer, or parser has problems understanding the input.
</div>
<h4 class="pDefTerm"><a name="wp2194920"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2194921"> </a>
A Tuxedo system error has occurred. The exact nature of the error is written to <code class="cCode">userlog(3)</code>. This will also indicate when a conversion to FML32 was unable to be done. In that instance error detail info will be added to the userlog.
</div>
<h4 class="pDefTerm"><a name="wp2194922"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp2194923"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in Uunixerr.
</div>
<h4 class="pHeading3"><a name="wp2187102"> </a>
SEE ALSO
</h4>
<p class="pBody"><a name="wp2187103"> </a>
<a href="rf3c.html#wp1987733"><code class="cCode">tpfml32toxml(3c)</code></a><code class="cCode">, </code><a href="rf3c.html#wp2011500"><code class="cCode">tpxmltofml(3c)</code></a><code class="cCode">,</code><a href="rf3c.html#wp2178284"><code class="cCode">tpfmltoxml(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2011500"> </a>
tpxmltofml(3c)
</h3>
<h4 class="pHeading3"><a name="wp2011501"> </a>
Name
</h4>
<p class="pBody"><a name="wp2011502"> </a>
<code class="cCode">tpxmltofml()</code>&#8212;Converts XML data to FML buffers
</p>
<h4 class="pHeading3"><a name="wp2011503"> </a>
Synopsis
</h4>
<a name="wp2194976"> </a><div class="pPreformatted"><pre>#include &lt;fml.h&gt;<br />int tpxmltofml (char *xmlbufp, char *vfile, FBFR **fmlbufp, char **rtag, long flags)</pre></div><h4 class="pHeading3"><a name="wp2011835"> </a>
Description
</h4>
<p class="pBody"><a name="wp2194986"> </a>
This function is used to convert XML data to FML buffers. It supports the following valid arguments:
</p>
<h4 class="pDefTerm"><a name="wp2194987"> </a>
<code class="cCode">xmlbufp</code>
</h4><div class="pDefPara"><a name="wp2194988"> </a>
This argument is a pointer to valid XML typed buffer input. 
</div>
<h4 class="pDefTerm"><a name="wp2194989"> </a>
<code class="cCode">vfile</code>
</h4><div class="pDefPara"><a name="wp2194990"> </a>
The argument is the fully qualified path name of an XML Schema file used to validate XML input. To use this argument, you must set the <code class="cCode">TPXPARSNSPACE</code> and <code class="cCode">TPXPARSDOSCHE</code> flags and <span style="font-style: italic">not </span>set the <code class="cCode">TPXPARSNEVER</code> flag.
</div>
<h4 class="pDefTerm"><a name="wp2194991"> </a>
<code class="cCode">fmlbufp</code>
</h4><div class="pDefPara"><a name="wp2194992"> </a>
This argument is a pointer to an output FML typed buffer created from the input XML. 
</div>
<h4 class="pDefTerm"><a name="wp2194993"> </a>
<code class="cCode">rtag</code> 
</h4><div class="pDefPara"><a name="wp2194994"> </a>
This argument is a pointer that stores the root element name from the input XML document.
</div>
<h4 class="pDefTerm"><a name="wp2187226"> </a>
<code class="cCode">flags</code>
</h4><div class="pDefPara"><a name="wp2187227"> </a>
This argument is used in XML to FML/FM32L conversion to map to a Tuxedo 9.x subset of Xerces parser classes (see, <span class="cHyperlink">
<a href="../xmlparser/html/apiDocs/index.html">XercesParser 2.5 documentation</a></span>). The following is a list of Tuxedo 9.x valid Xerces parser <code class="cCode">flags</code>:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2194998"> </a>
<code class="cCode">TPXPARSNEVER</code>
</h4></div>
<div class="pDefPara2"><a name="wp2194999"> </a>
Sets <code class="cCode">setValidationScheme</code> to <code class="cCode">Val_Never</code>. The parser will not report Schema validation errors.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195000"> </a>
<code class="cCode">TPXPARSALWAYS</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195001"> </a>
Sets <code class="cCode">setValidationScheme</code> to <code class="cCode">Val_Always</code>. The parser will always report Schema validation errors.
</div><a name="wp2195002"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">TPXPARSNEVER</code> takes precedent over <code class="cCode">TPXPARSALWAYS</code> if both arguments are used at the same time. </td>
</tr>
</table>

<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195003"> </a>
<code class="cCode">TPXPARSSCHFULL</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195008"> </a>
Sets <code class="cCode">setValidationSchemaFullChecking</code> to true. This flag allows the user to turn full Schema constraint checking on/off. Only takes effect if Schema validation is enabled. If turned off, partial constraint checking is done. Full schema constraint checking includes those checking that may be time-consuming or memory intensive. Currently, particle unique attribution constraint checking and particle derivation restriction checking are controlled by this option.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195009"> </a>
<code class="cCode">TPXPARSCONFATAL</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195010"> </a>
Sets <code class="cCode">setValidationConstraintFatal</code> to true. This flag allows users to set the parser&#8217;s behavior when it encounters a validation constraint error. If set to true, and the parser will treat validation error as fatal and will exit depends on the state of <code class="cCode">getExitOnFirstFatalError</code>. If false, then it will report the error and continue processing.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195011"> </a>
<code class="cCode">TPXPARSNSPACE</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195012"> </a>
Sets <code class="cCode">setDoNamespaces</code> to true. This flag allows users to enable or disable the parser&#8217;s namespace processing. When set to true, parser starts enforcing all the constraints and rules specified by the <code class="cCode">NameSpace</code> specification.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195013"> </a>
<code class="cCode">TPXPARSDOSCH</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195014"> </a>
Sets <code class="cCode">setDoSchema</code> to true. This flag allows users to enable or disable the parser&#8217;s schema processing. When set to false, parser will not process any schema found.
</div><a name="wp2195015"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If set to true, namespace processing must also be turned on.</td>
</tr>
</table>

<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195016"> </a>
<code class="cCode">TPXPARSEREFN</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195017"> </a>
Sets <code class="cCode">setCreateEntityReferencNodes</code><span style="font-style: normal"> to false. This flag allows the user to specify whether the parser should create entity reference nodes in the DOM tree being produced. When the </span><span style="font-style: italic">create</span><span style="font-style: normal"> flag is true, the parser will create EntityReference nodes in the DOM tree. The EntityReference nodes and their child nodes will be read-only. When the </span><span style="font-style: italic">create</span> flag is false, no EntityReference nodes will be created.The replacement text of the entity is included in either case, either as a child of the Entity Reference node or in place at the location of the reference.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195018"> </a>
<code class="cCode">TPXPARSNOEXIT</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195019"> </a>
Sets <code class="cCode">setExitOnFirstFatalError</code> to false. This flag allows users to set the parser&#8217;s behavior when it encounters the first fatal error. If set to true, the parser will exit at the first fatal error. If false, then it will report the error and continue processing.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195020"> </a>
<code class="cCode">TPXPARSNOINCWS</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195021"> </a>
Sets <code class="cCode">setIncludeIgnorableWhitespace</code> to false. This flag allows the user to specify whether a validating parser should include ignorable whitespaces as text nodes. It has no effect on non-validating parsers which always include non-markup text.
</div><div class="pDefPara2"><a name="wp2195022"> </a>
When set to false, all ignorable whitespace will be discarded and no text node is added to the DOM tree. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195026"> </a>
<code class="cCode">TPXPARSCACHESET</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195027"> </a>
Sets <code class="cCode">setcacheGrammarFromParse</code><span style="font-style: normal"> to true. This flag allows users to enable or disable caching of grammar when parsing XML documents. When set to true, the parser will cache the resulting grammar for use in subsequent parses. If the flag is set to true, the </span><span style="font-style: italic">Use cached grammar </span>flag will also be set to true.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp2195028"> </a>
<code class="cCode">TPXPARSCACHERESET</code>
</h4></div>
<div class="pDefPara2"><a name="wp2195029"> </a>
Resets <code class="cCode">resetCachedGrammarPool</code>. Resets the documents vector pool and release all the associated memory back to the system.
</div><div class="pDefPara2"><a name="wp2195030"> </a>
When parsing a document using a DOM parser, all memory allocated for a DOM tree is associated to the DOM document.
</div><div class="pDefPara2"><a name="wp2195031"> </a>
If you do multiple parse using the same DOM parser instance, then multiple DOM documents will be generated and saved in a vector pool. All these documents (and thus all the allocated memory) won&#39;t be deleted until the parser instance is destroyed.
</div><div class="pDefPara2"><a name="wp2195032"> </a>
If you do not need these DOM documents anymore and do not want to destroy the DOM parser instance at this moment, then you can call this method to reset the document vector pool and release all the allocated memory back to the system. It is an error to call this method if you are in the middle of a parse (for example, a mid progressive parse).
</div><h4 class="pHeading3"><a name="wp2187350"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp2187351"> </a>
Upon success, <code class="cCode">tpxmltofml ()</code> returns a 0. This function returns -1 on error and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp2187441"> </a>
Errors
</h4>
<p class="pBody"><a name="wp2195916"> </a>
The function may fail for the following reasons. 
</p>
<h4 class="pDefTerm"><a name="wp2195917"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp2195918"> </a>
Either <code class="cCode">fml32bufp</code> or <code class="cCode">xmlbufp</code> is not a valid typed buffer, or parser has problems understanding the input.
</div>
<h4 class="pDefTerm"><a name="wp2195919"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp2195920"> </a>
A Tuxedo system error has occurred. The exact nature of the error is written to <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>. This will also indicate when a conversion to FML was unable to be done. In that instance error detail info will be added to the userlog.
</div>
<h4 class="pDefTerm"><a name="wp2195921"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp2195922"> </a>
An operating system error has occurred. A numeric value representing the system call that failed is available in Uunixerr.
</div>
<h4 class="pHeading3"><a name="wp2187449"> </a>
SEE ALSO
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2187452"> </a><a href="rf3c.html#wp2009111"><code class="cCode">tpxmltofml32(3c)</code></a>, <a href="rf3c.html#wp1987733"><code class="cCode">tpfml32toxml(3c)</code></a>, <a href="rf3c.html#wp2178284"><code class="cCode">tpfmltoxml(3c)</code></a></li>
<li><a name="wp2188417"> </a><span class="cHyperlink">
<a href="../pgc/pgbuf.html">Converting XML Data To and From FML/FML32 Buffers</a></span> in <em class="cEmphasis">Programming Oracle Tuxedo ATMI Applications Using C</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2154415"> </a>
TRY(3c)
</h3>
<h4 class="pHeading3"><a name="wp2011140"> </a>
Name
</h4>
<p class="pBody"><a name="wp1036019"> </a>
<code class="cCode">TRY()</code>&#8212;Exception-returning interface.
</p>
<h4 class="pHeading3"><a name="wp1036020"> </a>
Synopsis
</h4>
<a name="wp1036021"> </a><div class="pPreformatted"><pre><code class="cCode">#include &lt;texc.h&gt;<br /> <br />TRY<br /></code><code class="cCodeEmphasis">try_block</code><code class="cCode"> <br />[  CATCH(</code><code class="cCodeEmphasis">exception_name</code><code class="cCode">) </code><code class="cCodeEmphasis">handler_block</code><code class="cCode">] ...  <br />[CATCH_ALL </code><code class="cCodeEmphasis">handler_block</code><code class="cCode">] <br />ENDTRY  <br /> <br />TRY <br /></code><code class="cCodeEmphasis">try_block</code><code class="cCode"> <br />FINALLY <br /></code><code class="cCodeEmphasis">finally_block</code><code class="cCode"> <br />ENDTRY  <br /> <br />RAISE(</code><code class="cCodeEmphasis">exception_name</code><code class="cCode">)  <br />RERAISE  <br /> <br />/* declare exception */ <br />EXCEPTION </code><code class="cCodeEmphasis">exception_name</code><code class="cCode">;  <br /> <br />/* initialize address (application) exception */<br />EXCEPTION_INIT(EXCEPTION </code><code class="cCodeEmphasis">exception_name</code><code class="cCode">)  <br /> <br />/* intialize status exception (map status to exception */ <br />exc_set_status(EXCEPTION *</code><code class="cCodeEmphasis">exception_name</code><code class="cCode">, long </code><code class="cCodeEmphasis">status</code><code class="cCode">)  <br /> <br />/* map status exception to status */ <br />exc_get_status(EXCEPTION *</code><code class="cCodeEmphasis">exception_name</code><code class="cCode">, long *</code><code class="cCodeEmphasis">status</code><code class="cCode">)  <br /> <br />/* compare exceptions */ <br />exc_matches(EXCEPTION *</code><code class="cCodeEmphasis">e1</code><code class="cCode">, EXCEPTION *</code><code class="cCodeEmphasis">e2</code><code class="cCode">)  <br /> <br />/* print error to stderr */ <br />void exc_report(EXCEPTION *</code><code class="cCodeEmphasis">exception</code><code class="cCode">)</code></pre></div><h4 class="pHeading3"><a name="wp1036022"> </a>
Description
</h4>
<p class="pBody"><a name="wp1036023"> </a>
The <code class="cCode">TRY</code>/<code class="cCode">CATCH</code> interface provides a mechanism to handle exceptions without the use of status variables (for example, <code class="cCodeEmphasis">errno</code> or status variables passed back from an RPC operation). These macros are defined in <code class="cCode">texc.h</code>.
</p>
<p class="pBody"><a name="wp1036024"> </a>
The <code class="cCode">TRY</code> <code class="cCodeEmphasis">try_block</code> is a block of C or C++ declarations and statements in which an exception may be raised (code that is not associated with raising an exception should be placed before or after the <code class="cCodeEmphasis">try_block</code>). Each <code class="cCode">TRY</code>/<code class="cCode">ENDTRY</code> pair constitutes a &#8220;scope,&#8221; with respect to exceptions (not unlike C scoping), or a region of code over which exceptions are caught. These scopes can be properly nested. When an exception is raised, an error is reported to the application by searching the active scopes for actions written to handle (&#8220;absorb&#8221;) an exception (<code class="cCode">CATCH</code> or <code class="cCode">CATCH_ALL</code> clauses) or complete the scopes (<code class="cCode">FINALLY</code> clauses). If a scope does not handle an exception, the scope is torn down with the exception raised at the next higher level (unwinding the stack of exception scopes). Execution resumes at the point after which the exception is handled; there is no provision for resuming execution at the point of error. If the exception is not handled by any scope, the program is terminated (a message is written to the log via <a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a> and <code class="cCode">abort</code>(3) is called).
</p>
<p class="pBody"><a name="wp1036025"> </a>
Zero or more occurrences of <code class="cCode">CATCH</code> (<code class="cCodeEmphasis">exception_name</code>) <code class="cCodeEmphasis">handler_block</code> may be provided. Each <code class="cCodeEmphasis">handler_block</code> is a block of C or C++ declarations and statements in which the associated exception (<code class="cCodeEmphasis">exception_name</code>) is processed (normally, actions are specified for recovery from the failure). If an exception is raised by a statement in <code class="cCodeEmphasis">try_block</code>, then the first <code class="cCode">CATCH</code> clause that matches the exception is executed.
</p>
<p class="pBody"><a name="wp1036026"> </a>
Within a <code class="cCode">CATCH</code> or <code class="cCode">CATCH_ALL</code> <code class="cCodeEmphasis">handler_block</code>, the current exception can be referenced by the <code class="cCode">EXCEPTION</code> pointer <code class="cCode">THIS_CATCH</code> (for example, for logic based on or printing the exception value).
</p>
<p class="pBody"><a name="wp1036027"> </a>
If the exception is not handled by one of the <code class="cCode">CATCH</code> clauses, then the <code class="cCode">CATCH_ALL</code> clause is executed. By default, no further action is taken for an exception that is handled by a <code class="cCode">CATCH</code> or <code class="cCode">CATCH_ALL</code> clause. If no <code class="cCode">CATCH_ALL</code> clause exists, then the exception is raised at the <code class="cCodeEmphasis">try_block</code> at the next higher level, assuming that the <code class="cCodeEmphasis">try_block</code> is nested within another <code class="cCodeEmphasis">try_block</code>. If an ANSI C compiler is used, register and automatic variables that are used in the handler blocks should be declared with the <code class="cCode">volatile</code> attribute (as is true of any blocks that use <code class="cCode">setjmp/longjmp</code>). Also note that output parameters and return values from the functions that can generate an exception are indeterminate.
</p>
<p class="pBody"><a name="wp1036028"> </a>
Within a <code class="cCode">CATCH</code> or <code class="cCode">CATCH_ALL</code> <code class="cCodeEmphasis">handler_block</code>, the current exception can be propagated to the next higher level (the exception is &#8220;reraised&#8221;) using the <code class="cCode">RERAISE</code> statement. The <code class="cCode">RERAISE</code> statement must appear lexically within the scope of a <code class="cCodeEmphasis">handler_block</code> (that is, not within a function called by the <code class="cCodeEmphasis">handler_block</code>). Any exception that is caught but not fully handled should be reraised. In many cases, a <code class="cCode">CATCH_ALL</code> handler should reraise the exception because the handler is not written to handle every exception. The application should also be written such that an exception is raised to the proper scope such that the handler blocks take the appropriate actions and modify the appropriate state (for example, if an exception occurs while opening a file, the handler function for that level should not try to close the unopened file).
</p>
<p class="pBody"><a name="wp1036029"> </a>
An exception can be raised from anywhere by using the <code class="cCode">RAISE</code>(<code class="cCodeEmphasis">exception_name</code>) statement. This statement causes the exception to start propagating at the current <code class="cCodeEmphasis">try_block</code> and will be reraised until it is handled.
</p>
<p class="pBody"><a name="wp1116604"> </a>
The <code class="cCode">FINALLY</code> clause can be used to specify an epilogue block of code that is executed after the <code class="cCodeEmphasis">try_block</code>, whether or not an exception is raised. If an exception is raised in the <code class="cCodeEmphasis">try_block</code>, it is reraised after the <code class="cCodeEmphasis">finally_block</code> is executed. This clause can be used to avoid replicating epilogue code twice, once in a <code class="cCode">CATCH_ALL</code> clause, and again after the <code class="cCode">ENDTRY</code>. It is normally used to execute cleanup activities, restoring invariants (for example, shared data, locks) as the scopes are unwound, whether or not exceptions are raised (that is, on both normal and abnormal exits from the block). Note (in the &#8220;Synopsis&#8221; section) that a <code class="cCode">FINALLY</code> clause cannot be used with a <code class="cCode">CATCH</code> or <code class="cCode">CATCH_ALL</code> clause for the same <code class="cCodeEmphasis">try_block</code>; use nested <code class="cCodeEmphasis">try_block</code>s.
</p>
<p class="pBody"><a name="wp1036031"> </a>
The <code class="cCode">ENDTRY</code> statement must be used to complete the <code class="cCode">TRY</code> block, since it contains code that must be executed to make sure that exceptions are handled and the context is cleaned up. A <code class="cCodeEmphasis">try_block</code>, <code class="cCodeEmphasis">handler_block</code>, or <code class="cCodeEmphasis">finally_block</code> must not contain a <code class="cCode">return</code>, non-local jump, or any other means of leaving the block such that the <code class="cCode">ENDTRY</code> is not reached (for example, <code class="cCode">goto()</code>, <code class="cCode">break()</code>, <code class="cCode">continue()</code>, <code class="cCode">longjmp()</code>).
</p>
<p class="pBody"><a name="wp1036032"> </a>
This interface is provided to handle exceptions from RPC operations. However, this is a generic interface that can be used for any application. An exception is declared to be of type <code class="cCode">EXCEPTION</code>. (This is a complex data type; do not try to use it like a long integer.) There are two types of exceptions. They are declared in the same manner but initialized differently.
</p>
<p class="pBody"><a name="wp1036034"> </a>
One type of exception is used to define application exceptions. It is initialized by calling the <code class="cCode">EXCEPTION_INIT()</code> macro. The address of the exception is stored as the value within the <code class="cCodeEmphasis">address</code> exception. Note that this value is valid only within a single address space and will change if the exception is an automatic variable. For this reason, an <code class="cCodeEmphasis">address</code> exception should be declared as a static or external variable, not an automatic or register variable. The <code class="cCode">exc_get_status()</code> macro will evaluate to -1 for an <code class="cCodeEmphasis">address</code> exception. Using the <code class="cCode">exc_set_status()</code> macro on this exception will make it a <code class="cCodeEmphasis">status</code> exception.
</p>
<p class="pBody"><a name="wp1036035"> </a>
The <code class="cCode">exc_matches</code> macro can be used to compare two exceptions. To compare equal, the exceptions must both be the same type and have the same value (for example, the same status value for <code class="cCodeEmphasis">status</code> exceptions, or the same addresses for <code class="cCodeEmphasis">address</code> exceptions). This comparison is used for the <code class="cCode">CATCH</code> clause, described above.
</p>
<p class="pBody"><a name="wp1036036"> </a>
When status exceptions are raised, a common part of handling the exception might be to print out the status value, or better yet, a string indicating what status value occurred. If the string is to be printed to the standard error output, then the function <code class="cCode">exc_report()</code> can be called with a pointer to the <code class="cCodeEmphasis">status</code> exception to print the string in one operation. 
</p>
<a name="wp1036037"> </a><div class="pPreformatted"><pre>CATCH_ALL <br />{<br /> exc_report(THIS_CATCH);<br />}<br />ENDTRY </pre></div><p class="pBody"><a name="wp1036038"> </a>
If something else is to be done with the string (for example, printing the error to the user log), <code class="cCode">exc_get_status()</code> can be used on <code class="cCode">THIS_CATCH</code> to get the status value (remember that <code class="cCode">THIS_CATCH</code> is already a pointer to an <code class="cCode">EXCEPTION</code>, not an <code class="cCode">EXCEPTION</code>), and <code class="cCode">dce_error_inq_text()</code> can be used to get the string value associated with the status value.
</p>
<a name="wp1036039"> </a><div class="pPreformatted"><pre><code class="cCode">CATCH_ALL <br />{<br />  unsigned long status_to_convert;  <br />  unsigned char error_text[200];<br />  int status;  <br /> <br />  exc_get_status(THIS_CATCH,status_to_convert); <br />  dce_error_inq_text(status_to_convert, error_text, status); <br />  userlog(&#8220;%s&#8221;, (char *)error_text);  <br />}<br />ENDTRY</code></pre></div><a name="wp1618175"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>A thread in a multithreaded application may invoke the <code class="cCode">TRY</code>/<code class="cCode">CATCH</code> interface while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1036040"> </a>
When to Use Exception and Status Returns
</h4>
<p class="pBody"><a name="wp1036041"> </a>
The status of RPC operations can be determined portably by defining status variables for each operation ([<code class="cCode">comm_status</code>] and [<code class="cCode">fault_status</code>] parameters are defined via the Attribute Configuration File). The status-returning interface is the only interface provided in the X/OPEN RPC specification. The <code class="cCode">fault_status</code> attribute indicates that errors occurring on the server due to incorrectly specified parameter values, resource constraints, or coding errors be reported by an additional status argument or return value. Similarly, the <code class="cCode">comm_status</code> attribute indicates that RPC communications failures be reported by an additional status argument or return value. Using status values works well for fine-grained error handling (on a per-call basis) with recovery specified for each possible error on each call, and where it is necessary to retry from the point of failure. The disadvantage is that it is not transparent whether or not the call is local or remote. The remote call has additional status parameters, or a status return value instead of being a void return. Thus, the application must have procedure declarations adjusted between local and distributed code.
</p>
<p class="pBody"><a name="wp1036042"> </a>
For application portability from an OSF/DCE environment, the <code class="cCode">TRY</code>/<code class="cCode">CATCH</code> exception-returning interface is also provided. This interface may not be provided in all environments. However, it has the advantage that procedure declarations need not be adjusted between local and distributed code, maintaining existing interfaces. The checking for errors can be simplified such that each procedure call does not have specific failure checking or recovery code. If an error is not handled at some level, then the program exits with a system error message such that the error is detected and can be corrected (omissions become more obvious). Exceptions work better for coarse-grained exception handling.
</p>
<h4 class="pHeading3"><a name="wp1036043"> </a>
Built-in Exceptions
</h4>
<p class="pBody"><a name="wp1036044"> </a>
The exceptions shown in <a href="rf3c.html#wp1036047">Table&#160;13</a> are &#8220;built-in&#8221; to the use of this exception interface. The first <code class="cCode">TRY</code> clause sets up a signal handler to catch the signals list below if they are not currently ignored or caught; the other exceptions are defined only for DCE program portability.
</p>
<p class="pGraphic"><a name="wp1036198"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1036047table1036045"><caption><a name="wp1036047"> </a>
Table&#160;13  Built-in Exceptions&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1036051"> </a>
Exception
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1036053"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036055"> </a>
<code class="cCode">exc_e_SIGBUS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036057"> </a>
An unhandled <code class="cCode">SIGBUS</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036059"> </a>
<code class="cCode">exc_e_SIGEMT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036061"> </a>
An unhandled <code class="cCode">SIGEMT</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036063"> </a>
<code class="cCode">exc_e_SIGFPE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036065"> </a>
An unhandled <code class="cCode">SIGFPE</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036067"> </a>
<code class="cCode">exc_e_SIGILL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036069"> </a>
An unhandled <code class="cCode">SIGILL</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036071"> </a>
<code class="cCode">exc_e_SIGIOT</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036073"> </a>
An unhandled <code class="cCode">SIGIOT</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036075"> </a>
<code class="cCode">exc_e_SIGPIPE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036077"> </a>
An unhandled <code class="cCode">SIGPIPE</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036079"> </a>
<code class="cCode">exc_e_SIGSEGV</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036081"> </a>
An unhandled <code class="cCode">SIGSEGV</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036083"> </a>
<code class="cCode">exc_e_SIGSYS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036085"> </a>
An unhandled <code class="cCode">SIGSYS</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036087"> </a>
<code class="cCode">exc_e_SIGTRAP</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036089"> </a>
An unhandled <code class="cCode">SIGTRAP</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036091"> </a>
<code class="cCode">exc_e_SIGXCPU</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036093"> </a>
An unhandled <code class="cCode">SIGXCPU</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036095"> </a>
<code class="cCode">exc_e_SIGXFSZ</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036097"> </a>
An unhandled <code class="cCode">SIGXFSZ</code> signal occurred.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036099"> </a>
<code class="cCode">pthread_e_badparam</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036103"> </a>
<code class="cCode">pthread_e_defer_q_full</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036107"> </a>
<code class="cCode">pthread_e_existence</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036111"> </a>
<code class="cCode">pthread_e_in_use</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036115"> </a>
<code class="cCode">pthread_e_nostackmem</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036119"> </a>
<code class="cCode">pthread_e_nostack</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036123"> </a>
<code class="cCode">pthread_e_signal_q_full</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036127"> </a>
<code class="cCode">pthread_e_stackovf</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036131"> </a>
<code class="cCode">pthread_e_unimp</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036135"> </a>
<code class="cCode">pthread_e_use_error</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036139"> </a>
<code class="cCode">exc_e_decovf</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036143"> </a>
<code class="cCode">exc_e_exquota</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036147"> </a>
<code class="cCode">exc_e_fltdiv</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036151"> </a>
<code class="cCode">exc_e_fltovf</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036155"> </a>
<code class="cCode">exc_e_fltund</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036159"> </a>
<code class="cCode">exc_e_illaddr</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036163"> </a>
<code class="cCode">exc_e_insfmem</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036167"> </a>
<code class="cCode">exc_e_intdiv</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036171"> </a>
<code class="cCode">exc_e_intovf</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036175"> </a>
<code class="cCode">exc_e_nopriv</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036179"> </a>
<code class="cCode">exc_e_privinst</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036183"> </a>
<code class="cCode">exc_e_resaddr</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036187"> </a>
<code class="cCode">exc_e_resoper</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036191"> </a>
<code class="cCode">exc_e_subrng</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1036195"> </a>
<code class="cCode">exc_e_uninitexc</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1036199"> </a>
These same exception codes are also defined with the &#8220;<code class="cCode">_e</code>&#8221; at the end of the name (for example, <code class="cCode">exc_e_SIGBUS</code> is also defined as <code class="cCode">exc_SIGBUS_e</code>). Equivalent status codes are defined with similar names but the &#8220;<code class="cCode">_e_</code>&#8221; is changed to &#8220;<code class="cCode">_s_</code>&#8221; (for example, <code class="cCode">exc_e_SIGBUS</code> is equivalent to the <code class="cCode">exc_s_SIGBUS</code> status code).
</p>
<h4 class="pHeading3"><a name="wp1036200"> </a>
Caveats
</h4>
<p class="pBody"><a name="wp1036201"> </a>
In OSF/DCE, the header file is named <code class="cCode">exc_handling.h</code>; the Oracle Tuxedo ATMI system header file is <code class="cCode">texc.h</code>. It is not possible for the same source file to use both DCE and Oracle Tuxedo ATMI system exception handling. Further, within a program, the handling of signal exceptions can only be done by either DCE or the Oracle Tuxedo ATMI system, not both.
</p>
<h4 class="pHeading3"><a name="wp1036203"> </a>
Examples
</h4>
<p class="pBody"><a name="wp1036204"> </a>
The following is an example C source file that uses exceptions: 
</p>
<a name="wp1036205"> </a><div class="pPreformatted"><pre>#include &lt;texc.h&gt;  <br /> <br />EXCEPTION badopen_e;                      /* declare exception for bad open() */<br /> <br />doit(char *filename)  <br />{<br />  EXCEPTION_INIT(badopen_e);              /* initialize exception */<br />  TRY  get_and_update_data(filename);     /* do the operation */<br />  CATCH(badopen_e)                        /* exception - open() failed */<br />     fprintf(stderr, &#8220;Cannot open %s\en&#8221;, filename); <br />  CATCH_ALL                               /* handle other errors */<br />     /* handle rpc service not available, ... */<br />     exc_report(THIS_CATCH)  <br />   ENDTRY<br />}<br />/*<br /> * Open output file<br /> * Get the remote data item <br /> * Write out to file <br /> */<br />get_and_update_data(char *filename)<br />{<br />  FILE *fp;<br />  if ((fp == fopen(filename)) == NULL) /* open output file */<br />    RAISE(badopen_e);                  /* raise exception */<br />  TRY<br />    /* in this block, file is opened successfully -<br />     * use associated FINALLY to close file  <br />     */<br />      long data;<br />      /*  <br />       * Execute RPC call - exceptions are raised to the calling<br />       * function, doit()<br />       */<br />      data = remote_get_data();<br />      fprintf(fp, &#8220;%ld\en&#8221;, data);<br />  FINALLY<br />    /* Whether or not exceptions are raised, close the file */<br />     fclose(fp);<br />  ENDTRY<br />}</pre></div><h4 class="pHeading3"><a name="wp1036206"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1036207"> </a>
<a href="rf3c.html#wp1049646"><code class="cCode">userlog(3c)</code></a>
</p>
<p class="pBody"><a name="wp1368387"> </a>
<code class="cCode">abort</code>(2) in a UNIX system reference manual
</p>
<p class="pBody"><a name="wp1270440"> </a>
<em class="cEmphasis">Programming Oracle Tuxedo ATMI Applications Using TxRPC</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046072"> </a>
tuxgetenv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046073"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046074"> </a>
<code class="cCode">tuxgetenv()</code>&#8212;Returns value for environment name.
</p>
<h4 class="pHeading3"><a name="wp1046075"> </a>
Synopsis
</h4>
<a name="wp1046076"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;  <br />char *tuxgetenv(char *name)</pre></div><h4 class="pHeading3"><a name="wp1046077"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046078"> </a>
<code class="cCode">tuxgetenv()</code> searches the environment list for a string of the form <code class="cCodeEmphasis">name</code><code class="cCode">=</code><code class="cCodeEmphasis">value</code> and, if the string is present, returns a pointer to the <code class="cCodeEmphasis">value</code> in the current environment. Otherwise, it returns a NULL pointer.
</p>
<p class="pBody"><a name="wp1046079"> </a>
This function provides a portable interface to environment variables across the different platforms on which the Oracle Tuxedo ATMI system is supported, including those platforms that do not normally have environment variables.
</p>
<p class="pBody"><a name="wp1046080"> </a>
Note that <code class="cCode">tuxgetenv</code> is case-sensitive.
</p>
<p class="pBody"><a name="wp1618198"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tuxgetenv()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1046081"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1046082"> </a>
If a pointer to the string exists, <code class="cCode">tuxgetenv()</code> returns that pointer. If a pointer does not exist, <code class="cCode">tuxgetenv()</code> returns a NULL pointer.
</p>
<h4 class="pHeading3"><a name="wp1046083"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1046084"> </a>
On MS Windows, this function overcomes the inability to share environment variables between an application and a Dynamic Link Library. The Oracle Tuxedo ATMI Workstation DLL maintains an environment copy for each application that is attached to it. This associated environment and context information is destroyed when <code class="cCode">tpterm()</code> is called from a Windows application. The value of an environment variable could be changed after the application program calls <code class="cCode">tpterm()</code>.
</p>
<p class="pBody"><a name="wp1046085"> </a>
It is recommended that uppercase variable names be used for the Windows environments. (<code class="cCode">tuxreadenv()</code> converts all environment variable names to uppercase.)
</p>
<h4 class="pHeading3"><a name="wp1046086"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046087"> </a>
<a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a>, <a href="rf3c.html#wp1046107"><code class="cCode">tuxreadenv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1928429"> </a>
tuxgetmbaconv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1928430"> </a>
Name
</h4>
<p class="pBody"><a name="wp1928431"> </a>
<code class="cCode">tuxgetmbaconv()</code>&#8212;Gets the value for environment variable <code class="cCode">TPMBACONV</code> in the process environment.
</p>
<h4 class="pHeading3"><a name="wp1928432"> </a>
Synopsis
</h4>
<a name="wp1938688"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br /><br />int<br />tuxgetmbaconv(long flags)     /* Get TPMBACONV info */</pre></div><h4 class="pHeading3"><a name="wp1938680"> </a>
Description
</h4>
<p class="pBody"><a name="wp1938705"> </a>
This function is used for getting the TPMBACONV status. The <code class="cCode">tuxgetnombaconv()</code> function is used by an application developer to check if the automatic conversion capability of the typed switch buffers is turned off. By default the TPMBACONV is not set and automatic conversion functions are used. 
</p>
<p class="pBody"><a name="wp1938706"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not currently used and should be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1938684"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1938713"> </a>
<code class="cCode">tuxgetnombaconv()</code> returns  MBAUTOCONVERSION_ON if the TPMBACONV is set and MBAUTOCONVERSION_OFF if TPMBACONV is not set. 
</p>
<h4 class="pHeading3"><a name="wp1928434"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1928447"> </a>
<a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a>, <a href="rf3c.html#wp1928228"><code class="cCode">tuxsetmbaconv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1928458"> </a>
tuxgetmbenc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1928459"> </a>
Name
</h4>
<p class="pBody"><a name="wp1928460"> </a>
<code class="cCode">tuxgetmbenc()</code>&#8212;Gets the code-set encoding name for environment variable <code class="cCode">TPMBENC</code> in the process environment.
</p>
<h4 class="pHeading3"><a name="wp1928461"> </a>
Synopsis
</h4>
<a name="wp1938587"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br /><br />int<br />tuxgetmbenc(char *enc_name, long flags)</pre></div><h4 class="pHeading3"><a name="wp1938579"> </a>
Description
</h4>
<p class="pBody"><a name="wp1938604"> </a>
This function is used for getting the codeset encoding name that is contained in the TPMBENC environment variable. This environment variable is automatically used as the default codeset encoding name when an MBSTRING typed buffer is created. The default encoding name can be reset or unset using the tpsetmbenc() function once the new message is available. 
</p>
<p class="pBody"><a name="wp1938605"> </a>
The <code class="cCodeEmphasis">enc_name</code> argument will contain the value of the TPMBENC environment variable upon successful execution of this function. This pointer should be large enough for the encoding name to be copied into.
</p>
<p class="pBody"><a name="wp1938606"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not currently used and should be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1938583"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1928462"> </a>
Upon success, tuxgetmbenc() returns 0; otherwise, it returns a non-zero value on error.
</p>
<h4 class="pHeading3"><a name="wp1928463"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1928476"> </a>
<a href="rf3c.html#wp1928689"><code class="cCode">tpconvmb(3c)</code></a>, <a href="rf3c.html#wp1930050"><code class="cCode">tpgetmbenc(3c)</code></a>, <a href="rf3c.html#wp1930111"><code class="cCode">tpsetmbenc(3c)</code></a>, <a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a>, <a href="rf3c.html#wp1928257"><code class="cCode">tuxsetmbenc(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1023341"> </a>
tuxputenv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1023342"> </a>
Name
</h4>
<p class="pBody"><a name="wp1023343"> </a>
<code class="cCode">tuxputenv()</code>&#8212;Changes or adds a value to the environment.
</p>
<h4 class="pHeading3"><a name="wp1023344"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1023345"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tuxputenv(char *string)</code>
</p>
<h4 class="pHeading3"><a name="wp1023346"> </a>
Description
</h4>
<p class="pBody"><a name="wp1023347"> </a>
<code class="cCodeEmphasis">string</code> points to a string of the form &#8220;name=value.&#8221; <code class="cCode">tuxputenv()</code> makes the value of the environment variable name equal to value by altering an existing variable or creating a new one. In either case, the string pointed to by <code class="cCodeEmphasis">string</code> becomes part of the environment.
</p>
<p class="pBody"><a name="wp1023348"> </a>
This function provides a portable interface to environment variables across different platforms on where Oracle Tuxedo ATMI system is supported (including those platforms that do not normally have environment variables).
</p>
<a name="wp1023349"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">tuxputenv()</code> is case-sensitive.</td>
</tr>
</table>

<p class="pBody"><a name="wp1618206"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tuxputenv()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1023350"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1023351"> </a>
If <code class="cCode">tuxputenv()</code> cannot obtain enough space, via <code class="cCode">malloc()</code>, for an expanded environment, it returns a non-zero integer. Otherwise, it returns zero.
</p>
<h4 class="pHeading3"><a name="wp1023352"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1023353"> </a>
On MS Windows, this function overcomes the inability to share environment variables between an application and a Dynamic Link Library. The Oracle Tuxedo ATMI system Workstation DLL maintains an environment copy for each application that is attached to it. This associated environment and context information is destroyed when <code class="cCode">tpterm()</code> is called from a Windows application. The value of an environment variable could be changed after the application program calls <code class="cCode">tpterm()</code>.
</p>
<p class="pBody"><a name="wp1023354"> </a>
We recommend using uppercase variable names for the DOS, Windows, and OS/2, environments. (<code class="cCode">tuxreadenv()</code> converts all environment variable names to uppercase.)
</p>
<h4 class="pHeading3"><a name="wp1023355"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1023356"> </a>
<a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a>, <a href="rf3c.html#wp1046107"><code class="cCode">tuxreadenv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046107"> </a>
tuxreadenv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046108"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046109"> </a>
<code class="cCode">tuxreadenv()</code>&#8212;Adds variables to the environment from a file.
</p>
<h4 class="pHeading3"><a name="wp1046110"> </a>
Synopsis
</h4>
<a name="wp1046111"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt; <br />int tuxreadenv(char *file, char *label)</pre></div><h4 class="pHeading3"><a name="wp1046112"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046113"> </a>
<code class="cCode">tuxreadenv()</code> reads a file containing environment variables and adds them to the environment, independent of platform. These variables are available using <code class="cCode">tuxgetenv()</code> and can be reset using <code class="cCode">tuxputenv()</code>.
</p>
<p class="pBody"><a name="wp1046114"> </a>
The format of the environment file is as follows: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1046115"> </a>Any leading space or tab character on a line is ignored and is not considered in the following points.</li>
<li><a name="wp1046116"> </a>Lines containing variables to be put into the environment are of the form:</li>
<a name="wp1046117"> </a><div class="pPreformattedRelative"><pre><code class="cCodeEmphasis">variable</code><code class="cCode">=</code><code class="cCodeEmphasis">value</code></pre></div><p class="pBodyRelative"><a name="wp1046118"> </a>
or 
</p>
<a name="wp1046119"> </a><div class="pPreformattedRelative"><pre><code class="cCode">set </code><code class="cCodeEmphasis">variable</code><code class="cCode">=</code><code class="cCodeEmphasis">value</code></pre></div><p class="pBodyRelative"><a name="wp1046120"> </a>
where <code class="cCodeEmphasis">variable</code> must begin with an alphabetic or underscore character and contain only alphanumeric or underscore characters, and <code class="cCodeEmphasis">value</code> may contain any character except newline. 
</p>
<li><a name="wp1046121"> </a>Within the <code class="cCodeEmphasis">value</code>, strings of the form <code class="cCode">$</code>{<code class="cCodeEmphasis">env</code>} are expanded using variables already in the environment (forward referencing is not supported and if a value is not set, the variable is replaced with the empty string). Backslash (\) may be used to escape the dollar sign and itself. All other shell quoting and escape mechanisms are ignored and the expanded <code class="cCodeEmphasis">value</code> is placed into the environment.</li>
<li><a name="wp1046122"> </a>Lines beginning with slash (/), pound sign (#), semicolon (;), or exclamation point (!) are treated as comments and ignored. Lines beginning with other characters besides these comment characters, a left square bracket, or an alphabetic or underscore character are reserved for future use; their use is undefined.</li>
<li><a name="wp1046123"> </a>The file is partitioned into sections by lines beginning with left square bracket ([), which acts as a label. The label will be silently truncated if longer than 31 characters. The format of a label is:</li>
<a name="wp1046124"> </a><div class="pPreformattedRelative"><pre><code class="cCode">[</code><code class="cCodeEmphasis">label</code><code class="cCode">]</code></pre></div><p class="pBodyRelative"><a name="wp1046125"> </a>
where <code class="cCodeEmphasis">label</code> follows the same rules for <code class="cCodeEmphasis">variable</code> above (lines with invalid <code class="cCodeEmphasis">label</code> values are ignored). 
</p>
<li><a name="wp1046126"> </a>Variable lines between the top of the file and the first label are put into the environment for all labels (this is the global section). Other variables are put into the environment only if the label matches the label specified for the application. A label of [] will indicate the global section.</li>
</ul></div>
<p class="pBody"><a name="wp1148542"> </a>
If <code class="cCodeEmphasis">file</code> is NULL, then a default filename is used. The fixed filenames are as follows:
</p>
<p class="pBody"><a name="wp1046127"> </a>
<code class="cCode">DOS, Windows, OS2, NT: C:\TUXEDO\TUXEDO.ENV<br />MAC: TUXEDO.ENV in the system preferences directory <br />NETWARE: SYS:SYSTEM\TUXEDO.ENV <br />POSIX: /usr/tuxedo/TUXEDO.ENV </code>or<code class="cCode"> /var/opt/tuxedo/TUXEDO.ENV </code>
</p>
<p class="pBody"><a name="wp1046128"> </a>
If <code class="cCodeEmphasis">label</code> is NULL, then only variables in the global section are put into the environment. For other values of <code class="cCodeEmphasis">label</code>, the global section variables plus any variables in a section matching the <code class="cCodeEmphasis">label</code> are put into the environment.
</p>
<p class="pBody"><a name="wp1046129"> </a>
An error message is printed to the <code class="cCode">userlog()</code> if there is a memory failure, if a non-NULL filename does not exist, or if a non-NULL label does not exist.
</p>
<p class="pBody"><a name="wp1618215"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">tuxreadenv()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1046130"> </a>
Example
</h4>
<p class="pBody"><a name="wp1046131"> </a>
The following is an example environment file.
</p>
<p class="pBody"><a name="wp1046132"> </a>
<code class="cCode">TUXDIR=/usr/tuxedo <br />[application1] <br />;this is a comment <br />/* this is a comment */ <br />#this is a comment <br />//this is a comment <br />FIELDTBLS=app1_flds <br />FLDTBLDIR=/usr/app1/udataobj <br />[application2] <br />FIELDTBLS=app2_flds <br />FLDTBLDIR=/usr/app2/udataobj</code>
</p>
<h4 class="pHeading3"><a name="wp1233540"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1233541"> </a>
If <code class="cCode">tuxreadenv()</code>cannot obtain enough space, via <code class="cCode">malloc()</code>, for an expanded environment, or if it cannot open and read a file with a non-NULL name, it returns a non-zero integer. Otherwise, <code class="cCode">tuxreadenv()</code> returns zero.
</p>
<h4 class="pHeading3"><a name="wp1046135"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1046136"> </a>
In the DOS, Windows, OS/2, and NetWare environments, <code class="cCode">tuxreadenv()</code> converts all environment variable names to uppercase.
</p>
<h4 class="pHeading3"><a name="wp1046137"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046138"> </a>
<a href="rf3c.html#wp1046072"><code class="cCode">tuxgetenv(3c)</code></a>, <a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1928228"> </a>
tuxsetmbaconv(3c)
</h3>
<h4 class="pHeading3"><a name="wp1928229"> </a>
Name
</h4>
<p class="pBody"><a name="wp1928230"> </a>
<code class="cCode">tuxsetmbaconv()</code>&#8212;Sets the value for environment variable <code class="cCode">TPMBACONV</code> in the process environment.
</p>
<h4 class="pHeading3"><a name="wp1928231"> </a>
Synopsis
</h4>
<a name="wp1938631"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br /><br />int<br />tuxsetmbaconv(int onoff, long flags)     /* Set TPMBACONV */</pre></div><h4 class="pHeading3"><a name="wp1938623"> </a>
Description
</h4>
<p class="pBody"><a name="wp1938648"> </a>
This function is used for setting or resetting the <code class="cCode">TPMBACONV</code> environment variable. By default <code class="cCode">TPMBACONV</code> is not set and automatic conversion functions are used. 
</p>
<p class="pBody"><a name="wp1938649"> </a>
The <code class="cCodeEmphasis">onoff</code> argument is equal to <code class="cCode">MBAUTOCONVERSION_OFF</code> to unset <code class="cCode">TPMBACONV</code> and turn off auto-conversions. It is equal to <code class="cCode">MBAUTOCONVERSION_ON</code> to set <code class="cCode">TPMBACONV</code> and turn on the typed switch buffers auto-conversion of codeset multi-byte data.
</p>
<p class="pBody"><a name="wp1938650"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not currently used and should be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1938627"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1938657"> </a>
Upon success, <code class="cCode">tuxsetnombaconv()</code> returns 0; otherwise, it returns a non-zero value on error. (for example, it returns -1 if the <code class="cCodeEmphasis">onoff</code> arg is not one of the defined values).
</p>
<h4 class="pHeading3"><a name="wp1928233"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1928246"> </a>
<a href="rf3c.html#wp1928429"><code class="cCode">tuxgetmbaconv(3c)</code></a>, <a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1928257"> </a>
tuxsetmbenc(3c)
</h3>
<h4 class="pHeading3"><a name="wp1928258"> </a>
Name
</h4>
<p class="pBody"><a name="wp1928259"> </a>
<code class="cCode">tuxsetmbenc()</code>&#8212;Sets the code-set encoding name for environment variable <code class="cCode">TPMBENC</code> in the process environment.
</p>
<h4 class="pHeading3"><a name="wp1928260"> </a>
Synopsis
</h4>
<a name="wp1938542"> </a><div class="pPreformatted"><pre>#include &lt;atmi.h&gt;<br />extern int tperrno;<br /><br />int<br />tuxsetmbenc(char *enc_name, long flags)</pre></div><h4 class="pHeading3"><a name="wp1938534"> </a>
Description
</h4>
<p class="pBody"><a name="wp1938559"> </a>
This function is used for setting or resetting the codeset encoding name that is contained in the TPMBENC environment variable. This environment variable is automatically used as the default codeset encoding name when an MBSTRING typed buffer is created. This default encoding name can be reset or unset using the <code class="cCode">tpsetmbenc()</code> function once the new message is available. 
</p>
<p class="pBody"><a name="wp1938560"> </a>
The <code class="cCodeEmphasis">enc_name</code> argument is the encoding name to use to identify the codeset. 
</p>
<p class="pBody"><a name="wp1938561"> </a>
The <code class="cCodeEmphasis">flags</code> argument is not currently used and should be set to 0.
</p>
<h4 class="pHeading3"><a name="wp1938538"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1928261"> </a>
Upon success, <code class="cCode">tuxsetmbenc()</code> returns 0; otherwise, it returns a non-zero value on error.
</p>
<h4 class="pHeading3"><a name="wp1928262"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1928275"> </a>
<a href="rf3c.html#wp1928689"><code class="cCode">tpconvmb(3c)</code></a>, <a href="rf3c.html#wp1930050"><code class="cCode">tpgetmbenc(3c)</code></a>, <a href="rf3c.html#wp1930111"><code class="cCode">tpsetmbenc(3c)</code></a>, <a href="rf3c.html#wp1928458"><code class="cCode">tuxgetmbenc(3c)</code></a>, <a href="rf3c.html#wp1023341"><code class="cCode">tuxputenv(3c)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp2461886"> </a>
tuxthrputenv(3c) 
</h3>
<h4 class="pHeading3"><a name="wp2461888"> </a>
Name 
</h4>
<p class="pBody"><a name="wp2461890"> </a>
<code class="cCode">tuxthrputenv()</code>&#8212;Changes or adds an environment variable for the current thread. 
</p>
<h4 class="pHeading3"><a name="wp2461892"> </a>
Synopsis 
</h4>
<p class="pBody"><a name="wp2461894"> </a>
<code class="cCode">#include &lt;atmi.h&gt; <br />int tuxthrputenv(char *string</code>) 
</p>
<h4 class="pHeading3"><a name="wp2461897"> </a>
Description 
</h4>
<p class="pBody"><a name="wp2461899"> </a>
<code class="cCode">string</code> points to a string of the form &#8220;<code class="cCode">name=value</code>.&#8221;<code class="cCode">tuxthrputenv()</code> makes the value of the environment variable name equal to value by altering an existing variable or creating a new one. In either case, the string pointed to by string becomes part of the environment. 
</p>
<p class="pBody"><a name="wp2461904"> </a>
This function provides a portable interface to environment variables across different platforms where the Oracle Tuxedo ATMI system is supported (including those platforms that do not normally have environment variables). It allows a thread in a multithreaded application to use its own environment variables.
</p>
<p class="pBody"><a name="wp2463598"> </a>
<code class="cCode">tuxthrputenv</code> works only when it is read by <code class="cCode">tuxgetenv()</code>. If <code class="cCode">getenv</code> is used, <code class="cCode">tuxthrputenv </code>fails.
</p>
<a name="wp2463583"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">tuxthrputenv()</code> is case-sensitive, it overrides the <code class="cCode">tuxputenv</code> set value. </td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp2461913"> </a>
Return Values 
</h4>
<p class="pBody"><a name="wp2461915"> </a>
If <code class="cCode">tuxthrputenv()</code> cannot obtain enough space via <code class="cCode">malloc()</code>for an expanded environment, it returns a non-zero integer. Otherwise, it returns zero. 
</p>
<h4 class="pHeading3"><a name="wp2461918"> </a>
Portability 
</h4>
<p class="pBody"><a name="wp2461920"> </a>
On MS Windows, <code class="cCode">tuxthrputenv()</code> overcomes the inability to share environment variables between an application and a Dynamic Link Library. The Oracle Tuxedo ATMI system Workstation DLL maintains an environment copy for each application that is attached to it. This associated environment and context information is destroyed when <code class="cCode">tpterm()</code> is called from a Windows application. The value of an environment variable could be changed after the application program calls <code class="cCode">tpterm()</code>. 
</p>
<p class="pBody"><a name="wp2461928"> </a>
It is recommended that you use uppercase variable names for the DOS, Windows, and OS/2, environments. (<code class="cCode">tuxreadenv()</code> converts all environment variable names to uppercase.) 
</p>
<h4 class="pHeading3"><a name="wp2463481"> </a>
See Also 
</h4>
<p class="pBody"><a name="wp2461883"> </a>
<a href="rf3c.html#wp1046072"><code class="cHyperlinkCode">
tuxgetenv(3c)</code></a>, <a href="rf3c.html#wp1046107"><code class="cHyperlinkCode">
tuxreadenv(3c)</code></a>, <a href="rf3c.html#wp1023341"><code class="cHyperlinkCode">
tuxputenv(3c)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046168"> </a>
tx_begin(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046169"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046170"> </a>
<code class="cCode">tx_begin()</code>&#8212;Begins a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1046171"> </a>
Synopsis
</h4>
<a name="wp1046172"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_begin(void)</pre></div><h4 class="pHeading3"><a name="wp1046173"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046174"> </a>
<code class="cCode">tx_begin()</code> is used to place the calling thread of control in transaction mode. The calling thread must first ensure that its linked resource managers have been opened (via <code class="cCode">tx_open()</code>) before it can start transactions. <code class="cCode">tx_begin()</code> fails (returning [<code class="cCode">TX_PROTOCOL_ERROR</code>]) if the caller is already in transaction mode or <code class="cCode">tx_open()</code> has not been called.
</p>
<p class="pBody"><a name="wp1046175"> </a>
Once in transaction mode, the calling thread must call <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code> to complete its current transaction. There are certain cases related to transaction chaining where <code class="cCode">tx_begin()</code> does not need to be called explicitly to start a transaction. See <code class="cCode">tx_commit()</code> and <code class="cCode">tx_rollback()</code> for details.
</p>
<p class="pBody"><a name="wp1632158"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_begin()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046176"> </a>
Optional Set-up
</h4>
<p class="pBody"><a name="wp1046177"> </a>
<code class="cCode">tx_set_transaction_timeout()</code>
</p>
<h4 class="pHeading3"><a name="wp1046178"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046179"> </a>
Upon successful completion, <code class="cCode">tx_begin()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046180"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046181"> </a>
Under the following conditions, <code class="cCode">tx_begin()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046182"> </a>
[<code class="cCode">TX_OUTSIDE</code>] 
</h4><div class="pDefPara"><a name="wp1046183"> </a>
The transaction manager is unable to start a global transaction because the calling thread of control is currently participating in work outside any global transaction with one or more resource managers. All such work must be completed before a global transaction can be started. The caller&#8217;s state with respect to the local transaction is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1046184"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046185"> </a>
The function was called in an improper context (for example, the caller is already in transaction mode). The caller&#8217;s state with respect to transaction mode is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1046186"> </a>
[<code class="cCode">TX_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046187"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error trying to start a new transaction. When this error is returned, the caller is not in transaction mode. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1046188"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046189"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. When this error is returned, the caller is not in transaction mode. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046190"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046191"> </a>
<a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a>, <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>, <a href="rf3c.html#wp1046426"><code class="cCode">tx_rollback(3c)</code></a>, <a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046192"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046193"> </a>
XA-compliant resource managers must be successfully opened to be included in the global transaction. (See <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a> for details.) Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046217"> </a>
tx_close(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046218"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046219"> </a>
<code class="cCode">tx_close()</code>&#8212;Closes a set of resource managers.
</p>
<h4 class="pHeading3"><a name="wp1046220"> </a>
Synopsis
</h4>
<a name="wp1046221"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_close(void)</pre></div><h4 class="pHeading3"><a name="wp1046222"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046223"> </a>
<code class="cCode">tx_close()</code> closes a set of resource managers in a portable manner. It invokes a transaction manager to read resource-manager-specific information in a transaction-manager-specific manner and pass this information to the resource managers linked to the caller.
</p>
<p class="pBody"><a name="wp1046224"> </a>
<code class="cCode">tx_close()</code> closes all resource managers to which the caller is linked. This function is used in place of resource-manager-specific &#8220;close&#8221; calls and allows an application program to be free of calls which may hinder portability. Since resource managers differ in their termination semantics, the specific information needed to &#8220;close&#8221; a particular resource manager must be published by each resource manager.
</p>
<p class="pBody"><a name="wp1046225"> </a>
<code class="cCode">tx_close()</code> should be called when an application thread of control no longer wishes to participate in global transactions. <code class="cCode">tx_close()</code> fails (returning [<code class="cCode">TX_PROTOCOL_ERROR</code>]) if the caller is in transaction mode. That is, no resource managers are closed even though some may not be participating in the current transaction.
</p>
<p class="pBody"><a name="wp1046226"> </a>
When <code class="cCode">tx_close()</code> returns success (<code class="cCode">TX_OK</code>), all resource managers linked to the calling thread are closed.
</p>
<p class="pBody"><a name="wp1632166"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_close()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046227"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046228"> </a>
Upon successful completion, <code class="cCode">tx_close</code>() returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046229"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046230"> </a>
Under the following conditions, <code class="cCode">tx_close()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046231"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046232"> </a>
The function was called in an improper context (for example, the caller is in transaction mode). No resource managers are closed.
</div>
<h4 class="pDefTerm"><a name="wp1046233"> </a>
[<code class="cCode">TX_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046234"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error. The exact nature of the error is written to a log file. All resource managers that could be closed are closed.
</div>
<h4 class="pDefTerm"><a name="wp1046235"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046236"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046237"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046238"> </a>
<a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046239"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046240"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046266"> </a>
tx_commit(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046267"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046268"> </a>
<code class="cCode">tx_commit()</code>&#8212;Commits a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1046269"> </a>
Synopsis
</h4>
<a name="wp1046270"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_commit(void)</pre></div><h4 class="pHeading3"><a name="wp1046271"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046272"> </a>
<code class="cCode">tx_commit()</code> is used to commit the work of the transaction active in the caller&#8217;s thread of control.
</p>
<p class="pBody"><a name="wp1046273"> </a>
If the <code class="cCodeEmphasis">transaction_control</code> characteristic (see <a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>) is <code class="cCode">TX_UNCHAINED</code>, then when <code class="cCode">tx_commit()</code> returns, the caller is no longer in transaction mode. However, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, then when <code class="cCode">tx_commit()</code> returns, the caller remains in transaction mode on behalf of a new transaction (see the Return Value and Errors sections below).
</p>
<p class="pBody"><a name="wp1632174"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_commit()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046274"> </a>
Optional Set-up
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1046275"> </a><code class="cCode">tx_set_commit_return()</code></li>
<li><a name="wp1716700"> </a><code class="cCode">tx_set_transaction_control()</code></li>
<li><a name="wp1716701"> </a><code class="cCode">tx_set_transaction_timeout()</code></li>
</ul></div>
<h4 class="pHeading3"><a name="wp1716702"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046279"> </a>
Upon successful completion, <code class="cCode">tx_commit()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046280"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046281"> </a>
Under the following conditions, <code class="cCode">tx_commit()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046282"> </a>
[<code class="cCode">TX_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046283"> </a>
The current transaction committed successfully; however, a new transaction could not be started and the caller is no longer in transaction mode. This return value may occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046284"> </a>
[<code class="cCode">TX_ROLLBACK</code>] 
</h4><div class="pDefPara"><a name="wp1046285"> </a>
The current transaction could not commit and has been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046286"> </a>
[<code class="cCode">TX_ROLLBACK_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046287"> </a>
The transaction could not commit and has been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046288"> </a>
[<code class="cCode">TX_MIXED</code>] 
</h4><div class="pDefPara"><a name="wp1046289"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046290"> </a>
[<code class="cCode">TX_MIXED_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046291"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046292"> </a>
[<code class="cCode">TX_HAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1046293"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046294"> </a>
[<code class="cCode">TX_HAZARD_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046295"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046296"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046297"> </a>
The function was called in an improper context (for example, the caller is not in transaction mode). The caller&#8217;s state with respect to transaction mode is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1046298"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046299"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file. The caller&#8217;s state with respect to the transaction is unknown.
</div>
<h4 class="pHeading3"><a name="wp1046300"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046301"> </a>
<a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a>, <a href="rf3c.html#wp1046490"><code class="cCode">tx_set_commit_return(3c)</code></a>, <a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>, <a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046302"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046303"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046331"> </a>
tx_info(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046332"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046333"> </a>
<code class="cCode">tx_info()</code>&#8212;Returns global transaction information.
</p>
<h4 class="pHeading3"><a name="wp1046334"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1046335"> </a>
<code class="cCode">#include &lt;tx.h&gt; <br />int tx_info(TXINFO *info)</code>
</p>
<h4 class="pHeading3"><a name="wp1046336"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046337"> </a>
<code class="cCode">tx_info()</code> returns global transaction information in the structure pointed to by <code class="cCodeEmphasis">info</code>. In addition, this function returns a value indicating whether the caller is currently in transaction mode or not. If <code class="cCodeEmphasis">info</code> is non-NULL, then <code class="cCode">tx_info()</code> populates a <code class="cCode">TXINFO</code> structure pointed to by <code class="cCodeEmphasis">info</code> with global transaction information. The <code class="cCode">TXINFO</code> structure contains the following elements: 
</p>
<a name="wp1046338"> </a><div class="pPreformatted"><pre>XID                 xid;  <br />COMMIT_RETURN       when_return;<br />TRANSACTION_CONTROL transaction_control;<br />TRANSACTION_TIMEOUT transaction_timeout;  <br />TRANSACTION_STATE    transaction_state;</pre></div><p class="pBody"><a name="wp1046339"> </a>
If <code class="cCode">tx_info()</code> is called in transaction mode, then <code class="cCodeEmphasis">xid</code> will be populated with a current transaction branch identifier and <code class="cCodeEmphasis">transaction_state</code> will contain the state of the current transaction. If the caller is not in transaction mode, <code class="cCodeEmphasis">xid</code> will be populated with the NULL XID (see the <code class="cCode">tx.h</code> file for details). In addition, regardless of whether the caller is in transaction mode, <code class="cCodeEmphasis">when_return</code>, <code class="cCodeEmphasis">transaction_control</code>, and <code class="cCodeEmphasis">transaction_timeout</code> contain the current settings of the <code class="cCodeEmphasis">commit_return</code> and <code class="cCodeEmphasis">transaction_control</code> characteristics, and the transaction timeout value in seconds.
</p>
<p class="pBody"><a name="wp1716715"> </a>
The transaction timeout value returned reflects the setting that will be used when the next transaction is started. Thus, it may not reflect the timeout value for the caller&#8217;s current global transaction since calls made to <code class="cCode">tx_set_transaction_timeout()</code> after the current transaction was begun may have changed its value.
</p>
<p class="pBody"><a name="wp1046341"> </a>
If <code class="cCodeEmphasis">info</code> is NULL, no <code class="cCode">TXINFO</code> structure is returned.
</p>
<p class="pBody"><a name="wp1632186"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_info()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046342"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046343"> </a>
If the caller is in transaction mode, then 1 is returned. If the caller is not in transaction mode, then 0 is returned.
</p>
<h4 class="pHeading3"><a name="wp1046344"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046345"> </a>
Under the following conditions, <code class="cCode">tx_info()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046346"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046347"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">tx_open()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1046348"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046349"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046350"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046351"> </a>
<a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>, <a href="rf3c.html#wp1046490"><code class="cCode">tx_set_commit_return(3c)</code></a>, <a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>, <a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046352"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046353"> </a>
Within the same global transaction, subsequent calls to <code class="cCode">tx_info()</code> are guaranteed to provide an XID with the same <code class="cCodeEmphasis">gtrid</code> component, but not necessarily the same <code class="cCodeEmphasis">bqual</code> component. Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046379"> </a>
tx_open(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046380"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046381"> </a>
<code class="cCode">tx_open()</code>&#8212;Opens a set of resource managers.
</p>
<h4 class="pHeading3"><a name="wp1046382"> </a>
Synopsis
</h4>
<a name="wp1046383"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_open(void)</pre></div><h4 class="pHeading3"><a name="wp1046384"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046385"> </a>
<code class="cCode">tx_open()</code> opens a set of resource managers in a portable manner. It invokes a transaction manager to read resource-manager-specific information in a transaction-manager-specific manner and pass this information to the resource managers linked to the caller.
</p>
<p class="pBody"><a name="wp1046386"> </a>
<code class="cCode">tx_open()</code> attempts to open all resource managers that have been linked with the application. This function is used in place of resource-manager-specific &#8220;open&#8221; calls and allows an application program to be free of calls which may hinder portability. Since resource managers differ in their initialization semantics, the specific information needed to &#8220;open&#8221; a particular resource manager must be published by each resource manager.
</p>
<p class="pBody"><a name="wp1046387"> </a>
If <code class="cCode">tx_open()</code> returns <code class="cCode">TX_ERROR</code>, then no resource managers are open. If <code class="cCode">tx_open()</code> returns <code class="cCode">TX_OK</code>, some or all of the resource managers have been opened. Resource managers that are not open will return resource-manager-specific errors when accessed by the application. <code class="cCode">tx_open()</code> must successfully return before a thread of control participates in global transactions.
</p>
<p class="pBody"><a name="wp1046388"> </a>
Once <code class="cCode">tx_open()</code> returns success, subsequent calls to <code class="cCode">tx_open()</code> (before an intervening call to <code class="cCode">tx_close()</code>) are allowed. However, such subsequent calls will return success, and the TM will not attempt to reopen any RMs.
</p>
<p class="pBody"><a name="wp1632203"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_open()</code>.
</p>
<h4 class="pHeading3"><a name="wp1632204"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046390"> </a>
Upon successful completion, <code class="cCode">tx_open()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046391"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046392"> </a>
Under the following conditions, <code class="cCode">tx_open()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046393"> </a>
[<code class="cCode">TX_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046394"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error. No resource managers are open. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1046395"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046396"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. <code class="cCode">TX_FAIL</code> is returned if <code class="cCode">tpinit()</code> is not called before the call to <code class="cCode">tx_open</code> in a secure application (SECURITY APP_PW). The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046397"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046398"> </a>
<a href="rf3c.html#wp1046217"><code class="cCode">tx_close(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046399"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046400"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046426"> </a>
tx_rollback(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046427"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046428"> </a>
<code class="cCode">tx_rollback()</code>&#8212;Rolls back a global transaction.
</p>
<h4 class="pHeading3"><a name="wp1046429"> </a>
Synopsis
</h4>
<a name="wp1046430"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_rollback(void)</pre></div><h4 class="pHeading3"><a name="wp1046431"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046432"> </a>
<code class="cCode">tx_rollback()</code> is used to roll back the work of the transaction active in the caller&#8217;s thread of control.
</p>
<p class="pBody"><a name="wp1046433"> </a>
If the <code class="cCodeEmphasis">transaction_control</code> characteristic (see <a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>) is <code class="cCode">TX_UNCHAINED</code>, then when <code class="cCode">tx_rollback()</code> returns, the caller is no longer in transaction mode. However, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, then when <code class="cCode">tx_rollback()</code> returns, the caller remains in transaction mode on behalf of a new transaction (see the Return Value and Errors sections below).
</p>
<p class="pBody"><a name="wp1632210"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_rollback()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046434"> </a>
Optional Set-up
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1046435"> </a><code class="cCode">tx_set_transaction_control()</code></li>
<li><a name="wp1046436"> </a><code class="cCode">tx_set_transaction_timeout()</code></li>
</ul></div>
<h4 class="pHeading3"><a name="wp1046437"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046438"> </a>
Upon successful completion, <code class="cCode">tx_rollback()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046439"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046440"> </a>
Under the following conditions, <code class="cCode">tx_rollback()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046441"> </a>
[<code class="cCode">TX_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046442"> </a>
The current transaction rolled back; however, a new transaction could not be started and the caller is no longer in transaction mode. This return value may occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046443"> </a>
[<code class="cCode">TX_MIXED</code>] 
</h4><div class="pDefPara"><a name="wp1046444"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046445"> </a>
[<code class="cCode">TX_MIXED_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046446"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046447"> </a>
[<code class="cCode">TX_HAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1046448"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046449"> </a>
[<code class="cCode">TX_HAZARD_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046450"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046451"> </a>
[<code class="cCode">TX_COMMITTED</code>] 
</h4><div class="pDefPara"><a name="wp1046452"> </a>
The work done on behalf of the transaction was heuristically committed. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1046453"> </a>
[<code class="cCode">TX_COMMITTED_NO_BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1046454"> </a>
The work done on behalf of the transaction was heuristically committed. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046455"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046456"> </a>
The function was called in an improper context (for example, the caller is not in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp1046457"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046458"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file. The caller&#8217;s state with respect to the transaction is unknown.
</div>
<h4 class="pHeading3"><a name="wp1046459"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046460"> </a>
<a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a>, <a href="rf3c.html#wp1046542"><code class="cCode">tx_set_transaction_control(3c)</code></a>, <a href="rf3c.html#wp1046597"><code class="cCode">tx_set_transaction_timeout(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046461"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046462"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046490"> </a>
tx_set_commit_return(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046491"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046492"> </a>
<code class="cCode">tx_set_commit_return()</code>&#8212;Sets the <code class="cCodeEmphasis">commit_return</code> characteristic.
</p>
<h4 class="pHeading3"><a name="wp1046493"> </a>
Synopsis
</h4>
<a name="wp1046494"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_set_commit_return(COMMIT_RETURN when_return)</pre></div><h4 class="pHeading3"><a name="wp1046495"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046496"> </a>
<code class="cCode">tx_set_commit_return()</code> sets the <code class="cCodeEmphasis">commit_return</code> characteristic to the value specified in <code class="cCodeEmphasis">when_return</code>. This characteristic affects the way <code class="cCode">tx_commit()</code> behaves with respect to returning control to its caller. <code class="cCode">tx_set_commit_return()</code> may be called regardless of whether its caller is in transaction mode. This setting remains in effect until changed by a subsequent call to <code class="cCode">tx_set_commit_return()</code>.
</p>
<p class="pBody"><a name="wp1046497"> </a>
The initial setting for this characteristic is <code class="cCode">TX_COMMIT_COMPLETED</code>.
</p>
<p class="pBody"><a name="wp1046498"> </a>
The following are the valid settings for <code class="cCodeEmphasis">when_return</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1046499"> </a>
<code class="cCode">TX_COMMIT_DECISION_LOGGED</code> 
</h4><div class="pDefPara"><a name="wp1046500"> </a>
This flag indicates that <code class="cCode">tx_commit()</code> should return after the commit decision has been logged by the first phase of the two-phase commit protocol but before the second phase has completed. This setting allows for faster response to the caller of <code class="cCode">tx_commit()</code>. However, there is a risk that a transaction will have a heuristic outcome, in which case the caller will not find out about this situation via return codes from <code class="cCode">tx_commit()</code>. Under normal conditions, participants that promise to commit during the first phase will do so during the second phase. In certain unusual circumstances however (for example, long-lasting network or node failures), phase 2 completion may not be possible and heuristic results may occur.
</div>
<h4 class="pDefTerm"><a name="wp1046501"> </a>
<code class="cCode">TX_COMMIT_COMPLETED</code> 
</h4><div class="pDefPara"><a name="wp1046502"> </a>
This flag indicates that <code class="cCode">tx_commit()</code> should return after the two-phase commit protocol has finished completely. This setting allows the caller of <code class="cCode">tx_commit()</code> to see return codes that indicate that a transaction had or may have had heuristic results.
</div>
<p class="pBody"><a name="wp1632315"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_set_commit_return()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046503"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046504"> </a>
Upon successful completion, <code class="cCode">tx_set_commit_return()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046505"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046506"> </a>
Under the following conditions, <code class="cCode">tx_set_commit_return()</code> does not change the setting of the <code class="cCodeEmphasis">commit_return</code> characteristic and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046507"> </a>
[<code class="cCode">TX_EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1046508"> </a>
<code class="cCodeEmphasis">when_return</code> is not one of <code class="cCode">TX_COMMIT_DECISION_LOGGED</code> or <code class="cCode">TX_COMMIT_COMPLETED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046509"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046510"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">tx_open()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1046511"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046512"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046513"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046514"> </a>
<a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a>, <a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a>, <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046515"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046516"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046542"> </a>
tx_set_transaction_control(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046543"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046544"> </a>
<code class="cCode">tx_set_transaction_control()</code>&#8212;Sets the <code class="cCodeEmphasis">transaction_control</code> characteristic.
</p>
<h4 class="pHeading3"><a name="wp1046545"> </a>
Synopsis
</h4>
<a name="wp1046546"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_set_transaction_control(TRANSACTION_CONTROL control)</pre></div><h4 class="pHeading3"><a name="wp1046547"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046548"> </a>
<code class="cCode">tx_set_transaction_control()</code> sets the <code class="cCodeEmphasis">transaction_control</code> characteristic to the value specified in <code class="cCodeEmphasis">control</code>. This characteristic determines whether <code class="cCode">tx_commit()</code> and <code class="cCode">tx_rollback()</code> start a new transaction before returning to their caller. <code class="cCode">tx_set_transaction_control()</code> may be called regardless of whether the application program is in transaction mode. This setting remains in effect until changed by a subsequent call to <code class="cCode">tx_set_transaction_control()</code>.
</p>
<p class="pBody"><a name="wp1046549"> </a>
The initial setting for this characteristic is <code class="cCode">TX_UNCHAINED</code>.
</p>
<p class="pBody"><a name="wp1046550"> </a>
The following are the valid settings for <code class="cCodeEmphasis">control</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1046551"> </a>
<code class="cCode">TX_UNCHAINED</code> 
</h4><div class="pDefPara"><a name="wp1046552"> </a>
This flag indicates that <code class="cCode">tx_commit()</code> and <code class="cCode">tx_rollback()</code> should not start a new transaction before returning to their caller. The caller must issue <code class="cCode">tx_begin()</code> to start a new transaction.
</div>
<p class="pBody"><a name="wp1046553"> </a>
<code class="cCode">TX_CHAINED</code> 
</p>
<div class="pDefPara"><a name="wp1046554"> </a>
This flag indicates that <code class="cCode">tx_commit()</code> and <code class="cCode">tx_rollback()</code> should start a new transaction before returning to their caller.
</div>
<p class="pBody"><a name="wp1632340"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_set_transaction_control()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046555"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046556"> </a>
Upon successful completion, <code class="cCode">tx_set_transaction_control()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046557"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046558"> </a>
Under the following conditions, <code class="cCode">tx_set_transaction_control()</code> does not change the setting of the <code class="cCodeEmphasis">transaction_control</code> characteristic and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046559"> </a>
[<code class="cCode">TX_EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1046560"> </a>
<code class="cCodeEmphasis">control</code> is not one of <code class="cCode">TX_UNCHAINED</code> or <code class="cCode">TX_CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046561"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046562"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">tx_open()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1046563"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046564"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1046565"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1046566"> </a>
<a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a>, <a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a>, <a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a>, <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>, <a href="rf3c.html#wp1046426"><code class="cCode">tx_rollback(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1046567"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046568"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1046597"> </a>
tx_set_transaction_timeout(3c)
</h3>
<h4 class="pHeading3"><a name="wp1046598"> </a>
Name
</h4>
<p class="pBody"><a name="wp1046599"> </a>
<code class="cCode">tx_set_transaction_timeout()</code>&#8212;Sets the <code class="cCodeEmphasis">transaction_timeout</code> characteristic.
</p>
<h4 class="pHeading3"><a name="wp1046600"> </a>
Synopsis
</h4>
<a name="wp1046601"> </a><div class="pPreformatted"><pre>#include &lt;tx.h&gt; <br />int tx_set_transaction_timeout(TRANSACTION_TIMEOUT timeout)</pre></div><h4 class="pHeading3"><a name="wp1046602"> </a>
Description
</h4>
<p class="pBody"><a name="wp1046603"> </a>
<code class="cCode">tx_set_transaction_timeout()</code> sets the <code class="cCodeEmphasis">transaction_timeout</code> characteristic to the value specified in <code class="cCodeEmphasis">timeout</code>. This value specifies the time period in which the transaction must complete before becoming susceptible to transaction timeout; that is, the interval between the AP calling <code class="cCode">tx_begin()</code> and <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code>. <code class="cCode">tx_set_transaction_timeout()</code> may be called regardless of whether its caller is in transaction mode or not. If <code class="cCode">tx_set_transaction_timeout()</code> is called in transaction mode, the new <code class="cCode">timeout</code> value does not take effect until the next transaction.
</p>
<p class="pBody"><a name="wp1046604"> </a>
The initial <code class="cCodeEmphasis">transaction_timeout</code> value is 0 (no timeout).
</p>
<p class="pBody"><a name="wp1046605"> </a>
<code class="cCodeEmphasis">timeout</code> specifies the number of seconds allowed before the transaction becomes susceptible to transaction timeout. It may be set to any value up to the maximum value for a <code class="cCode">long</code> as defined by the system. A <code class="cCodeEmphasis">timeout</code> value of zero disables the timeout feature.
</p>
<p class="pBody"><a name="wp1632352"> </a>
In a multithreaded application, a thread in the <code class="cCode">TPINVALIDCONTEXT</code> state is not allowed to issue a call to <code class="cCode">tx_set_transaction_timeout()</code>.
</p>
<h4 class="pHeading3"><a name="wp1046606"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1046607"> </a>
Upon successful completion, <code class="cCode">tx_set_transaction_timeout()</code> returns <code class="cCode">TX_OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1046608"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1046609"> </a>
Under the following conditions, <code class="cCode">tx_set_transaction_timeout()</code> does not change the setting of the <code class="cCodeEmphasis">transaction_timeout</code> characteristic and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1046610"> </a>
[<code class="cCode">TX_EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1046611"> </a>
The timeout value specified is invalid.
</div>
<h4 class="pDefTerm"><a name="wp1046612"> </a>
[<code class="cCode">TX_PROTOCOL_ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1046613"> </a>
The function was called improperly. For example, it was called before the caller called <code class="cCode">tx_open()</code>.
</div>
<h4 class="pDefTerm"><a name="wp1046614"> </a>
[<code class="cCode">TX_FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1046615"> </a>
The transaction manager encountered an error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1887648"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1887664"> </a>
<a href="rf3c.html#wp1046168"><code class="cCode">tx_begin(3c)</code></a>, <a href="rf3c.html#wp1046266"><code class="cCode">tx_commit(3c)</code></a>, <a href="rf3c.html#wp1046331"><code class="cCode">tx_info(3c)</code></a>, <a href="rf3c.html#wp1046379"><code class="cCode">tx_open(3c)</code></a>, <a href="rf3c.html#wp1046426"><code class="cCode">tx_rollback(3c)</code></a>
</p>
<h4 class="pHeading3"><a name="wp1887665"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1046619"> </a>
Both the X/Open TX interface and the X-Windows system define the type XID. It is not possible to use both X-Windows calls and TX calls in the same file.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1049646"> </a>
userlog(3c)
</h3>
<h4 class="pHeading3"><a name="wp1049647"> </a>
Name
</h4>
<p class="pBody"><a name="wp1049648"> </a>
<code class="cCode">userlog()</code>&#8212;Writes a message to the Oracle Tuxedo ATMI system central event log.
</p>
<h4 class="pHeading3"><a name="wp1049649"> </a>
Synopsis
</h4>
<a name="wp1049650"> </a><div class="pPreformatted"><pre>#include &#8220;userlog.h&#8221; <br />extern char *proc_name; <br /> <br />int userlog (format [ ,arg] . . .) <br />char *format;</pre></div><h4 class="pHeading3"><a name="wp1049651"> </a>
Description
</h4>
<p class="pBody"><a name="wp1049652"> </a>
<code class="cCode">userlog()</code> accepts a <code class="cCode">printf</code>(3S) style format specification, with a fixed output file&#8212;the Oracle Tuxedo ATMI system central event log.
</p>
<p class="pBody"><a name="wp1049653"> </a>
The central event log is an ordinary UNIX file whose pathname is composed as follows: If the shell variable <code class="cCode">ULOGPFX</code> is set, its value is used as the prefix for the filename. If <code class="cCode">ULOGPFX</code> is not set, <code class="cCode">ULOG</code> is used. The prefix is determined the first time <code class="cCode">userlog()</code> is called. Each time <code class="cCode">userlog()</code> is called the date is determined, and the month, day, and year are concatenated to the prefix as <code class="cCode">mmddyy</code> to set the name for the file. The first time a process writes to the user log, it first writes an additional message indicating the associated Oracle Tuxedo ATMI system version. 
</p>
<p class="pBody"><a name="wp1049654"> </a>
The message is then appended to the file. With this scheme, processes that call <code class="cCode">userlog()</code> on successive days will write into different files.
</p>
<p class="pBody"><a name="wp1049655"> </a>
Messages are appended to the log file with a tag made up of the time (<code class="cCode">hhmmss</code>), system name, process name, and process ID, thread ID, and context ID of the calling process. The tag is terminated with a colon (<code class="cCode">:</code>). The name of the process is taken from the pathname of the external variable <code class="cCode">proc_name</code>. If <code class="cCode">proc_name</code> has value NULL, the printed name is set to <code class="cCode">?proc</code>.
</p>
<p class="pBody"><a name="wp1049656"> </a>
Oracle Tuxedo ATMI system-generated error messages in the log file are prefixed by a unique identification string of the form:
</p>
<a name="wp1049657"> </a><div class="pPreformatted"><pre>&lt;catalog&gt;:number&gt;:</pre></div><p class="pBody"><a name="wp1049658"> </a>
This string gives the name of the internationalized catalog containing the message string, plus the message number. By convention, Oracle Tuxedo ATMI system-generated error messages are used only once, so the string uniquely identifies a location in the source code.
</p>
<p class="pBody"><a name="wp1049659"> </a>
If the last character of the <code class="cCodeEmphasis">format</code> specification is not a newline character, <code class="cCode">userlog()</code> appends one.
</p>
<p class="pBody"><a name="wp1049660"> </a>
If the first character of the shell variable <code class="cCode">ULOGDEBUG</code> is <code class="cCode">1</code> or <code class="cCode">y</code>, the message sent to <code class="cCode">userlog()</code> is also written to the standard error of the calling process, using the <code class="cCode">fprintf</code>(3S) function.
</p>
<p class="pBody"><a name="wp1049661"> </a>
<code class="cCode">userlog()</code> is used by the Oracle Tuxedo ATMI system to record a variety of events.
</p>
<p class="pBody"><a name="wp1049662"> </a>
The <code class="cCode">userlog</code> mechanism is entirely independent of any database transaction logging mechanism.
</p>
<p class="pBody"><a name="wp1618231"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">userlog()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp2187475"> </a>
Environment Variables
</h4>
<h4 class="pDefTerm"><a name="wp2187476"> </a>
<code class="cCode">ULOGMILLISEC</code>
</h4><div class="pDefPara"><a name="wp2204460"> </a>
An on/off switch environment variable that time stamps messages sent to the userlog file in millisecond time intervals instead of seconds. If not specified, default time stamping is in seconds. The server must be rebooted when <code class="cCode">ULOGMILLISEC</code> is turned on or off.<br />Example: <code class="cCode">ULOGMILLISEC=Y</code>
</div>
<h4 class="pDefTerm"><a name="wp2204462"> </a>
<code class="cCode">ULOGRTNSIZE</code>
</h4><div class="pDefPara"><a name="wp2187479"> </a>
An on/off switch environment variable that specifies the userlog rotation file size. The default rotation file size is 2GB. The server must be rebooted when <code class="cCode">ULOGRTNSIZE</code> is turned on or off. <br />Example: <code class="cCode">ULOGRTNSIZE=1000000</code> (when the file size is 1Mb)
</div>
<div class="pDefParaCont"><a name="wp2204486"> </a>
Rotated files are saved in using the following syntax: filename.nn. <br />Example:<code class="cCode"> ULOG.083103.1</code>, <code class="cCode">ULOG.083103.2</code> ... <code class="cCode">ULOG.083103.10</code>, etc.
<a name="wp2204578"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If <code class="cCode">ULOGRTNSIZE</code> is not specified, file rotation does not take place.</td>
</tr>
</table>

</div>
<h4 class="pHeading3"><a name="wp2204488"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1049664"> </a>
The <code class="cCode">userlog()</code> interface is supported on UNIX and MS-DOS operating systems. The system name produced as part of the log message is not available on MS-DOS systems; therefore, the value <code class="cCode">PC</code> is used as the system name for MS-DOS systems.
</p>
<h4 class="pHeading3"><a name="wp1049665"> </a>
Examples
</h4>
<p class="pBody"><a name="wp1049666"> </a>
If the variable <code class="cCode">ULOGPFX</code> is set to <code class="cCode">/application/logs/log</code> and if the first call to <code class="cCode">userlog()</code> occurred on 9/7/90, the log file created is named <code class="cCode">/application/logs/log.090790</code>. If the call: 
</p>
<a name="wp1049667"> </a><div class="pPreformatted"><pre>userlog(&#8220;UNKNOWN USER &#39;%s&#39; (UID=%d)&#8221;, usrname, UID); </pre></div><p class="pBody"><a name="wp1049668"> </a>
is made at 4:22:14pm on the UNIX system file named <code class="cCode">m1</code> by the <code class="cCode">sec</code> program, whose process-id is 23431, and the variable <code class="cCode">usrname</code> contains the string &#8220;sxx&#8221;, and the variable <code class="cCode">UID</code> contains the integer 123, the following line appears in the log file: 
</p>
<a name="wp1049669"> </a><div class="pPreformatted"><pre>162214.m1!sec.23431: UNKNOWN USER &#39;sxx&#39; (UID=123) </pre></div><p class="pBody"><a name="wp1049670"> </a>
If the message is sent to the central event log while the process is in transaction mode, the user log entry has additional components in the tag. These components consist of the literal <code class="cCode">gtrid</code> followed by three <code class="cCode">long</code> hexadecimal integers. The integers uniquely identify the global transaction and make up what is referred to as the global transaction identifier. This identifier is used mainly for administrative purposes, but it does make an appearance in the tag that prefixes the messages in the central event log. If the foregoing message is written to the central event log in transaction mode, the resulting log entry will look like this: 
</p>
<a name="wp1049671"> </a><div class="pPreformatted"><pre>162214.logsys!security.23431: gtrid x2 x24e1b803 x239: UNKNOWN USER &#39;sxx&#39; (UID=123) </pre></div><p class="pBody"><a name="wp1049672"> </a>
If the shell variable <code class="cCode">ULOGDEBUG</code> has a value of <code class="cCode">y</code>, the log message is also written to the standard error of the program named <code class="cCode">security</code>.
</p>
<h4 class="pHeading3"><a name="wp1049673"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1049674"> </a>
<code class="cCode">userlog()</code> hangs if the message sent to it is larger than <code class="cCode">BUFSIZ</code> as defined in <code class="cCode">stdio.h</code>
</p>
<h4 class="pHeading3"><a name="wp1049675"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp1049676"> </a>
<code class="cCode">userlog()</code> returns the number of characters output, or a negative value if an output error was encountered. Output errors include the inability to open, or write to the current log file. Inability to write to the standard error, when <code class="cCode">ULOGDEBUG</code> is set, is not considered an error.
</p>
<h4 class="pHeading3"><a name="wp1049677"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1049678"> </a>
It is recommended that applications&#8217; use of <code class="cCode">userlog()</code> messages be limited to messages that can be used to help debug application errors; flooding the log with incidental information can make it hard to spot actual errors.
</p>
<h4 class="pHeading3"><a name="wp2187588"> </a>
See Also
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp2187589"> </a><code class="cCode">printf</code>(3S) in a UNIX system reference manual</li>
<li><a name="wp2187593"> </a><span style="font-style: italic">Using Log Files to Monitor Activity</span> in <span style="font-style: italic"><a href="../ada/admon.html">Monitoring Your Oracle Tuxedo Application</a></span> in Administering an Oracle Tuxedo Application at Run Time</li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1049719"> </a>
Usignal(3c)
</h3>
<h4 class="pHeading3"><a name="wp1049720"> </a>
Name
</h4>
<p class="pBody"><a name="wp1049721"> </a>
<code class="cCode">Usignal()</code>&#8212;Signal handling in an Oracle Tuxedo ATMI system environment.
</p>
<h4 class="pHeading3"><a name="wp1049722"> </a>
Synopsis
</h4>
<a name="wp1049723"> </a><div class="pPreformatted"><pre>#include &#8220;Usignal.h&#8221; <br /> <br />UDEFERSIGS() <br />UENSURESIGS() <br />UGDEFERLEVEL() <br />URESUMESIGS() <br />USDEFERLEVEL(level) <br /> <br />int (*Usignal(sig,func)() <br />int sig; <br />int (*func)(); <br /> <br />void Usiginit()</pre></div><h4 class="pHeading3"><a name="wp1049724"> </a>
Description
</h4>
<p class="pBody"><a name="wp1049725"> </a>
Many of the facilities provided by the Oracle Tuxedo ATMI system software require concurrent access to data structures in shared memory. Processes accessing the shared data structures run in user mode, and are thus interruptible by signals sent to them. In order to ensure the consistency of the shared data structures, it is important that the operations which access them not be interrupted by the receipt of certain UNIX signals. The functions described in this section provide protection against the most common signals, and are used internally by much of the Oracle Tuxedo ATMI system code. Additionally, they are available to applications to prevent the untimely arrival of a signal.
</p>
<p class="pBody"><a name="wp1049726"> </a>
The idea behind the Oracle Tuxedo ATMI system signal handling package is that signals should be deferrable while in critical code sections. To this end, signals are not immediately processed when received. Instead, an Oracle Tuxedo ATMI system routine first catches the sent signal. If it is safe to process the signal, the specified action for the signal is taken. If it is not safe to process the signal when it arrives, the arrival is noted, but the processing is deferred until the user indicates that the critical section of code has been terminated.
</p>
<p class="pBody"><a name="wp1618255"> </a>
We recommend against any use of signals in multithreaded programs, although the software does not prevent such usage. If signals are used, however, a thread in a multithreaded application may issue a call to <code class="cCode">Usignal()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1049727"> </a>
Catching Signals
</h4>
<p class="pBody"><a name="wp1049728"> </a>
User code that uses calls <code class="cCode">rmopen()</code> or <code class="cCode">tpinit()</code> should catch signals through the use of the <code class="cCode">Usignal()</code> function. <code class="cCode">Usignal()</code> behaves like the UNIX <code class="cCode">signal()</code> system call, except that <code class="cCode">Usignal()</code> first arranges for the signal to be caught by an internal routine before dispatching the user routine.
</p>
<h4 class="pHeading3"><a name="wp1049729"> </a>
Deferring and Restoring Signals
</h4>
<p class="pBody"><a name="wp1049730"> </a>
The calls described in this section need only be used if application code wishes to defer signals. In general, these routines are called automatically by Oracle Tuxedo ATMI system routines to protect themselves from untimely signal arrival.
</p>
<p class="pBody"><a name="wp1049731"> </a>
Before deferring or restoring signals, the mechanism must be initialized. This is done automatically for Oracle Tuxedo ATMI system clients when they call <code class="cCode">tpinit()</code> and for Oracle Tuxedo ATMI system servers. It is also done the first time that the application calls <code class="cCode">Usignal()</code>. It can be done explicitly by calling <code class="cCode">Usiginit()</code>.
</p>
<p class="pBody"><a name="wp1049732"> </a>
The <code class="cCode">UDEFERSIGS()</code> macro should be used when entering a section of critical code. After <code class="cCode">UDEFERSIGS()</code> is called, signals are held in a pending state. The <code class="cCode">URESUMESIGS()</code> macro should be invoked when the critical section is exited. Note that signal deferrals stack. The stack is implemented via a counter which is initially set to zero. When signals are deferred by a call to <code class="cCode">UDEFERSIGS()</code>, the counter is incremented. When signals are resumed, by a call to <code class="cCode">URESUMESIGS()</code>, the counter is decremented. If a signal arrives while the counter is non-zero, the processing of the signal is deferred. If the counter is zero when the signal arrives, the signal is processed immediately. If signal resumption causes the counter to be become zero (that is, prior to the resumption it had value 1), any signals that arrived during the deferral period are processed. In general, each call to <code class="cCode">UDEFERSIGS()</code> should have a counterpart call to <code class="cCode">URESUMESIGS()</code>.
</p>
<p class="pBody"><a name="wp1049733"> </a>
<code class="cCode">UDEFERSIGS</code> increments the deferral counter, but returns the value of the counter prior to its incrementation. The macro <code class="cCode">UENSURESIGS()</code> may be used to explicitly set the deferral counter to zero (and thus force the processing of deferred signals), in case the user wishes to protect against unmatching <code class="cCode">UDEFERSIGS()</code> and <code class="cCode">URESUMESIGS()</code>.
</p>
<p class="pBody"><a name="wp1049734"> </a>
The function <code class="cCode">UGDEFERLEVEL()</code> returns the current setting of the deferral counter. The macro <code class="cCode">USDEFERLEVEL</code>(level) allows the setting of a specific deferral level. <code class="cCode">UGDEFERLEVEL()</code> and <code class="cCode">USDEFERLEVEL()</code> are useful to set the counter appropriately in <code class="cCode">setjmp/longjmp</code> situations where a set of deferrals/resumes are bypassed. The idea is to save the value of the counter when <code class="cCode">setjmp()</code> is called, via a call to <code class="cCode">UGDEFERLEVEl()</code>, and to restore it via a call to <code class="cCode">USDEFERLEVel()</code> when the <code class="cCode">longjmp()</code> is performed.
</p>
<h4 class="pHeading3"><a name="wp1049735"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1049736"> </a>
<code class="cCode">Usignal</code> provides signal deferral for the following signals: <code class="cCode">SIGHUP</code>,<code class="cCode">SIGINT</code>, <code class="cCode">SIGQUIT</code>, <code class="cCode">SIGALRM</code>, <code class="cCode">SIGTERM</code>,<code class="cCode"> SIGUSR1, </code>and <code class="cCode">SIGUSR2</code>. Handling requests for all other signal numbers are passed directly to <code class="cCode">signaL()</code> by <code class="cCode">Usignal()</code>. Signals may be deferred for a considerable time. For this reason, during signal deferral, individual signal arrivals are counted. When it is safe to process a signal that may have arrived many times, the signal&#8217;s processing routine is iteratively called to process each arrival of the signal. Before each call the default action for the signal is instantiated. The idea is to handle the deferred occurrences of the signal as if they happened in quick succession in safe code.
</p>
<p class="pBody"><a name="wp1049737"> </a>
In general, users should not mix calls to <code class="cCode">signaL()</code> and <code class="cCode">UsignaL()</code> for the same signal. The recommended procedure is to go through <code class="cCode">Usignal()</code>, so that it is always aware of the state of the signal. Sometimes it may be necessary, such as when an application wants to use alarms within Oracle Tuxedo ATMI system services. To do this, <code class="cCode">UsiginiT()</code> should be called to initialize the signal deferring mechanism. Then <code class="cCode">signaL()</code> can be called to override the mechanism for the desired signal. To restore the deferring mechanism for the signal, it is necessary to call <code class="cCode">UsignaL()</code> for the signal with <code class="cCode">SIG_IGN</code>, and then again with the desired signal-handling function.
</p>
<p class="pBody"><a name="wp1049738"> </a>
The shell variable <code class="cCode">UIMMEDSIGS</code> can be used to override the deferral of signals. If the value of this variable begins with the letter <code class="cCode">y</code> as in: 
</p>
<a name="wp1049739"> </a><div class="pPreformatted"><pre>UIMMEDSIGS=y </pre></div><p class="pBody"><a name="wp1049740"> </a>
signals are not intercepted (and thus not deferred) by the <code class="cCode">Usignal()</code> code. In such a case, a call to <code class="cCode">Usignal()</code> is passed immediately to <code class="cCode">signaL()</code>.
</p>
<p class="pBody"><a name="wp1049741"> </a>
<code class="cCode">Usignal</code> is not available under DOS operating systems.
</p>
<h4 class="pHeading3"><a name="wp1049742"> </a>
Files
</h4>
<p class="pBody"><a name="wp1049743"> </a>
<code class="cCode">Usignal.h</code>
</p>
<h4 class="pHeading3"><a name="wp1049744"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1049745"> </a>
<code class="cCode">signal</code>(2) in a UNIX system reference manual
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1049777"> </a>
Uunix_err(3c)
</h3>
<h4 class="pHeading3"><a name="wp1049778"> </a>
Name
</h4>
<p class="pBody"><a name="wp1049779"> </a>
<code class="cCode">Uunix_err()</code>&#8212;Prints a UNIX system call error.
</p>
<h4 class="pHeading3"><a name="wp1049780"> </a>
Synopsis
</h4>
<a name="wp1049781"> </a><div class="pPreformatted"><pre>#include Uunix.h <br /> <br />void Uunix_err(s) <br />char *s;</pre></div><h4 class="pHeading3"><a name="wp1049782"> </a>
Description
</h4>
<p class="pBody"><a name="wp1049783"> </a>
When an Oracle Tuxedo ATMI system function calls a UNIX system call that detects an error, an error is returned. The external integer <code class="cCode">Uunixerr()</code> is set to a value (as defined in <code class="cCode">Uunix.h</code>) that identifies the system call that returned the error. In addition, the system call sets <code class="cCode">errno()</code> to a value (as defined in <code class="cCode">errno.h</code>) that tells why the system call failed.
</p>
<p class="pBody"><a name="wp1049784"> </a>
The <code class="cCode">Uunix_err()</code> function is provided to produce a message on the standard error output, describing the last system call error encountered during a call to an Oracle Tuxedo ATMI system function. It takes one argument, a string. The function prints the argument string, then a colon and a blank, followed by the name of the system call that failed, the reason for failure, and a newline. To be of most use, the argument string should include the name of the program that incurred the error. The system call error number is taken from the external variable <code class="cCode">Uunixerr()</code>, the reason is taken from <code class="cCode">errno()</code>. Both variables are set when errors occur. They are not cleared when non-erroneous calls are made.
</p>
<p class="pBody"><a name="wp1049785"> </a>
To simplify variant formatting of messages, the array of message strings: 
</p>
<a name="wp1049786"> </a><div class="pPreformatted"><pre>extern char *Uunixmsg[]; </pre></div><p class="pBody"><a name="wp1049787"> </a>
is provided; <code class="cCode">Uunixerr()</code> can be used as an index into this table to get the name of the system call that failed (without the newline).
</p>
<p class="pBody"><a name="wp1618275"> </a>
A thread in a multithreaded application may issue a call to <code class="cCode">Uunix_err()</code> while running in any context state, including <code class="cCode">TPINVALIDCONTEXT</code>.
</p>
<h4 class="pHeading3"><a name="wp1049788"> </a>
Examples
</h4>
<a name="wp1049789"> </a><div class="pPreformatted"><pre>#include Uunix.h <br />extern int Uunixerr, errno;<br /> <br />  ..........  <br />   if((fd=open(&#8220;myfile&#8221;, 3, 0660)) == -1)</pre></div><a name="wp1791066"> </a><div class="pPreformatted"><pre>       { <br />       Uunixerr = UOPEN;  <br />       Uunix_err(&#8220;myprog&#8221;);  <br />       exit(1); <br />       }</pre></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="rf3c.html"><img id="LongDescNotReq66" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq67" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq68" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
