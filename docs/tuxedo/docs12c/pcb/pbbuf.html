<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/pcb/fm/pbbuf.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:23:23" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Managing Typed Records</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Programming an Oracle Tuxedo Application Using COBOL
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="pbenv.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="pbclt.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/pcb.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1271238"> </a>
Managing Typed Records
</h1>
<p class="pBody"><a name="wp1251796"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1266426"> </a><a href="pbbuf.html#wp1266544">Overview of Typed Records</a></li>
<li><a name="wp1266430"> </a><a href="pbbuf.html#wp1266946">Defining Typed Records</a></li>
<li><a name="wp1266454"> </a><a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a></li>
<li><a name="wp1266498"> </a><a href="pbbuf.html#wp1267873">Using an FML Typed Record</a></li>
<li><a name="wp1266522"> </a><a href="pbbuf.html#wp1268201">Using an XML Typed Record</a></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1266544"> </a>
Overview of Typed Records
</h2><p class="pBody"><a name="wp1127043"> </a>
In order to send data to another application program, the sending program first places the data in a record. Oracle Tuxedo ATMI clients use typed records to send messages to ATMI servers. The term &#8220;typed record&#8221; refers to a pair of COBOL records: a data record and an auxiliary type record. The data record is defined in static storage and contains application data to be passed to another application program. An auxiliary type record accompanies the data record. It specifies the interpretation and translation rules of the data record to be used by the Oracle Tuxedo system when passing the information between heterogeneous systems. Typed records make up one of the fundamental features of the distributed programming environment supported by the Oracle Tuxedo system. 
</p>
<p class="pBody"><a name="wp1127044"> </a>
Why<span style="font-style: italic"> typed</span>? In a distributed environment, an application may be installed on heterogeneous systems that communicate across multiple networks using different protocols. Different types of records require different routines to initialize, send and receive messages, and encode and decode data. Each record is designated as a specific type so that the appropriate routines can be called automatically without programmer intervention.
</p>
<p class="pBody"><a name="wp1127045"> </a>
<a href="pbbuf.html#wp1238181">Table&#160;3-1</a> lists the typed records supported by the Oracle Tuxedo system and indicates whether or not:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127046"> </a>The record is <em class="cEmphasis">self-describing</em>; in other words, the record data type and length can be determined simply by (a) knowing the type and subtype, and (b) looking at the data.</li>
<li><a name="wp1127047"> </a>The record requires a subtype.</li>
<li><a name="wp1127048"> </a>The system supports data-dependent routing for the typed record.</li>
<li><a name="wp1127049"> </a>The system supports encoding and decoding for the typed record.</li>
</ul></div>
<p class="pBody"><a name="wp1127050"> </a>
If any routing routines are required, the application programmer must provide them as part of the application.<span style="font-weight: bold">Records</span>.
</p>
<p class="pGraphic"><a name="wp1271669"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1238181table1127051"><caption><a name="wp1238181"> </a>
Table 3-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Typed Buffers&#160;</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1127053"> </a>
Typed Record
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127055"> </a>
Description
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127057"> </a>
Self-<br />Describing
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127059"> </a>
Subtype 
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127061"> </a>
Data-<br />Dependent Routing
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127063"> </a>
Encoding/<br />Decoding
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127065"> </a>
<code class="cCode">CARRAY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127067"> </a>
Undefined array of characters, any of which can be LOW-VALUE. This typed record is used to handle the data opaquely, as the Oracle Tuxedo system does not interpret the semantics of the array. Because a <code class="cCode">CARRAY</code> is not self-describing, the length must always be provided during transmission. Encoding and decoding are not supported for messages sent between machines because the bytes are not interpreted by the system.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127069"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127071"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127073"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127075"> </a>
No
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127077"> </a>
<code class="cCode">FML</code> (Field Manipulation Language) 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127079"> </a>
Proprietary Oracle Tuxedo system type of self-describing record in which each data field carries its own identifier, an occurrence number, and possibly a length indicator. T record offers data-independence and greater flexibility
</div>
<div class="pCellBody"><a name="wp1127080"> </a>
The <code class="cCode">FML</code> record uses 16 bits for field identifiers and lengths of fields. 
</div>
<div class="pCellBody"><a name="wp1127083"> </a>
Refer to <a href="pbbuf.html#wp1267873">Using an FML Typed Record</a> for more information.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127086"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127088"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127090"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127092"> </a>
Yes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127094"> </a>
<code class="cCode">FML32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127096"> </a>
Equivalent to <code class="cCode">FML</code> but uses 32 bits for field identifiers and lengths of fields, which allows for larger and more fields and, consequently, larger overall records. 
</div>
<div class="pCellBody"><a name="wp1268864"> </a>
However, the <code class="cCode">FML</code> routines that are available for manipulating the <code class="cCode">FML</code> typed record in the C programming language are not available in COBOL.The primary use of <code class="cCode">FML32</code> in COBOL is simply to work with C programs in which <code class="cCode">VIEW32</code> or <code class="cCode">FML32</code> typed records are used.
</div>
<div class="pCellBody"><a name="wp1127100"> </a>
Refer to <a href="pbbuf.html#wp1267873">Using an FML Typed Record</a> for more information.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127103"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127105"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127107"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127109"> </a>
Yes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127111"> </a>
<code class="cCode">STRING</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127113"> </a>
Array of characters that terminates with a LOW-VALUE character. The Oracle Tuxedo system can convert data automatically when data is exchanged by machines with different character sets.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127115"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127117"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127119"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127121"> </a>
No
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127123"> </a>
<code class="cCode">VIEW</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127125"> </a>
COBOL data structure defined by the application. <code class="cCode">VIEW</code> types must have subtypes that designate individual data structures. A <span class="cHyperlink">
<a href="pbbuf.html#wp1127546">view description file</a></span>, in which the fields and types that appear in the data structure are defined, must be available to client and server processes that use a data structure described in a <code class="cCode">VIEW</code> typed record. Encoding and decoding are performed automatically if the record is passed between machines of different types. Refer to <a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a> for more information.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127131"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127133"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127135"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127137"> </a>
Yes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127139"> </a>
<code class="cCode">VIEW32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127141"> </a>
Equivalent to <code class="cCode">VIEW</code> but uses 32 bits for length and count fields, which allows for larger and more fields and, consequently, larger overall records.
</div>
<div class="pCellBody"><a name="wp1269043"> </a>
The primary use of <code class="cCode">VIEW32</code> in COBOL is simply to work with C programs in which <code class="cCode">VIEW32</code> or <code class="cCode">FML32</code> typed records are used.
</div>
<div class="pCellBody"><a name="wp1127145"> </a>
Refer to <a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a> for more information.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127148"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127150"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127152"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127154"> </a>
Yes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127168"> </a>
<code class="cCode">X_COMMON</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127170"> </a>
Equivalent to <code class="cCode">VIEW</code>, but used for compatibility between COBOL and C programs. Field types should be limited to short, long, and string.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127172"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127174"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127176"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127178"> </a>
Yes
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127180"> </a>
<code class="cCode">XML</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127182"> </a>
An XML document that consists of:
</div>
<div class="pSmartList1TableBullet"><ul class="SmartList1TableBullet">
<li><a name="wp1127183"> </a>Text, in the form of a sequence of encoded characters</li>
<li><a name="wp1146626"> </a>A description of the logical structure of the document and information about that structure</li>
</ul></div>
<div class="pCellBody"><a name="wp1127185"> </a>
The routing of an XML document can be based on element content, or on element type and an attribute value. The XML parser determines the character encoding being used; if the encoding differs from the native character sets (US-ASCII or EBCDIC) used in the Oracle Tuxedo configuration files (<a href="../rf5/rf5.html">UBBCONFIG(5)</a> and <a href="../rf5/rf5.html">DMCONFIG(5)</a>), the element and attribute names are converted to US-ASCII or EBCDIC. Refer to <a href="pbbuf.html#wp1268201">Using an XML Typed Record</a> for more information.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127190"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127192"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127194"> </a>
Yes
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127196"> </a>
No
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127198"> </a>
<code class="cCode">X_OCTET</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127200"> </a>
Equivalent to <code class="cCode">CARRAY</code>.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127202"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127204"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127206"> </a>
No
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127208"> </a>
No
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1127210"> </a>
All record types are defined in a file called <code class="cCode">tmtypesw.c</code> in the <code class="cCode">$TUXDIR/lib</code> directory. Only record types defined in <code class="cCode">tmtypesw.c</code> are known to your client and server programs. You can edit the <code class="cCode">tmtypesw.c</code> file to add or remove record types. In addition, you can use the <code class="cCode">BUFTYPE</code> parameter (in <code class="cCode">UBBCONFIG</code>) to restrict the types and subtypes that can be processed by a given service. 
</p>
<p class="pBody"><a name="wp1127211"> </a>
The <code class="cCode">tmtypesw.c</code> file is used to build a shared object or dynamic link library. This object is dynamically loaded by both Oracle Tuxedo administrative servers, and application clients and servers.
</p>
<h3 class="pHeading2"><a name="wp1127212"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127216"> </a> <a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a></li>
<li><a name="wp1266900"> </a><a href="pbbuf.html#wp1267873">Using an FML Typed Record</a></li>
<li><a name="wp1266924"> </a><a href="pbbuf.html#wp1268201">Using an XML Typed Record</a></li>
<li><a name="wp1127227"> </a><a href="../rf5/rf5.html">tuxtypes(5)</a> in the <em class="cEmphasis">File Formats, Data Descriptions, MIBs, and System Processes Reference</em></li>
<li><a name="wp1127231"> </a><a href="../rf5/rf5.html">UBBCONFIG(5)</a> in the <em class="cEmphasis">File Formats, Data Descriptions, MIBs, and System Processes Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1266946"> </a>
Defining Typed Records
</h2><p class="pBody"><a name="wp1266947"> </a>
The <code class="cCode">TPTYPE-REC</code> COBOL structure is used whenever sending or receiving application data. 
</p>
<p class="pBody"><a name="wp1266965"> </a>
The following table lists the <code class="cCode">TPTYPE-REC</code> structure fields.
</p>
<p class="pGraphic"><a name="wp1271687"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1266950table1266948">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1266950"> </a>
Field
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1266952"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266954"> </a>
<code class="cCode">REC-TYPE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266956"> </a>
Specifies which record type the application wishes to send or receive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266958"> </a>
<code class="cCode">SUB-TYPE</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266960"> </a>
Specifies the subtype of the record type, if further classification is required (as it is, for example, in a <code class="cCode">VIEW</code> record). 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266962"> </a>
<code class="cCode">LEN</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1266964"> </a>
When data is being sent, specifies the number of bytes to be sent. After a successful transfer, <code class="cCode">LEN</code> contains the number of bytes transferred. When data is being received, <code class="cCode">LEN</code> in <code class="cCode">TPTYPE-REC</code> specifies the number of bytes to be moved into the data record. After a successful call, <code class="cCode">LEN</code> contains the number of bytes moved into the data record. If the size of the incoming message is larger than the size specified in <code class="cCode">LEN</code>, the data is truncated, all data after the <code class="cCode">LEN</code> length is reached is discarded, and <code class="cCode">TPTYPE-STATUS</code> is set to <code class="cCode">TPTRUNCATE</code>.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1266966"> </a>
The following shows the <code class="cCode">TPTYPE</code> data structure:
</p>
<a name="wp1266967"> </a><div class="pPreformattedRelative"><pre>05 REC-TYPE PIC X(8).<br />  88 X-OCTET VALUE &#8220;X_OCTET&#8221;.<br />  88 X-COMMON VALUE &#8220;X_COMMON&#8221;.<br />05 SUB-TYPE PIC X(16).<br />05 LEN PIC S9(9) COMP-5.<br />  88 NO-LENGTH VALUE 0.<br />05 TPTYPE-STATUS PIC S9(9) COMP-5.<br />  88 TPTYPEOK  VALUE 0.<br />  88 TPTRUNCATE VALUE 1.</pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1266973"> </a>
Using a VIEW Typed Record
</h2><p class="pBody"><a name="wp1127507"> </a>
There are two kinds of <code class="cCode">VIEW</code> typed records. The first, <code class="cCode">FML VIEW</code>, is a COBOL record generated from an <code class="cCode">FML</code> record. The second is simply an independent COBOL record. 
</p>
<p class="pBody"><a name="wp1128322"> </a>
The reason for converting <code class="cCode">FML</code> records into COBOL records and back again (and the purpose of the <code class="cCode">FML VIEW</code> typed records) is that FML functions are not available in the COBOL programming environment. 
</p>
<p class="pBody"><a name="wp1128326"> </a>
For more information on the <code class="cCode">FML</code> typed record, refer to the <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>.
</p>
<p class="pBody"><a name="wp1128327"> </a>
To use <code class="cCode">VIEW</code> typed records, you must perform the following steps:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127515"> </a><span class="cHyperlink">
<a href="pbbuf.html#wp1127521">Set the appropriate environment variables</a></span>.</li>
<li><a name="wp1127517"> </a><span class="cHyperlink">
<a href="pbbuf.html#wp1127546">Describe each structure in view description files</a></span>.</li>
<li><a name="wp1127519"> </a><span class="cHyperlink">
Compile the view description files using </span>viewc -C<a href="pbbuf.html#wp1127615">, the Oracle Tuxedo view compiler</a>. By running this command you will produce one or more COBOL <code class="cCode">COPY</code> files (one per view), each of which contains data description records. These records can be used in the <code class="cCode">LINKAGE</code> section or the <code class="cCode">WORKING STORAGE</code> section of the <code class="cCode">DATA DIVISION</code>, according to the demands of the program.</li>
</ul></div>
<h3 class="pHeading2"><a name="wp1127521"> </a>
Setting Environment Variables for a VIEW Typed Record
</h3>
<p class="pBody"><a name="wp1127522"> </a>
To use a <code class="cCode">VIEW</code> typed record in an application, you must set the following environment variables shown in <a href="pbbuf.html#wp258062">Table&#160;3-2</a>.
</p>
<p class="pGraphic"><a name="wp1127544"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp258062table1127523"><caption><a name="wp258062"> </a>
Table 3-2  Environment Variables for a VIEW Typed Record

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1127525"> </a>
Environment Variable
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127527"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127529"> </a>
<code class="cCode">FIELDTBLS</code> or <code class="cCode">FIELDTBLS32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127531"> </a>
Comma-separated list of field table filenames for <code class="cCode">FML</code> or <code class="cCode">FML32</code> typed records. Required only for <code class="cCode">FML</code> <code class="cCode">VIEW</code> types.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127533"> </a>
<code class="cCode">FLDTBLDIR</code> or <code class="cCode">FLDTBLDIR32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127535"> </a>
Colon-separated list of directories to search for the field table files for <code class="cCode">FML</code> and <code class="cCode">FML32</code> typed records. For Microsoft Windows, use a semicolon-separated list. Required only for <code class="cCode">FML</code> <code class="cCode">VIEW</code> types.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127537"> </a>
<code class="cCode">VIEWFILES</code> or <code class="cCode">VIEWFILES32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127539"> </a>
Comma-separated list of allowable <code class="cCode">f</code>ilenames for <code class="cCode">VIEW</code> or <code class="cCode">VIEW32</code> description files.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127541"> </a>
<code class="cCode">VIEWDIR</code> or <code class="cCode">VIEWDIR32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127543"> </a>
Colon-separated list of directories to search for <code class="cCode">VIEW</code> or <code class="cCode">VIEW32</code> files. For Microsoft Windows, use a semicolon-separated list.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1127546"> </a>
Creating a View Description File
</h3>
<p class="pBody"><a name="wp1127547"> </a>
To use a <code class="cCode">VIEW</code> typed record, you must define the COBOL record in a view description file. The view description file includes, a view for each entry, a view that describes the characteristic COBOL procedure mapping and the potential <code class="cCode">FML</code> conversion pattern. The name of the view corresponds to the name of the copy file that is included in COBOL program. 
</p>
<p class="pBody"><a name="wp1128201"> </a>
The following format is used for each record in the view description file:
</p>
<p class="pBody"><a name="wp1128202"> </a>
<code class="cCode">$ /* View structure */<br />  VIEW viewname<br />  </code><code class="cCodeEmphasis">type    cname     fbname   count   flag    size    null</code>
</p>
<p class="pBody"><a name="wp1127550"> </a>
<a href="pbbuf.html#wp1265402">Table&#160;3-3</a> describes the fields that must be specified in the view description file for each COBOL record.
</p>
<p class="pGraphic"><a name="wp1265337"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1265402table1265354"><caption><a name="wp1265402"> </a>
Table 3-3  View Description File Fields&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1265418"> </a>
Field
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1265420"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265425"> </a>
<code class="cCodeEmphasis">type</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265427"> </a>
Data type of the field. Can be set to <code class="cCode">short</code>, <code class="cCode">long</code>, <code class="cCode">float</code>, <code class="cCode">double</code>, <code class="cCode">char</code>, <code class="cCode">string</code>, or <code class="cCode">carray</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265429"> </a>
<code class="cCodeEmphasis">cname</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265431"> </a>
Name of the field as it appears in the COBOL record. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265433"> </a>
<code class="cCodeEmphasis">fbname</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265435"> </a>
If you will be using the <code class="cCode">FML</code>-to-<code class="cCode">VIEW</code> or <code class="cCode">VIEW</code>-to-<code class="cCode">FML</code> conversion routines, this field must be included to indicate the corresponding <code class="cCode">FML</code> name. This field name must also appear in the FML <span class="cHyperlink">
<a href="pbbuf.html#wp1127688">field table file</a></span>. This field is not required for FML-independent VIEWs.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265438"> </a>
<code class="cCodeEmphasis">count</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265440"> </a>
Number of times field occurs.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265442"> </a>
<code class="cCodeEmphasis">flag</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265444"> </a>
Specifies any of the following optional flag settings:
</div>
<div class="pSmartList1TableBullet"><ul class="SmartList1TableBullet">
<li><a name="wp1265445"> </a>P&#8212;change the interpretation of the LOW-VALUE value</li>
<li><a name="wp1265446"> </a>S&#8212;one-way mapping from fielded record to structure</li>
<li><a name="wp1265447"> </a>F&#8212;one-way mapping from structure to fielded record</li>
<li><a name="wp1265448"> </a>N&#8212;zero-way mapping</li>
<li><a name="wp1265449"> </a>C&#8212;generate additional field for associated count member (ACM)</li>
<li><a name="wp1265450"> </a>L&#8212;hold number of bytes transferred for <code class="cCode">STRING</code> and <code class="cCode">CARRAY</code></li>
</ul></div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265452"> </a>
<code class="cCodeEmphasis">size</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265454"> </a>
For <code class="cCode">STRING</code> and <code class="cCode">CARRAY</code> record types, specifies the maximum length of the value. This field is ignored for all other record types. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265456"> </a>
<code class="cCodeEmphasis">null</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1265458"> </a>
User-specified LOW-VALUE value, or minus sign (<code class="cCode">-</code>) to indicate the default value for a field. LOW-VALUE values are used in <code class="cCode">VIEW</code> typed records to indicate empty COBOL record members. 
</div>
<div class="pCellBody"><a name="wp1265459"> </a>
The default LOW-VALUE value for all numeric types is 0 (0.0 for <code class="cCode">dec_t</code>). For character types, the default LOW-VALUE value is ‘<code class="cCode">\0</code>&#8217;. For <code class="cCode">STRING</code> and <code class="cCode">CARRAY</code> types, the default LOW-VALUE value is &#8220; &#8221;. 
</div>
<div class="pCellBody"><a name="wp1265460"> </a>
Constants used, by convention, as escape characters can also be used to specify a LOW-VALUE value. The view compiler recognizes the following escape constants: <code class="cCode">\ddd</code> (where <code class="cCode">d</code> is an octal digit), <code class="cCode">\0</code>, <code class="cCode">\n</code>, <code class="cCode">\t</code>, <code class="cCode">\v</code>, <code class="cCode">\r</code>, <code class="cCode">\f</code>, <code class="cCode">\\</code>, <code class="cCode">\&#8217;</code>, and <code class="cCode">\&#8221;</code>. 
</div>
<div class="pCellBody"><a name="wp1265461"> </a>
You may enclose <code class="cCode">STRING</code>, <code class="cCode">CARRAY</code>, and LOW-VALUE values in double or single quotes. The view compiler does not accept unescaped quotes within a user-specified LOW-VALUE value. 
</div>
<div class="pCellBody"><a name="wp1265462"> </a>
You can also specify the keyword NONE in the LOW-VALUE field of a view member description, which means that there is no LOW-VALUE value for the member. The maximum size of default values for string and character array members is 2660 characters. For more information, refer to the <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1127599"> </a>
You can include a comment line by prefixing it with the # or $ character. Lines prefixed by a $ sign are included in the <code class="cCode">.h</code> file. 
</p>
<p class="pBody"><a name="wp1127600"> </a>
<a href="pbbuf.html#wp1127604">Listing&#160;3-1</a> is an excerpt from an example view description file based on an <code class="cCode">FML</code> record. In this case, the <code class="cCodeEmphasis">fbname</code> field must be specified and match that which appears in the corresponding <span class="cHyperlink">
<a href="pbbuf.html#wp1127688">field table file</a></span>. Note that the <code class="cCode">CARRAY1</code> field includes an occurrence count of <code class="cCode">2</code> and sets the <code class="cCode">C</code> flag to indicate that an additional count element should be created. In addition, the <code class="cCode">L</code> flag is set to establish a length element that indicates the number of characters with which the application populates the <code class="cCode">CARRAY1</code> field.
</p>
<div class="pCodeTitle"><a name="wp1127604"> </a>
Listing&#160;3-1	   View Description File for FML VIEW
</div> <a name="wp1127605"> </a><div class="pPreformatted"><pre>$ /* View structure */<br />  VIEW MYVIEW<br />  #type    cname     fbname   count   flag    size    null<br />  float    float1    FLOAT1    1       -       -       0.0<br />  double   double1   DOUBLE1   1       -       -       0.0<br />  long     long1     LONG1     1       -       -       0<br />  short    short1    SHORT1    1       -       -       0<br />  int      int1      INT1      1       -       -       0<br />  dec_t    dec1      DEC1      1       -       9,16    0<br />  char     char1     CHAR1     1       -       -       &#39;\0&#39;<br />  string   string1   STRING1   1       -       20      &#39;\0&#39;<br />  carray   carray1   CARRAY1   2       CL      20      &#39;\0&#39;<br />  END</pre></div><p class="pBody"><a name="wp1127607"> </a>
<a href="pbbuf.html#wp1127609">Listing&#160;3-2</a> illustrates the same view description file for an independent <code class="cCode">VIEW</code>.
</p>
<div class="pCodeTitle"><a name="wp1127609"> </a>
Listing&#160;3-2	   View Description File for an Independent View
</div> <a name="wp1127610"> </a><div class="pPreformatted"><pre>$ /* View data structure */<br />  VIEW MYVIEW<br />  #type   cname   fbname  count   flag    size    null<br />  float   float1  -       1       -       -       -<br />  double  double1 -       1       -       -       -<br />  long    long1   -       1       -       -       -<br />  short   short1  -       1       -       -       -<br />  int     int1    -       1       -       -       -<br />  dec_t   dec1    -       1       -       9,16    -<br />  char    char1   -       1       -       -       -<br />  string  string1 -       1       -       20      -<br />  carray  carray1 -       2       CL      20      -<br />  END</pre></div><p class="pBody"><a name="wp1127612"> </a>
Note that the format is similar to the <code class="cCode">FML</code>-dependent view, except that the <code class="cCodeEmphasis">fbname</code> and <code class="cCodeEmphasis">null</code> fields are not relevant and are ignored by the <a href="pbbuf.html#wp1127615">viewc</a> compiler. You must include a value (for example, a dash) as a placeholder in these fields.
</p>
<h3 class="pHeading2"><a name="wp1127615"> </a>
Executing the VIEW Compiler
</h3>
<p class="pBody"><a name="wp1127616"> </a>
To compile a <code class="cCode">VIEW</code> typed record, run the <code class="cCode">viewc -C</code> command, specifying the name of the view description file as an argument. To specify an independent <code class="cCode">VIEW</code>, use the <code class="cCode">-n</code> option. You can optionally specify a directory in which the resulting output file should be written. By default, the output file is written to the current directory. 
</p>
<p class="pBody"><a name="wp1127617"> </a>
For example, for an <code class="cCode">FML</code>-dependent <code class="cCode">VIEW</code>, the compiler is invoked as follows:
</p>
<a name="wp1127618"> </a><div class="pPreformatted"><pre>viewc -C myview.v</pre></div><a name="wp1127619"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>To compile a <code class="cCode">VIEW32</code> typed record, run the <code class="cCode">viewc32 -C</code> command.</td>
</tr>
</table>

<p class="pBody"><a name="wp1127620"> </a>
For an independent <code class="cCode">VIEW</code>, use the <code class="cCode">-n</code> option on the command line, as follows:
</p>
<a name="wp1127621"> </a><div class="pPreformatted"><pre>viewc -C -n myview.v</pre></div><p class="pBody"><a name="wp1127622"> </a>
The output of the <code class="cCode">viewc</code> command includes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127623"> </a>One or more COBOL <code class="cCode">COPY</code> files; for example, <code class="cCode">MYVIEW.cbl</code></li>
<li><a name="wp1127624"> </a>Header file containing a structure definition that may be used by application programs for C routines that share the same view</li>
<li><a name="wp1127625"> </a>Binary version of the source description file; for example, <code class="cCode">myview.V</code></li>
<a name="wp1127626"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>On case-insensitive platforms (for example, Microsoft Windows), the extension used for the names of such files is <code class="cCode">vv</code>; for example, <code class="cCode">myview.vv</code>. </td>
</tr>
</table>

</ul></div>
<p class="pBody"><a name="wp1127627"> </a>
<a href="pbbuf.html#wp1267790">Listing&#160;3-3</a> provides an example of the COBOL <code class="cCode">COPY</code> file created by <code class="cCode">viewc</code>.
</p>
<div class="pCodeTitle"><a name="wp1267790"> </a>
Listing&#160;3-3	   COBOL COPY File Example
</div> <a name="wp1267791"> </a><div class="pPreformatted"><pre>*    VIEWFILE: &quot;myview.v&quot;<br />*    VIEWNAME: &quot;MYVIEW&quot;<br />  05 FLOAT1                      USAGE IS COMP-1.<br />  05 DOUBLE1                     USAGE IS COMP-2.<br />  05 LONG1                       PIC S9(9) USAGE IS COMP-5.<br />  05 SHORT1                      PIC S9(4) USAGE IS COMP-5.<br />  05 FILLER                      PIC X(02).<br />  05 INT1                        PIC S9(9) USAGE IS COMP-5.<br />  05 DEC1.<br />    07 DEC-EXP                   PIC S9(4) USAGE IS COMP-5.<br />    07 DEC-POS                   PIC S9(4) USAGE IS COMP-5.<br />    07 DEC-NDGTS                 PIC S9(4) USAGE IS COMP-5.<br />*     DEC-DGTS is the actual packed decimal value<br />    07 DEC-DGTS                  PIC S9(1)V9(16) COMP-3.<br />    07 FILLER                    PIC X(07).<br />  05 CHAR1                       PIC X(01).<br />  05 STRING1                     PIC X(20).<br />  05 FILLER                      PIC X(01).<br />  05 L-CARRAY1 OCCURS 2 TIMES    PIC 9(4) USAGE IS COMP-5.<br />*    LENGTH OF CARRAY1<br />  05 C-CARRAY1                   PIC S9(4) USAGE IS COMP-5.<br />*    COUNT OF CARRAY1<br />  05 CARRAY1 OCCURS 2 TIMES      PIC X(20).<br />  05 FILLER                      PIC X(02).</pre></div><p class="pBody"><a name="wp1267793"> </a>
COBOL <code class="cCode">COPY</code> files for views must be brought into client programs and service subroutines with <code class="cCode">COPY</code> statements. 
</p>
<p class="pBody"><a name="wp1267794"> </a>
In the previous example, the compiler includes <code class="cCode">FILLER</code> files so that the alignment of fields in COBOL code matches the alignment in C code. 
</p>
<p class="pBody"><a name="wp1267795"> </a>
The format of the packed decimal value, <code class="cCode">DEC1</code>, is composed of five fields. Four fields&#8212;<code class="cCode">DEC-EXP</code>, <code class="cCode">DEC-POS</code>, <code class="cCode">DEC-NDGTS</code>, and <code class="cCode">FILLER</code>&#8212;are used only in C (they are defined in the <code class="cCode">dec_t</code> type); they are included in the COBOL record for filler. Do not use these fields in COBOL applications. 
</p>
<p class="pBody"><a name="wp1267796"> </a>
The fifth field, <code class="cCode">DEC-DGTS</code>, is used by the system to store the actual packed decimal value. You should use this value within the COBOL program. ATMI calls operate on the <code class="cCode">DEC-DGTS</code> field to:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1267797"> </a>Populate the field before the record is passed from a C program to a COBOL program.</li>
<li><a name="wp1267798"> </a>Convert the field back to the <code class="cCode">dec_t</code> type when passed from the COBOL program to the C program. </li>
</ul></div>
<p class="pBody"><a name="wp1267799"> </a>
The only restriction is that a COBOL program cannot directly pass a record to a C function outside of the ATMI interface because the decimal formats in the COBOL program and C function do not match.
</p>
<p class="pBody"><a name="wp1267800"> </a>
Finally, note that the sample COBOL <code class="cCode">COPY</code> file includes an <code class="cCode">L-CARRAY1</code> length field that occurs twice, once for each occurrence of <code class="cCode">CARRAY1</code>, and a <code class="cCode">C-CARRAY1</code> count field.
</p>
<p class="pBody"><a name="wp1267801"> </a>
<code class="cCode">viewc</code> creates a C version of the header file that you can use to mix C and COBOL service and/or client programs.
</p>
<h3 class="pHeading2"><a name="wp1127643"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1267827"> </a><a href="pbbuf.html#wp1267873">Using an FML Typed Record</a></li>
<li><a name="wp1267851"> </a><a href="pbbuf.html#wp1268201">Using an XML Typed Record</a></li>
<li><a name="wp1127655"> </a>vi<a href="../rfcm/rfcmd.html"></a>ewc, viewc<a href="../rfcm/rfcmd.html"></a>32(1) in the <em class="cEmphasis">Oracle Tuxedo Command Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1267873"> </a>
Using an FML Typed Record
</h2><p class="pBody"><a name="wp1267874"> </a>
The <code class="cCode">FML</code> interface was designed for use with the C language. For COBOL, routines are provided that allow you to convert a received <code class="cCode">FML</code> record type to a COBOL record for processing, and then convert the record back to <code class="cCode">FML</code>. 
</p>
<p class="pBody"><a name="wp1127659"> </a>
To use <code class="cCode">FML</code> typed records, you must perform the following steps:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127661"> </a><span class="cHyperlink">
<a href="pbbuf.html#wp1127671">Set the appropriate environment variables</a></span>.</li>
<li><a name="wp1127663"> </a><span class="cHyperlink">
<a href="pbbuf.html#wp1127688">Describe the potential fields in an FML field table</a></span>.</li>
<li><a name="wp1267910"> </a>Initialize the <code class="cCode">FML</code> record using <code class="cCode">FINIT.</code></li>
<li><a name="wp1127665"> </a>Create an <code class="cCode">FML</code> header file and specify the header file in a <code class="cCode">#include</code> statement C routines that share the same view in the application.</li>
</ul></div>
<p class="pBody"><a name="wp1127666"> </a>
<code class="cCode">FML</code> routines are used to manipulate typed records, including those that convert fielded records to C structures and vice versa. By using these functions, you can access and update data values without having to know how data is structured and stored. For more information on <code class="cCode">FML</code> routines, refer to the <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>. 
</p>
<h3 class="pHeading2"><a name="wp1127671"> </a>
Setting Environment Variables for an FML Typed Record
</h3>
<p class="pBody"><a name="wp1127672"> </a>
To use an <code class="cCode">FML</code> typed record in an application program, you must set the following environment variables shown in <a href="pbbuf.html#wp258084">Table&#160;3-4</a>.
</p>
<p class="pGraphic"><a name="wp1127686"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp258084table1127673"><caption><a name="wp258084"> </a>
Table 3-4  FML Typed Record Environment Variables

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1127675"> </a>
Environment Variable
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127677"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127679"> </a>
<code class="cCode">FIELDTBLS</code> or <code class="cCode">FIELDTBLS32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127681"> </a>
Comma-separated list of field table filenames for <code class="cCode">FML</code> or <code class="cCode">FML32</code> typed records, respectively. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127683"> </a>
<code class="cCode">FLDTBLDIR</code> or <code class="cCode">FLDTBLDIR32</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127685"> </a>
Colon-separated list of directories to search for the field table files for <code class="cCode">FML</code> and <code class="cCode">FML32</code>, respectively. For Microsoft Windows, use a semicolon-separated list. 
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1127688"> </a>
Creating a Field Table File
</h3>
<p class="pBody"><a name="wp1127689"> </a>
Field table files are always required when <code class="cCode">FML</code> records and/or <code class="cCode">FML</code>-dependent <code class="cCode">VIEW</code>s are used. A field table file maps the logical name of a field in an <code class="cCode">FML</code> record to a string that uniquely identifies the field. 
</p>
<p class="pBody"><a name="wp1127690"> </a>
The following format is used for the description of each field in the <code class="cCode">FML</code> field table:
</p>
<a name="wp1127691"> </a><div class="pPreformatted"><pre>$ /* FML structure */<br />   *base <code class="cCodeEmphasis">value<br /></code>   <code class="cCodeEmphasis">name    number     type   flags   comments</code></pre></div><p class="pBody"><a name="wp1127692"> </a>
<a href="pbbuf.html#wp258131">Table&#160;3-5</a> describes the fields that must be specified in the <code class="cCode">FML</code> field table file for each <code class="cCode">FML</code> field.
</p>
<p class="pGraphic"><a name="wp1127723"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp258131table1127693"><caption><a name="wp258131"> </a>
Table 3-5  Field Table File Fields

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1127695"> </a>
Field
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1127697"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127699"> </a>
<code class="cCodeEmphasis">*</code><code class="cCode">base</code><code class="cCodeEmphasis"> value</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127701"> </a>
Specifies a base for offsetting subsequent field numbers, providing an easy way to group and renumber sets of related fields. The <code class="cCode">*base</code> option allows field numbers to be reused. For a 16-bit record, the base plus the relevant number must be greater than or equal to 100 and less than 8191. This field is optional.
</div>
<p class="pTableNote"><a name="wp1127702"> </a><table>
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The Oracle Tuxedo system reserves field numbers 1-100 and 6000-7000 for internal use. Field numbers 101-8191 are available for application-defined fields with <code class="cCode">FML</code>; field numbers 101-33, 554, and 431, for <code class="cCode">FML32</code>.</td></tr>
</table>
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127704"> </a>
<code class="cCodeEmphasis">name</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127706"> </a>
Identifier for the field. The value must be a string of up to 256 characters, consisting of alphanumeric and underscore characters only.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127708"> </a>
<code class="cCodeEmphasis">rel-number</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127710"> </a>
Relative numeric value of the field. This value is added to the current base, if specified, to calculate the field number.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127712"> </a>
<code class="cCodeEmphasis">type</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127714"> </a>
Type of the field. This value can be any of the following: <code class="cCode">char</code>, <code class="cCode">string</code>, <code class="cCode">short</code>, <code class="cCode">long</code>, <code class="cCode">float</code>, <code class="cCode">double</code>, or <code class="cCode">carray</code>.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127716"> </a>
<code class="cCodeEmphasis">flag</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127718"> </a>
Reserved for future use. A dash (-) should be included as a placeholder.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127720"> </a>
<code class="cCodeEmphasis">comment</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1127722"> </a>
Optional comment.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1127724"> </a>
All fields are optional, and may be included more than once.
</p>
<p class="pBody"><a name="wp1127725"> </a>
<a href="pbbuf.html#wp1127727">Listing&#160;3-4</a> illustrates a field table file that may be used with the FML-dependent VIEW<a href="pbbuf.html#wp1127604"> example</a>.
</p>
<div class="pCodeTitle"><a name="wp1127727"> </a>
Listing&#160;3-4	   Field Table File for FML VIEW
</div> <a name="wp1127728"> </a><div class="pPreformatted"><pre># name       number    type     flags   comments<br />  FLOAT1     110       float    -       -<br />  DOUBLE1    111       double   -       -<br />  LONG1      112       long     -       -<br />  SHORT1     113       short    -       -<br />  INT1       114       long     -       -<br />  DEC1       115       string   -       -<br />  CHAR1      116       char     -       -<br />  STRING1    117       string   -       -<br />  CARRAY1    118       carray   -       -</pre></div><h3 class="pHeading2"><a name="wp1268082"> </a>
Initializing a Typed Record
</h3>
<p class="pBody"><a name="wp1268083"> </a>
An <code class="cCode">FML</code> typed record must be initialized using the <code class="cCode">FINIT</code> procedure. The <code class="cCode">TPINIT</code> procedure takes the specified <code class="cCode">FML</code> record (preferably aligned on a full-word boundary) and uses the value specified in the <code class="cCode">FML-LENGTH</code> field in the <code class="cCode">FMLINFO</code> record as the length.
</p>
<p class="pBody"><a name="wp1268084"> </a>
If <code class="cCode">TPNOCHANGE</code> is set, then any <code class="cCode">FML</code> record received by a program (rather than created by the program) is initialized automatically. In this case, it is unnecessary to call <code class="cCode">FINIT</code>.
</p>
<p class="pBody"><a name="wp1268085"> </a>
<a href="pbbuf.html#wp1268087">Listing&#160;3-5</a> shows how to perform an initialization.
</p>
<div class="pCodeTitle"><a name="wp1268087"> </a>
Listing&#160;3-5	   FML/VIEW Conversion
</div> <a name="wp1268088"> </a><div class="pPreformatted"><pre>WORKING-STORAGE SECTION.<br />*RECORD TYPE AND LENGTH<br /> 01 TPTYPE-REC.<br />        COPY TPTYPE.<br />*STATUS OF CALL<br /> 01 TPSTATUS-REC.<br />        COPY TPSTATUS.<br />* SERVICE CALL FLAGS/RECORD<br /> 01 TPSVCDEF-REC.<br />        COPY TPSVCDEF.<br />* TPINIT FLAGS/RECORD<br /> 01 TPINFDEF-REC.<br />        COPY TPINFDEF.<br />* FML CALL FLAGS/RECORD<br /> 01 FML-REC.<br />        COPY FMLINFO.<br />*<br />*<br />* APPLICATION FML RECORD - ALIGNED<br /> 01 MYFML.<br />     05 FBFR-DTA OCCURS 100 TIMES   PIC S9(9) USAGE IS COMP-5.<br />* APPLICATION VIEW RECORD<br /> 01 MYVIEW.<br />        COPY MYVIEW.</pre></div><a name="wp1268089"> </a><div class="pPreformatted"><pre>.....</pre></div><a name="wp1268090"> </a><div class="pPreformatted"><pre>* MOVE DATA INTO MYVIEW</pre></div><a name="wp1268091"> </a><div class="pPreformatted"><pre>.....</pre></div><a name="wp1268092"> </a><div class="pPreformatted"><pre>* INITIALIZE FML RECORD<br /> MOVE LENGTH OF MYFML TO FML-LENGTH.<br /> CALL &quot;FINIT&quot; USING MYFML FML-REC.<br /> IF NOT FOK<br />        MOVE &quot;FINIT Failed&quot; TO LOGMSG-TEXT<br />        PERFORM DO-USERLOG<br />        PERFORM EXIT-PROGRAM<br /> END-IF.</pre></div><a name="wp1268093"> </a><div class="pPreformatted"><pre>* Convert VIEW to FML Record<br /> SET FUPDATE TO TRUE.<br /> MOVE &quot;MYVIEW&quot; TO VIEWNAME.<br /> CALL &quot;FVSTOF&quot; USING MYFML MYVIEW FML-REC.<br /> IF NOT FOK<br />        MOVE &quot;FVSTOF Failed&quot; TO LOGMSG-TEXT<br />        PERFORM DO-USERLOG<br />        PERFORM EXIT-PROGRAM<br /> END-IF.<br />* CALL THE SERVICE USING THE FML RECORD<br /> MOVE &quot;FML&quot; TO REC-TYPE IN TPTYPE-REC.<br /> MOVE SPACES TO SUB-TYPE IN TPTYPE-REC.<br /> MOVE LENGTH OF MYFML TO LEN.<br /> CALL &quot;TPCALL&quot; USING TPSVCDEF-REC<br />        TPTYPE-REC<br />        MYFML<br />        TPTYPE-REC<br />        MYFML<br />        TPSTATUS-REC.<br /> IF NOT TPOK<br />        MOVE &quot;TPCALL MYFML Failed&quot; TO LOGMSG-TEXT<br />        PERFORM DO-USERLOG<br />        PERFORM EXIT-PROGRAM<br /> END-IF.<br />* CONVERT THE FML RECORD BACK TO MYVIEW<br /> CALL &quot;FVFTOS&quot; USING MYFML MYVIEW FML-REC.<br /> IF NOT FOK<br />        MOVE &quot;FVFTOS Failed&quot; TO LOGMSG-TEXT<br />        PERFORM DO-USERLOG<br />        PERFORM EXIT-PROGRAM<br /> END-IF.</pre></div><p class="pBody"><a name="wp1268095"> </a>
In the preceding listing, the <code class="cCode">FVSTOF</code> procedure converts an <code class="cCode">FML</code> record into a <code class="cCode">VIEW</code> record. The view is defined by including the copy file generated by the view compiler. The <code class="cCode">FML-REC</code> record provides the <code class="cCode">VIEWNAME</code> and the <code class="cCode">FML-MODE</code> transfer mode, which can be set to <code class="cCode">FUPDATE</code>, <code class="cCode">FOJOIN</code>, <code class="cCode">FJOIN</code>, or <code class="cCode">FCONCAT</code>. The actions associated with these modes are the same as those described in <a href="../rf3fml/rf3fml.html">Fupdate, Fupdate3</a><a href="../rf3fml/rf3fml.html">2(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fojoin, Fojoi</a><a href="../rf3fml/rf3fml.html">n32(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fjoin, Fjoi</a><a href="../rf3fml/rf3fml.html">n32(3fml)</a>, and <a href="../rf3fml/rf3fml.html">Fconcat, Fconcat3</a><a href="../rf3fml/rf3fml.html">2(3fml)</a>.
</p>
<p class="pBody"><a name="wp1268108"> </a>
The <code class="cCode">FVFTOS</code> procedure converts a <code class="cCode">VIEW</code> record into an <code class="cCode">FML</code> record. The parameters are the same as those for an <code class="cCode">FVSTOF</code> procedure but you do not need to set <code class="cCode">FML-MODE</code>. The system copies the fields from the fielded record into the structure, based on the element descriptions in the view. If there is no corresponding element in the COBOL record for a field in the fielded record, then the system ignores the field. If there is no corresponding field in the fielded record for an element specified in the COBOL record, the system copies a null value into the element. The null value used can be defined for each element in the view description. 
</p>
<p class="pBody"><a name="wp1268109"> </a>
To store multiple occurrences of a field in the COBOL record, a record element should be defined with <code class="cCode">OCCURS</code>. If the number of occurrences of the field in the record is smaller than the number of occurrences of the element, the extra element slots are assigned null values. Alternatively, if the number of occurrences of the field in the record is higher than the number of occurrences of the element, then the surplus occurrences are ignored.
</p>
<p class="pBody"><a name="wp1268110"> </a>
For <code class="cCode">FML32</code> and <code class="cCode">VIEW32</code>, the <code class="cCode">FINIT32</code>, <code class="cCode">FVSTOF32</code>, and <code class="cCode">FVFTOS32</code> procedures should be used.
</p>
<p class="pBody"><a name="wp1268111"> </a>
Upon successful completion, the system sets the <code class="cCode">FML-STATUS</code> to <code class="cCode">FOK</code>. On error, the system sets the <code class="cCode">FML-STATUS</code> to a non-zero value.
</p>
<h3 class="pHeading2"><a name="wp1127748"> </a>
Creating an FML Header File
</h3>
<p class="pBody"><a name="wp1127749"> </a>
In order to use an <code class="cCode">FML</code> typed record in client programs or service subroutines, you must create an <code class="cCode">FML</code> header file and specify it in the application <code class="cCode">#include</code> statements. 
</p>
<p class="pBody"><a name="wp1127750"> </a>
To create an <code class="cCode">FML</code> header file from a field table file, use the <code class="cCode">mkfldhdr(1)</code> command. For example, to create a file called <code class="cCode">myview.flds.h</code>, enter the following command:
</p>
<a name="wp1127751"> </a><div class="pPreformatted"><pre>mkfldhdr myview.flds</pre></div><p class="pBody"><a name="wp1127752"> </a>
For <code class="cCode">FML32</code> typed records, use the <code class="cCode">mkfldhdr32</code> command.
</p>
<p class="pBody"><a name="wp1127753"> </a>
<a href="pbbuf.html#wp1127755">Listing&#160;3-6</a> shows the <code class="cCode">myview.flds.h</code> header file that is created by the <code class="cCode">mkfldhdr</code> command.
</p>
<div class="pCodeTitle"><a name="wp1127755"> </a>
Listing&#160;3-6	   myview.flds.h Header File
</div> <a name="wp1127756"> </a><div class="pPreformatted"><pre>/*       fname    fldid            */<br />/*       -----    -----            */<br /> <br />#define  FLOAT1    ((FLDID)24686)   /* number: 110 type: float  */<br />#define  DOUBLE1   ((FLDID)32879)   /* number: 111 type: double */<br />#define  LONG1     ((FLDID)8304)    /* number: 112 type: long   */<br />#define  SHORT1    ((FLDID)113)     /* number: 113 type: short  */<br />#define  INT1      ((FLDID)8306)    /* number: 114 type: long   */<br />#define  DEC1      ((FLDID)41075)   /* number: 115 type: string */<br />#define  CHAR1     ((FLDID)16500)   /* number: 116 type: char   */<br />#define  STRING1   ((FLDID)41077)   /* number: 117 type: string */<br />#define  CARRAY1   ((FLDID)49270)   /* number: 118 type: carray */</pre></div><p class="pBody"><a name="wp1127759"> </a>
Specify the new header file in the <code class="cCode">#include</code> statement of your application. Once the header file is included, you can refer to fields by their symbolic names. 
</p>
<h3 class="pHeading2"><a name="wp1127760"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127764"> </a> <a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a></li>
<li><a name="wp1268179"> </a><a href="pbbuf.html#wp1268201">Using an XML Typed Record</a></li>
<li><a name="wp1176735"> </a><a href="../rfcm/rfcmd.html">mkfldhdr</a>, <a href="../rfcm/rfcmd.html">mkfldhdr32(1)</a> in the <em class="cEmphasis">Oracle Tuxedo Command Reference</em></li>
</ul></div>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1268201"> </a>
Using an XML Typed Record
</h2><p class="pBody"><a name="wp1265047"> </a>
<code class="cCode">XXML</code> records enable Oracle Tuxedo applications to use XML for exchanging data within and between applications. Oracle Tuxedo applications can send and receive simple <code class="cCode">XML</code> records, and route those records to the appropriate servers. All logic for dealing with <code class="cCode">XML</code> documents, including parsing, resides in the application. 
</p>
<p class="pBody"><a name="wp1127772"> </a>
An <code class="cCode">XML</code> document consists of:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127773"> </a>A sequence of characters that encode the text of a document</li>
<li><a name="wp1127774"> </a>A description of the logical structure of the document and information about that structure</li>
</ul></div>
<p class="pBody"><a name="wp1127776"> </a>
Formatting and filtering for Events processing (which are supported when a <code class="cCode">STRING</code> record type is used) are not supported for the <code class="cCode">XML</code> record type. Therefore, the <code class="cCode">_tmfilter</code> and  <code class="cCode">_tmformat</code> pointers in the record type switch for <code class="cCode">XML</code> records are set to LOW-VALUE.
</p>
<p class="pBody"><a name="wp1127777"> </a>
The <code class="cCode">XML</code> parser in the Oracle Tuxedo system performs the following routines:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127778"> </a>Autodetection of character encodings</li>
<li><a name="wp1127779"> </a>Character code conversion</li>
<li><a name="wp1127780"> </a>Detection of element content and attribute values</li>
<li><a name="wp1127781"> </a>Data type conversion</li>
</ul></div>
<p class="pBody"><a name="wp1127782"> </a>
Data-dependent routing is supported for <code class="cCode">XML</code> records. The routing of an <code class="cCode">XML</code> document can be based on element content, or on element type and an attribute value. The <code class="cCode">XML</code> parser determines the character encoding being used; if the encoding differs from the native character sets (US-ASCII or EBCDIC) used in the Oracle Tuxedo configuration files (<code class="cCode">UBBCONFIG</code> and <code class="cCode">DMCONFIG</code>), the element and attribute names are converted to US-ASCII or EBCDIC.
</p>
<p class="pBody"><a name="wp1127783"> </a>
Attributes configured for routing must be included in an <code class="cCode">XML</code> document. If an attribute is configured as a routing criteria but it is not included in the <code class="cCode">XML</code> document, routing processing fails.
</p>
<p class="pBody"><a name="wp1127784"> </a>
The content of an element and the value of an attribute must conform to the syntax and semantics required for a routing field value. The user must also specify the type of the routing field value. <code class="cCode">XML</code> supports only character data. If a range field is numeric, the content or value of that field is converted to a numeric value during routing processing. 
</p>
<h3 class="pHeading2"><a name="wp1127785"> </a>
See Also
</h3>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1127789"> </a> <a href="pbbuf.html#wp1266973">Using a VIEW Typed Record</a></li>
<li><a name="wp1268454"> </a><a href="pbbuf.html#wp1267873">Using an FML Typed Record</a></li>
</ul></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="pbbuf.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="pbenv.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="pbclt.html"><img id="LongDescNotReq9" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
