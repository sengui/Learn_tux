<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/rf3cbl/fm/rf3cbl.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:30:03" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Section 3(cbl) - COBOL Functions</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">ATMI COBOL Function Reference
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next_grey1.gif" border="0" alt="Next" />&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/rf3cbl.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1259772"> </a>
Section 3(cbl) - COBOL Functions
</h1>
<p class="pGraphic"><a name="wp1130167"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1313385table1130169"><caption><a name="wp1313385"> </a>
Table&#160;1  Oracle Tuxedo ATMI COBOL Functions

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1313389"> </a>
Name
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1313391"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313395"> </a>
<a href="rf3cbl.html#wp1005398">Introduction to the COBOL Application-Transaction Monitor Interface</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313398"> </a>
Provides an introduction to the COBOL ATMI
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313403"> </a>
<a href="rf3cbl.html#wp997198"><code class="cCode">FINIT, FINIT32(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313405"> </a>
Initializes fielded buffer 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313410"> </a>
<a href="rf3cbl.html#wp998315"><code class="cCode">FVFTOS, FVFTOS32(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313412"> </a>
Copies from fielded buffer to COBOL structure 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313417"> </a>
<a href="rf3cbl.html#wp998368"><code class="cCode">FVSTOF(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313419"> </a>
Copies from C structure to fielded buffer 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313424"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313426"> </a>
Abort current Oracle Tuxedo ATMI transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313431"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313433"> </a>
Routine to send a message to a service asynchronously 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313438"> </a>
<a href="rf3cbl.html#wp998560"><code class="cCode">TPADVERTISE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313440"> </a>
Routine for advertising service names 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313445"> </a>
<a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313447"> </a>
Routine to begin an Oracle Tuxedo ATMI transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313452"> </a>
<a href="rf3cbl.html#wp998826"><code class="cCode">TPBROADCAST(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313454"> </a>
Broadcasts notification by name 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313459"> </a>
<a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313461"> </a>
Routine to send a message to a service synchronously 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313466"> </a>
<a href="rf3cbl.html#wp999069"><code class="cCode">TPCANCEL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313468"> </a>
Cancels a communication handle for an outstanding reply 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313473"> </a>
<a href="rf3cbl.html#wp999132"><code class="cCode">TPCHKAUTH(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313475"> </a>
Checks if authentication required to join an Oracle Tuxedo ATMI application 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313480"> </a>
<a href="rf3cbl.html#wp999231"><code class="cCode">TPCHKUNSOL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313482"> </a>
Checks for unsolicited message 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313487"> </a>
<a href="rf3cbl.html#wp999299"><code class="cCode">TPCLOSE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313489"> </a>
Closes the Oracle Tuxedo ATMI resource manager 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313494"> </a>
<a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313496"> </a>
Commits current Oracle Tuxedo ATMI transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313501"> </a>
<a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313503"> </a>
Establishes a conversational connection 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313508"> </a>
<a href="rf3cbl.html#wp999573"><code class="cCode">TPDEQUEUE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313510"> </a>
Routine to dequeue a message from a queue 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313515"> </a>
<a href="rf3cbl.html#wp999791"><code class="cCode">TPDISCON(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313517"> </a>
Takes down a conversational connection 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313522"> </a>
<a href="rf3cbl.html#wp999853"><code class="cCode">TPENQUEUE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313524"> </a>
Routine to enqueue a message 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313529"> </a>
<a href="rf3cbl.html#wp1000056"><code class="cCode">TPFORWAR(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313531"> </a>
Forwards an Oracle Tuxedo ATMI service request to another routine 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313536"> </a>
<a href="rf3cbl.html#wp1301314">TPGBLKTIME(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313538"> </a>
Routine for retrieving a previously set, per second, blocktime value
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313543"> </a>
<a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313545"> </a>
Retrieves a context identifier for the current application association 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313550"> </a>
<a href="rf3cbl.html#wp1044551"><code class="cCode">TPGETLEV(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313552"> </a>
Checks if an Oracle Tuxedo ATMI transaction is in progress 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313557"> </a>
<a href="rf3cbl.html#wp1000197"><code class="cCode">TPGETRPLY(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313559"> </a>
Gets reply from asynchronous message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313564"> </a>
<a href="rf3cbl.html#wp1000332"><code class="cCode">TPGETUNSOL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313566"> </a>
Gets unsolicited message
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313571"> </a>
<a href="rf3cbl.html#wp1000395"><code class="cCode">TPGPRIO(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313573"> </a>
Gets service request priority 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313578"> </a>
<a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313580"> </a>
Joins an Oracle Tuxedo ATMI application 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313585"> </a>
<a href="rf3cbl.html#wp1066533"><code class="cCode">TPKEYCLOSE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313587"> </a>
Closes a previously opened key handle
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313592"> </a>
<a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313594"> </a>
Gets information associated with a key handle
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313599"> </a>
<a href="rf3cbl.html#wp1143651"><code class="cCode">TPKEYOPEN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313601"> </a>
Opens a key handle for digital signature generation, message encryption, or message decryption
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313606"> </a>
<a href="rf3cbl.html#wp1066613"><code class="cCode">TPKEYSETINFO(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313608"> </a>
Sets optional attribute parameters associated with a key handle 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313613"> </a>
<a href="rf3cbl.html#wp1000626"><code class="cCode">TPNOTIFY(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313615"> </a>
Sends notification by client identifier 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313620"> </a>
<a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313622"> </a>
Opens the Oracle Tuxedo ATMI resource manager 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313627"> </a>
<a href="rf3cbl.html#wp1000793"><code class="cCode">TPPOST(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313629"> </a>
Posts an event 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313634"> </a>
<a href="rf3cbl.html#wp1000927"><code class="cCode">TPRECV(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313636"> </a>
Receives a message in a conversational connection 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313641"> </a>
<a href="rf3cbl.html#wp1001071"><code class="cCode">TPRESUME(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313643"> </a>
Resumes a global transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313648"> </a>
<a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313650"> </a>
Returns from an Oracle Tuxedo ATMI service routine 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1352291"> </a>
<a href="rf3cbl.html#wp1353588">TPRMCLOSE(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1344884"> </a>
Routine for closing a specified RM configured in a multiple RMs server group
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1352296"> </a>
<a href="rf3cbl.html#wp1353615">TPRMEND(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1344888"> </a>
 Routine for ending current work performed on behalf of a transaction branch in a specified RM
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1352301"> </a>
<a href="rf3cbl.html#wp1354208">TPRMOPEN(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1344892"> </a>
Routine for opening a specified RM configured in a multiple RMs server group
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1352306"> </a>
<a href="rf3cbl.html#wp1354024">TPRMSTART(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1344896"> </a>
Routine for starting work on behalf of a transaction branch of specified RM in a MRM server
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313655"> </a>
<a href="rf3cbl.html#wp1344910">TPSBLKTIME(3cbl)</a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313657"> </a>
Routine for setting the blocktime value, in seconds, of a potential blocking<span style="font-style: italic"> </span>API.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313662"> </a>
<a href="rf3cbl.html#wp1001241"><code class="cCode">TPSCMT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313664"> </a>
Sets when <code class="cCode">TPCOMMIT</code> should return 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313669"> </a>
<a href="rf3cbl.html#wp1001318"><code class="cCode">TPSEND(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313671"> </a>
Routine to send a message in a conversational connection 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313676"> </a>
<a href="rf3cbl.html#wp1047746"><code class="cCode">TPSETCTXT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313678"> </a>
Sets a context identifier for the current application association 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313683"> </a>
<a href="rf3cbl.html#wp1047466"><code class="cCode">TPSETUNSOL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313685"> </a>
Sets method for handling unsolicited messages 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313690"> </a>
<a href="rf3cbl.html#wp1001527"><code class="cCode">TPSPRIO(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313692"> </a>
Sets service request priority 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313697"> </a>
<a href="rf3cbl.html#wp1001590"><code class="cCode">TPSUBSCRIBE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313699"> </a>
Subscribes to an event 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313704"> </a>
<a href="rf3cbl.html#wp1001740"><code class="cCode">TPSUSPEND(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313706"> </a>
Suspends a global transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313711"> </a>
<a href="rf3cbl.html#wp1001806"><code class="cCode">TPSVCSTART(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313713"> </a>
Starts an Oracle Tuxedo ATMI service 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313718"> </a>
<a href="rf3cbl.html#wp1001902"><code class="cCode">TPSVRDONE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313720"> </a>
Routine to terminate an Oracle Tuxedo ATMI server 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313725"> </a>
<a href="rf3cbl.html#wp1268536"><code class="cCode">TPSVRINIT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313727"> </a>
Routine to initialize an Oracle Tuxedo ATMI server 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313732"> </a>
<a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313734"> </a>
Leaves an application 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313739"> </a>
<a href="rf3cbl.html#wp1002068"><code class="cCode">TPUNADVERTISE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313741"> </a>
Routine for unadvertising service names 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313746"> </a>
<a href="rf3cbl.html#wp1002132"><code class="cCode">TPUNSUBSCRIBE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313748"> </a>
Unsubscribes to an event 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313753"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313755"> </a>
Begins a global transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313760"> </a>
<a href="rf3cbl.html#wp1002297"><code class="cCode">TXCLOSE(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313762"> </a>
Closes a set of resource managers 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313767"> </a>
<a href="rf3cbl.html#wp1002357"><code class="cCode">TXCOMMIT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313769"> </a>
Commits a transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313774"> </a>
<a href="rf3cbl.html#wp1002447"><code class="cCode">TXINFORM(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313776"> </a>
Returns global transaction information 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313781"> </a>
<a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313783"> </a>
Opens a set of resource managers 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313788"> </a>
<a href="rf3cbl.html#wp1009819"><code class="cCode">TXROLLBACK(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313790"> </a>
Rolls back a transaction 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313795"> </a>
<a href="rf3cbl.html#wp1002642"><code class="cCode">TXSETCOMMITRET(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313797"> </a>
Sets <code class="cCodeEmphasis">commit_return</code> characteristic 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313802"> </a>
<a href="rf3cbl.html#wp1002713"><code class="cCode">TXSETTRANCTL(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313804"> </a>
Sets <code class="cCodeEmphasis">transaction_control</code> characteristic 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313809"> </a>
<a href="rf3cbl.html#wp998698"><code class="cCode">TXSETTIMEOUT(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313811"> </a>
Sets <code class="cCodeEmphasis">transaction_timeout</code> characteristic 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313816"> </a>
<a href="rf3cbl.html#wp998615"><code class="cCode">USERLOG(3cbl)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1313818"> </a>
Writes a message to the Oracle Tuxedo ATMI central event log 
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1005398"> </a>
Introduction to the COBOL Application-Transaction Monitor Interface
</h2><h4 class="pHeading3"><a name="wp1263452"> </a>
Description
</h4>
<p class="pBody"><a name="wp1263453"> </a>
The Application-Transaction Monitor Interface (ATMI) provides the interface between the COBOL application and the transaction processing system. This interface is known as ATMI and these pages specify its COBOL language binding. It provides routines to open and close resources, manage transactions, manage record types, and invoke request/response and conversational service calls.
</p>
<h4 class="pHeading3"><a name="wp1002960"> </a>
Communication Paradigms
</h4>
<p class="pBody"><a name="wp1002961"> </a>
The routines described in the ATMI reference pages imply a particular model of communication. This model is expressed in terms of how client and server programs can communicate using request and reply messages.
</p>
<p class="pBody"><a name="wp1002962"> </a>
There are two basic communication paradigms: request/response and conversational. Request/response services are invoked by service requests along with their associated data. Request/response services can receive exactly one request (upon entering the service routine) and send at most one reply (upon returning from the service routine). Conversational services, on the other hand, are invoked by connection requests along with a means of referring to the open connection (that is, a handle used in calling subsequent connection routines). Once the connection has been established and the service routine invoked, either the connecting program or the conversational service can send and receive data as defined by the application until the connection is torn down.
</p>
<p class="pBody"><a name="wp1002963"> </a>
Note that a program can initiate both request/response and conversational communication, but cannot accept both request/response and conversational service requests. The following sections describe the two communication paradigms in greater detail.
</p>
<a name="wp1123440"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In various parts of the Oracle Tuxedo ATMI documentation we refer to <em class="cEmphasis">threads</em>. Because the Oracle Tuxedo system does not support multithreading in COBOL, COBOL programmers may assume that the term <em class="cEmphasis">thread</em> refers to an entire process or context, depending on the circumstances. For example:</td>
</tr>
</table>

<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp1188120"> </a>A multithreaded/multicontexted C client with three threads associated with three contexts maps to a multicontexted COBOL client with three contexts.</li>
<li><a name="wp1188150"> </a>A multithreaded/single-context C client with three threads associated with a single context maps to a non-threaded, single-context COBOL client.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1002964"> </a>
Oracle Tuxedo Request/<br />Response Paradigm for Client/Server
</h4>
<p class="pBody"><a name="wp1002965"> </a>
With regard to request/response communication, a client is defined as a program that can send requests and receive replies. By definition, clients cannot receive requests nor send replies. A client can send any number of requests, and can wait for the replies synchronously or receive (some limited number of) the replies at its convenience. In certain cases, a client can send a request that has no reply. <code class="cCode">TPINITIALIZE()</code> and <code class="cCode">TPTERM()</code> allow a client to join and leave an Oracle Tuxedo ATMI application.
</p>
<p class="pBody"><a name="wp1002966"> </a>
A request/response server is a program that can receive one (and only one) service request at a time and send at most one reply to that request. While a server is working on a particular request, it can act like a client by initiating request/response or conversational requests and receiving their replies. In such a capacity, a server is called a requester. Note that both client and server programs can be requesters (in fact, a client can be nothing but a requester).
</p>
<p class="pBody"><a name="wp1002967"> </a>
A request/response server can forward a request to another request/response server. Here, the server passes along the request it received to another server and does not expect a reply. It is the responsibility of the last server in the chain to send the reply to the original requester. Use of the forwarding routine ensures that the original requester ultimately receives its reply.
</p>
<p class="pBody"><a name="wp1002968"> </a>
Servers and service routines offer a structured approach to writing Oracle Tuxedo ATMI applications. In a server, the application writer can concentrate on the work performed by the service rather than communications details such as receiving requests and sending replies. Because many of the communication details are handled by the Oracle Tuxedo system, the application must adhere to certain conventions when writing a service routine. At the time a server finishes its service routine, it can send a reply using <code class="cCode">TPRETURN()</code> or forward the request using <code class="cCode">TPFORWAR()</code>. A service is not allowed to perform any other work nor is it allowed to communicate with any other program after this point. Thus, a service performed by a server is started when a request is received and ended when either a reply is sent or the request is forwarded.
</p>
<p class="pBody"><a name="wp1002969"> </a>
Concerning request and reply messages, there is an inherent difference between the two: a request has no associated context before it is sent, but a reply does. For example, when sending a request, the caller must supply addressing information, whereas a reply is always returned to the program that originated the request, that is, addressing context is maintained for a reply and the sender of the reply can exert no control over its destination. The differences between the two message types manifest themselves in the parameters and descriptions of the routines described in <code class="cCode">TPCALL()</code>.
</p>
<p class="pBody"><a name="wp1338698"> </a>
When a request message is sent, it is sent at a particular priority. The priority affects how a request is dequeued: when a server dequeues requests, it dequeues the one with the highest priority. To prevent starvation, the oldest request is dequeued every so often regardless of priority. By default, a request&#8217;s priority is associated with the service name to which the request is being sent. Service names can be given priorities at configuration time (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a>). A default priority is used if none is defined. In addition, the priority can be set at run time using a routine (<code class="cCode">TPSPRIO()</code>) described in <code class="cCode">TPCALL()</code>. By doing so, the caller can override the configuration or default priority when the message is sent.
</p>
<h4 class="pHeading3"><a name="wp1002971"> </a>
Oracle Tuxedo System Conversational Paradigm for Client/Server
</h4>
<p class="pBody"><a name="wp1002972"> </a>
With regard to conversational communication, a client is defined as a program that can initiate a conversation but cannot accept a connection request.
</p>
<p class="pBody"><a name="wp1002973"> </a>
A conversational server is a program that can receive connection requests. Once the connection has been established and the service routine invoked, either the connecting program or the conversational service can send and receive data as defined by the application until the connection is torn down. The conversation is half-duplex in nature such that one side of the connection has control and can send data until it gives up control to the other side. While the connection is established, the server is &#8220;reserved&#8221; such that no other program can establish a connection with the server. 
</p>
<p class="pBody"><a name="wp1109427"> </a>
As with a request/response server, the conversational server can act as a requester by initiating other requests or connections with other servers. Unlike a request/response server, a conversational server can not forward a request to another server. Thus, a conversational service performed by a server is started when a request is received and ended when the final reply is sent via <code class="cCode">TPRETURN()</code>.
</p>
<p class="pBody"><a name="wp1002974"> </a>
Once the connection is established, the communications handle implies any context needed regarding addressing information for the participants. Messages can be sent and received as needed by the application. There is no inherent difference between the request and reply messages and no notion of priority of messages.
</p>
<h4 class="pHeading3"><a name="wp1002975"> </a>
Oracle Tuxedo System Queued Message Model
</h4>
<p class="pBody"><a name="wp1002976"> </a>
The Oracle Tuxedo ATMI queued message model allows for enqueuing a request message to stable storage for subsequent processing without waiting for its completion, and optionally getting a reply via a queued response message. The ATMI functions that queue messages and dequeue responses are <code class="cCode">TPENQUEUE()</code> and <code class="cCode">TPDEQUEUE()</code>. They can be called from any type of Oracle Tuxedo ATMI application processes: client, server, or conversational.
</p>
<p class="pBody"><a name="wp1002977"> </a>
The queued message facility is an XA-compliant resource manager. Persistent messages are enqueued and dequeued within transactions to ensure reliable one-time-only processing.
</p>
<h4 class="pHeading3"><a name="wp1002978"> </a>
ATMI Transactions
</h4>
<p class="pBody"><a name="wp1002979"> </a>
The Oracle Tuxedo system supports two sets of mutually exclusive functions for defining and managing transactions: the Oracle Tuxedo system&#8217;s ATMI transaction demarcation functions (the names of which include the prefix <code class="cCode">TP</code>) and X/Open&#8217;s TX Interface functions (the names of which include the prefix <code class="cCode">TX_</code>). Because X/Open used ATMI&#8217;s transaction demarcation functions as the base for the TX Interface, the syntax and semantics of the TX Interface are quite similar to those of the ATMI. This section is an overview of ATMI transaction concepts. The next section introduces additional concepts about the TX Interface.
</p>
<p class="pBody"><a name="wp1109461"> </a>
In the Oracle Tuxedo system, a <em class="cEmphasis">transaction</em> is used to define a single logical unit of work that either wholly succeeds or has no effect whatsoever. A transaction allows work performed in many processes, possibly at different sites, to be treated as an atomic unit of work. The initiator of a transaction normally uses <code class="cCode">TPBEGIN()</code> and either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> to delineate the operations within a transaction.
</p>
<p class="pBody"><a name="wp1002981"> </a>
The initiator may also suspend its work on the current transaction by issuing <code class="cCode">TPSUSPEND()</code>. Another process may take over the role of the initiator of a suspended transaction by issuing <code class="cCode">TPRESUME()</code>. As a transaction initiator, a program must call one of the following: <code class="cCode">TPSUSPEND()</code>, <code class="cCode">TPCOMMIT()</code>, or <code class="cCode">TPABORT()</code>. Thus, one program can start a transaction that another may finish.
</p>
<p class="pBody"><a name="wp1002982"> </a>
If a program calling a service is in transaction mode, then the called service routine is also placed in transaction mode on behalf of the same transaction. Otherwise, whether the service is invoked in transaction mode or not depends on options specified for the service in the configuration file. A service that is not invoked in transaction mode can define multiple transactions between the time it is invoked and the time it ends. On the other hand, a service routine invoked in transaction mode can participate in only one transaction, and work on that transaction is completed upon termination of the service routine. Note that a connection cannot be upgraded to transaction mode: if <code class="cCode">TPBEGIN()</code> is called while a conversation exists, the conversation remains outside of the transaction (as if <code class="cCode">TPCONNECT()</code> had been called with the <code class="cCode">TPNOTRAN</code> setting).
</p>
<p class="pBody"><a name="wp1002983"> </a>
A service routine joining a transaction that was started by another program is called a <em class="cEmphasis">participant</em>. A transaction can have several participants. A service can be invoked to do work on the same transaction more than once. Only the initiator of a transaction (that is, a program calling either <code class="cCode">TPBEGIN()</code> or <code class="cCode">TPRESUME()</code>) can call <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. Participants influence the outcome of a transaction by using <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code>. These two calls signify the end of a service routine and indicate that the routine has finished its part of the transaction.
</p>
<h4 class="pHeading3"><a name="wp1002984"> </a>
TX Transactions
</h4>
<p class="pBody"><a name="wp1002985"> </a>
Transactions defined by the TX Interface are practically identical with those defined by the ATMI functions. An application writer may use either set of functions when writing clients and service routines. In fact, the Oracle Tuxedo system does not require all client and server programs within a single application to use one set of functions or the other. However, the two function sets may not be used together within a single program (that is, a program cannot call <code class="cCode">TPBEGIN()</code> and later call <code class="cCode">TXCOMMIT()</code>).
</p>
<p class="pBody"><a name="wp1002986"> </a>
The TX Interface has two calls for opening and closing resource managers in a portable manner, <code class="cCode">TXOPEN()</code> and <code class="cCode">TXCLOSE()</code>, respectively. Transactions are started with <code class="cCode">TXBEGIN()</code> and completed with either <code class="cCode">TXCOMMIT()</code> or <code class="cCode">TXROLLBACK()</code>. <code class="cCode">TXINFORM()</code> is used to retrieve transaction information, and there are three calls to set options for transactions: <code class="cCode">TXSETCOMMITRET()</code>, <code class="cCode">TXSETTRANCTL()</code>, and <code class="cCode">TXSETTIMEOUT()</code>. The TX Interface has no equivalents to ATMI&#8217;s <code class="cCode">TPSUSPEND()</code> and <code class="cCode">TPRESUME()</code>.
</p>
<p class="pBody"><a name="wp1002987"> </a>
In addition to the semantics and rules defined for ATMI transactions, the TX Interface has some additional semantics that are worth introducing here. First, service routine writers wanting to use the TX Interface must supply their own <code class="cCode">TPSVRINIT()</code> routine that calls <code class="cCode">TXOPEN()</code>. The default Oracle Tuxedo system-supplied <code class="cCode">TPSVRINIT()</code> calls <code class="cCode">TPOPEN()</code>. The same rule applies for <code class="cCode">TPSVRDONE()</code>: if the TX Interface is being used, then service routine writers must supply their own <code class="cCode">TPSVRDONE()</code> that calls <code class="cCode">TXCLOSE()</code>.
</p>
<p class="pBody"><a name="wp1002988"> </a>
Second, the TX Interface has two additional semantics not found in ATMI. These are chained and unchained transactions, and transaction characteristics.
</p>
<h4 class="pHeading3"><a name="wp1002989"> </a>
Chained and Unchained Transactions
</h4>
<p class="pBody"><a name="wp1002990"> </a>
The TX Interface supports chained and unchained modes of transaction execution. By default, clients and service routines execute in the unchained mode; when an active transaction is completed, a new transaction does not begin until <code class="cCode">TXBEGIN()</code> is called.
</p>
<p class="pBody"><a name="wp1002991"> </a>
In the chained mode, a new transaction starts implicitly when the current transaction completes. That is, when <code class="cCode">TXCOMMIT()</code> or <code class="cCode">TXROLLBACK()</code> is called, the Oracle Tuxedo system coordinates the completion of the current transaction and initiates a new transaction before returning control to the caller. (Certain failure conditions may prevent a new transaction from starting.)
</p>
<p class="pBody"><a name="wp1002992"> </a>
Clients and service routines enable or disable the chained mode by calling <code class="cCode">TXSETTRANCTL()</code>. Transitions between the chained and unchained mode affect the behavior of the next <code class="cCode">TXCOMMIT()</code> or <code class="cCode">TXROLLBACK()</code> call. The call to <code class="cCode">TXSETTRANCTL()</code> does not put the caller into or take it out of transaction mode.
</p>
<p class="pBody"><a name="wp1002993"> </a>
Since <code class="cCode">TXCLOSE()</code> cannot be called when the caller is in transaction mode, a caller executing in chained mode must switch to unchained mode and complete the current transaction before calling <code class="cCode">TXCLOSE()</code>.
</p>
<h4 class="pHeading3"><a name="wp1002994"> </a>
Transaction Characteristics
</h4>
<p class="pBody"><a name="wp1002995"> </a>
A client or a service routine may call <code class="cCode">TXINFORM()</code> to obtain the current values of their transaction characteristics and to determine whether they are executing in transaction mode.
</p>
<p class="pBody"><a name="wp1002996"> </a>
The state of an application program includes several transaction characteristics. The caller specifies these by calling <code class="cCode">TXSET*</code> functions. When a client or a service routine sets the value of a characteristic, it remains in effect until the caller specifies a different value. When the caller obtains the value of a characteristic via <code class="cCode">TXINFORM()</code>, it does not change the value.
</p>
<h4 class="pHeading3"><a name="wp1002997"> </a>
Timeouts
</h4>
<p class="pBody"><a name="wp1002998"> </a>
There are three types of timeouts in the Oracle Tuxedo ATMI system: one is associated with the duration of a transaction from start to finish. A second is associated with the maximum length of time a blocking call will remain blocked before the caller regains control. The third is a service timeout and occurs when a call exceeds the number of seconds specified in the <code class="cCode">SVCTIMEOUT</code> parameter in the <code class="cCode">SERVICES</code> section of the configuration file.
</p>
<p class="pBody"><a name="wp1338711"> </a>
The first kind of timeout is specified when a transaction is started with <code class="cCode">TPBEGIN()</code> (see <code class="cCode">TPBEGIN()</code> for details). The second kind of timeout can occur when using the Oracle Tuxedo ATMI communication routines defined in <code class="cCode">TPCALL()</code>. Callers of these routines typically block when awaiting a reply that has yet to arrive, although they can also block trying to send data (for example, if request queues are full). The maximum amount of time a caller remains blocked is determined by an Oracle Tuxedo ATMI configuration file parameter. (See the <code class="cCode">BLOCKTIME</code> parameter in <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details.)
</p>
<p class="pBody"><a name="wp1338712"> </a>
Blocking timeouts are performed by default when the caller is not in transaction mode. When a client or server is in transaction mode, it is subject to the timeout value with which the transaction was started and is not subject to the blocking timeout value specified in the <code class="cCode">UBBCONFIG</code> file.
</p>
<p class="pBody"><a name="wp1003000"> </a>
When a transaction timeout occurs, replies to asynchronous requests made in transaction mode become invalid. That is, if a program is waiting for a particular asynchronous reply for a request sent in transaction mode and a transaction timeout occurs, the handle for that reply becomes invalid. Similarly, if a transaction timeout occurs, an event is generated on the connection handle associated with the transaction and that handle becomes invalid. On the other hand, if a blocking timeout occurs, the handle is still valid and the waiting program can reissue the call to await the reply.
</p>
<p class="pBody"><a name="wp1003001"> </a>
The service timeout mechanism provides a way for the system to kill processes that may be frozen by some unknown or unexpected system error. When a service timeout occurs in a request/response service, the Oracle Tuxedo system kills the server process that is executing the frozen service and returns error code <code class="cCode">TPESVCERR</code>. If a service timeout occurs in a conversational service, the <code class="cCode">TPEV_SVCERR</code> event is returned.
</p>
<p class="pBody"><a name="wp1230074"> </a>
If a transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</p>
<h4 class="pHeading3"><a name="wp1003003"> </a>
Dynamic Service Advertisements
</h4>
<p class="pBody"><a name="wp1003004"> </a>
By default, a server&#8217;s services are advertised when it is booted and unadvertised when it is shut down. If a server needs to control the set of services that it offers at run time, it can do so by calling <code class="cCode">TPADVERTISE()</code> and <code class="cCode">TPUNADVERTISE()</code>. These routines affect only the services offered by the calling server unless that server belongs to a multiple server, single queue (MSSQ) set. Because all servers in an MSSQ set must offer the same set of services, these routines also affect the advertisements of all servers sharing the caller&#8217;s MSSQ set.
</p>
<h4 class="pHeading3"><a name="wp1003005"> </a>
Typed Records
</h4>
<p class="pBody"><a name="wp1003006"> </a>
In order to send data to another application program, the sending application program first places the data in a <code class="cCode">record</code>. The ATMI interface supports the notion of a <code class="cCode">typed record</code>. A typed record is really a pair of COBOL records. The data record is defined in static storage and contains application data to be passed to another application program. An auxiliary type record accompanies the data record and it identifies to the Oracle Tuxedo system the interpretation and translation rules of the data record as it passes across heterogeneous machine boundaries. The auxiliary type record contains the data record&#8217;s type, its optional subtype, and its optional length. Some record types require further specification via a subtype (for example, a particular record layout) and those of variable length require a length to be specified.
</p>
<p class="pBody"><a name="wp1003007"> </a>
The application programmer may choose one of the six supported typed records. Note, the Oracle Tuxedo system provides a method for adding user-specific typed records. For details, refer to the &#8220;Introduction to the C Language Application-Transaction Monitor Interface&#8221; in the <em class="cEmphasis">Oracle Tuxedo ATMI C Function Reference</em>. <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> selects which record type the application wishes to send or receive. <code class="cCode">SUB-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> must also be given when further classification is required (for example, a view record). When sending, <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> indicates the number of bytes to be sent and when receiving the number of bytes to move into the user&#8217;s record. The following are the supported <code class="cCode">REC-TYPE</code>s. 
</p>
<h4 class="pDefTerm"><a name="wp1003008"> </a>
<code class="cCode">CARRAY</code> 
</h4><div class="pDefPara"><a name="wp1003009"> </a>
The <code class="cCode">CARRAY</code> record type allows an arbitrary number of characters which may contain <code class="cCode">LOW-VALUE</code> characters anywhere in the record. When sending data, <code class="cCode">LEN</code> must contain the number of bytes to be transferred.
</div>
<h4 class="pDefTerm"><a name="wp1003010"> </a>
<code class="cCode">STRING</code> 
</h4><div class="pDefPara"><a name="wp1003011"> </a>
The <code class="cCode">STRING</code> record type allows an arbitrary number of characters which may not contain <code class="cCode">LOW-VALUE</code> characters within the record but may be at the end of the record. When sending data, <code class="cCode">LEN</code> must contain the number of bytes to be transferred.
</div>
<h4 class="pDefTerm"><a name="wp1003012"> </a>
<code class="cCode">VIEW</code> 
</h4><div class="pDefPara"><a name="wp1003013"> </a>
This record type describes a COBOL record that was generated using the <code class="cCode">viewc()</code> compiler. When using a <code class="cCode">VIEW</code>, <code class="cCode">SUB-TYPE</code> must contain the name of the view. When sending a <code class="cCode">VIEW</code> type, <code class="cCode">LEN</code> must contain the number of bytes to be transferred or set <code class="cCode">NO-LENGTH</code> which will send the length of the view.
</div>
<p class="pBody"><a name="wp1003014"> </a>
Two of the above record types have synonyms: <code class="cCode">X_OCTET</code> is a synonym for <code class="cCode">CARRAY</code>, and <code class="cCode">X_COMMON</code> is a synonym for <code class="cCode">VIEW</code>. <code class="cCode">X_COMMON</code> supports a subset of the data types supported by <code class="cCode">VIEW</code>: <code class="cCode">longs (PIC S9(9) COMP-5)</code>, <code class="cCode">shorts (PIC S9(4) COMP-5)</code>, and <code class="cCode">characters (PIC X(n))</code>. <code class="cCode">X_COMMON</code> should be used when both C and COBOL programs are communicating.
</p>
<p class="pBody"><a name="wp1003015"> </a>
In all three cases, after a successful transfer, <code class="cCode">LEN</code> contains the number of bytes transferred. When receiving data, <code class="cCode">LEN</code> must contain the maximum number of bytes the data area contains. After a successful call, <code class="cCode">LEN</code> contains the number of bytes moved into the data area. If the size of the incoming message is larger than the size specified in <code class="cCode">LEN</code>, only <code class="cCode">LEN</code> amount of data is moved into the data area; the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp1003016"> </a>
Buffer Type Switch
</h4>
<p class="pBody"><a name="wp1003017"> </a>
The Oracle Tuxedo system provides a method for adding user specific record types. For details, see the &#8220;Buffer Type Switch&#8221; section in <span class="cHyperlink">
Introductio</span><a href="../rf3c/rf3c.html"></a>n to the C Language Application-to-Transaction Monitor Interface in <em class="cEmphasis">Oracle Tuxedo ATMI C Function Reference</em>.
</p>
<h4 class="pHeading3"><a name="wp1024236"> </a>
Single or Multiple Application Context per Process
</h4>
<p class="pBody"><a name="wp1024238"> </a>
The Oracle Tuxedo system allows client programs to create an association with one or more applications per process. If <code class="cCode">TPINITIALIZE()</code> is called with the <code class="cCode">TP-MULTI-CONTEXTS</code> setting of <code class="cCode">CONTEXTS-FLAG</code> in <code class="cCode">TPINFDEF-REC</code>, then multiple client contexts are allowed. If <code class="cCode">TPINITIALIZE()</code> is called implicitly or the <code class="cCode">CONTEXTS-FLAG</code> is not set to <code class="cCode">TP-MULTI-CONTEXTS</code>, then only a single application association is allowed.
</p>
<p class="pBody"><a name="wp1024239"> </a>
In single-context mode, if <code class="cCode">TPINITIALIZE()</code> is called more than once (that is, if it is called after the client has already joined the application), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1024240"> </a>
In multi-context mode, each call to <code class="cCode">TPINITIALIZE()</code> creates a new application association. The program can obtain a handle representing this application association by calling <code class="cCode">TPGETCTXT()</code> and it can call <code class="cCode">TPSETCTXT()</code> to set its context.
</p>
<p class="pBody"><a name="wp1024241"> </a>
Once an application has chosen single-context mode, all calls to <code class="cCode">TPINITIALIZE()</code> must specify single-context mode until all application associations are terminated. Similarly, once an application has chosen multi-context mode, all calls to <code class="cCode">TPINITIALIZE()</code> must specify multi-context mode until all application associations are terminated.
</p>
<p class="pBody"><a name="wp1024242"> </a>
Server programs can be associated with only a single application and cannot act as clients.
</p>
<a name="wp1024243"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>In addition to allowing multiple application contexts per process, the Oracle Tuxedo system allows multiple application threads per process. Multithreading is supported, however, only in the C language interface.</td>
</tr>
</table>

<p class="pBody"><a name="wp1024244"> </a>
<a href="rf3cbl.html#wp1124549">Table&#160;2</a> shows the transitions that may occur, within a client process, among the following states: the uninitialized state, the initialized in single-context mode state, and the initialized in multi-context mode state.
</p>
<p class="pGraphic"><a name="wp1035961"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1124549table1035888"><caption><a name="wp1124549"> </a>
Table&#160;2  Per-Process Context Modes

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1035890"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp1035892"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1035900"> </a>
Uninitialized<br />S<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1035902"> </a>
Initialized Single-context Mode <br />S<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1035904"> </a>
Initialized Multi-context Mode S<sub class="cSubscript">2</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035906"> </a>
<code class="cCode">TPINITIALIZE()</code> without <code class="cCode">TP-MULTI-CONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035908"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035910"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035912"> </a>
S<sub class="cSubscript">2</sub> (<code class="cCodeEmphasis">error</code>)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035914"> </a>
<code class="cCode">TPINITIALIZE()</code> with <code class="cCode">TP-MULTI-CONTEXTS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035916"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035918"> </a>
S<sub class="cSubscript">1 </sub>(<code class="cCodeEmphasis">error</code>)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035920"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035922"> </a>
Implicit <code class="cCode">TPINITIALIZE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035924"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035926"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035928"> </a>
S<sub class="cSubscript">2</sub> (<code class="cCodeEmphasis">error</code>)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035938"> </a>
<code class="cCode">TPTERM()</code> - not last association
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035944"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035946"> </a>
<code class="cCode">TPTERM()</code> - last association
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035950"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035952"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035954"> </a>
<code class="cCode">TPTERM()</code> - no association
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1035956"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pHeading3"><a name="wp1003018"> </a>
Unsolicited Notification
</h4>
<p class="pBody"><a name="wp1112972"> </a>
There are two methods for sending messages to application clients outside the boundaries of the client/server interaction defined above. The first is the broadcast mechanism supported by <code class="cCode">TPBROADCAST()</code>. This function allows application clients, servers, and administrators to broadcast typed record messages to a set of clients selected on the basis of the names assigned to them. The names assigned to clients are determined in part by the application (specifically, by the information passed in the <code class="cCodeEmphasis">TPINFDEF-REC</code> data structure at <code class="cCode">TPINITIALIZE</code> time) and in part by the system (based on the processor through which the client accesses the application).
</p>
<p class="pBody"><a name="wp1112973"> </a>
The second is the notification of a particular client as identified from an earlier or current service request. Each service request contains a unique client identifier that identifies the originating client for the service request. Calls to the <code class="cCode">TPCALL()</code> and <code class="cCode">TPFORWAR()</code> functions from within a service routine do not change the originating client for that chain of service requests. Client identifiers can be saved and passed between application servers. The <code class="cCode">TPNOTIFY()</code> function is used to notify clients identified in this manner.
</p>
<h4 class="pHeading3"><a name="wp1003021"> </a>
COBOL Language ATMI Return Codes and Other Definitions
</h4>
<p class="pBody"><a name="wp1003022"> </a>
The following return code and setting definitions are used by the ATMI routines: 
</p>
<a name="wp1003023"> </a><div class="pPreformatted"><pre>*<br />* TPSTATUS.cbl<br />*<br />05 TP-STATUS       PIC S9(9) COMP-5.<br />  88 TPOK            VALUE 0.<br />  88 TPEABORT        VALUE 1.<br />  88 TPEBADDESC      VALUE 2.<br />  88 TPEBLOCK        VALUE 3.<br />  88 TPEINVAL        VALUE 4.<br />  88 TPELIMIT        VALUE 5.<br />  88 TPENOENT        VALUE 6.<br />  88 TPEOS           VALUE 7.<br />  88 TPEPERM         VALUE 8.<br />  88 TPEPROTO        VALUE 9.<br />  88 TPESVCERR       VALUE 10.<br />  88 TPESVCFAIL      VALUE 11.<br />  88 TPESYSTEM       VALUE 12.<br />  88 TPETIME         VALUE 13.<br />  88 TPETRAN         VALUE 14.<br />  88 TPEGOTSIG       VALUE 15.<br />  88 TPERMERR        VALUE 16.<br />  88 TPEITYPE        VALUE 17.<br />  88 TPEOTYPE        VALUE 18.<br />  88 TPERELEASE      VALUE 19.<br />  88 TPEHAZARD       VALUE 20.<br />  88 TPEHEURISTIC    VALUE 21.<br />  88 TPEEVENT        VALUE 22.<br />  88 TPEMATCH        VALUE 23.<br />  88 TPEDIAGNOSTIC   VALUE 24.<br />  88 TPEMIB          VALUE 25.<br />  88 TPEMAXVAL       VALUE 26.<br />05 TPEVENT         PIC S9(9) COMP-5.<br />  88 TPEV-NOEVENT    VALUE 0.<br />  88 TPEV-DISCONIMM  VALUE 1.<br />  88 TPEV-SENDONLY   VALUE 2.<br />  88 TPEV-SVCERR     VALUE 3.<br />  88 TPEV-SVCFAIL    VALUE 4.<br />  88 TPEV-SVCSUCC    VALUE 5.<br />05 TPSVCTIMOUT     PIC S9(9) COMP-5.<br />  88 TPED-NOEVENT    VALUE 0.<br />  88 TPEV-SVCTIMEOUT VALUE 1.<br />  88 TPEV-TERM       VALUE 2.<br />05 APPL-RETURN-CODE PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1003024"> </a>
The <code class="cCodeEmphasis">TPTYPE</code> COBOL structure is used whenever sending or receiving application data. <code class="cCode">REC-TYPE</code> indicates the type of data record that is to be sent. <code class="cCode">SUB-TYPE</code> indicates the name of the view if a <code class="cCode">VIEW</code> <code class="cCode">REC-TYPE</code> is specified. <code class="cCode">LEN</code> indicates the amount of data to send and the amount received. 
</p>
<a name="wp1003025"> </a><div class="pPreformatted"><pre>*<br />* TPTYPE.cbl<br />*<br />05 REC-TYPE      PIC X(8).<br />  88 X-OCTET       VALUE &quot;X_OCTET&quot;.<br />  88 X-COMMON      VALUE &quot;X_COMMON&quot;.<br />05 SUB-TYPE      PIC X(16).<br />05 LEN           PIC S9(9) COMP-5.<br />  88 NO-LENGTH     VALUE 0.<br />05 TPTYPE-STATUS PIC S9(9) COMP-5.<br />  88 TPTYPEOK      VALUE 0.<br />  88 TPTRUNCATE    VALUE 1.</pre></div><p class="pBody"><a name="wp1003026"> </a>
The <code class="cCode">TPSVCDEF</code> data structure is used by functions to pass settings to and from the Oracle Tuxedo system: 
</p>
<a name="wp1131348"> </a><div class="pPreformatted"><pre>*<br />* TPSVCDEF.cbl <br />*<br />05 COMM-HANDLE         PIC S9(9) COMP-5.<br />05 TPBLOCK-FLAG        PIC S9(9) COMP-5.<br />  88 TPBLOCK             VALUE 0.<br />  88 TPNOBLOCK           VALUE 1.<br />05 TPTRAN-FLAG         PIC S9(9) COMP-5.<br />  88 TPTRAN              VALUE 0.<br />  88 TPNOTRAN            VALUE 1.<br />05 TPREPLY-FLAG        PIC S9(9) COMP-5.<br />  88 TPREPLY             VALUE 0.<br />  88 TPNOREPLY           VALUE 1.<br />05 TPACK-FLAG          PIC S9(9) COMP-5 REDEFINES TPREPLY-FLAG.<br />  88 TPNOACK             VALUE 0.<br />  88 TPACK               VALUE 1.<br />05 TPTIME-FLAG         PIC S9(9) COMP-5.<br />  88 TPTIME              VALUE 0.<br />  88 TPNOTIME            VALUE 1.<br />05 TPSIGRSTRT-FLAG     PIC S9(9) COMP-5.<br />  88 TPNOSIGRSTRT        VALUE 0.<br />  88 TPSIGRSTRT          VALUE 1.<br />05 TPGETANY-FLAG       PIC S9(9) COMP-5.<br />  88 TPGETHANDLE         VALUE 0.<br />  88 TPGETANY            VALUE 1.<br />05 TPSENDRECV-FLAG     PIC S9(9) COMP-5.<br />  88 TPSENDONLY          VALUE 0.<br />  88 TPRECVONLY          VALUE 1.<br />05 TPNOCHANGE-FLAG     PIC S9(9) COMP-5.<br />  88 TPCHANGE            VALUE 0.<br />  88 TPNOCHANGE          VALUE 1.<br />05 TPSERVICETYPE-FLAG  PIC S9(9) COMP-5.<br />  88 TPREQRSP            VALUE IS 0.<br />  88 TPCONV              VALUE IS 1.<br />*<br />05 APPKEY              PIC S9(9) COMP-5.<br />05 CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5.<br />05 SERVICE-NAME        PIC X(127).</pre></div><p class="pBody"><a name="wp1003028"> </a>
The <code class="cCodeEmphasis">TPINFDEF</code> data structure is used by <code class="cCode">TPINITIALIZE()</code> to join the application:
</p>
<a name="wp1040880"> </a><div class="pPreformatted"><pre>*<br />* TPINFDEF.cbl<br />*<br />05 USRNAME            PIC X(30).<br />05 CLTNAME            PIC X(30).<br />05 PASSWD             PIC X(30).<br />05 GRPNAME            PIC X(30).<br />05 NOTIFICATION-FLAG  PIC S9(9) COMP-5.<br />  88 TPU-SIG           VALUE 1.<br />  88 TPU-DIP           VALUE 2.<br />  88 TPU-IGN           VALUE 3.<br />05 ACCESS-FLAG        PIC S9(9) COMP-5.<br />  88 TPSA-FASTPATH     VALUE 1.<br />  88 TPSA-PROTECTED    VALUE 2.<br />05 CONTEXTS-FLAG      PIC S9(9) COMP-5.<br />  88 TP-SINGLE-CONTEXT VALUE 0.<br />  88 TP-MULTI-CONTEXTS VALUE 1.<br />05 DATALEN            PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1036206"> </a>
The <code class="cCode">TPCONTEXTDEF</code> data structure is used by <code class="cCode">TPGETCTXT()</code> and <code class="cCode">TPSETCTXT()</code> to manipulate program contexts:
</p>
<a name="wp1036208"> </a><div class="pPreformatted"><pre>      *</pre></div><a name="wp1036209"> </a><div class="pPreformatted"><pre>      *  TPCONTEXTDEF.cbl</pre></div><a name="wp1036210"> </a><div class="pPreformatted"><pre>      *</pre></div><a name="wp1036211"> </a><div class="pPreformatted"><pre>       05 CONTEXT     PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1036196"> </a>
The <code class="cCodeEmphasis">TPQUEDEF</code> data structure is used to pass and retrieve information associated with enqueuing the message:
</p>
<a name="wp1077658"> </a><div class="pPreformatted"><pre>*<br />* TPQUEDEF.cbl<br />*<br />05 TPBLOCK-FLAG                  PIC S9(9) COMP-5.<br />  88 TPNOBLOCK                     VALUE 0.<br />  88 TPBLOCK                       VALUE 1.<br />05 TPTRAN-FLAG                   PIC S9(9) COMP-5.<br />  88 TPNOTRAN                      VALUE 0.<br />  88 TPTRAN                        VALUE 1.<br />05 TPTIME-FLAG                   PIC S9(9) COMP-5.<br />  88 TPNOTIME                      VALUE 0.<br />  88 TPTIME                        VALUE 1.<br />05 TPSIGRSTRT-FLAG               PIC S9(9) COMP-5.<br />  88 TPNOSIGRSTRT                  VALUE 0.<br />  88 TPSIGRSTRT                    VALUE 1.<br />05 TPNOCHANGE-FLAG               PIC S9(9) COMP-5.<br />  88 TPNOCHANGE                    VALUE 0.<br />  88 TPCHANGE                      VALUE 1.<br />05 TPQUE-ORDER-FLAG              PIC S9(9) COMP-5.<br />  88 TPQDEFAULT                    VALUE 0.<br />  88 TPQTOP                        VALUE 1.<br />  88 TPQBEFOREMSGID                VALUE 2.<br />05 TPQUE-TIME-FLAG               PIC S9(9) COMP-5.<br />  88 TPQNOTIME                     VALUE 0.<br />  88 TPQTIME-ABS                   VALUE 1.<br />  88 TPQTIME-REL                   VALUE 2.<br />05 TPQUE-PRIORITY-FLAG           PIC S9(9) COMP-5.<br />  88 TPQNOPRIORITY                 VALUE 0.<br />  88 TPQPRIORITY                   VALUE 1.<br />05 TPQUE-CORRID-FLAG             PIC S9(9) COMP-5.<br />  88 TPQNOCORRID                   VALUE 0.<br />  88 TPQCORRID                     VALUE 1.<br />05 TPQUE-REPLYQ-FLAG             PIC S9(9) COMP-5.<br />  88 TPQNOREPLYQ                   VALUE 0.<br />  88 TPQREPLYQ                     VALUE 1.<br />05 TPQUE-FAILQ-FLAG              PIC S9(9) COMP-5.<br />  88 TPQNOFAILUREQ                 VALUE 0.<br />  88 TPQFAILUREQ                   VALUE 1.<br />05 TPQUE-MSGID-FLAG              PIC S9(9) COMP-5.<br />  88 TPQNOMSGID                    VALUE 0.<br />  88 TPQMSGID                      VALUE 1.<br />05 TPQUE-GETBY-FLAG              PIC S9(9) COMP-5.<br />  88 TPQGETNEXT                    VALUE 0.<br />  88 TPQGETBYMSGIDOLD              VALUE 1.<br />  88 TPQGETBYCORRIDOLD             VALUE 2.<br />  88 TPQGETBYMSGID                 VALUE 3.<br />  88 TPQGETBYCORRID                VALUE 4.<br />05 TPQUE-WAIT-FLAG               PIC S9(9) COMP-5.<br />  88 TPQNOWAIT                     VALUE 0.<br />  88 TPQWAIT                       VALUE 1.<br />05 TPQUE-DELIVERY-FLAG           PIC S9(9) COMP-5.<br />  88 TPQNODELIVERYQOS              VALUE 0.<br />  88 TPQDELIVERYQOS                VALUE 1.<br />05 TPQUEQOS-DELIVERY-FLAG        PIC S9(9) COMP-5.<br />  88 TPQQOSDELIVERYDEFAULTPERSIST  VALUE 0.<br />  88 TPQQOSDELIVERYPERSISTENT      VALUE 1. <br />  88 TPQQOSDELIVERYNONPERSISTENT   VALUE 2.<br />05 TPQUE-REPLY-FLAG              PIC S9(9) COMP-5.<br />  88 TPQNOREPLYQOS                 VALUE 0.<br />  88 TPQREPLYQOS                   VALUE 1.<br />05 TPQUEQOS-REPLY-FLAG           PIC S9(9) COMP-5.<br />  88 TPQQOSREPLYDEFAULTPERSIST     VALUE 0.<br />  88 TPQQOSREPLYPERSISTENT         VALUE 1. <br />  88 TPQQOSREPLYNONPERSISTENT      VALUE 2.<br />05 TPQUE-EXPTIME-FLAG            PIC S9(9) COMP-5.<br />  88 TPQNOEXPTIME                  VALUE 0.<br />  88 TPQEXPTIME-ABS                VALUE 1. <br />  88 TPQEXPTIME-REL                VALUE 2.<br />  88 TPQEXPTIME-NONE               VALUE 3.<br />05 TPQUE-PEEK-FLAG               PIC S9(9) COMP-5.<br />  88 TPQNOPEEK                     VALUE 0.<br />  88 TPQPEEK                       VALUE 1.<br />05 DIAGNOSTIC                    PIC S9(9) COMP-5.<br />  88 QMEINVAL                      VALUE -1.<br />  88 QMEBADRMID                    VALUE -2.<br />  88 QMENOTOPEN                    VALUE -3.<br />  88 QMETRAN                       VALUE -4.<br />  88 QMEBADMSGID                   VALUE -5.<br />  88 QMESYSTEM                     VALUE -6.<br />  88 QMEOS                         VALUE -7.<br />  88 QMEABORTED                    VALUE -8.<br />  88 QMEPROTO                      VALUE -9.<br />  88 QMEBADQUEUE                   VALUE -10.<br />  88 QMENOMSG                      VALUE -11.<br />  88 QMEINUSE                      VALUE -12.<br />  88 QMENOSPACE                    VALUE -13.<br />  88 QMERELEASE                    VALUE -14.<br /><code class="cCode">  88 QMEINVHANDLE                  VALUE -15.<br />  88 QMESHARE                      VALUE -16.<br /></code>05 DEQ-TIME                      PIC S9(9) COMP-5.<br />05 EXP-TIME                      PIC S9(9) COMP-5.<br />05 PRIORITY                      PIC S9(9) COMP-5.<br />05 MSGID                         PIC X(32).<br />05 CORRID                        PIC X(32).<br />05 QNAME                         PIC X(127).<br />05 QSPACE-NAME                   PIC X(127).<br />05 REPLYQUEUE                    PIC X(127).<br />05 FAILUREQUEUE                  PIC X(127).<br />05 CLIENTID OCCURS4 TIMES        PIC S9(9) COMP-5.<br />05 APPL-RETURN-CODE              PIC S9(9) COMP-5.<br />05 APPKEY                        PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1003032"> </a>
The <code class="cCodeEmphasis">TPSVCRET</code> data structure is used by <code class="cCode">TPRETURN()</code> to indicate the status of the transaction:
</p>
<a name="wp1003033"> </a><div class="pPreformatted"><pre>*<br />* TPSVCRET.cbl<br />*<br />05 TP-RETURN-VAL                 PIC S9(9) COMP-5.<br />  88 TPSUCCESS                     VALUE 0.<br />  88 TPFAIL                        VALUE 1.<br />  88 TPEXIT                        VALUE 2.<br />05 APPL-CODE                     PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1003034"> </a>
The <code class="cCodeEmphasis">TPTRXDEF</code> data structure is used by <code class="cCode">TPBEGIN()</code> to set transaction timeouts, and by <code class="cCode">TPSUSPEND()</code> and <code class="cCode">TPRESUME()</code> to get and set, respectively, transaction identifiers:
</p>
<a name="wp1003035"> </a><div class="pPreformatted"><pre>*<br />* TPTRXDEF.cbl<br />*<br />05 T-OUT                        PIC S9(9) COMP-5 VALUE IS 0.<br />05 TRANID       OCCURS 6 TIMES   PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp1003036"> </a>
The <code class="cCodeEmphasis">TPCMTDEF</code> data structure is used by <code class="cCode">TPSCMT()</code> to set the commit level characteristics:
</p>
<a name="wp1003037"> </a><div class="pPreformatted"><pre>*<br />* TPCMTDEF.cbl<br />*<br />05 CMT-FLAG                      PIC S9(9) COMP-5.<br />  88 TP-CMT-LOGGED                 VALUE 1.<br />  88 TP-CMT-COMPLETE               VALUE 2.<br />05 PREV-CMT-FLAG                 PIC S9(9) COMP-5.<br />  88 PREV-TP-CMT-LOGGED            VALUE 1.<br />  88 PREV-TP-CMT-COMPLETE          VALUE 2.</pre></div><p class="pBody"><a name="wp1003038"> </a>
The <code class="cCodeEmphasis">TPAUTDEF</code> data structure is used by <code class="cCode">TPCHKAUTH()</code> to check if authentication is required:
</p>
<a name="wp1003039"> </a><div class="pPreformatted"><pre>* TPAUTDEF.cbl<br />*<br />05 AUTH-FLAG                     PIC S9(9) COMP-5.<br />  88 TPNOAUTH                      VALUE 0.<br />  88 TPSYSAUTH                     VALUE 1.<br />  88 TPAPPAUTH                     VALUE 2.</pre></div><p class="pBody"><a name="wp1003040"> </a>
The <code class="cCodeEmphasis">TPPRIDEF</code> data structure is used by <code class="cCode">TPSPRIO()</code> and <code class="cCode">TPGPRIO()</code> to manipulate message priorities:
</p>
<a name="wp1003041"> </a><div class="pPreformatted"><pre>*<br />* TPPRIDEF.cbl<br />*<br />05 PRIORITY                      PIC S9(9) COMP-5.<br />05 PRIO-FLAG                     PIC S9(9) COMP-5.<br />  88 TPABSOLUTE                    VALUE 0.<br />  88 TPRELATIVE                    VALUE 1.</pre></div><p class="pBody"><a name="wp1003042"> </a>
The <code class="cCodeEmphasis">TPTRXLEV</code> data structure is used by <code class="cCode">TPGETLEV()</code> to receive transaction level setting:
</p>
<a name="wp1003043"> </a><div class="pPreformatted"><pre>*<br />* TPTRXLEV.cbl<br />*<br />05 TPTRXLEV-FLAG     PIC S9(9) COMP-5.<br />  88 TP-NOT-IN-TRAN    VALUE 0.<br />  88 TP-IN-TRAN        VALUE 1.</pre></div><p class="pBody"><a name="wp1003044"> </a>
The <code class="cCodeEmphasis">TPBCTDEF</code> data structure is used by <code class="cCode">TPNOTIFY()</code> and <code class="cCode">TPBROADCAST()</code> to send notifications:
</p>
<a name="wp1187864"> </a><div class="pPreformatted"><pre>*<br />* TPBCTDEF.cbl<br />*<br />05 TPBLOCK-FLAG      PIC S9(9) COMP-5.<br />  88 TPBLOCK           VALUE 0.<br />  88 TPNOBLOCK         VALUE 1.<br />05 TPTIME-FLAG       PIC S9(9) COMP-5.<br />  88 TPTIME            VALUE 0.<br />  88 TPNOTIME          VALUE 1.<br />05 TPSIGRSTRT-FLAG   PIC S9(9) COMP-5.<br />  88 TPNOSIGRSTRT      VALUE 0.<br />  88 TPSIGRSTRT        VALUE 1.<br />05 LMID              PIC X(30).<br />05 USERNAME          PIC X(30).<br />05 CLTNAME           PIC X(30).</pre></div><p class="pBody"><a name="wp1187865"> </a>
The <code class="cCodeEmphasis">FML-INFO</code> data structure is used by <code class="cCode">FINIT()</code>, <code class="cCode">FVSTOF()</code>, and <code class="cCode">FVFTOS()</code> to deal with FML buffers:
</p>
<a name="wp1187912"> </a><div class="pPreformatted"><pre>*<br />* FMLINFO.cbl<br />*<br />05 FML-STATUS        PIC S9(9) COMP-5.<br />  88 FOK               VALUE 0.<br />  88 FALIGNERR         VALUE 1.<br />  88 FNOTFLD           VALUE 2.<br />  88 FNOSPACE          VALUE 3.<br />  88 FNOTPRES          VALUE 4.<br />  88 FBADFLD           VALUE 5.<br />  88 FTYPERR           VALUE 6.<br />  88 FEUNIX            VALUE 7.<br />  88 FBADNAME          VALUE 8.<br />  88 FMALLOC           VALUE 9.<br />  88 FSYNTAX           VALUE 10.<br />  88 FFTOPEN           VALUE 11.<br />  88 FFTSYNTAX         VALUE 12.<br />  88 FEINVAL           VALUE 13.<br />  88 FBADTBL           VALUE 14.<br />  88 FBADVIEW          VALUE 15.<br />  88 FVFSYNTAX         VALUE 16.<br />  88 FVFOPEN           VALUE 17.<br />  88 FBADACM           VALUE 18.<br />  88 FNOCNAME          VALUE 19.<br />  88 FEBADOP           VALUE 20.<br />*<br />05 FML-LENGTH        PIC S9(9) COMP-5.<br />*<br />05 FML-MODE          PIC S9(9) COMP-5.<br />  88 FUPDATE           VALUE 1.<br />  88 FCONCAT           VALUE 2.<br />  88 FJOIN             VALUE 3.<br />  88 FOJOIN            VALUE 4.<br />*<br />05 VIEWNAME          PIC X(33).</pre></div><p class="pBody"><a name="wp1003048"> </a>
The <code class="cCodeEmphasis">TPEVTDEF</code> data structure is used by <code class="cCode">TPPOST()</code>, <code class="cCode">TPSUBSCRIBE()</code>, and <code class="cCode">TPUNSUBSCRIBE()</code> to handle event postings and subscriptions:
</p>
<a name="wp1003049"> </a><div class="pPreformatted"><pre>*<br />* TPEVTDEF.cbl<br />*<br />05 TPBLOCK-FLAG        PIC S9(9) COMP-5.<br />  88 TPBLOCK             VALUE 0.<br />  88 TPNOBLOCK           VALUE 1.<br />05 TPTRAN-FLAG         PIC S9(9) COMP-5.<br />  88 TPTRAN              VALUE 0.<br />  88 TPNOTRAN            VALUE 1.<br />05 TPREPLY-FLAG        PIC S9(9) COMP-5.<br />  88 TPREPLY             VALUE 0.<br />  88 TPNOREPLY           VALUE 1.<br />05 TPTIME-FLAG         PIC S9(9) COMP-5.<br />  88 TPTIME              VALUE 0.<br />  88 TPNOTIME            VALUE 1.<br />05 TPSIGRSTRT-FLAG     PIC S9(9) COMP-5.<br />  88 TPNOSIGRSTRT        VALUE 0.<br />  88 TPSIGRSTRT          VALUE 1.<br />05 TPEV-METHOD-FLAG    PIC S9(9) COMP-5.<br />  88 TPEVNOTIFY          VALUE 0.<br />  88 TPEVSERVICE         VALUE 1.<br />  88 TPEVQUEUE           VALUE 2.<br />05 TPEV-PERSIST-FLAG   PIC S9(9) COMP-5.<br />  88 TPEVNOPERSIST       VALUE 0.<br />  88 TPEVPERSIST         VALUE 1.<br />05 TPEV-TRAN-FLAG      PIC S9(9) COMP-5.<br />  88 TPEVNOTRAN          VALUE 0.<br />  88 TPEVTRAN            VALUE 1.<br />*<br />05 EVENT-COUNT         PIC S9(9) COMP-5.<br />05 SUBSCRIPTION-HANDLE PIC S9(9) COMP-5.<br />05 NAME-1              PIC X(127).<br />05 NAME-2              PIC X(127).<br />05 EVENT-NAME          PIC X(31).<br />05 EVENT-EXPR          PIC X(255).<br />05 EVENT-FILTER        PIC X(255).</pre></div><p class="pBody"><a name="wp1170024"> </a>
The TPKEYDEF data structure is used by <code class="cCode">TPKEYCLOSE()</code>, <code class="cCode">TPKEYGETINFO()</code>, <code class="cCode">TPKEYOPEN()</code>, and <code class="cCode">TPKEYSETINFO()</code>to manage public-private keys for performing message-based digital signature and encryption operations:
</p>
<a name="wp1170025"> </a><div class="pPreformatted"><pre>*<br />*      TPKEYDEF.cbl<br />*<br />	05     KEY-HANDLE           PIC S9(9) COMP-5.<br />	05     PRINCIPAL-NAME       PIC X(512).<br />	05     LOCATION             PIC X(1024).<br />	05     IDENTITY-PROOF       PIC X(2048).<br />	05     PROOF-LEN            PIC S9(9) COMP-5.<br />	05     CRYPTO-PROVIDER      PIC X(128).<br />	05     SIGNATURE-FLAG       PIC S9(9) COMP-5.<br />	       88 TPKEY-NOSIGNATURE   VALUE 0.<br />	       88 TPKEY-SIGNATURE     VALUE 1.<br />	05     DECRYPT-FLAG         PIC S9(9) COMP-5.<br />	       88 TPKEY-NODECRYPT     VALUE 0.<br />	       88 TPKEY-DECRYPT       VALUE 1.<br />	05     ENCRYPT-FLAG         PIC S9(9) COMP-5.<br />	       88 TPKEY-NOENCRYPT     VALUE 0.<br />	       88 TPKEY-ENCRYPT       VALUE 1.<br />	05     AUTOSIGN-FLAG        PIC S9(9) COMP-5.<br />	       88 TPKEY-NOAUTOSIGN    VALUE 0.<br />	       88 TPKEY-AUTOSIGN      VALUE 1.<br />	05     AUTOENCRYPT-FLAG     PIC S9(9) COMP-5.<br />	       88 TPKEY-NOAUTOENCRYPT VALUE 0.<br />	       88 TPKEY-AUTOENCRYPT   VALUE 1.<br />	05     ATTRIBUTE-NAME       PIC X(64).<br />	05     ATTRIBUTE-VALUE-LEN  PIC S9(9) COMP-5.</pre></div><h4 class="pHeading3"><a name="wp1003050"> </a>
COBOL Language TX Return Codes and Other Definitions
</h4>
<p class="pBody"><a name="wp1003051"> </a>
The following return code and setting definitions are used by the TX routines:
</p>
<a name="wp1003052"> </a><div class="pPreformatted"><pre>*<br />* TXSTATUS.cbl<br />*<br />05 TX-STATUS      PIC S9(9) COMP-5.<br />  88 TX-NOT-SUPPORTED      VALUE 1.<br />*  Normal execution<br />  88 TX-OK                 VALUE 0.<br />*  Normal execution<br />  88 TX-OUTSIDE            VALUE -1.<br />*  Application is in an RM local transaction<br />  88 TX-ROLLBACK           VALUE -2.<br />*  Transaction was rolled back<br />  88 TX-MIXED              VALUE -3.<br />*  Transaction was partially committed and partially<br />*  rolled back<br />  88 TX-HAZARD             VALUE -4.<br />*  Transaction may have been partially committed and<br />*  partially rolled back<br />  88 TX-PROTOCOL-ERROR     VALUE -5.<br />*  Routine invoked in an improper context<br />  88 TX-ERROR              VALUE -6.<br />*  Transient error<br />  88 TX-FAIL               VALUE -7.<br />*  Fatal error<br />  88 TX-EINVAL             VALUE -8.<br />*  Invalid arguments were given<br />  88 TX-COMMITTED          VALUE -9.<br />*  The transaction was heuristically committed<br />  88 TX-NO-BEGIN           VALUE -100.<br />*  Transaction committed plus new transaction could not<br />*  be started<br />  88 TX-ROLLBACK-NO-BEGIN  VALUE -102.<br />*  Transaction rollback plus new transaction could not<br />*  be started<br />  88 TX-MIXED-NO-BEGIN     VALUE -103.<br />*  Mixed plus new transaction could not be started<br />  88 TX-HAZARD-NO-BEGIN    VALUE -104.<br />*  Hazard plus new transaction could not be started<br />  88 TX-COMMITTED-NO-BEGIN VALUE -109.<br />*  Heuristically committed plus transaction could not<br />*  be started</pre></div><p class="pBody"><a name="wp1003053"> </a>
The <code class="cCodeEmphasis">TXINFDEF</code> record defines a data structure where the result of the <code class="cCode">TXINFORM()</code> call will be stored:
</p>
<a name="wp1003054"> </a><div class="pPreformatted"><pre>*<br />* TXINFDEF.cbl<br />*<br />05 XID-REC.<br />*  XID record<br />10 FORMAT-ID            PIC S9(9) COMP-5.<br />*  A value of -1 in FORMAT-ID means that the XID is NULL<br />10 GTRID-LENGTH         PIC S9(9) COMP-5.<br />10 BRANCH-LENGTH        PIC S9(9) COMP-5.<br />10 XID-DATA             PIC X(128).<br />05 TRANSACTION-MODE     PIC S9(9) COMP-5.<br />*  Transaction mode settings<br />  88 TX-NOT-IN-TRAN            VALUE 0.<br />  88 TX-IN-TRAN                VALUE 1.<br />05 COMMIT-RETURN        PIC S9(9) COMP-5.<br />*  Commit_return settings<br />  88 TX-COMMIT-COMPLETED       VALUE 0.<br />  88 TX-COMMIT-DECISION-LOGGED VALUE 1.<br />05 TRANSACTION-CONTROL  PIC S9(9) COMP-5.<br />*  Transaction_control settings<br />  88 TX-UNCHAINED              VALUE 0.<br />  88 TX-CHAINED                VALUE 1.<br />05 TRANSACTION-TIMEOUT  PIC S9(9) COMP-5.<br />*  Transaction_timeout value<br />  88 NO-TIMEOUT                VALUE 0.<br />05 TRANSACTION-STATE    PIC S9(9) COMP-5.<br />*  Transaction_state information<br />  88 TX-ACTIVE                 VALUE 0.<br />  88 TX-TIMEOUT-ROLLBACK-ONLY  VALUE 1.<br />  88 TX-ROLLBACK-ONLY          VALUE 2.</pre></div><h4 class="pHeading3"><a name="wp1003055"> </a>
ATMI State Transitions
</h4>
<p class="pBody"><a name="wp1003056"> </a>
The Oracle Tuxedo system keeps track of the state for each program and verifies that legal state transitions occur for the various function calls and options. The state information includes the program type (request/response server, conversational server, or client), the initialization state (uninitialized or initialized), the resource management state (closed or open), the transaction state of the program, and the state of all asynchronous request/response and connection handles. When an illegal state transition is attempted, the called function fails, setting <code class="cCodeEmphasis">TPSTATUS-REC</code> to <code class="cCode">TPEPROTO()</code>. The legal states and transitions for this information are described in the following tables. 
</p>
<p class="pBody"><a name="wp1113108"> </a>
<a href="rf3cbl.html#wp1113111">Table&#160;3</a> indicates which functions may be called by request/response servers, conversational servers, and clients. Note that <code class="cCode">TPSVRINIT()</code> and <code class="cCode">TPSVRDONE()</code> are not included in this table because they are not called by applications (that is, they are application-supplied functions that are invoked by the Oracle Tuxedo system). 
</p>
<p class="pGraphic"><a name="wp1113430"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1113111table1113109"><caption><a name="wp1113111"> </a>
Table&#160;3  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Available Functions</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1113119"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp1113121"> </a>
Process Type
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1113129"> </a>
Request/Response<br />Server
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1113131"> </a>
Conversational<br />Server
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1113133"> </a>
Client
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113135"> </a>
<code class="cCode">TPABORT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113137"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113139"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113141"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113143"> </a>
<code class="cCode">TPACALL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113145"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113147"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113149"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113151"> </a>
<code class="cCode">TPADVERTISE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113153"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113155"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113157"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113159"> </a>
<code class="cCode">TPBEGIN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113161"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113163"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113165"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113167"> </a>
<code class="cCode">TPBROADCAST()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113169"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113171"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113173"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113175"> </a>
<code class="cCode">TPCALL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113177"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113179"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113181"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113183"> </a>
<code class="cCode">TPCANCEL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113185"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113187"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113189"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113191"> </a>
<code class="cCode">TPCHKAUTH()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113193"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113195"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113197"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113199"> </a>
<code class="cCode">TPCHKUNSOL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113201"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113203"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113205"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113207"> </a>
<code class="cCode">TPCLOSE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113209"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113211"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113213"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113215"> </a>
<code class="cCode">TPCOMMIT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113217"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113219"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113221"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113223"> </a>
<code class="cCode">TPCONNECT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113225"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113227"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113229"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113231"> </a>
<code class="cCode">TPDEQUE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113233"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113235"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113237"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113239"> </a>
<code class="cCode">TPDISCON()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113241"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113243"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113245"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113247"> </a>
<code class="cCode">TPENQUEUE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113249"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113251"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113253"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113255"> </a>
<code class="cCode">TPFORWAR()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113257"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113259"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113261"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300600"> </a>
TPGBLKTIME()
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300602"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300604"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300606"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113263"> </a>
<code class="cCode">TPGETCTXT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113265"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113267"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113269"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113271"> </a>
<code class="cCode">TPGETLEV()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113273"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113275"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113277"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113279"> </a>
<code class="cCode">TPGETRPLY()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113281"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113283"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113285"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113287"> </a>
<code class="cCode">TPGPRIO()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113289"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113291"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113293"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113295"> </a>
<code class="cCode">TPINITIALIZE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113297"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113299"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113301"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113303"> </a>
<code class="cCode">TPNOTIFY()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113305"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113307"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113309"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113311"> </a>
<code class="cCode">TPOPEN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113313"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113315"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113317"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113319"> </a>
<code class="cCode">TPPOST()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113321"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113323"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113325"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113327"> </a>
<code class="cCode">TPRECV()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113329"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113331"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113333"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113335"> </a>
<code class="cCode">TPRESUME()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113337"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113339"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113341"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113343"> </a>
<code class="cCode">TPRETURN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113345"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113347"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113349"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300608"> </a>
TPSBLKTIME()
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300610"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300612"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1300614"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113351"> </a>
<code class="cCode">TPSCMT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113353"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113355"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113357"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113359"> </a>
<code class="cCode">TPSEND()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113361"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113363"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113365"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113367"> </a>
<code class="cCode">TPSETCTXT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113369"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113371"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113373"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113375"> </a>
<code class="cCode">TPSETUNSOL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113377"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113379"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113381"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113383"> </a>
<code class="cCode">TPSPRIO()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113385"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113387"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113389"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113391"> </a>
<code class="cCode">TPSUBSCRIBE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113393"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113395"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113397"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113399"> </a>
<code class="cCode">TPSUSPEND()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113401"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113403"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113405"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113407"> </a>
<code class="cCode">TPTERM()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113409"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113411"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113413"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113415"> </a>
<code class="cCode">TPUNADVERTISE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113417"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113419"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113421"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113423"> </a>
<code class="cCode">TPUNSUBSCRIBE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113425"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113427"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1113429"> </a>
Y
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1113431"> </a>
The remaining state tables are for both clients and servers, unless otherwise noted. Keep in mind that because some functions cannot be called by both clients and servers (for example, <code class="cCode">TPINITIALIZE()</code>), certain state transitions shown below may not be possible for both program types. The above table should be consulted to determine whether the program in question is allowed to call a particular function.
</p>
<p class="pBody"><a name="wp1003373"> </a>
<a href="rf3cbl.html#wp1062586">Table&#160;4</a> indicates whether or not a client program has been initialized and registered with the transaction manager. Note that this table assumes the use of <code class="cCode">TPINITIALIZE()</code>, which is optional in single-context mode. That is, a single-context client may implicitly join an application by issuing one of many ATMI functions (for example, <code class="cCode">TPACALL()</code> or <code class="cCode">TPCALL()</code>). A client must use <code class="cCode">TPINITIALIZE()</code> when one of the following is true:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1044025"> </a>Application authentication is required. (See <code class="cCode">TPINITIALIZE()</code> and the description of the <code class="cCode">SECURITY</code> keyword in UBBCONFIG(5) for details.)</li>
<li><a name="wp1044028"> </a>The client wants to access an XA-compliant resource manager directly. (See <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> for details.) </li>
<li><a name="wp1044033"> </a>The client wants to create multiple application associations.</li>
</ul></div>
<p class="pBody"><a name="wp1003374"> </a>
A server is placed in the initialized state by the Oracle Tuxedo dispatcher before its <code class="cCode">TPSVRINIT()</code> function is invoked, and it is placed in the uninitialized state by the Oracle Tuxedo dispatcher after its <code class="cCode">TPSVRDONE()</code> function has returned. Note that in all of the state tables shown below, an error return from a function causes the program to remain in the same state, unless otherwise noted.
</p>
<p class="pBody"><a name="wp1342606"> </a>
<a href="rf3cbl.html#wp1062586">Table&#160;4</a> shows the initialization states.
</p>
<p class="pGraphic"><a name="wp1062651"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1062586table1062584"><caption><a name="wp1062586"> </a>
Table&#160;4  Initialization States

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1062592"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1062594"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1062600"> </a>
Uninitialized<br />I<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1062602"> </a>
Initialized<br />I<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062604"> </a>
<code class="cCode">TPCHKAUTH()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062606"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062608"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062610"> </a>
<code class="cCode">TPGETCTXT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062612"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062614"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062616"> </a>
<code class="cCode">TPINITIALIZE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062618"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062620"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062622"> </a>
<code class="cCode">TPSETCTXT()<br /></code>set to a non-NULL <br />context
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062624"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062626"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062657"> </a>
<code class="cCode">TPSETCTXT()</code> with <code class="cCode">TPNULLCONTEXT</code> set
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062659"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062661"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062628"> </a>
<code class="cCode">TPSETUNSOL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062630"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062632"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062634"> </a>
<code class="cCode">TPTERM()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062636"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062638"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062646"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1062650"> </a>
I<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1062653"> </a>
The remaining state tables assume a precondition of state I (regardless of whether a process arrived in this state via <code class="cCode">TPINITIALIZE()</code>, <code class="cCode">TPSETCTXT()</code>, or the Oracle Tuxedo service dispatcher).
</p>
<p class="pBody"><a name="wp1003439"> </a>
<a href="rf3cbl.html#wp1003442">Table&#160;5</a> indicates the state of a client or server with respect to whether or not a resource manager associated with the process has been initialized: 
</p>
<p class="pGraphic"><a name="wp1003519"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1003442table1003440"><caption><a name="wp1003442"> </a>
Table&#160;5  Resource Management States

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1003448"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1003450"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1003456"> </a>
Closed<br />R<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1003458"> </a>
Open<br />R<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003466"> </a>
<code class="cCode">TPOPEN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003468"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003470"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003472"> </a>
<code class="cCode">TPCLOSE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003474"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003476"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003478"> </a>
<code class="cCode">TPBEGIN()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003482"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003484"> </a>
<code class="cCode">TPCOMMIT()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003488"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003490"> </a>
<code class="cCode">TPABORT()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003494"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003496"> </a>
<code class="cCode">TPSUSPEND()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003500"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003502"> </a>
<code class="cCode">TPRESUME()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003506"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003508"> </a>
<code class="cCode">TPSVCSTART()</code> with <code class="cCode">TPTRAN</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003512"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003514"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003516"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003518"> </a>
R<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1003520"> </a>
<a href="rf3cbl.html#wp1003523">Table&#160;6</a> indicates the state of a process with respect to whether or not the process is associated with a transaction. For servers, transitions to states T<sub class="cSubscript">1</sub> and T<sub class="cSubscript">2</sub> assume a precondition of state R<sub class="cSubscript">1</sub> (for example, <code class="cCode">TPOPEN()</code> has been called with no subsequent call to <code class="cCode">TPCLOSE()</code> or <code class="cCode">TPTERM()</code>). 
</p>
<p class="pGraphic"><a name="wp1003650"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1003523table1003521"><caption><a name="wp1003523"> </a>
Table&#160;6  Transaction State of Application Association

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1003531"> </a>
Function
</div>
</th>
    <th colspan="3" rowspan="1"><div class="pCellHeading"><a name="wp1003533"> </a>
State
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1003541"> </a>
Not in Transaction<br /><span style="font-weight: normal">T</span><sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1003543"> </a>
Initiator<br /><span style="font-weight: normal">T</span><sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1003545"> </a>
Participant<br /><span style="font-weight: normal">T</span><sub class="cSubscript">2</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003555"> </a>
<code class="cCode">TPBEGIN()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003563"> </a>
<code class="cCode">TPABORT()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003567"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003571"> </a>
<code class="cCode">TPCOMMIT()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003575"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003579"> </a>
<code class="cCode">SPSUSPEND()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003583"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003587"> </a>
<code class="cCode">TPRESUME()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003591"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003595"> </a>
<code class="cCode">TPSVCSTART()</code> with <code class="cCode">TPTRAN</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003597"> </a>
T<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003603"> </a>
<code class="cCode">TPSVCSTART()<br /></code>(not in transaction mode)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003605"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003611"> </a>
<code class="cCode">TPRETURN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003613"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003617"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003619"> </a>
<code class="cCode">TPFORWAR()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003621"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003625"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003627"> </a>
<code class="cCode">TPCLOSE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003629"> </a>
R<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003635"> </a>
<code class="cCode">TPTERM()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003637"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003639"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003643"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003645"> </a>
T<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003647"> </a>
T<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003649"> </a>
T<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1003651"> </a>
<a href="rf3cbl.html#wp1003654">Table&#160;7</a> indicates the state of a single request handle returned by <code class="cCode">TPACALL()</code>: 
</p>
<p class="pGraphic"><a name="wp1003743"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1003654table1003652"><caption><a name="wp1003654"> </a>
Table&#160;7  Asynchronous Request Descriptor States

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1003660"> </a>
Function
</div>
</th>
    <th colspan="2" rowspan="1"><div class="pCellHeading"><a name="wp1003662"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1003668"> </a>
No Descriptor<br />A<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1003670"> </a>
Valid Descriptor<br />A<sub class="cSubscript">1</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003684"> </a>
<code class="cCode">TPACALL()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003686"> </a>
A<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003690"> </a>
<code class="cCode">TPGETRPLY()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003694"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003696"> </a>
<code class="cCode">TPCANCEL()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003700"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript">a</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003702"> </a>
<code class="cCode">TPABORT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003704"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003706"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript">b</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003708"> </a>
<code class="cCode">TPCOMMIT()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003710"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003712"> </a>
A<sub class="cSubscript">0</sub><sup class="cSuperscript">b</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003714"> </a>
<code class="cCode">TPSUSPEND()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003716"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003718"> </a>
A<sup class="cSuperscript">c</sup>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003720"> </a>
<code class="cCode">TPRETURN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003722"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003724"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003726"> </a>
<code class="cCode">TPFORWAR()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003728"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003730"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003732"> </a>
<code class="cCode">TPTERM()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003734"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003736"> </a>
I<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003738"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003740"> </a>
A<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1003742"> </a>
A<sub class="cSubscript">1</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<a name="wp1003744"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><sup class="cSuperscript">a</sup> This state change occurs only if the descriptor is not associated with the caller&#8217;s transaction.</td>
</tr>
</table>

<a name="wp1003745"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">b</sup> This state change occurs only if the descriptor is associated with the caller&#8217;s transaction.</td>
</tr>
</table>
<a name="wp1003746"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">c</sup> If the descriptor is associated with the caller&#8217;s transaction, then <code class="cCode">TPSUSPEND()</code> returns a protocol error.</td>
</tr>
</table>
<p class="pBody"><a name="wp1134065"> </a>
<a href="rf3cbl.html#wp1231079">Table&#160;8</a> indicates the state of a connection descriptor returned by <code class="cCode">TPCONNECT()</code> or provided by a service invocation in the <code class="cCode">TPSVCINFO</code> structure. For primitives that do not take a connection descriptor, the state changes apply to all connection descriptors, unless otherwise noted.
</p>
<p class="pBody"><a name="wp1003748"> </a>
The states are as follows: 
</p>
<p class="pBody"><a name="wp1003749"> </a>
C<sub class="cSubscript">0</sub> - No handle <br />C<sub class="cSubscript">1</sub> - TPCONNECT handle send-only <br />C<sub class="cSubscript">2</sub> - TPCONNECT handle receive-only <br />C<sub class="cSubscript">3</sub> - TPSVCDEF handle send-only <br />C<sub class="cSubscript">4</sub> - TPSVCDEF handle receive-only
</p>
<p class="pGraphic"><a name="wp1004075"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1231079table1003750"><caption><a name="wp1231079"> </a>
Table&#160;8  Connection Request Handle States

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1231091"> </a>
Function/Event
</div>
</th>
    <th colspan="5" rowspan="1"><div class="pCellHeading"><a name="wp1231093"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1231105"> </a>
C<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1231107"> </a>
C<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1231109"> </a>
C<sub class="cSubscript">2</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1231111"> </a>
C<sub class="cSubscript">3</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1231113"> </a>
C<sub class="cSubscript">4</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231115"> </a>
<code class="cCode">TPCONNECT()</code> with <code class="cCode">TPSENDONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231117"> </a>
C<sub class="cSubscript">1</sub><sup class="cSuperscript">a</sup> 
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231127"> </a>
<code class="cCode">TPCONNECT()</code> with <code class="cCode">TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231129"> </a>
C<sub class="cSubscript">2</sub><sup class="cSuperscript">a</sup><sub class="cSubscript"> </sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231139"> </a>
<code class="cCode">TPSVCSTART()</code> with flag<code class="cCode"> TPSENDONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231141"> </a>
C<sub class="cSubscript">3</sub><sup class="cSuperscript">b </sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231151"> </a>
<code class="cCode">TPSVCSTART()</code> with flag<code class="cCode"> TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231153"> </a>
C<sub class="cSubscript">4</sub><sup class="cSuperscript">b</sup><sub class="cSubscript"> </sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231163"> </a>
<code class="cCode">TPRECV()</code>/no event
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231169"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231173"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231175"> </a>
<code class="cCode">TPRECV()/TPEV_SENDONLY</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231181"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231185"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231187"> </a>
<code class="cCode">TPRECV()/TPEV_DISCONIMM</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231193"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231197"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231199"> </a>
<code class="cCode">TPRECV()/TPEV_SVCERR</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231205"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231211"> </a>
<code class="cCode">TPRECV()/TPEV_SVCFAIL</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231217"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231223"> </a>
<code class="cCode">TPRECV()/TPEV_SVCSUCC</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231229"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231235"> </a>
<code class="cCode">TPSEND()</code>/no event
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231239"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231243"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231247"> </a>
<code class="cCode">TPSEND()</code> with flag <code class="cCode">TPRECVONLY</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231251"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231255"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231259"> </a>
<code class="cCode">TPSEND()/TPEV_DISCONIMM</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231263"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231267"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231271"> </a>
<code class="cCode">TPSEND()/TPEV_SVCERR</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231275"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231283"> </a>
<code class="cCode">TPSEND()/TPEV_SVCFAIL</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231287"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231295"> </a>
<code class="cCode">TPTERM() (client only)</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231297"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231299"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231307"> </a>
<code class="cCode">TPCOMMIT()</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231309"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231311"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231313"> </a>
C<sub class="cSubscript">0</sub> <sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231319"> </a>
<code class="cCode">TPSUSPEND()</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231321"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231323"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript">d</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231325"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript">d</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231331"> </a>
<code class="cCode">TPABORT()</code> (originator only)
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231333"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231335"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript"> c</sup>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231337"> </a>
C<sub class="cSubscript">0</sub><sup class="cSuperscript">c</sup>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231343"> </a>
<code class="cCode">TPDISCON()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231347"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231349"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231355"> </a>
<code class="cCode">TPRETURN()</code> (<code class="cCode">CONV</code> server)
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231359"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231361"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231363"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231365"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231367"> </a>
<code class="cCode">TPFORWAR()</code> (<code class="cCode">CONV</code> server)
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231371"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231373"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231375"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231377"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231379"> </a>
All other ATMI functions
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231381"> </a>
C<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231383"> </a>
C<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231385"> </a>
C<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231387"> </a>
C<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1231389"> </a>
C<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<a name="wp1004076"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><sup class="cSuperscript">a</sup> If the program is in transaction mode and <code class="cCode">TPNOTRAN</code> is not specified, the connection is in transaction mode.</td>
</tr>
</table>

<a name="wp1004077"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">b</sup> If the <code class="cCode">TPTRAN</code> flag is set, the connection is in transaction mode. </td>
</tr>
</table>
<a name="wp1004078"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">c</sup> If the connection is not in transaction mode, no state change. </td>
</tr>
</table>
<a name="wp1004079"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><sup class="cSuperscript">d</sup> If the connection is in transaction mode, then <code class="cCode">TPSUSPEND()</code> returns a protocol error.</td>
</tr>
</table>
<h4 class="pHeading3"><a name="wp1004080"> </a>
TX State Transitions
</h4>
<p class="pBody"><a name="wp1004081"> </a>
Oracle Tuxedo ensures that a process calls the TX functions in a legal sequence. When an illegal state transition is attempted (that is, a call from a state with a blank transition entry), the called function returns <code class="cCode">TX_PROTOCOL_ERROR</code>. The legal states and transitions for the TX functions are shown in the table below. Calls that return failure do not make state transitions, except where described by specific state table entries. Any Oracle Tuxedo client or server is allowed to use the TX functions.
</p>
<p class="pBody"><a name="wp1004082"> </a>
The states are defined below: 
</p>
<h4 class="pDefTerm"><a name="wp1004083"> </a>
S<sub class="cSubscript">0</sub> 
</h4><div class="pDefPara"><a name="wp1004084"> </a>
No RMs have been opened or initialized. A process cannot start a global transaction until it has successfully called <code class="cCode">TXOPEN()</code>.
</div>
<h4 class="pDefTerm"><a name="wp1004085"> </a>
S<sub class="cSubscript">1</sub> 
</h4><div class="pDefPara"><a name="wp1004086"> </a>
A process has opened its RM but is not in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX-UNCHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1004087"> </a>
S<sub class="cSubscript">2</sub> 
</h4><div class="pDefPara"><a name="wp1004088"> </a>
A process has opened its RM but is not in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1004089"> </a>
S<sub class="cSubscript">3</sub> 
</h4><div class="pDefPara"><a name="wp1004090"> </a>
A process has opened its RM and is in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX-UNCHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1004091"> </a>
S<sub class="cSubscript">4</sub> 
</h4><div class="pDefPara"><a name="wp1004092"> </a>
A process has opened its RM and is in a transaction. Its <code class="cCode">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
<p class="pGraphic"><a name="wp1004300"> </a>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1141377table1004093"><caption><a name="wp1141377"> </a>
Table&#160;9  TX State Transitions

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th colspan="1" rowspan="2"><div class="pCellHeading"><a name="wp1141389"> </a>
Function
</div>
</th>
    <th colspan="5" rowspan="1"><div class="pCellHeading"><a name="wp1141391"> </a>
States
</div>
</th>
</tr>
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1141403"> </a>
S<sub class="cSubscript">0</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1141405"> </a>
S<sub class="cSubscript">1</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1141407"> </a>
S<sub class="cSubscript">2</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1141409"> </a>
S<sub class="cSubscript">3</sub>
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1141411"> </a>
S<sub class="cSubscript">4</sub>
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141413"> </a>
<code class="cCode">TXBEGIN()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141417"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141419"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141425"> </a>
<code class="cCode">TXCLOSE()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141427"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141429"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141431"> </a>
S<sub class="cSubscript">0</sub>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141437"> </a>
<code class="cCode">TXCOMMIT() -&gt; TX_SET1</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141445"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141447"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141449"> </a>
<code class="cCode">TXCOMMIT() -&gt; TX_SET2</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141459"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141461"> </a>
<code class="cCode">TXINFORM()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141465"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141467"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141469"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141471"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141473"> </a>
<code class="cCode">TXOPEN()</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141475"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141477"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141479"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141481"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141483"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141485"> </a>
<code class="cCode">TXROLLBACK() -&gt; TX_SET1</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141493"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141495"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141497"> </a>
<code class="cCode">TXROLLBACK() -&gt; TX_SET2</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141507"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141509"> </a>
<code class="cCode">TXSETCOMMITRET()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141513"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141515"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141517"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141519"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141521"> </a>
<code class="cCode">TXSETTRANCTL()</code> 
</div>
<div class="pCellBody"><a name="wp1141522"> </a>
<code class="cCode">  control = TX-CHAINED</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141526"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141528"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141530"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141532"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141534"> </a>
<code class="cCode">TXSETRRANCTL()</code> 
</div>
<div class="pCellBody"><a name="wp1141535"> </a>
<code class="cCode">  control = TX-UNCHAINED</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141539"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141541"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141543"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141545"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141547"> </a>
<code class="cCode">TXSETTIMEOUT()</code>
</div>
</td>
    <td class="table" scope="row">&#160;</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141551"> </a>
S<sub class="cSubscript">1</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141553"> </a>
S<sub class="cSubscript">2</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141555"> </a>
S<sub class="cSubscript">3</sub>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1141557"> </a>
S<sub class="cSubscript">4</sub>
</div>
</td>
</tr>
</table>
</div>

</p>
</div>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1004301"> </a><code class="cCode">TX_SET1</code> denotes any of the following: <code class="cCode">TX_OK</code>, <code class="cCode">TX_ROLLBACK</code>, <code class="cCode">TX_MIXED</code>, <code class="cCode">TX_HAZARD</code>, or <code class="cCode">TX_COMMITTED.</code> <code class="cCode">TX_ROLLBACK</code> is not returned by <code class="cCode">tx_rollback()</code> and <code class="cCode">TX_COMMITTED</code> is not returned by <code class="cCode">tx_commit()</code>.</li>
<li><a name="wp1004302"> </a><code class="cCode">TX_SET2</code> denotes any of the following: <code class="cCode">TX_NO_BEGIN</code>, <code class="cCode">TX_ROLLBACK_NO_BEGIN</code>, <code class="cCode">TX_MIXED_NO_BEGIN</code>, <code class="cCode">TX_HAZARD_NO_BEGIN</code>, or <code class="cCode">TX_COMMITTED_NO_BEGIN.</code> <code class="cCode">TX_ROLLBACK_NO_BEGIN</code> is not returned by <code class="cCode">tx_rollback()</code> and <code class="cCode">TX_COMMITTED_NO_BEGIN</code> is not returned by <code class="cCode">tx_commit()</code>.</li>
<li><a name="wp1004303"> </a>If <code class="cCode">TX_FAIL</code> is returned on any call, the application process is in an undefined state with respect to the above table.</li>
<li><a name="wp1004304"> </a>When <code class="cCode">tx_info()</code> returns either <code class="cCode">TX_ROLLBACK_ONLY</code> or <code class="cCode">TX_TIMEOUT_ROLLBACK_ONLY</code> in the transaction state information, the transaction is marked rollback-only and is rolled back, regardless of whether the application program calls <code class="cCode">tx_commit()</code> or <code class="cCode">tx_rollback()</code>.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1186032"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1186042"> </a>
<a href="../rf3c/rf3c.html">buffer(3c)</a>, <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp998560"><code class="cCode">TPADVERTISE(3cbl)</code></a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>,<code class="cCode"> </code><a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a>, <a href="rf3cbl.html#wp1066533"><code class="cCode">TPKEYCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a>, <a href="rf3cbl.html#wp1143651"><code class="cCode">TPKEYOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1066613"><code class="cCode">TPKEYSETINFO(3cbl)</code></a>, <a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1047746"><code class="cCode">TPSETCTXT(3cbl)</code></a>, <a href="rf3cbl.html#wp1001806"><code class="cCode">TPSVCSTART(3cbl)</code></a>, <a href="../rf5/rf5.html">tuxtypes(5)</a>, <a href="../rf5/rf5.html">typesw(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp997198"> </a>
FINIT, FINIT32(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp997218"> </a>
Name
</h4>
<p class="pBody"><a name="wp998140"> </a>
<code class="cCode">FINIT()</code>, <code class="cCode">FINIT32()</code> - initialize fielded buffer
</p>
<h4 class="pHeading3"><a name="wp998364"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp997411"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">FML-BUFFER</code><code class="cCode">.<br /> 05 </code><code class="cCodeEmphasis">FML-ALIGN</code><code class="cCode">      PIC S9(9) USAGE IS COMP.<br /> 05 </code><code class="cCodeEmphasis">FML-DATA</code><code class="cCode">       PIC X(</code><code class="cCodeEmphasis">applen</code><code class="cCode">).<br /> <br />01 </code><code class="cCodeEmphasis">FML-REC<br /></code><code class="cCode"> COPY FMLINFO.<br /> <br />CALL &quot;FINIT&quot; USING </code><code class="cCodeEmphasis">FML-BUFFER</code><code class="cCode"> </code><code class="cCodeEmphasis">FML-REC</code><code class="cCode">.<br /> <br />CALL &quot;FINIT32&quot; USING </code><code class="cCodeEmphasis">FML-BUFFER</code><code class="cCode"> </code><code class="cCodeEmphasis">FML-REC</code><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp997424"> </a>
Description
</h4>
<p class="pBody"><a name="wp997501"> </a>
<code class="cCode">FINIT()</code> can be called to initialize a fielded buffer. <code class="cCodeEmphasis">FML-BUFFER</code> is the record to be used for the fielded buffer; it should be aligned on a 4-byte boundary to work with both FML16 and FML32. This can be accomplished by defining two record elements as shown in the synopsis above. <code class="cCode">FML-LENGTH IN</code> <code class="cCodeEmphasis">FML-REC</code> is the length of the record. The internal structure is set up for a fielded buffer with no fields; the application program should not interpret the record, other than to pass it to <code class="cCode">FINIT()</code>, <code class="cCode">FVFTOS()</code>, or <code class="cCode">FVSTOF()</code>, or an ATMI call that takes a typed record (in this case, the type is &#8220;FML&#8221; and there is no subtype).
</p>
<p class="pBody"><a name="wp997540"> </a>
<code class="cCode">FINIT32()</code> is used with 32-bit FML.
</p>
<h4 class="pHeading3"><a name="wp997559"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp997603"> </a>
Upon successful completion, <code class="cCode">FINIT()</code> sets <code class="cCode">FML-STATUS</code> in <code class="cCodeEmphasis">FML-REC</code> to <code class="cCode">FOK</code>.
</p>
<p class="pBody"><a name="wp997616"> </a>
On error, <code class="cCode">FML-STATUS</code> is set to a non-zero value.
</p>
<h4 class="pHeading3"><a name="wp997640"> </a>
Errors
</h4>
<p class="pBody"><a name="wp997672"> </a>
Under the following conditions, <code class="cCode">FINIT()</code> fails and sets <code class="cCode">FML-STATUS</code> in <code class="cCodeEmphasis">FML-REC </code>to: 
</p>
<h4 class="pDefTerm"><a name="wp997688"> </a>
<code class="cCode">[FALIGNERR</code>]
</h4><div class="pDefPara"><a name="wp1006333"> </a>
&#8220;fielded buffer not aligned&#8221;<br />The buffer does not begin on the proper boundary.
</div>
<h4 class="pDefTerm"><a name="wp1006334"> </a>
[<code class="cCode">FNOSPACE</code>]
</h4><div class="pDefPara"><a name="wp1006335"> </a>
&#8220;no space in fielded buffer&#8221;<br />The buffer size specified is too small for a fielded buffer.
</div>
<h4 class="pHeading3"><a name="wp1006336"> </a>
Example
</h4>
<p class="pBody"><a name="wp1006337"> </a>
The correct was to reinitialize a buffer to have no fields is: <code class="cCode">Finit</code>(<code class="cCode">frfr</code>, (<code class="cCode">FLDLEN</code>)<code class="cCode">Fsizeof</code>(<code class="cCode">fbfr</code>));
</p>
<h4 class="pHeading3"><a name="wp997785"> </a>
See Also
</h4>
<p class="pBody"><a name="wp997796"> </a>
<span class="cHyperlink">
Introdu</span><a href="../rf3fml/rf3fml.html"></a>ction to FML Functions in <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998315"> </a>
FVFTOS, FVFTOS32(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998316"> </a>
Name
</h4>
<p class="pBody"><a name="wp998317"> </a>
<code class="cCode">FVFTOS()</code>, <code class="cCode">FVFTOS32()</code> - copy from fielded buffer to COBOL structure
</p>
<h4 class="pHeading3"><a name="wp998361"> </a>
Synopsis
</h4>
<a name="wp998318"> </a><div class="pPreformatted"><pre>01 DATA-REC. <br />COPY User data. <br /> <br />01 FML-BUFFER.<br /> 05 FML-ALIGN      PIC S9(9) USAGE IS COMP.<br /> 05 FML-DATA       PIC X(applen).<br /> <br />01 FML-REC COPY FMLINFO. <br /> <br />CALL &quot;FVFTOS&quot; USING FML-BUFFER DATA-REC FML-REC. <br /> <br />CALL &quot;FVFTOS32&quot; USING FML-BUFFER DATA-REC FML-REC.</pre></div><h4 class="pHeading3"><a name="wp998319"> </a>
Description
</h4>
<p class="pBody"><a name="wp998320"> </a>
The <code class="cCode">FVFTOS()</code> function transfers data from a fielded buffer to a COBOL record. <code class="cCodeEmphasis">FML-BUFFER</code> is a pointer to a fielded buffer initialized with <code class="cCode">FINIT()</code>. <code class="cCodeEmphasis">DATA-REC</code> is a pointer to a C structure. <code class="cCode">VIEWNAME IN</code> <code class="cCodeEmphasis">FML-REC</code> is the name of the view describing the COBOL record.
</p>
<p class="pBody"><a name="wp998321"> </a>
Fields are copied from the fielded buffer into the structure based on the element descriptions in <code class="cCodeEmphasis">VIEWNAME</code>. If a field in the fielded buffer has no corresponding element in the COBOL record, it is ignored. If an element specified in the COBOL record has no corresponding field in the fielded buffer, a NULL value is copied into the element. The NULL value used is definable for each element in the view description.
</p>
<p class="pBody"><a name="wp998322"> </a>
To store multiple occurrences in the COBOL record, the record element should be defined with <code class="cCode">OCCURS</code>. If the buffer has fewer occurrences of the field than there are occurrences of the element, the extra element slots are assigned NULL values. On the other hand, if the buffer has more occurrences of the field than there are occurrences of the element, the surplus occurrences are ignored.
</p>
<p class="pBody"><a name="wp998323"> </a>
<code class="cCode">FVFTOS32()</code> is used for views defined with <code class="cCode">view32()</code> typed buffers for larger views with more fields.
</p>
<h4 class="pHeading3"><a name="wp998324"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998325"> </a>
Upon successful completion, <code class="cCode">FVFTOS32()</code> sets <code class="cCode">FML-STATUS IN</code> <code class="cCodeEmphasis">FML-REC</code> to <code class="cCode">FOK</code>.
</p>
<p class="pBody"><a name="wp998326"> </a>
On error, <code class="cCode">FML-STATUS</code> is set to a non-zero value.
</p>
<h4 class="pHeading3"><a name="wp998327"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998328"> </a>
Under the following conditions, <code class="cCode">FVFTOS()</code> fails and sets <code class="cCode">FML-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998329"> </a>
[<code class="cCode">FALIGNERR</code>]
</h4><div class="pDefPara"><a name="wp998330"> </a>
&#8220;fielded buffer not aligned&#8221;<br />The buffer does not begin on the proper boundary.
</div>
<h4 class="pDefTerm"><a name="wp998331"> </a>
[<code class="cCode">FNOTFLD</code>]
</h4><div class="pDefPara"><a name="wp998332"> </a>
&#8220;buffer not fielded&#8221;<br />The buffer is not a fielded buffer or has not been initialized by <code class="cCode">FINIT()</code>.
</div>
<h4 class="pDefTerm"><a name="wp998333"> </a>
[<code class="cCode">FEINVAL</code>]
</h4><div class="pDefPara"><a name="wp998334"> </a>
&#8220;invalid argument to function&#8221;<br />One of the arguments to the function invoked was invalid.
</div>
<h4 class="pDefTerm"><a name="wp998335"> </a>
[<code class="cCode">FBADACM</code>]
</h4><div class="pDefPara"><a name="wp998336"> </a>
&#8220;ACM contains negative value&#8221;<br />An Associated Count Member should not be a negative value while transferring data from a COBOL record to a fielded buffer.
</div>
<h4 class="pDefTerm"><a name="wp998337"> </a>
[<code class="cCode">FBADVIEW</code>]
</h4><div class="pDefPara"><a name="wp998338"> </a>
&#8220;cannot find or get view&#8221;<br />The view description <code class="cCodeEmphasis">VIEWNAME</code> was not found in the files specified by <code class="cCode">VIEWDIR</code> or <code class="cCode">VIEWFILES</code>.
</div>
<h4 class="pHeading3"><a name="wp998339"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998340"> </a>
<span class="cHyperlink">
Introductio</span><a href="../rf3fml/rf3fml.html"></a>n to FML Functions in <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>, <a href="../rf5/rf5.html">viewfile(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998368"> </a>
FVSTOF(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998369"> </a>
Name
</h4>
<p class="pBody"><a name="wp998370"> </a>
<code class="cCode">FVSTOF()</code> - copy from C structure to fielded buffer
</p>
<h4 class="pHeading3"><a name="wp998371"> </a>
Synopsis
</h4>
<a name="wp998372"> </a><div class="pPreformatted"><pre>01 DATA-REC.<br /> COPY User data. <br /> <br />01 FML-BUFFER.<br /> 05 FML-ALIGN      PIC S9(9) USAGE IS COMP.<br /> 05 FML-DATA       PIC X(applen).<br /> <br />01 FML-REC<br /> COPY FMLINFO. <br /> <br />CALL &quot;FVSTOF&quot; USING FML-BUFFER DATA-REC FML-REC. <br /> <br />CALL &quot;FVSTOF32&quot; USING FML-BUFFER DATA-REC FML-REC.</pre></div><h4 class="pHeading3"><a name="wp998373"> </a>
Description
</h4>
<p class="pBody"><a name="wp998374"> </a>
<code class="cCode">FVSTOF()</code> transfers data from a C structure to a fielded buffer. <code class="cCodeEmphasis">FML-BUFFER</code> is a record containing the fielded buffer. <code class="cCodeEmphasis">DATA-REC</code> is the COBOL record. <code class="cCode">VIEWNAME IN</code> <code class="cCodeEmphasis">FML-REC</code> is the name of the view describing the COBOL record. <code class="cCode">FML-MODE IN</code> <code class="cCodeEmphasis">FML-REC</code> specifies the manner in which the transfer is made. <code class="cCode">FML-MODE</code> has four possible values:
</p>
<a name="wp998375"> </a><div class="pPreformatted"><pre>FUPDATE<br />FOJOIN<br />FJOIN<br />FCONCAT</pre></div><p class="pBody"><a name="wp1340755"> </a>
The action of these modes are the same as that described in <a href="../rf3fml/rf3fml.html">Fupdate,&#160;Fupdat</a><a href="../rf3fml/rf3fml.html">e32(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fojoin,&#160;Fojo</a><a href="../rf3fml/rf3fml.html">in32(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fjoin,&#160;Fjoin</a><a href="../rf3fml/rf3fml.html">32(3fml)</a>, and <a href="../rf3fml/rf3fml.html">Fconcat,&#160;Fcon</a><a href="../rf3fml/rf3fml.html">cat32(3fml)</a>. One can even think of <code class="cCode">FVSTOF()</code> as the same as these functions, except that where they specify a source buffer, <code class="cCode">FVSTOF()</code> specifies a COBOL record. Bear in mind that <code class="cCode">FUPDATE</code> does not move record elements that have NULL values.
</p>
<p class="pBody"><a name="wp998377"> </a>
<code class="cCode">FVSTOF32()</code> is used for views defined with <code class="cCode">view32()</code> typed buffers for larger views with more fields.
</p>
<h4 class="pHeading3"><a name="wp998378"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998379"> </a>
Upon successful completion, <code class="cCode">FVSTOF32()</code> sets <code class="cCode">FML-STATUS IN</code> <code class="cCodeEmphasis">FML-REC</code> to <code class="cCode">FOK</code>.
</p>
<p class="pBody"><a name="wp998380"> </a>
On error, <code class="cCode">FML-STATUS</code> is set to a non-zero value.
</p>
<h4 class="pHeading3"><a name="wp998381"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998382"> </a>
Under the following conditions, <code class="cCode">FVSTOF()</code> fails and sets <code class="cCode">FML-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998383"> </a>
[<code class="cCode">FALIGNERR</code>] 
</h4><div class="pDefPara"><a name="wp998384"> </a>
&#8220;fielded buffer not aligned&#8221;<br />The buffer does not begin on the proper boundary.
</div>
<h4 class="pDefTerm"><a name="wp998385"> </a>
[<code class="cCode">FNOTFLD</code>] 
</h4><div class="pDefPara"><a name="wp998386"> </a>
&#8220;buffer not fielded&#8221;<br />The buffer is not a fielded buffer or has not been initialized by <code class="cCode">FINIT()</code>.
</div>
<h4 class="pDefTerm"><a name="wp998387"> </a>
[<code class="cCode">FEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998388"> </a>
&#8220;invalid argument to function&#8221;<br />One of the arguments to the function invoked was invalid.
</div>
<h4 class="pDefTerm"><a name="wp998389"> </a>
[<code class="cCode">FBADACM</code>] 
</h4><div class="pDefPara"><a name="wp998390"> </a>
&#8220;ACM contains negative value&#8221;<br />An Associated Count Member should not be a negative value while transferring data from a COBOL record to a fielded buffer.
</div>
<h4 class="pDefTerm"><a name="wp998391"> </a>
[<code class="cCode">FBADVIEW</code>] 
</h4><div class="pDefPara"><a name="wp998392"> </a>
&#8220;cannot find or get view&#8221;<br />The view description <code class="cCodeEmphasis">VIEWNAME</code> was not found in the files specified by <code class="cCode">VIEWDIR</code> or <code class="cCode">VIEWFILES</code>.
</div>
<h4 class="pHeading3"><a name="wp998393"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998394"> </a>
<span class="cHyperlink">
Introducti</span><a href="../rf3fml/rf3fml.html"></a>on to FML Functions in <em class="cEmphasis">Oracle Tuxedo ATMI FML Function Reference</em>, <a href="../rf5/rf5.html">viewfile(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998418"> </a>
TPABORT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998419"> </a>
Name
</h4>
<p class="pBody"><a name="wp998420"> </a>
<code class="cCode">TPABORT()</code> - abort current Oracle Tuxedo ATMI transaction
</p>
<h4 class="pHeading3"><a name="wp998421"> </a>
Synopsis
</h4>
<a name="wp998422"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode">.<br />  COPY TPTRXDEF.<br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS.<br /> <br />CALL &quot;TPABORT&quot; USING </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998423"> </a>
Description
</h4>
<p class="pBody"><a name="wp998424"> </a>
<code class="cCode">TPABORT()</code> signifies the abnormal end of a transaction. When this call returns, all changes made to resources during the transaction are undone. Like <code class="cCode">TPCOMMIT()</code>, this routine can be called only by the initiator of a transaction. Participants (that is, service routines) can express their desire to have a transaction aborted by calling <code class="cCode">TPRETURN()</code> with <code class="cCode">TPFAIL()</code>.
</p>
<p class="pBody"><a name="wp998425"> </a>
If <code class="cCode">TPABORT()</code> is called while communication handles exist for outstanding replies, then upon return from the routine, the transaction is aborted and those communications handles associated with the caller&#8217;s transaction are no longer valid. Communications handles not associated with the caller&#8217;s transaction remain valid.
</p>
<p class="pBody"><a name="wp998426"> </a>
For each open connection to a conversational server in transaction mode, <code class="cCode">TPABORT()</code> will send a <code class="cCode">TPEV-DISCONIMM</code> event to the server, whether or not the server has control of a connection. Connections opened before <code class="cCode">TPBEGIN()</code> or with the <code class="cCode">TPNOTRAN</code> setting (that is, not in transaction mode) are not affected.
</p>
<p class="pBody"><a name="wp998427"> </a>
The <code class="cCode">TPABORT()</code> argument, <code class="cCodeEmphasis">TPTRXDEF-REC</code>, is reserved for future use.
</p>
<h4 class="pHeading3"><a name="wp998428"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998429"> </a>
Upon successful completion, <code class="cCode">TPABORT()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp998430"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998431"> </a>
Under the following conditions, <code class="cCode">TPABORT()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998432"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp998433"> </a>
Invalid arguments were given. The caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp998434"> </a>
[<code class="cCode">TPEHEURISTIC</code>] 
</h4><div class="pDefPara"><a name="wp998435"> </a>
Due to a heuristic decision, the work done on behalf of the transaction was partially committed and partially aborted.
</div>
<h4 class="pDefTerm"><a name="wp998436"> </a>
[<code class="cCode">TPEHAZARD</code>] 
</h4><div class="pDefPara"><a name="wp998437"> </a>
Due to some failure, the work done on behalf of the transaction could have been heuristically completed.
</div>
<h4 class="pDefTerm"><a name="wp998438"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998439"> </a>
<code class="cCode">TPABORT()</code> was called in an improper context (for example, by a participant).
</div>
<h4 class="pDefTerm"><a name="wp998440"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998441"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998442"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp998443"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp998444"> </a>
Notices
</h4>
<p class="pBody"><a name="wp998445"> </a>
When using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT()</code> and <code class="cCode">TPABORT()</code> to delineate an Oracle Tuxedo ATMI transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT</code>.
</p>
<h4 class="pHeading3"><a name="wp998446"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998447"> </a>
<a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1044551"><code class="cCode">TPGETLEV(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998473"> </a>
TPACALL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998474"> </a>
Name
</h4>
<p class="pBody"><a name="wp998475"> </a>
<code class="cCode">TPACALL()</code> - routine to send a message to a service asynchronously
</p>
<h4 class="pHeading3"><a name="wp998476"> </a>
Synopsis
</h4>
<a name="wp998477"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br />  COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br />  COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br />  COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS. <br /> <br />CALL &quot;TPACALL&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998478"> </a>
Description
</h4>
<p class="pBody"><a name="wp998479"> </a>
<code class="cCode">TPACALL()</code> sends a request message to the service named by <code class="cCode">SERVICE-NAME IN</code> <code class="cCodeEmphasis">TPSVCDEF-REC</code>. The request is sent out at the priority defined for <code class="cCode">SERVICE-NAME</code> unless overridden by a previous call to <code class="cCode">TPSPRIO()</code>. <code class="cCodeEmphasis">DATA-REC</code> is a message to be sent and <code class="cCode">LEN IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code> specifies the amount of data in <code class="cCodeEmphasis">DATA-REC</code> that should be sent. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a request is sent with no data portion. If <code class="cCode">REC-TYPE</code> is <code class="cCode">STRING</code> and <code class="cCode">LEN</code> is <code class="cCode">0</code>, then the request is sent with no data portion. The <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> of <code class="cCodeEmphasis">DATA-REC</code> must match one of the <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>s recognized by <code class="cCode">SERVICE-NAME</code>. Note that for each request sent while in transaction mode, a corresponding reply must ultimately be received.
</p>
<p class="pBody"><a name="wp998480"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp998481"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp998482"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. If <code class="cCode">SERVICE-NAME</code> belongs to a server that does not support transactions, then this setting must be used when the caller is in transaction mode. A caller in transaction mode that uses this setting is still subject to the transaction timeout (and no other). If a service fails that was invoked with this setting, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998483"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp998484"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is performed on behalf of the caller&#8217;s transaction. This setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998485"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp998486"> </a>
Informs <code class="cCode">TPACALL()</code> that a reply is not expected. When <code class="cCode">TPNOREPLY</code> is set, the routine returns [<code class="cCode">TPOK</code>] on success and sets <code class="cCode">COMM-HANDLE IN</code> <code class="cCodeEmphasis">TPSVCDEF-REC</code> to <code class="cCode">0</code>, an invalid communications handle. When the caller is in transaction mode, this setting cannot be used when <code class="cCode">TPTRAN</code> is also set. Either <code class="cCode">TPNOREPLY</code> or <code class="cCode">TPREPLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1188992"> </a>
<code class="cCode">TPREPLY</code> 
</h4><div class="pDefPara"><a name="wp1188993"> </a>
Informs <code class="cCode">TPACALL()</code> that a reply is expected. When <code class="cCode">TPREPLY</code> is set, the routine returns [<code class="cCode">TPOK</code>] on success and sets <code class="cCode">COMM-HANDLE</code> to a valid communications handle. When the caller is in transaction mode, this setting must be used when <code class="cCode">TPTRAN</code> is also set. Either <code class="cCode">TPNOREPLY</code> or <code class="cCode">TPREPLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998489"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998490"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998491"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998492"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998493"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp998494"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998495"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp998496"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998497"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998498"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998499"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998500"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp998501"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998502"> </a>
Upon successful completion, <code class="cCode">TPACALL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. In addition, if <code class="cCode">TPREPLY</code> was set in <code class="cCodeEmphasis">TPSVCDEF-REC</code>, then <code class="cCode">TPCALL()</code> returns a valid communications handle in <code class="cCode">COMM-HANDLE</code> that can be used to receive the reply of the request sent.
</p>
<h4 class="pHeading3"><a name="wp998503"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998504"> </a>
Under the following conditions, <code class="cCode">TPACALL()</code> fails and sets <code class="cCode">TP-STATUS</code> to (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists): 
</p>
<h4 class="pDefTerm"><a name="wp998505"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998506"> </a>
Invalid arguments were given (for example, settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp998507"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp998508"> </a>
Cannot send to <code class="cCode">SERVICE-NAME</code> because it does not exist or is not a request/response service (that is, it is a conversational service).
</div>
<h4 class="pDefTerm"><a name="wp998509"> </a>
[<code class="cCode">TPEITYPE</code>] 
</h4><div class="pDefPara"><a name="wp998510"> </a>
The pair <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> is not one of the allowed types and subtypes that <code class="cCode">SERVICE-NAME</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp998511"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp998512"> </a>
The caller&#8217;s request was not sent because the maximum number of outstanding asynchronous requests has been reached.
</div>
<h4 class="pDefTerm"><a name="wp998513"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp998514"> </a>
<code class="cCode">SERVICE-NAME</code> belongs to a server that does not support transactions and <code class="cCode">TPTRAN</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp998515"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1263973"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPACALL()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1263974"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1263975"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1263976"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp998517"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp998518"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp998519"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp998520"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp998521"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998522"> </a>
<code class="cCode">TPACALL()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp998523"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998524"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998525"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp998526"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp998527"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998528"> </a>
<a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999069"><code class="cCode">TPCANCEL(3cbl)</code></a>, <a href="rf3cbl.html#wp1000197"><code class="cCode">TPGETRPLY(3cbl)</code></a>, <a href="rf3cbl.html#wp1000395"><code class="cCode">TPGPRIO(3cbl)</code></a>, <a href="rf3cbl.html#wp1001527"><code class="cCode">TPSPRIO(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998560"> </a>
TPADVERTISE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998561"> </a>
Name
</h4>
<p class="pBody"><a name="wp998562"> </a>
<code class="cCode">TPADVERTISE()</code> - routine for advertising service names
</p>
<h4 class="pHeading3"><a name="wp998563"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp998564"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">SVC-NAME</code><code class="cCode">     PIC X(127).<br />01 </code><code class="cCodeEmphasis">PROGRAM-NAME</code><code class="cCode">   PIC X(32). <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS.<br /> <br />CALL &quot;TPADVERTISE&quot; USING </code><code class="cCodeEmphasis">SVC-NAME</code><code class="cCode"> </code><code class="cCodeEmphasis">PROGRAM-NAME</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp998565"> </a>
Description
</h4>
<p class="pBody"><a name="wp998566"> </a>
<code class="cCode">TPADVERTISE()</code> allows a server to advertise the services that it offers. By default, a server&#8217;s services are advertised when it is booted and unadvertised when it is shut down.
</p>
<p class="pBody"><a name="wp998567"> </a>
All servers belonging to a multiple server, single queue (MSSQ) set must offer the same set of services. These routines enforce this rule by affecting the advertisements of all servers sharing an MSSQ set.
</p>
<p class="pBody"><a name="wp998568"> </a>
<code class="cCode">TPADVERTISE()</code> advertises <code class="cCodeEmphasis">SVC-NAME</code> for the server (or the set of servers sharing the caller&#8217;s MSSQ set). <code class="cCodeEmphasis">SVC-NAME</code> should be 127 characters or less, but cannot be <code class="cCode">SPACES</code>. (See <code class="cCode">SERVICES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>.) Longer names are truncated to 127 characters. Users should make sure that truncated names do not match other service names. <code class="cCodeEmphasis">PROGRAM-NAME</code> is the name of an Oracle Tuxedo ATMI service program. This program will be invoked whenever a request for <code class="cCodeEmphasis">SVC-NAME</code> is received by the server. <code class="cCodeEmphasis">PROGRAM-NAME</code> cannot be <code class="cCode">SPACES</code>.
</p>
<p class="pBody"><a name="wp998569"> </a>
If <code class="cCodeEmphasis">SVC-NAME</code> is already advertised for the server and <code class="cCodeEmphasis">PROGRAM-NAME</code> matches its current program, then <code class="cCode">TPADVERTISE()</code> returns success (this includes truncated names that match already advertised names). However, if <code class="cCodeEmphasis">SVC-NAME</code> is already advertised for the server but <code class="cCodeEmphasis">PROGRAM-NAME</code> does not match its current program, then an error is returned (this can happen if truncated names match already advertised names).
</p>
<h4 class="pHeading3"><a name="wp998570"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998571"> </a>
<code class="cCode">TPADVERTISE()</code> Upon successful completion, <code class="cCode">TPADVERTISE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp998572"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998573"> </a>
Under the following conditions, <code class="cCode">TPADVERTISE()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998574"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998575"> </a>
Either <code class="cCodeEmphasis">SVC-NAME</code> or <code class="cCodeEmphasis">PROGRAM-NAME</code> is <code class="cCode">SPACES</code>, or <code class="cCodeEmphasis">PROGRAM-NAME</code> is not a name of a valid program.
</div>
<h4 class="pDefTerm"><a name="wp998576"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp998577"> </a>
<code class="cCodeEmphasis">SVC-NAME</code> cannot be advertised because of space limitations. (See <code class="cCode">MAXSERVICES</code> in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>)
</div>
<h4 class="pDefTerm"><a name="wp998578"> </a>
[<code class="cCode">TPEMATCH</code>] 
</h4><div class="pDefPara"><a name="wp998579"> </a>
<code class="cCodeEmphasis">SVC-NAME</code> is already advertised for the server but with a program other than <code class="cCodeEmphasis">PROGRAM-NAME</code>. Although <code class="cCode">TPADVERTISE()</code> fails, <code class="cCodeEmphasis">SVC-NAME</code> remains advertised with its current program (that is, <code class="cCodeEmphasis">PROGRAM-NAME</code> does not replace the current program).
</div>
<h4 class="pDefTerm"><a name="wp998580"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998581"> </a>
<code class="cCode">TPADVERTISE()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp998582"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998583"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998584"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp998585"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp998586"> </a>
Portability
</h4>
<p class="pBody"><a name="wp998587"> </a>
On AIX on the RS6000, any services provided in the first COBOL object file are not available in the symbol table; their names must be specified using the <code class="cCode">-s</code> option on the <code class="cCode">buildserver</code> command so that they can be advertised at run time using <code class="cCode">TPADVERTISE()</code>.
</p>
<h4 class="pHeading3"><a name="wp998588"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998589"> </a>
<a href="rf3cbl.html#wp1002068"><code class="cCode">TPUNADVERTISE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998758"> </a>
TPBEGIN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998759"> </a>
Name
</h4>
<p class="pBody"><a name="wp998760"> </a>
<code class="cCode">TPBEGIN()</code> - routine to begin an Oracle Tuxedo ATMI transaction
</p>
<h4 class="pHeading3"><a name="wp998761"> </a>
Synopsis
</h4>
<a name="wp998762"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode">.<br />  COPY TPTRXDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS. <br /> <br />CALL &quot;TPBEGIN&quot; USING </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998763"> </a>
Description
</h4>
<p class="pBody"><a name="wp998764"> </a>
A transaction in the Oracle Tuxedo system is used to define a single logical unit of work that either wholly succeeds or has no effect whatsoever. A transaction allows work being performed in many processes, at possibly different sites, to be treated as an atomic unit of work. The initiator of a transaction uses <code class="cCode">TPBEGIN()</code> and either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> to delineate the operations within a transaction. Once <code class="cCode">TPBEGIN()</code> is called, communication with any other program can place the latter (of necessity, a server) in &#8220;transaction mode&#8221; (that is, the server&#8217;s work becomes part of the transaction). Threads of control that join a transaction are called participants. A transaction always has one initiator and can have several participants. Only the initiator of a transaction can call <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. Participants can influence the outcome of a transaction by the settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> they use when they call <code class="cCode">TPRETURN()</code>. Once in transaction mode, any service requests made to servers are processed on behalf of the transaction (unless the requester explicitly specifies otherwise).
</p>
<p class="pBody"><a name="wp998765"> </a>
Note that if a program starts a transaction while it has any open connections that it initiated to conversational servers, these connections will not be upgraded to transaction mode. It is as if the <code class="cCode">TPNOTRAN</code> setting had been specified on the <code class="cCode">TPCONNECT()</code> call.
</p>
<p class="pBody"><a name="wp998766"> </a>
<code class="cCode">T-OUT</code> specifies that the transaction should be allowed at least <code class="cCode">T-OUT</code> seconds before timing out. Once a transaction times out it must be aborted. If <code class="cCode">T-OUT</code> is <code class="cCode">0</code>, then the transaction is given the maximum number of seconds allowed by the system before timing out (that is, the timeout value equals the maximum value for an unsigned long as defined by the system).
</p>
<h4 class="pHeading3"><a name="wp998767"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998768"> </a>
Upon successful completion, <code class="cCode">TPBEGIN()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp998769"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998770"> </a>
Under the following conditions, <code class="cCode">TPBEGIN()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998771"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998772"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp998773"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp998774"> </a>
The caller cannot be placed in transaction mode because an error occurred starting the transaction.
</div>
<h4 class="pDefTerm"><a name="wp998775"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998776"> </a>
<code class="cCode">TPBEGIN()</code> was called in an improper context (for example, the caller is already in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp998777"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998778"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998779"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp998780"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp998781"> </a>
Notices
</h4>
<p class="pBody"><a name="wp998782"> </a>
When using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT()</code> and <code class="cCode">TPABORT()</code> to delineate an Oracle Tuxedo ATMI transaction, it is important to remember that only the work done by a resource manager that meets the XA0 interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI transaction.
</p>
<h4 class="pHeading3"><a name="wp998783"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998784"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1044551"><code class="cCode">TPGETLEV(3cbl)</code></a>, <a href="rf3cbl.html#wp1001241"><code class="cCode">TPSCMT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998826"> </a>
TPBROADCAST(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998827"> </a>
Name
</h4>
<p class="pBody"><a name="wp998828"> </a>
<code class="cCode">TPBROADCAST()</code> - broadcast notification by name
</p>
<h4 class="pHeading3"><a name="wp998829"> </a>
Synopsis
</h4>
<a name="wp998830"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPBCTDEF-REC</code><code class="cCode">.<br />  COPY TPBCTDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br />  COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br />  COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS. <br /> <br />CALL &quot;TPBROADCAST&quot; USING </code><code class="cCodeEmphasis">TPBCTDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998831"> </a>
Description
</h4>
<p class="pBody"><a name="wp998832"> </a>
<code class="cCode">TPBROADCAST()</code> allows a client or server to send unsolicited messages to registered clients within the system. The target client set consists of those clients matching identifiers passed to <code class="cCode">TPBROADCAST()</code>. Wildcards can be used in specifying identifiers.
</p>
<p class="pBody"><a name="wp998833"> </a>
<code class="cCode">LMID</code>, <code class="cCode">USRNAME</code> and <code class="cCode">CLTNAME</code>, all in <code class="cCodeEmphasis">TPBCTDEF-REC</code>, are logical identifiers used to select the target client set. A <code class="cCode">SPACES</code> value for any logical identifiers constitutes a wildcard for that argument. A wildcard argument matches all client identifiers for that field. Each identifier must meet the size restrictions defined for the system to be considered valid, that is, each identifier must be between 0 and 30 characters in length.
</p>
<p class="pBody"><a name="wp998834"> </a>
The data portion of the request is identified by <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies how much of <code class="cCodeEmphasis">DATA-REC</code> to send. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, in which case <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a request is sent with no data portion.
</p>
<p class="pBody"><a name="wp998835"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPBCTDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp998836"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998837"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998838"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998839"> </a>
If a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998840"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp998841"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998842"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp998843"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998844"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998845"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Upon successful return from <code class="cCode">TPBROADCAST()</code>, the message has been delivered to the system for forwarding to the selected clients. <code class="cCode">TPBROADCAST()</code> does not wait for the message to be delivered to each selected client. Either <code class="cCode">TPNOSIGRSTRT</code>or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998846"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998847"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp998848"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998849"> </a>
Upon successful completion, <code class="cCode">TPBROADCAST()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp998850"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998851"> </a>
Under the following conditions, <code class="cCode">TPBROADCAST()</code> sends no broadcast messages to application clients and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp998852"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998853"> </a>
Invalid arguments were given. Note that use of an illegal <code class="cCode">LMID</code> will cause <code class="cCode">TPBROADCAST()</code> to fail and return <code class="cCode">TPEINVAL()</code>. However, non-existent user or client names will simply successfully broadcast to no one.
</div>
<h4 class="pDefTerm"><a name="wp998854"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp998855"> </a>
A blocking timeout occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
</div>
<h4 class="pDefTerm"><a name="wp998856"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp998857"> </a>
A blocking condition was found on the call and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp998858"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp998859"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp998860"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998861"> </a>
<code class="cCode">TPBROADCAST()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp998862"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998863"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998864"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp998865"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp998866"> </a>
Portability
</h4>
<p class="pBody"><a name="wp998870"> </a>
The interfaces described in <code class="cCode">TPNOTIFY()</code> are supported on native site UNIX-based processors. In addition, the routines <code class="cCode">TPBROADCAST()</code> and <code class="cCode">TPCHKUNSOL()</code> as well as the routine <code class="cCode">TPSETUNSOL()</code> are supported on UNIX and MS-DOS workstation processors.
</p>
<h4 class="pHeading3"><a name="wp998874"> </a>
Usage
</h4>
<p class="pBody"><a name="wp998875"> </a>
Clients that select signal-based notification may not be signal-able by the system due to signal restrictions. When this occurs, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. (See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> description of the <code class="cCode">RESOURCES</code> <code class="cCode">NOTIFY</code> parameter for a detailed discussion of notification methods.)
</p>
<p class="pBody"><a name="wp1097811"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1097812"> </a>A native client must be running as an application administrator.</li>
<li><a name="wp1097813"> </a>A Workstation client is not required to be running as the application administrator.</li>
</ul></div>
<p class="pBody"><a name="wp1097814"> </a>
The ID for the application administrator is identified in the configuration file for the application.
</p>
<p class="pBody"><a name="wp998877"> </a>
If signal-based notification is selected for a client, then certain ATMI calls can fail, returning <code class="cCode">TPGOTSIG()</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> and <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> for more information on notification method selection.
</p>
<h4 class="pHeading3"><a name="wp998878"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998879"> </a>
<a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp1000626"><code class="cCode">TPNOTIFY(3cbl)</code></a>, <a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998931"> </a>
TPCALL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998932"> </a>
Name
</h4>
<p class="pBody"><a name="wp998933"> </a>
<code class="cCode">TPCALL()</code> - routine to send a message to a service synchronously
</p>
<h4 class="pHeading3"><a name="wp998934"> </a>
Synopsis
</h4>
<a name="wp998935"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">ITPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">IDATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">OTPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">ODATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPCALL&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">ITPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">IDATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">OTPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">ODATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998936"> </a>
Description
</h4>
<p class="pBody"><a name="wp998937"> </a>
<code class="cCode">TPCALL()</code> sends a request and synchronously awaits its reply. A call to this routine is the same as calling <code class="cCode">TPACALL()</code> immediately followed by <code class="cCode">TPGETRPLY()</code>. <code class="cCode">TPCALL()</code> sends a request to the request/response service named by <code class="cCode">SERVICE-NAME</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. The request is sent out at the priority defined for <code class="cCode">SERVICE-NAME</code> unless overridden by a previous call to <code class="cCode">TPSPRIO()</code>. The data portion of a request is specified by <code class="cCodeEmphasis">IDATA-REC</code> and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> specifies how much of <code class="cCodeEmphasis">IDATA-REC</code> to send. Note that if <code class="cCodeEmphasis">IDATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">IDATA-REC</code> and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> are ignored and a request is sent with no data portion. If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> is <code class="cCode">STRING</code> and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> is <code class="cCode">0</code>, then the request is sent with no data portion. The <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> and <code class="cCode">SUB-TYPE</code> in <code class="cCodeEmphasis">ITPTYPE-REC</code> must match one of the <code class="cCode">REC-TYPE</code>s and <code class="cCode">SUB-TYPE</code>s recognized by <code class="cCode">SERVICE-NAME</code>.
</p>
<p class="pBody"><a name="wp998938"> </a>
<code class="cCodeEmphasis">ODATA-REC</code> specifies where a reply is read into, and, on input <code class="cCode">LEN</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> indicates the maximum number of bytes that should be moved into <code class="cCodeEmphasis">ODATA-REC</code>. If the same record is to be used for both sending and receiving, <code class="cCodeEmphasis">ODATA-REC</code> should be <code class="cCode">REDEFINED</code> to <code class="cCodeEmphasis">IDATA-REC</code>. Upon successful return from <code class="cCode">TPCALL()</code>, <code class="cCode">LEN</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">ODATA-REC</code>. <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> contain the replies type and subtype respectively. If the reply is larger than <code class="cCodeEmphasis">ODATA-REC</code>, then <code class="cCodeEmphasis">ODATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the reply is discarded and <code class="cCode">TPCALL()</code> sets <code class="cCode">TPTRUNCATE()</code>.
</p>
<p class="pBody"><a name="wp998939"> </a>
If <code class="cCode">LEN</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> is <code class="cCode">0</code> upon successful return, then the reply has no data portion and <code class="cCodeEmphasis">ODATA-REC</code> was not modified. It is an error for <code class="cCode">LEN</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> to be <code class="cCode">0</code> on input.
</p>
<p class="pBody"><a name="wp998940"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp998941"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp998942"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. If the <code class="cCode">SERVICE-NAME</code> belongs to a server that does not support transactions then this setting must be used when the caller is in transaction mode. A caller in transaction mode that sets this to <code class="cCode">true</code> is still subject to the transaction timeout (and no other). If a service fails that was invoked with this setting, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998943"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp998944"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is performed on behalf of the caller&#8217;s transaction. The setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998945"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp998946"> </a>
When this setting is used, the type of <code class="cCodeEmphasis">ODATA-REC</code> is not allowed to change. That is, the type and subtype of the replied record must match <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">OTPTYPE-REC</code> and <code class="cCode">SUB-TYPE IN</code> <code class="cCodeEmphasis">OTPTYPE-REC</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998947"> </a>
<code class="cCode">TPCHANGE</code> 
</h4><div class="pDefPara"><a name="wp998948"> </a>
The type and/or subtype of the reply record is allowed to differ from those specified in <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">OTPTYPE-REC</code> and <code class="cCode">SUB-TYPE IN</code> <code class="cCodeEmphasis">OTPTYPE-REC</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998949"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998950"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). Note that this setting applies only to the send portion of <code class="cCode">TPCALL()</code>: the routine may block waiting for the reply. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998951"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp998952"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998953"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp998954"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998955"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp998956"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998957"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998958"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp998959"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp998960"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the routine fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp998961"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp998962"> </a>
Upon successful completion, <code class="cCode">TPCALL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. When <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPOK</code> or <code class="cCode">TPESVCFAIL</code>, <code class="cCode">APPL-RETURN-CODE IN</code> <code class="cCodeEmphasis">TPSTATUS-REC</code> contains an application-defined value that was sent as part of <code class="cCode">TPRETURN()</code>.
</p>
<p class="pBody"><a name="wp998963"> </a>
If the size of the incoming message was larger then the size specified in <code class="cCode">LEN</code> on input, <code class="cCode">TPTRUNCATE()</code> is set and only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">ODATA-REC</code>, the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp998964"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998965"> </a>
Under the following conditions, <code class="cCode">TPCALL()</code> fails and sets <code class="cCode">TP-STATUS</code> to (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists): 
</p>
<h4 class="pDefTerm"><a name="wp998966"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998967"> </a>
Invalid arguments were given (for example, <code class="cCode">SERVICE-NAME</code> is <code class="cCode">SPACES</code> or settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp998968"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp998969"> </a>
Cannot send to <code class="cCode">SERVICE-NAME</code> because it does not exist or is not a request/response service (that is, it is a conversational service).
</div>
<h4 class="pDefTerm"><a name="wp998970"> </a>
[<code class="cCode">TPEITYPE</code>] 
</h4><div class="pDefPara"><a name="wp998971"> </a>
The pair <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> is not one of the allowed types and subtypes that <code class="cCode">SERVICE-NAME</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp998972"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp998973"> </a>
Either the type and subtype of the reply are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set and the <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> in <code class="cCodeEmphasis">ODATA-REC</code> do not match the type and subtype of the reply sent by the service. Neither <code class="cCodeEmphasis">ODATA-REC</code> nor <code class="cCode">LEN</code> in <code class="cCodeEmphasis">OTPTYPE-REC</code> are changed. If the service request was made on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only since the reply is discarded.
</div>
<h4 class="pDefTerm"><a name="wp998974"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp998975"> </a>
<code class="cCode">SERVICE-NAME</code> belongs to a server that does not support transactions and <code class="cCode">TPTRAN</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp998976"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1263999"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPCALL()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1264000"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.) In either case, no changes are made to <code class="cCodeEmphasis">ODATA-REC</code> or <code class="cCodeEmphasis">OTPTYPE-REC</code>.
<a name="wp1264001"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1264002"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp998978"> </a>
[<code class="cCode">TPESVCFAIL</code>] 
</h4><div class="pDefPara"><a name="wp1230063"> </a>
The service routine sending the caller&#8217;s reply called <code class="cCode">TPRETURN()</code> with <code class="cCode">TPFAIL()</code>. This is an application-level failure. The contents of the service&#8217;s reply, if one was sent, is available in <code class="cCodeEmphasis">ODATA-REC</code>. If the service request was made on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp998980"> </a>
[<code class="cCode">TPESVCERR</code>] 
</h4><div class="pDefPara"><a name="wp998981"> </a>
An error was encountered either in invoking a service routine or during its completion in <code class="cCode">TPRETURN()</code> (for example, bad arguments were passed). No reply data is returned when this error occurs (that is, neither <code class="cCodeEmphasis">ODATA-REC</code> nor <code class="cCodeEmphasis">OTPTYPE-REC</code> are changed). If the service request was made on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPNOTRAN</code> was not set), then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp998982"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp998983"> </a>
A blocking condition was found on the send portion of <code class="cCode">TPCALL()</code> and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp998984"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp998985"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp998986"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp998987"> </a>
<code class="cCode">TPCALL()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp998988"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp998989"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp998990"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1187453"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1187454"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1187467"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>, <a href="rf3cbl.html#wp1000056"><code class="cCode">TPFORWAR(3cbl)</code></a>, <a href="rf3cbl.html#wp1000395"><code class="cCode">TPGPRIO(3cbl)</code></a>, <a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001527"><code class="cCode">TPSPRIO(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999069"> </a>
TPCANCEL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999070"> </a>
Name
</h4>
<p class="pBody"><a name="wp999071"> </a>
<code class="cCode">TPCANCEL()</code> - cancel a communication handle for an outstanding reply
</p>
<h4 class="pHeading3"><a name="wp999072"> </a>
Synopsis
</h4>
<a name="wp999073"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br />  COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />  COPY TPSTATUS. <br /> <br />CALL &quot;TPCANCEL&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999074"> </a>
Description
</h4>
<p class="pBody"><a name="wp999075"> </a>
<code class="cCode">TPCANCEL()</code> cancels a communication handle, <code class="cCode">COMM-HANDLE IN</code> <code class="cCodeEmphasis">TPSVCDEF-REC</code>, returned by <code class="cCode">TPACALL()</code>. It is an error to attempt to cancel a communication handle associated with a transaction.
</p>
<p class="pBody"><a name="wp999076"> </a>
Upon success, <code class="cCode">COMM-HANDLE</code> is no longer valid and any reply received on behalf of <code class="cCode">COMM-HANDLE</code> will be silently discarded.
</p>
<h4 class="pHeading3"><a name="wp999077"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999078"> </a>
Upon successful completion, <code class="cCode">TPCANCEL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999079"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999080"> </a>
Under the following conditions, <code class="cCode">TPCANCEL()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999081"> </a>
[<code class="cCode">TPEBADDESC</code>]
</h4><div class="pDefPara"><a name="wp999082"> </a>
<code class="cCode">COMM-HANDLE</code> is an invalid communication handle.
</div>
<h4 class="pDefTerm"><a name="wp999083"> </a>
[<code class="cCode">TPETRAN</code>]
</h4><div class="pDefPara"><a name="wp999084"> </a>
<code class="cCode">COMM-HANDLE</code> is associated with the caller&#8217;s transaction. <code class="cCode">COMM-HANDLE</code> remains valid and the caller&#8217;s current transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp999085"> </a>
[<code class="cCode">TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp999086"> </a>
<code class="cCode">TPCANCEL()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp999087"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp999088"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999089"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp999090"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999091"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999092"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999132"> </a>
TPCHKAUTH(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999133"> </a>
Name
</h4>
<p class="pBody"><a name="wp999134"> </a>
<code class="cCode">TPCHKAUTH()</code>&#8212;check if authentication required to join an Oracle Tuxedo ATMI application
</p>
<h4 class="pHeading3"><a name="wp999135"> </a>
Synopsis
</h4>
<a name="wp999136"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPAUTDEF-REC</code><code class="cCode">.<br /> COPY TPAUTDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS.<br /> <br /> CALL &quot;TPCHKAUTH&quot; USING </code><code class="cCodeEmphasis">TPAUTDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999137"> </a>
Description
</h4>
<p class="pBody"><a name="wp999138"> </a>
<code class="cCode">TPCHKAUTH()</code> checks if authentication is required by the application configuration. This is typically used by application clients prior to calling <code class="cCode">TPINITIALIZE()</code> to determine if a password should be obtained from the user.
</p>
<h4 class="pHeading3"><a name="wp999139"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999140"> </a>
Upon successful completion, <code class="cCode">TPCHKAUTH()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and sets one of the following values in <code class="cCodeEmphasis">TPAUTDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp999141"> </a>
<code class="cCode">TPNOAUTH</code> 
</h4><div class="pDefPara"><a name="wp999142"> </a>
Indicates that no authentication is required.
</div>
<h4 class="pDefTerm"><a name="wp999143"> </a>
<code class="cCode">TPSYSAUTH</code> 
</h4><div class="pDefPara"><a name="wp999144"> </a>
Indicates that only system authentication is required.
</div>
<h4 class="pDefTerm"><a name="wp999145"> </a>
<code class="cCode">TPAPPAUTH</code> 
</h4><div class="pDefPara"><a name="wp999146"> </a>
Indicates that both system and application specific authentication are required.
</div>
<h4 class="pHeading3"><a name="wp999147"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999148"> </a>
Under the following conditions, <code class="cCode">TPCHKAUTH()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999149"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999150"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999151"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999152"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999153"> </a>
Portability
</h4>
<p class="pBody"><a name="wp999157"> </a>
The interfaces described in <code class="cCode">TPCHKAUTH()</code> are supported on UNIX system and MS-DOS operating systems.
</p>
<h4 class="pHeading3"><a name="wp999172"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999173"> </a>
<a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999231"> </a>
TPCHKUNSOL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999232"> </a>
Name
</h4>
<p class="pBody"><a name="wp999233"> </a>
<code class="cCode">TPCHKUNSOL()</code> - check for unsolicited message
</p>
<h4 class="pHeading3"><a name="wp999234"> </a>
Synopsis
</h4>
<a name="wp999235"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">MSG-NUM</code><code class="cCode"> PIC S9(9) COMP-5. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPCHKUNSOL&quot; USING </code><code class="cCodeEmphasis">MSG-NUM</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999236"> </a>
Description
</h4>
<p class="pBody"><a name="wp999237"> </a>
<code class="cCode">TPCHKUNSOL()</code> is used by a client to trigger checking for unsolicited messages. Calls to this routine in a client using signal-based notification do nothing and return immediately. Calls to this routine can result in calls to an application-defined unsolicited message handling routine by the Oracle Tuxedo ATMI libraries.
</p>
<h4 class="pHeading3"><a name="wp999238"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999239"> </a>
Upon successful completion, <code class="cCode">TPCHKUNSOL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and returns the number of unsolicited messages dispatched in <code class="cCodeEmphasis">MSG-NUM</code>.
</p>
<h4 class="pHeading3"><a name="wp999240"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999241"> </a>
Under the following conditions, <code class="cCode">TPCHKUNSOL()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999242"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999243"> </a>
<code class="cCode">TPCHKUNSOL()</code> was called in an improper context (for example, from within a server).
</div>
<h4 class="pDefTerm"><a name="wp999244"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999245"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999246"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999247"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999248"> </a>
Portability
</h4>
<p class="pBody"><a name="wp999252"> </a>
The interfaces described in <code class="cCode">TPNOTIFY()</code> are supported on native site UNIX-based processors. In addition, the routines <code class="cCode">TPBROADCAST()</code> and <code class="cCode">TPCHKUNSOL()</code> as well as the routine <code class="cCode">TPSETUNSOL()</code> are supported on UNIX and MS-DOS workstation processors.
</p>
<p class="pBody"><a name="wp999256"> </a>
Clients that select signal-based notification may not be signal-able by the system due to signal restrictions. When this occurs, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. (See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> description of the <code class="cCode">RESOURCES</code> <code class="cCode">NOTIFY</code> parameter for a detailed discussion of notification methods.) 
</p>
<p class="pBody"><a name="wp1097832"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1097833"> </a>A native client must be running as an application administrator.</li>
<li><a name="wp1097834"> </a>A Workstation client is not required to be running as the application administrator.</li>
</ul></div>
<p class="pBody"><a name="wp1097835"> </a>
The ID for the application administrator is identified as part of the configuration for the application.
</p>
<p class="pBody"><a name="wp999257"> </a>
If signal-based notification is selected for a client, then certain ATMI calls can fail, returning <code class="cCode">TPGOTSIG()</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> and <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> for more information on notification method selection.
</p>
<h4 class="pHeading3"><a name="wp999258"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999259"> </a>
<a href="rf3cbl.html#wp998826"><code class="cCode">TPBROADCAST(3cbl)</code></a>, <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp1000626"><code class="cCode">TPNOTIFY(3cbl)</code></a>, <a href="rf3cbl.html#wp1047466"><code class="cCode">TPSETUNSOL(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999299"> </a>
TPCLOSE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999300"> </a>
Name
</h4>
<p class="pBody"><a name="wp999301"> </a>
<code class="cCode">TPCLOSE()</code> - close the Oracle Tuxedo ATMI resource manager
</p>
<h4 class="pHeading3"><a name="wp999302"> </a>
Synopsis
</h4>
<a name="wp999303"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPCLOSE&quot; USING </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999304"> </a>
Description
</h4>
<p class="pBody"><a name="wp999305"> </a>
<code class="cCode">TPCLOSE()</code> tears down the association between the caller and the resource manager to which it is linked. Since resource managers differ in their <code class="cCode">close</code> semantics, the specific information needed to close a particular resource manager is placed in a configuration file.
</p>
<p class="pBody"><a name="wp999306"> </a>
If a resource manager is already closed (that is, <code class="cCode">TPCLOSE()</code> is called more than once), no action is taken and success is returned.
</p>
<h4 class="pHeading3"><a name="wp999307"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999308"> </a>
Upon successful completion, <code class="cCode">TPCLOSE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999309"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999310"> </a>
Under the following conditions, <code class="cCode">TPCLOSE()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999311"> </a>
[<code class="cCode">TPERMERR</code>] 
</h4><div class="pDefPara"><a name="wp999312"> </a>
A resource manager failed to close correctly. More information concerning the reason a resource manager failed to close can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp999313"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999314"> </a>
<code class="cCode">TPCLOSE()</code> was called in an improper context (for example, while the caller is in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp999315"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999316"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999317"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999318"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999319"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999320"> </a>
<a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999360"> </a>
TPCOMMIT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999361"> </a>
Name
</h4>
<p class="pBody"><a name="wp999362"> </a>
<code class="cCode">TPCOMMIT()</code> - commit current Oracle Tuxedo ATMI transaction
</p>
<h4 class="pHeading3"><a name="wp999363"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp999364"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode">.<br /> COPY TPTRXDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPCOMMIT&quot; USING </code><code class="cCodeEmphasis">TPTRXDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code>
</p>
<h4 class="pHeading3"><a name="wp999365"> </a>
Description
</h4>
<p class="pBody"><a name="wp999366"> </a>
<code class="cCode">TPCOMMIT()</code> signifies the end of a transaction, using a two-phase commit protocol to coordinate participants. <code class="cCode">TPCOMMIT()</code> can be called only by the initiator of a transaction. If any of the participants cannot commit the transaction (for example, they call <code class="cCode">TPRETURN()</code> with <code class="cCode">TPFAIL()</code>), then the entire transaction is aborted and <code class="cCode">TPCOMMIT()</code> fails. That is, all of the work involved in the transaction is undone. If all participants agree to commit their portion of the transaction, then this decision is logged to stable storage and all participants are asked to commit their work.
</p>
<p class="pBody"><a name="wp999367"> </a>
Depending on the setting of the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic (see <code class="cCode">TPSCMT()</code>), <code class="cCode">TPCOMMIT()</code> can return successfully either after the commit decision has been logged or after the two-phase commit protocol has completed. If <code class="cCode">TPCOMMIT()</code> returns after the commit decision has been logged but before the second phase has completed (<code class="cCode">TP-CMT-LOGGED</code>), then all participants have agreed to commit the work they did on behalf of the transaction and should fulfill their promise to commit the transaction during the second phase. However, because <code class="cCode">TPCOMMIT()</code> is returning before the second phase has completed, there is a hazard that one or more of the participants can heuristically complete their portion of the transaction (in a manner that is not consistent with the commit decision) even though the routine has returned success.
</p>
<p class="pBody"><a name="wp999368"> </a>
If the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic is set such that <code class="cCode">TPCOMMIT()</code> returns after the two-phase commit protocol has completed (<code class="cCode">TP-CMT-COMPLETE</code>), then its return value reflects the exact status of the transaction (that is, whether the transaction heuristically completed or not).
</p>
<p class="pBody"><a name="wp999369"> </a>
Note that if only a single resource manager is involved in a transaction, then a one-phase commit is performed (that is, the resource manager is not asked whether or not it can commit; it is simply told to commit). In this case, the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic has no bearing and <code class="cCode">TPCOMMIT()</code> will return heuristic outcomes if present.
</p>
<p class="pBody"><a name="wp999370"> </a>
If <code class="cCode">TPCOMMIT()</code> is called while communication handles exist for outstanding replies, then upon return from <code class="cCode">TPCOMMIT()</code>, the transaction is aborted and those handles associated with the caller&#8217;s transaction are no longer valid. Communication handles not associated with the caller&#8217;s transaction remain valid.
</p>
<p class="pBody"><a name="wp999371"> </a>
<code class="cCode">TPCOMMIT()</code> must be called after all connections associated with the caller&#8217;s transaction are closed (otherwise [<code class="cCode">TPEABORT</code>] is returned, the transaction is aborted and these connections are disconnected in a disorderly fashion with a <code class="cCode">TPEV-DISCONIMM</code> event). Connections opened before <code class="cCode">TPBEGIN()</code> or with the <code class="cCode">TPNOTRAN</code> setting (that is, connections not in transaction mode) are not affected by calls to <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>.
</p>
<p class="pBody"><a name="wp999372"> </a>
Currently, <code class="cCode">TPCOMMIT()</code>&#8217;s argument, <code class="cCodeEmphasis">TPTRXDEF-REC</code>, is reserved for future use.
</p>
<h4 class="pHeading3"><a name="wp999373"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999374"> </a>
Upon successful completion, <code class="cCode">TPCOMMIT()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999375"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999376"> </a>
Under the following conditions, <code class="cCode">TPCOMMT()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999377"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999378"> </a>
<code class="cCodeEmphasis">TPTRXDEF-REC</code> is not equal to <code class="cCode">0</code>. The caller&#8217;s transaction is not affected.
</div>
<h4 class="pDefTerm"><a name="wp999379"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1267704"> </a>
The transaction has timed out and its status is unknown: it may have been either committed or aborted. If a transaction has timed out and its status is known to be aborted, than <code class="cCode">TPEABORT</code> is returned.
</div>
<h4 class="pDefTerm"><a name="wp999381"> </a>
[<code class="cCode">TPEABORT</code>] 
</h4><div class="pDefPara"><a name="wp999382"> </a>
The transaction could not commit because either the work performed by the initiator or by one or more of its participants could not commit. This error is also returned if <code class="cCode">TPCOMMIT()</code> is called with outstanding replies or open conversational connections.
</div>
<h4 class="pDefTerm"><a name="wp999383"> </a>
[<code class="cCode">TPEHEURISTIC</code>] 
</h4><div class="pDefPara"><a name="wp999384"> </a>
Due to a heuristic decision, the work done on behalf of the transaction was partially committed and partially aborted.
</div>
<h4 class="pDefTerm"><a name="wp999385"> </a>
[<code class="cCode">TPEHAZARD</code>] 
</h4><div class="pDefPara"><a name="wp999386"> </a>
Due to some failure, the work done on behalf of the transaction could have been heuristically completed.
</div>
<h4 class="pDefTerm"><a name="wp999387"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999388"> </a>
<code class="cCode">TPCOMMIT()</code> was called in an improper context (for example, by a participant).
</div>
<h4 class="pDefTerm"><a name="wp999389"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999390"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999391"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999392"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999393"> </a>
Notices
</h4>
<p class="pBody"><a name="wp999394"> </a>
When using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT(),</code> and <code class="cCode">TPABORT()</code> to delineate an Oracle Tuxedo ATMI transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI transaction.
</p>
<h4 class="pHeading3"><a name="wp999395"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999396"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1044551"><code class="cCode">TPGETLEV(3cbl)</code></a>, <a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001241"><code class="cCode">TPSCMT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999450"> </a>
TPCONNECT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999451"> </a>
Name
</h4>
<p class="pBody"><a name="wp999452"> </a>
<code class="cCode">TPCONNECT()</code> - establish a conversational connection
</p>
<h4 class="pHeading3"><a name="wp999453"> </a>
Synopsis
</h4>
<a name="wp999454"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPCONNECT&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999455"> </a>
Description
</h4>
<p class="pBody"><a name="wp999456"> </a>
<code class="cCode">TPCONNECT()</code> allows a program to set up a half-duplex connection to a conversational service, <code class="cCode">SERVICE-NAME</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. The name must be one of the conversational service names posted by a conversational server.
</p>
<p class="pBody"><a name="wp999457"> </a>
As part of setting up a connection, the caller can pass application-defined data to the receiving service routine. If the caller chooses to pass data, then <code class="cCodeEmphasis">DATA-REC</code> contains the data and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies how much of the record to send. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored (no application data is passed to the conversational service). <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> must match one of the types and subtypes recognized by <code class="cCode">SERVICE-NAME</code>.
</p>
<p class="pBody"><a name="wp999458"> </a>
Because the conversational service receives <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> upon successful return from <code class="cCode">TPSVCSTART()</code>, the service does not call <code class="cCode">TPRECV()</code> to get the data sent by <code class="cCode">TPCONNECT()</code>.
</p>
<p class="pBody"><a name="wp999459"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp999460"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp999461"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is not performed on behalf of the caller&#8217;s transaction. If <code class="cCode">SERVICE-NAME</code> belongs to a server that does not support transactions, then this setting must be used when the caller is in transaction mode. A caller in transaction mode that uses this setting is still subject to the transaction timeout (and no other). If a service fails that was invoked with this setting, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999462"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp1188972"> </a>
If the caller is in transaction mode and this setting is used, then when <code class="cCode">SERVICE-NAME</code> is invoked, it is performed on behalf of the caller&#8217;s transaction. This setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1188973"> </a>
<code class="cCode">TPSENDONLY</code> 
</h4><div class="pDefPara"><a name="wp999465"> </a>
The caller wants the connection to be set up initially such that it can only send data and the called service can only receive data (that is, the caller initially has control of the connection). Either <code class="cCode">TPSENDONLY</code> or <code class="cCode">TPRECVONLY</code> must be specified.
</div>
<h4 class="pDefTerm"><a name="wp999466"> </a>
<code class="cCode">TPRECVONLY</code> 
</h4><div class="pDefPara"><a name="wp999467"> </a>
The caller wants the connection to be set up initially such that it can only receive data and the called service can only send data (that is, the service being called initially has control of the connection). Either <code class="cCode">TPSENDONLY</code> or <code class="cCode">TPRECVONLY</code> must be specified.
</div>
<h4 class="pDefTerm"><a name="wp999468"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp999469"> </a>
The connection is not established and the data is not sent if a blocking condition exists (for example, the data buffers through which the message is sent are full). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999470"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp999471"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999472"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp999473"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts will still affect the program. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999474"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp999475"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999476"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999477"> </a>
If a signal interrupts any underlying system calls, the interrupted call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999478"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999479"> </a>
When <code class="cCode">TPNOSIGRSTRT</code> is specified and a signal interrupts a system call, the call fails and <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPGOTSIG()</code>. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp999480"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999481"> </a>
Upon successful completion, <code class="cCode">TPCONNECT()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and returns a communications handle in <code class="cCode">COMM-HANDLE</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code> that is used to refer to the connection in subsequent calls.
</p>
<h4 class="pHeading3"><a name="wp999482"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999483"> </a>
Under the following conditions, <code class="cCode">TPCONNECT()</code> fails and sets <code class="cCode">TP-STATUS</code> to (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists). 
</p>
<h4 class="pDefTerm"><a name="wp999484"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999485"> </a>
Invalid arguments were given (for example, settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp999486"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp999487"> </a>
Can not initiate a connection to <code class="cCode">SERVICE-NAME</code> because it does not exist or is not a conversational service.
</div>
<h4 class="pDefTerm"><a name="wp999488"> </a>
[<code class="cCode">TPEITYPE</code>] 
</h4><div class="pDefPara"><a name="wp999489"> </a>
The pair <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> is not one of the allowed types and subtypes that <code class="cCode">SERVICE-NAME</code> accepts.
</div>
<h4 class="pDefTerm"><a name="wp999490"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp999491"> </a>
The connection was not sent because the maximum number of outstanding connections has been reached.
</div>
<h4 class="pDefTerm"><a name="wp999492"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp999493"> </a>
<code class="cCode">SERVICE-NAME</code> belongs to a program that does not support transactions and <code class="cCode">TPNOTRAN</code> was not set.
</div>
<h4 class="pDefTerm"><a name="wp999494"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1267718"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPCONNECT()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1267719"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1267720"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1267721"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp999498"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp999499"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp999500"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999501"> </a>
<code class="cCode">TPCONNECT()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp999502"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999503"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999504"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999505"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp999506"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999507"> </a>
<a href="rf3cbl.html#wp999791"><code class="cCode">TPDISCON(3cbl)</code></a>, <a href="rf3cbl.html#wp1000927"><code class="cCode">TPRECV(3cbl)</code></a>, <a href="rf3cbl.html#wp1001318"><code class="cCode">TPSEND(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999573"> </a>
TPDEQUEUE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999574"> </a>
Name
</h4>
<p class="pBody"><a name="wp999575"> </a>
<code class="cCode">TPDEQUEUE()</code> - routine to dequeue a message from a queue
</p>
<h4 class="pHeading3"><a name="wp1006373"> </a>
Synopsis
</h4>
<a name="wp999576"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode">.<br /> COPY TPQUEDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY STATDEF. <br /> <br />CALL &quot;TPDEQUEUE&quot; USING </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp999577"> </a>
Description
</h4>
<p class="pBody"><a name="wp999578"> </a>
<code class="cCode">TPDEQUEUE()</code> takes a message for processing from the queue named by <code class="cCode">QNAME</code> in the <code class="cCode">QSPACE-NAME</code> queue space.
</p>
<p class="pBody"><a name="wp999579"> </a>
By default, the message at the top of the queue is dequeued. The order of messages on the queue is defined when the queue is created. The application can request a particular message for dequeuing by specifying its message identifier using <code class="cCode">MSGID</code> or correlation identifier using <code class="cCode">CORRID</code>. <code class="cCodeEmphasis">TPQUEDEF-REC</code> settings can also be used to indicate that the application wants to wait for a message, in the case when a message is not currently available. It is possible to use the <code class="cCodeEmphasis">TPQUEDEF-REC</code> structure to look at a message without removing it from the queue or changing its relative position on the queue. See the section below describing this record.
</p>
<p class="pBody"><a name="wp999580"> </a>
<code class="cCodeEmphasis">DATA-REC</code> specifies where a dequeued message is to be read into, and, on input <code class="cCode">LEN</code> indicates the maximum number of bytes that should be moved into <code class="cCodeEmphasis">DATA-REC</code>. Upon successful return, <code class="cCode">LEN</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">DATA-REC</code>. <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> contain the replies type and subtype respectively. If the reply is larger than <code class="cCodeEmphasis">DATA-REC</code>, then <code class="cCodeEmphasis">DATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the reply is discarded and <code class="cCode">TPDEQUEUE()</code> fails returning [<code class="cCode">TPTRUNCATE</code>].
</p>
<p class="pBody"><a name="wp999581"> </a>
If <code class="cCode">LEN</code> is <code class="cCode">0</code> upon successful return, then the reply has no data portion and <code class="cCodeEmphasis">DATA-REC</code> was not modified. It is an error for <code class="cCode">LEN</code> to be <code class="cCode">0</code> on input.
</p>
<p class="pBody"><a name="wp999582"> </a>
The message is dequeued in transaction mode if the caller is in transaction mode and <code class="cCode">TPTRAN</code> is set. This has the effect that if <code class="cCodeEmphasis">TPDEQUEUE</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is removed from the queue. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be left on the queue (that is, the removal of the message from the queue is also rolled back). It is not possible to enqueue and dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp999583"> </a>
The message is not dequeued in transaction mode if either the caller is not in transaction mode, or <code class="cCode">TPNOTRAN</code> is set. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully dequeued and the message may be lost.
</p>
<p class="pBody"><a name="wp999584"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp999585"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp999586"> </a>
If the caller is in transaction mode and this setting is used, the message is not dequeued within the caller&#8217;s transaction. A caller in transaction mode that sets this to <code class="cCode">true</code> is still subject to the transaction timeout (and no other). If message dequeuing fails that was invoked with this setting, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999587"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp999588"> </a>
If the caller is in transaction mode and this setting is used, the message is dequeued within the same transaction as the caller. The setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999593"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1174591"> </a>
The message is not dequeued if a blocking condition exists. If <code class="cCode">TPNOBLOCK</code> is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPEBLOCK</code>. If <code class="cCode">TPNOBLOCK</code> is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">TP-STATUS </code>is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the <code class="cCode">DIAGNOSTIC</code> field of the <code class="cCode">TPQUEDEF</code> record is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on an Oracle product other than the Oracle Tuxedo system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999595"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp999596"> </a>
When <code class="cCode">TPBLOCK</code> is set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). This blocking condition does not include blocking on the queue itself if the <code class="cCode">TPQWAIT</code> setting is specified. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999597"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp999598"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999599"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp999600"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1185204"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1185205"> </a>
When this setting is used, the type of <code class="cCodeEmphasis">DATA-REC</code> is not allowed to change. That is, the type and subtype of the dequeued message must match <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code> and <code class="cCode">SUB-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1185206"> </a>
<code class="cCode">TPCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1185207"> </a>
The type and/or subtype of the dequeued message is allowed to differ from those specified in <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code> and <code class="cCode">SUB-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999601"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999602"> </a>
If a signal interrupts any underlying system calls, the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999603"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999604"> </a>
If a signal interrupts any underlying system calls, the interrupted system call is not restarted and the routine fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<p class="pBody"><a name="wp999605"> </a>
If <code class="cCode">TPDEQUEUE()</code> returns successfully, the application can retrieve additional information about the message using the <code class="cCodeEmphasis">TPQUEDEF-REC</code> structure. The information may include the message identifier for the dequeued message; a correlation identifier that should accompany any reply or failure message so that the originator can correlate the message with the original request; the quality of service the message was delivered with; the quality of service any replies to the message should be delivered with; the name of a reply queue if a reply is desired; and the name of the failure queue on which the application can queue information regarding failure to dequeue the message. These are described below.
</p>
<h4 class="pHeading3"><a name="wp999606"> </a>
Control Structure
</h4>
<p class="pBody"><a name="wp999607"> </a>
<code class="cCodeEmphasis">TPQUEDEF-REC</code> is used by the application program to pass and retrieve information associated with dequeuing the message. The settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> are used to indicate what other elements in the structure are valid.
</p>
<p class="pBody"><a name="wp999608"> </a>
On input to <code class="cCode">TPDEQUEUE()</code>, the following elements may be set in the <code class="cCodeEmphasis">TPQUEDEF-REC</code>:
</p>
<a name="wp999609"> </a><div class="pPreformatted"><pre>05 MSGID    PIC X(32).<br />05 CORRID   PIC X(32).</pre></div><p class="pBody"><a name="wp999610"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> controlling input information for <code class="cCode">TPDEQUEUE()</code>.
</p>
<h4 class="pDefTerm"><a name="wp999611"> </a>
<code class="cCode">TPQGETNEXT</code>
</h4><div class="pDefPara"><a name="wp999612"> </a>
Setting this value requests that the next message on the queue be dequeued, using the default queue order. One of the following must be set: <code class="cCode">TPQGETNEXT</code>, <code class="cCode">TPQGETBYMSGID</code>, or <code class="cCode">TPQGETBYCORRID</code>.
</div>
<h4 class="pDefTerm"><a name="wp999613"> </a>
<code class="cCode">TPQGETBYMSGID</code>
</h4><div class="pDefPara"><a name="wp1219668"> </a>
Setting this value requests that the message identified by <code class="cCode">MSGID</code> be dequeued. The message identifier may be acquired by a prior call to <code class="cCode">TPENQUEUE()</code>. Note that the message identifier changes if the message has moved from one queue to another. Note also that the entire 32 bytes of the message identifier value are significant, so the value identified by <code class="cCode">MSGID</code> must be completely initialized (for example, padded with spaces).
</div>
<div class="pDefParaCont"><a name="wp1219663"> </a>
One of the following must be set: <code class="cCode">TPQGETNEXT</code>, <code class="cCode">TPQGETBYMSGID</code>, or <code class="cCode">TPQGETBYCORRID</code>.
</div>
<h4 class="pDefTerm"><a name="wp999615"> </a>
<code class="cCode">TPQGETBYCORRID</code>
</h4><div class="pDefPara"><a name="wp999616"> </a>
Setting this value requests that the message identified by <code class="cCode">CORRID</code> be dequeued. The correlation identifier is specified by the application when enqueuing the message with <code class="cCode">TPENQUEUE()</code>. Note that the entire 32 bytes of the correlation identifier value are significant, so the value identified by <code class="cCode">CORRID</code> must be completely initialized (for example, padded with spaces).
</div>
<div class="pDefParaCont"><a name="wp1219673"> </a>
One of the following must be set: <code class="cCode">TPQGETNEXT</code>, <code class="cCode">TPQGETBYMSGID</code>, or <code class="cCode">TPQGETBYCORRID</code>.
</div>
<h4 class="pDefTerm"><a name="wp999617"> </a>
<code class="cCode">TPQWAIT</code> 
</h4><div class="pDefPara"><a name="wp999618"> </a>
Setting this value indicates that an error should not be returned if the queue is empty. Instead, the process should wait until a message is available. Set <code class="cCode">TPQNOWAIT</code> to not wait until a message is available. If <code class="cCode">TPQWAIT</code> is set in conjunction with <code class="cCode">TPQGETBYMSGID</code> or <code class="cCode">TPQGETBYCORRID</code>, it indicates that an error should not be returned if no message with the specified message identifier or correlation identifier is present in the queue. Instead, the process should wait until a message meeting the criteria is available. The process is still subject to the caller&#8217;s transaction timeout, or, when not in transaction mode, the process is still subject to the timeout specified on the <code class="cCode">TMQUEUE</code> process by the<code class="cCode"> -t</code> option.
</div>
<div class="pDefParaCont"><a name="wp1203891"> </a>
If a message matching the desired criteria is not immediately available and the configured action resources are exhausted, <code class="cCode">TPDEQUEUE</code> fails, <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, and <code class="cCode">DIAGNOSTIC</code> is set to <code class="cCode">QMESYSTEM</code>.
<a name="wp1210519"> </a>
Note that each <code class="cCode">TPDEQUEUE()</code> request specifying the <code class="cCode">TPQWAIT</code> control parameter requires that a queue manager (<code class="cCode">TMQUEUE</code>) action object be available if a message satisfying the condition is not immediately available. If one is not available, the <code class="cCode">TPDEQUEUE()</code> request fails. The number of available queue manager actions are specified when a queue space is created or modified. When a waiting dequeue request completes, the associated action object associated is made available for another request.
</div>
<h4 class="pDefTerm"><a name="wp1203892"> </a>
<code class="cCode">TPQPEEK</code> 
</h4><div class="pDefPara"><a name="wp1203893"> </a>
If <code class="cCode">TPQPEEK</code> is set, the specified message is read but not removed from the queue. The <code class="cCode">TPNOTRAN</code> flag must be set. It is not possible to read messages enqueued or dequeued within a transaction before the transaction completes.
</div>
<div class="pDefParaCont"><a name="wp1181776"> </a>
When a thread is non-destructively dequeuing a message using <code class="cCode">TPQPEEK</code>, the message may not be seen by other non-blocking dequeuers for the brief time the system is processing the non-destructive dequeue request. This includes dequeuers using specific selection criteria (such as message identifier and correlation identifier) that are looking for the message currently being non-destructively dequeued.
</div>
<p class="pBody"><a name="wp999620"> </a>
On output from <code class="cCode">TPDEQUEUE()</code>, the following elements may be set in <code class="cCodeEmphasis">TPQUEDEF-REC</code>:
</p>
<a name="wp999621"> </a><div class="pPreformatted"><pre>05 PRIORITY                PIC S9(9) COMP-5. <br />05 MSGID                   PIC X(32). <br />05 CORRID                  PIC X(32). <br />05 TPQUEQOS-DELIVERY-FLAG  PIC S9(9) COMP-5. <br />05 TPQUEQOS-REPLY-FLAG     PIC S9(9) COMP-5. <br />05 REPLYQUEUE              PIC X(127). <br />05 FAILUREQUEUE            PIC X(127). <br />05 DIAGNOSTIC              PIC S9(9) COMP-5. <br />05 CLIENTID OCCURS 4 TIMES PIC S9(9) COMP-5 <br />05 APPL-RETURN-CODE        PIC S9(9) COMP-5. <br />05 APPKEY                  PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp999622"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> controlling output information from <code class="cCode">TPDEQUEUE()</code>. For any of these settings, if the setting is true when <code class="cCode">TPDEQUEUE()</code> is called, the associated element in the record is populated with the value provided when the message was queued, and the setting remains true. If the value is not available (that is, no value was provided when the message was queued) or the setting is not <code class="cCode">true</code> when <code class="cCode">TPDEQUEUE()</code> is called, <code class="cCode">TPDEQUEUE()</code> completes with the setting not <code class="cCode">true</code>.
</p>
<h4 class="pDefTerm"><a name="wp1185542"> </a>
<code class="cCode">TPQPRIORITY</code> 
</h4><div class="pDefPara"><a name="wp1185543"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with an explicit priority, then the priority is stored in <code class="cCode">PRIORITY</code>. The priority is in the range 1 to 100, inclusive, and the higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). If <code class="cCode">TPQNOPRIORITY</code> is set, the priority is not available.
</div>
<div class="pDefParaCont"><a name="wp1210561"> </a>
Note that if no priority was explicitly specified when the message was queued, the priority for the message is 50.
</div>
<h4 class="pDefTerm"><a name="wp1185544"> </a>
<code class="cCode">TPQMSGID</code>
</h4><div class="pDefPara"><a name="wp1185545"> </a>
If this value is set and the call to <code class="cCode">TPDEQUEUE()</code> is successful, the message identifier is stored in <code class="cCode">MSGID</code>. The entire 32 bytes of the message identifier value are significant. If <code class="cCode">TPQNOMSGID</code> is set, the message identifier is not available.
</div>
<h4 class="pDefTerm"><a name="wp1210812"> </a>
<code class="cCode">TPQCORRID</code>
</h4><div class="pDefPara"><a name="wp1219422"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with a correlation identifier, then the correlation identifier is stored in <code class="cCode">CORRID</code>. The entire 32 bytes of the correlation identifier value are significant. Any Oracle Tuxedo /Q provided reply to a message has the correlation identifier of the original message. If <code class="cCode">TPQNOCORRID</code> is set, the correlation identifier is not available.
</div>
<h4 class="pDefTerm"><a name="wp1185548"> </a>
<code class="cCode">TPQDELIVERYQOS</code>
</h4><div class="pDefPara"><a name="wp1185549"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with a delivery quality of service, then the flag&#8212;<code class="cCode">TPQQOSDELIVERYDEFAULTPERSIST</code>, <code class="cCode">TPQQOSDELIVERYPERSISTENT</code>, or <code class="cCode">TPQQOSDELIVERYNONPERSISTENT</code>&#8212;specified by <code class="cCode">TPQUEQOS-DELIVERY-FLAG</code> indicates the delivery quality of service. If <code class="cCode">TPQNODELIVERYQOS</code> is set, the delivery quality of service is not available.
</div>
<div class="pDefParaCont"><a name="wp1214295"> </a>
Note that if no delivery quality of service was explicitly specified when the message was queued, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<h4 class="pDefTerm"><a name="wp1185550"> </a>
<code class="cCode">TPQREPLYQOS</code>
</h4><div class="pDefPara"><a name="wp1211775"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with a reply quality of service, then the flag&#8212;<code class="cCode">TPQQOSREPLYDEFAULTPERSIST</code>, <code class="cCode">TPQQOSREPLYPERSISTENT</code>, or <code class="cCode">TPQQOSREPLYNONPERSISTENT</code>&#8212;specified by <code class="cCode">TPQUEQOS-REPLY-FLAG</code> indicates the reply quality of service. If <code class="cCode">TPQNOREPLYQOS</code> is set, the reply quality of service is not available.
</div>
<div class="pDefParaCont"><a name="wp1214264"> </a>
Note that if no reply quality of service was explicitly specified when the message was queued, the default delivery policy of the <code class="cCode">REPLYQUEUE</code> queue dictates the delivery quality of service for any reply. The default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
</div>
<h4 class="pDefTerm"><a name="wp1185552"> </a>
<code class="cCode">TPQREPLYQ</code> 
</h4><div class="pDefPara"><a name="wp1185553"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with a reply queue, then the name of the reply queue is stored in <code class="cCode">REPLYQUEUE</code>. Any reply to the message should go to the named reply queue within the same queue space as the request message. If <code class="cCode">TPQNOREPLYQ</code> is set, the reply queue is not available.
</div>
<h4 class="pDefTerm"><a name="wp1185554"> </a>
<code class="cCode">TPQFAILUREQ</code> 
</h4><div class="pDefPara"><a name="wp1185555"> </a>
If this value is set, the call to <code class="cCode">TPDEQUEUE()</code> is successful, and the message was queued with a failure queue, then the name of the failure queue is stored in <code class="cCode">FAILUREQUEUE</code>. Any failure message should go to the named failure queue within the same queue space as the request message. If <code class="cCode">TPQNOFAILUREQ</code> is set, the failure queue is not available.
</div>
<p class="pBody"><a name="wp1186104"> </a>
The remaining settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> are set to the following values when <code class="cCode">TPDEQUEUE()</code> is called: <code class="cCode">TPQNOTOP</code>, <code class="cCode">TPQNOBEFOREMSGID</code>, <code class="cCode">TPQNOTIME_ABS</code>, <code class="cCode">TPQNOTIME_REL</code>, <code class="cCode">TPQNOEXPTIME_ABS</code>, <code class="cCode">TPQNOEXPTIME_REL</code>, and <code class="cCode">TPQNOEXPTIME_NONE</code>.
</p>
<p class="pBody"><a name="wp1101095"> </a>
If the call to <code class="cCode">TPDEQUEUE()</code> fails and <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCode">DIAGNOSTIC</code>. The possible values are defined below in the <code class="cCode">DIAGNOSTICS</code> section.
</p>
<p class="pBody"><a name="wp999634"> </a>
Additionally on output, if the call to <code class="cCode">TPDEQUEUE()</code> is successful, <code class="cCode">APPKEY</code> is set to the application authentication key, <code class="cCode">CLIENTID</code> is set to the identifier for the client originating the request, and <code class="cCode">APPL-RETURN-CODE</code> is set to the user-return code value that was set when the message was enqueued.
</p>
<h4 class="pHeading3"><a name="wp999635"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999636"> </a>
Upon successful completion, <code class="cCode">TPDEQUEUE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999637"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999638"> </a>
Under the following conditions, <code class="cCode">TPDEQUEUE()</code> fails and sets <code class="cCode">TP-STATUS</code> to the following values (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists): 
</p>
<h4 class="pDefTerm"><a name="wp999639"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999640"> </a>
Invalid arguments were given (for example, <code class="cCode">QSPACE-NAME</code> is <code class="cCode">SPACES</code> or settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1086615"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1086616"> </a>
Cannot access the <code class="cCode">QSPACE-NAME</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp999643"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp999644"> </a>
Either the <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> of the dequeued message are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set and the <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> do not match the type and subtype of the dequeued message. Neither <code class="cCodeEmphasis">DATA-REC</code> nor <code class="cCodeEmphasis">TPTYPE-REC</code> are changed. When the call is made in transaction mode and this error occurs, the transaction is marked abort-only, and the message remains on the queue.
</div>
<h4 class="pDefTerm"><a name="wp999645"> </a>
[<code class="cCode">TPTRUNCATE</code>] 
</h4><div class="pDefPara"><a name="wp999646"> </a>
The size of the incoming message is larger than the size specified in <code class="cCode">LEN</code>. Only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">DATA-REC</code>, the remaining data is discarded.
</div>
<h4 class="pDefTerm"><a name="wp999647"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1267759"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPDEQUEUE()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1267760"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.) In either case, no changes are made to <code class="cCodeEmphasis">DATA-REC</code> or <code class="cCodeEmphasis">TPTYPE-REC</code>.
<a name="wp1267761"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1267762"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp999649"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp999650"> </a>
A blocking condition exists and <code class="cCode">TPBLOCK</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp999651"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp999652"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp999653"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999654"> </a>
<code class="cCode">TPDEQUEUE()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp999655"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999656"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp999657"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999658"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp999659"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp999660"> </a>
Dequeuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via <code class="cCodeEmphasis">TPQUEDEF-REC</code>.
</div>
<h4 class="pHeading3"><a name="wp999661"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp999662"> </a>
The following diagnostic values are returned during the dequeuing of a message. 
</p>
<h4 class="pDefTerm"><a name="wp999663"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999664"> </a>
An invalid setting was specified.
</div>
<h4 class="pDefTerm"><a name="wp999665"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp999666"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp999667"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp999668"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp999669"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp999670"> </a>
The call was not in transaction mode or was made with <code class="cCode">TPNOTRAN</code> set and an error occurred trying to start a transaction in which to dequeue the message. This diagnostic is not returned by a queue manager from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp999671"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp999672"> </a>
An invalid message identifier was specified for dequeuing.
</div>
<h4 class="pDefTerm"><a name="wp1174664"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1174665"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999677"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp999678"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp999679"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp999680"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp999681"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999682"> </a>
A dequeue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp999683"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp999684"> </a>
An invalid, deleted, or reserved queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp999685"> </a>
[<code class="cCode">QMENOMSG</code>] 
</h4><div class="pDefPara"><a name="wp999686"> </a>
No message was available for dequeuing. Note that it is possible that the message exists on the queue and another application process has read the message from the queue. In this case, the message may be put back on the queue if that other process rolls back the transaction.
</div>
<h4 class="pDefTerm"><a name="wp1174655"> </a>
[<code class="cCode">QMEINUSE</code>]
</h4><div class="pDefPara"><a name="wp1174656"> </a>
When dequeuing a message by message identifier or correlation identifier, the specified message is in use by another transaction. Otherwise all messages currently on the queue are in use by other transactions. This diagnostic is not returned by a queue manager from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp1174669"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1174670"> </a>
When dequeuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp999687"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999688"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>, <a href="rf3cbl.html#wp999853"><code class="cCode">TPENQUEUE(3cbl)</code></a>, <a href="../rf5/rf5.html">TMQUEUE(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999791"> </a>
TPDISCON(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999792"> </a>
Name
</h4>
<p class="pBody"><a name="wp999793"> </a>
<code class="cCode">TPDISCON()</code> - take down a conversational connection
</p>
<h4 class="pHeading3"><a name="wp999794"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp999795"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPDISCON&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp999796"> </a>
Description
</h4>
<p class="pBody"><a name="wp999797"> </a>
<code class="cCode">TPDISCON()</code> immediately tears down the connection specified by <code class="cCode">COMM-HANDLE</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code>, the communications handle, and generates a <code class="cCode">TPEV-DISCONIMM</code> event on the other end of the connection.
</p>
<p class="pBody"><a name="wp999798"> </a>
<code class="cCode">TPDISCON()</code> can only be called by the initiator of the conversation. <code class="cCode">TPDISCON()</code> can not be called within a conversational service on the communications handle with which it was invoked. Rather, a conversational service must use <code class="cCode">TPRETURN()</code> to signify that it has completed its part of the conversation. Similarly, even though a program communicating with a conversational service can issue <code class="cCode">TPDISCON()</code>, the preferred way is to let the service tear down the connection in <code class="cCode">TPRETURN()</code>; doing so ensures correct results. If the initiator of the connection is a server, then <code class="cCode">TPRETURN()</code> can also be used to cause an orderly disconnection. If the initiator of the connection is in a transaction, then <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> can be used to cause an orderly disconnection.
</p>
<p class="pBody"><a name="wp999799"> </a>
<code class="cCode">TPDISCON()</code> causes the connection to be torn down immediately (that is, abortive rather than orderly). Any data that has not yet reached its destination may be lost. <code class="cCode">TPDISCON()</code> can be issued even when the program on the other end of the connection is participating in the caller&#8217;s transaction. In this case, the transaction is aborted. Also, the caller does not need to have control of the connection when <code class="cCode">TPDISCON()</code> is called.
</p>
<h4 class="pHeading3"><a name="wp999800"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999801"> </a>
Upon successful completion, <code class="cCode">TPDISCON()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999802"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999803"> </a>
Under the following conditions, <code class="cCode">TPDISCON()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp999804"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp999805"> </a>
<code class="cCode">COMM-HANDLE</code> is invalid or is the communications handle with which a conversational service was invoked.
</div>
<h4 class="pDefTerm"><a name="wp999806"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1268519"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPDISCON()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1268520"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. (Note that calling <code class="cCode">TPDISCON()</code> on a connection in the caller&#8217;s transaction would have resulted in the transaction being marked abort-only, even if <code class="cCode">TPDISCON()</code> had succeeded.)
<a name="wp1270731"> </a>
If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.) 
<a name="wp1268521"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to perform further conversational work, send new requests, or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp999807"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp999808"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999809"> </a>
<code class="cCode">TPDISCON()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp999810"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999811"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. The communications handle is no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp999812"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999813"> </a>
An operating system error has occurred. The communications handle is no longer valid.
</div>
<h4 class="pHeading3"><a name="wp999814"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999815"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1000927"><code class="cCode">TPRECV(3cbl)</code></a>, <a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001318"><code class="cCode">TPSEND(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp999853"> </a>
TPENQUEUE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp999854"> </a>
Name
</h4>
<p class="pBody"><a name="wp999855"> </a>
<code class="cCode">TPENQUEUE()</code> - routine to enqueue a message
</p>
<h4 class="pHeading3"><a name="wp999856"> </a>
Synopsis
</h4>
<a name="wp999857"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode">.<br /> COPY TPQUEDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPENQUEUE&quot; USING </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">. </code></pre></div><h4 class="pHeading3"><a name="wp999858"> </a>
Description
</h4>
<p class="pBody"><a name="wp1085513"> </a>
<code class="cCode">TPENQUEUE()</code> stores a message on the queue named by <code class="cCode">QNAME</code> in the <code class="cCode">QSPACE-NAME</code> queue space. A queue space is a collection of queues, one of which must be <code class="cCode">QNAME</code>. 
</p>
<p class="pBody"><a name="wp1085076"> </a>
When the message is intended for an Oracle Tuxedo ATMI server, the <code class="cCode">QNAME</code> matches the name of a service provided by the server. The system-provided server, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, provides a default mechanism for dequeuing messages from the queue and forwarding them to servers that provide a service matching the queue name. If the originator expects a reply, then the reply to the forwarded service request is stored on the originator&#8217;s queue unless otherwise specified. The originator will dequeue the reply message at a subsequent time. Queues can also be used for a reliable message transfer mechanism between any pair of Oracle Tuxedo ATMI processes (clients and/or servers). In this case, the queue name does not match a service name but some agreed upon name for transferring the message.
</p>
<p class="pBody"><a name="wp999861"> </a>
The data portion of a message is specified by <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies how much of <code class="cCodeEmphasis">DATA-REC</code> to enqueue. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a message is enqueued with no data portion. The <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, both in <code class="cCodeEmphasis">TPTYPE-REC</code>, must match one of the <code class="cCode">REC-TYPE</code>s and <code class="cCode">SUB-TYPE</code>s recognized by <code class="cCode">QSPACE-NAME</code>.
</p>
<p class="pBody"><a name="wp999862"> </a>
The message is queued at the priority defined for <code class="cCode">QSPACE-NAME</code> unless overridden by a previous call to <code class="cCode">TPSPRIO()</code>.
</p>
<p class="pBody"><a name="wp999863"> </a>
If the caller is within a transaction and <code class="cCode">TPTRAN</code> is set, the message is queued in transaction mode. This has the effect that if <code class="cCode">TPENQUEUE()</code> returns successfully and the caller&#8217;s transaction is committed successfully, then the message is guaranteed to be available subsequent to the transaction completing. If the caller&#8217;s transaction is rolled back either explicitly or as the result of a transaction timeout or some communication error, then the message will be removed from the queue (that is, the placing of the message on the queue is also rolled back). It is not possible to enqueue then dequeue the same message within the same transaction.
</p>
<p class="pBody"><a name="wp999864"> </a>
The message is not queued in transaction mode if either the caller is not in transaction mode, or <code class="cCode">TPNOTRAN</code> is set. Once <code class="cCode">TPENQUEUE()</code> returns successfully, the submitted message is guaranteed to be in the queue. When not in transaction mode, if a communication error or a timeout occurs, the application will not know whether or not the message was successfully stored on the queue.
</p>
<p class="pBody"><a name="wp999865"> </a>
The order in which messages are placed on the queue is controlled by the application via <code class="cCodeEmphasis">TPQUEDEF-REC</code> as described below; the default queue ordering is set when the queue is created.
</p>
<p class="pBody"><a name="wp999866"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp999867"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp999868"> </a>
If the caller is in transaction mode and this setting is used, the message is not enqueued within the caller&#8217;s transaction. A caller in transaction mode that sets this to <code class="cCode">true</code> is still subject to the transaction timeout (and no other). If message enqueuing fails that was invoked with this setting, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999869"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp999870"> </a>
If the caller is in transaction mode and this setting is used, the message is enqueued within the same transaction as the caller. The setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999871"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1174700"> </a>
The message is not enqueued if a blocking condition exists. If <code class="cCode">TPNOBLOCK</code> is set and a blocking condition exists such as the internal buffers into which the message is transferred are full, the call fails and <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPEBLOCK</code>. If <code class="cCode">TPNOBLOCK</code> is set and a blocking condition exists because the target queue is opened <em class="cEmphasis">exclusively</em> by another application, the call fails, <code class="cCode">TP-STATUS </code>is set to <code class="cCode">TPEDIAGNOSTIC</code>, and the <code class="cCode">DIAGNOSTIC</code> field of the <code class="cCode">TPQUEDEF</code> record is set to <code class="cCode">QMESHARE</code>. In the latter case, the other application, which is based on an Oracle product other than the Oracle Tuxedo system, opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999873"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp999874"> </a>
When <code class="cCode">TPBLOCK</code> is set and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999875"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp999876"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999877"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp999878"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999879"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999880"> </a>
If a signal interrupts any underlying system calls, the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999881"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp999882"> </a>
If a signal interrupts any underlying system calls, the interrupted system call is not restarted and the routine fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<p class="pBody"><a name="wp999883"> </a>
Additional information about queuing the message can be specified via <code class="cCodeEmphasis">TPQUEDEF-REC</code>. This information includes values to override the default queue ordering placing the message at the top of the queue or before an enqueued message; an absolute or relative time after which a queued message is made available; an absolute or relative time when a message expires and is removed from the queue; the quality of service for delivering the message; the quality of service that any replies to the message should use; a correlation identifier that aids in correlating a reply or failure message with the queued message; the name of a queue to which a reply should be enqueued; and the name of a queue to which any failure message should be enqueued.
</p>
<h4 class="pHeading3"><a name="wp999884"> </a>
Control Parameter
</h4>
<p class="pBody"><a name="wp999885"> </a>
<code class="cCodeEmphasis">TPQUEDEF-REC</code> is used by the application program to pass and retrieve information associated with enqueuing the message. Settings are used to indicate what elements in the record are valid.
</p>
<p class="pBody"><a name="wp1131554"> </a>
On input to <code class="cCode">TPENQUEUE()</code>, the following elements may be set in <code class="cCodeEmphasis">TPQUEDEF-REC</code>: 
</p>
<a name="wp1131555"> </a><div class="pPreformatted"><pre>05 DEQ-TIME                 PIC S9(9) COMP-5. <br />05 PRIORITY                 PIC S9(9) COMP-5. <br />05 MSGID                    PIC X(32). <br />05 CORRID                   PIC X(32). <br />05 TPQUEQOS-DELIVERY-FLAG   PIC S9(9) COMP-5. <br />05 TPQUEQOS-REPLY-FLAG      PIC S9(9) COMP-5. <br />05 EXP-TIME                 PIC S9(9) COMP-5.<br />05 REPLYQUEUE               PIC X(127). <br />05 FAILUREQUEUE             PIC X(127). <br />05 APPL-RETURN-CODE         PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp999888"> </a>
The following values indicate what values are set in the <code class="cCodeEmphasis">TPQUEDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp999889"> </a>
<code class="cCode">TPQTOP</code>
</h4><div class="pDefPara"><a name="wp1219758"> </a>
Setting this value indicates that the queue ordering be overridden and the message placed at the top of the queue. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. Set <code class="cCode">TPQDEFAULT</code> to use default queue ordering. <code class="cCode">TPQTOP</code>, <code class="cCode">TPQBEFOREMSGID</code>, or <code class="cCode">TPQDEFAULT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1219760"> </a>
<code class="cCode">TPQBEFOREMSGID</code>
</h4><div class="pDefPara"><a name="wp999892"> </a>
Setting this value indicates that the queue ordering be overridden and the message placed in the queue before the message identified by <code class="cCode">MSGID</code>. This request may not be granted depending on whether or not the queue was configured to allow overriding the queue ordering. Set <code class="cCode">TPQDEFAULT</code> to use default queue ordering. <code class="cCode">TPQTOP</code>, <code class="cCode">TPQBEFOREMSGID</code>, or <code class="cCode">TPQDEFAULT</code> must be set.
</div>
<div class="pDefParaCont"><a name="wp1219775"> </a>
Note that the entire 32 bytes of the message identifier value are significant, so the value identified by <code class="cCode">MSGID</code> must be completely initialized (for example, padded with spaces).
</div>
<h4 class="pDefTerm"><a name="wp1088896"> </a>
<code class="cCode">TPQTIME-ABS</code> 
</h4><div class="pDefPara"><a name="wp1088897"> </a>
If this value is set, the message is made available after the time specified by <code class="cCode">DEQ-TIME</code>. <code class="cCode">DEQ-TIME</code> is an absolute time value as generated by <code class="cCode">time</code>(2) or <code class="cCode">mktime</code>(3C) (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970). Set <code class="cCode">TPQNOTIME</code> if neither an absolute nor relative time value is set. <code class="cCode">TPQTIME-ABS</code>, <code class="cCode">TPQTIME-REL</code>, or <code class="cCode">TPQNOTIME</code> must be set. The absolute time is determined by the clock on the machine where the queue manager process resides.
</div>
<h4 class="pDefTerm"><a name="wp1088898"> </a>
<code class="cCode">TPQTIME-REL</code> 
</h4><div class="pDefPara"><a name="wp1088899"> </a>
If this value is set, the message is made available after a time relative to the completion of the enqueuing operation. <code class="cCode">DEQ-TIME</code> specifies the number of seconds to delay after the enqueuing completes before the submitted message should be available. Set <code class="cCode">TPQNOTIME</code> if neither an absolute nor relative time value is set. <code class="cCode">TPQTIME-ABS</code>, <code class="cCode">TPQTIME-REL</code>, or <code class="cCode">TPQNOTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp999897"> </a>
<code class="cCode">TPQPRIORITY</code> 
</h4><div class="pDefPara"><a name="wp1165947"> </a>
If this value is set, the priority at which the message should be enqueued is stored in <code class="cCode">PRIORITY</code>. The priority must be in the range 1 to 100, inclusive. The higher the number, the higher the priority (that is, a message with a higher number is dequeued before a message with a lower number). For queues not ordered by priority, this value is informational. If <code class="cCode">TPQNOPRIORITY</code> is set, the priority for the message is 50 by default.
</div>
<h4 class="pDefTerm"><a name="wp1165948"> </a>
<code class="cCode">TPQCORRID</code> 
</h4><div class="pDefPara"><a name="wp1185344"> </a>
If this value is set, the correlation identifier value specified in <code class="cCode">CORRID</code> is available when a message is dequeued with <code class="cCode">TPDEQUEUE()</code>. This identifier accompanies any reply or failure message that is queued so that an application can correlate a reply with a particular request. Set <code class="cCode">TPQNOCORRID</code> if a correlation identifier is not available.
</div>
<div class="pDefParaCont"><a name="wp1219816"> </a>
Note that the entire 32 bytes of the correlation identifier value are significant, so the value specified in <code class="cCode">CORRID</code> must be completely initialized (for example, padded with spaces).
</div>
<h4 class="pDefTerm"><a name="wp999901"> </a>
<code class="cCode">TPQREPLYQ</code> 
</h4><div class="pDefPara"><a name="wp999902"> </a>
If this value is set, a reply queue named in <code class="cCode">REPLYQUEUE</code> is associated with the queued message. Any reply to the message is queued to the named queue within the same queue space as the request message. Set <code class="cCode">TPQNOREPLYQ</code> if a reply queue name is not available.
</div>
<h4 class="pDefTerm"><a name="wp999903"> </a>
<code class="cCode">TPQFAILUREQ</code> 
</h4><div class="pDefPara"><a name="wp1185351"> </a>
If this value is set, a failure queue named in <code class="cCode">FAILUREQUEUE</code> is associated with the queued message. If (1) the enqueued message is processed by <code class="cCode">TMQFORWARD()</code>, (2) <code class="cCode">TMQFORWARD</code> was started with the <code class="cCode">-d</code> option, and (3) the service fails and returns a non-NULL reply, a failure message consisting of the reply and its associated <code class="cCode">APPL-RETURN-CODE</code> in the <code class="cCode">TPSTATUS</code> record is enqueued to the named queue within the same queue space as the original request message. Set <code class="cCode">TPQNOFAILUREQ</code> if a failure queue name is not available.
</div>
<h4 class="pDefTerm"><a name="wp1091757"> </a>
<code class="cCode">TPQDELIVERYQOS<br />TPQREPLYQOS</code> 
</h4><div class="pDefPara"><a name="wp1091758"> </a>
If <code class="cCode">TPQDELIVERYQOS</code> is set, the flags specified by <code class="cCode">TPQUEQOS-DELIVERY-FLAG</code> control the quality of service for message delivery. One of the following mutually exclusive flags must be set: <code class="cCode">TPQQOSDELIVERYDEFAULTPERSIST</code>, <code class="cCode">TPQQOSDELIVERYPERSISTENT</code>, or <code class="cCode">TPQQOSDELIVERYNONPERSISTENT</code>. If <code class="cCode">TPQDELIVERYQOS</code> is not set, <code class="cCode">TPQNODELIVERYQOS</code> must be set. When <code class="cCode">TPQNODELIVERYQOS</code> is set, the default delivery policy of the target queue dictates the delivery quality of service for the message.
</div>
<div class="pDefParaCont"><a name="wp1091759"> </a>
If <code class="cCode">TPQREPLYQOS</code> is set, the flags specified by <code class="cCode">TPQUEQOS-REPLY-FLAG</code> control the quality of service for reply message delivery for any reply. One of the following mutually exclusive flags must be set: <code class="cCode">TPQQOSREPLYDEFAULTPERSIST</code>, <code class="cCode">TPQQOSREPLYPERSISTENT</code>, or <code class="cCode">TPQQOSREPLYNONPERSISTENT</code>. The <code class="cCode">TPQREPLYQOS</code> flag is used when a reply is returned from messages processed by <code class="cCode">TMQFORWARD</code>. Applications not using <code class="cCode">TMQFORWARD</code> to invoke services may use the <code class="cCode">TPQREPLYQOS</code> flag as a hint for their own reply mechanism.
<a name="wp1166791"> </a>
If <code class="cCode">TPQREPLYQOS</code> is not set, <code class="cCode">TPQNOREPLYQOS</code> must be set. When <code class="cCode">TPQNOREPLYQOS</code> is set, the default delivery policy of the <code class="cCode">REPLYQUEUE</code> queue dictates the delivery quality of service for any reply. Note that the default delivery policy is determined when the reply to a message is enqueued. That is, if the default delivery policy of the reply queue is modified between the time that the original message is enqueued and the reply to the message is enqueued, the policy used is the one in effect when the reply is finally enqueued.
<a name="wp1091760"> </a>
The valid <code class="cCode">TPQUEQOS-DELIVERY-FLAG</code> and <code class="cCode">TPQUEQOS-REPLY-FLAG</code> flags are:
</div>
<div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1091761"> </a>
<code class="cCode">TPQQOSDELIVERYDEFAULTPERSIST<br />TPQQOSREPLYDEFAULTPERSIST</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1091762"> </a>
These flags specify that the message is to be delivered using the default delivery policy specified on the target or reply queue.
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1091763"> </a>
<code class="cCode">TPQQOSDELIVERYPERSISTENT<br />TPQQOSREPLYPERSISTENT</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1091764"> </a>
These flags specify that the message is to be delivered in a persistent manner using the disk-based delivery method. When specified, these flags override the default delivery policy specified on the target or reply queue. 
</div><div class="pDefTerm2"><h4 class="pDefTerm2"><a name="wp1091765"> </a>
<code class="cCode">TPQQOSDELIVERYNONPERSISTENT<br />TPQQOSREPLYNONPERSISTENT</code> 
</h4></div>
<div class="pDefPara2"><a name="wp1091766"> </a>
These flags specify that the message is to be delivered in a non-persistent manner using the memory-based delivery method; the message is queued in memory until it is dequeued. When specified, these flags override the default delivery policy specified on the target or reply queue.
</div><div class="pDefPara2"><a name="wp1091768"> </a>
If the caller is transactional, non-persistent messages are enqueued within the caller&#8217;s transaction, however, non-persistent messages are lost if the system is shut down or crashes or the IPC shared memory for the queue space is removed.
</div><h4 class="pDefTerm"><a name="wp1091771"> </a>
<code class="cCode">TPQEXPTIME-ABS</code> 
</h4><div class="pDefPara"><a name="wp1185901"> </a>
If this value is set, the message has an absolute expiration time, which is the absolute time when the message will be removed from the queue.
<a name="wp1185899"> </a>
The absolute expiration time is determined by the clock on the machine where the queue manager process resides.
</div>
<div class="pDefParaCont"><a name="wp1185905"> </a>
The absolute expiration time is specified by the value stored in <code class="cCode">EXP-TIME</code>. <code class="cCode">EXP-TIME</code> must be set to an absolute time generated by <code class="cCode">time</code>(2) or <code class="cCode">mktime</code>(3C) (the number of seconds since 00:00:00 Universal Coordinated Time&#8212;UTC, January 1, 1970).
<a name="wp1185909"> </a>
If an absolute time is specified that is earlier than the time of the enqueue operation, the operation succeeds, but the message is not counted for the purpose of calculating thresholds. If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. If a message expires during a transaction, the expiration does not cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no acknowledgment that the message has expired.
<a name="wp1185943"> </a>
One of the following must be set: <code class="cCode">TPQEXPTIME-ABS</code>, <code class="cCode">TPQEXPTIME-REL</code>, <code class="cCode">TPQEXPTIME-NONE</code>, or <code class="cCode">TPQNOEXPTIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1091775"> </a>
<code class="cCode">TPQEXPTIME-REL</code> 
</h4><div class="pDefPara"><a name="wp1185968"> </a>
If this value is set, the message has a relative expiration time, which is the number of seconds <em class="cEmphasis">after</em> the message arrives at the queue that the message is removed from the queue. The relative expiration time is specified by the value stored in <code class="cCode">EXP-TIME</code>.
</div>
<div class="pDefParaCont"><a name="wp1185976"> </a>
If the expiration time is before the message availability time, the message is not available for dequeuing unless either the availability or expiration time is changed so that the availability time is before the expiration time. In addition, these messages are removed from the queue at expiration time even if they were never available for dequeuing. The expiration of a message during a transaction does cause the transaction to fail. Messages that expire while being enqueued or dequeued within a transaction are removed from the queue when the transaction ends. There is no acknowledgment that the message has expired.
<a name="wp1185979"> </a>
One of the following must be set: <code class="cCode">TPQEXPTIME-ABS</code>, <code class="cCode">TPQEXPTIME-REL</code>, <code class="cCode">TPQEXPTIME-NONE</code>, or <code class="cCode">TPQNOEXPTIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1091779"> </a>
<code class="cCode">TPQEXPTIME-NONE</code> 
</h4><div class="pDefPara"><a name="wp1091780"> </a>
Setting this value indicates that the message should not expire. This flag overrides any default expiration policy associated with the target queue. You can remove a message by dequeuing it or by deleting it via an administrative interface. One of the following must be set: <code class="cCode">TPQEXPTIME-ABS</code>, <code class="cCode">TPQEXPTIME-REL</code>, <code class="cCode">TPQEXPTIME-NONE</code>, or <code class="cCode">TPQNOEXPTIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1091781"> </a>
<code class="cCode">TPQNOEXPTIME</code> 
</h4><div class="pDefPara"><a name="wp1091782"> </a>
Setting this value specifies that the default expiration time associated with the target queue applies to the message. One of the following must be set: <code class="cCode">TPQEXPTIME-ABS</code>, <code class="cCode">TPQEXPTIME-REL</code>, <code class="cCode">TPQEXPTIME-NONE</code>, or <code class="cCode">TPQNOEXPTIME</code>.
</div>
<p class="pBody"><a name="wp999905"> </a>
Additionally, <code class="cCode">APPL-RETURN-CODE</code> can be set with a user-return code. This value is returned to the application that dequeues the message.
</p>
<p class="pBody"><a name="wp999906"> </a>
On output from <code class="cCode">TPENQUEUE()</code>, the following elements may be set in <code class="cCodeEmphasis">TPQUEDEF-REC</code>: 
</p>
<a name="wp999907"> </a><div class="pPreformatted"><pre>05 MSGID      PIC X(32). <br />05 DIAGNOSTIC PIC S9(9) COMP-5.</pre></div><p class="pBody"><a name="wp999908"> </a>
The following is a valid setting in <code class="cCodeEmphasis">TPQUEDEF-REC</code> controlling output information from <code class="cCode">TPENQUEUE()</code>. If this setting is <code class="cCode">true</code> when <code class="cCode">TPENQUEUE()</code> is called, the /Q server <a href="../rf5/rf5.html">TMQUEUE(5)</a> populates the associated element in the record with a message identifier. If this setting is not <code class="cCode">true</code> when <code class="cCode">TPENQUEUE()</code> is called, <code class="cCode">TMQUEUE()</code> does <em class="cEmphasis">not</em> populate the associated element in the record with a message identifier.
</p>
<h4 class="pDefTerm"><a name="wp999909"> </a>
<code class="cCode">TPQMSGID</code> 
</h4><div class="pDefPara"><a name="wp999910"> </a>
If this value is set and the call to <code class="cCode">TPENQUEUE()</code> is successful, the message identifier is stored in <code class="cCode">MSGID</code>. The entire 32 bytes of the message identifier value are significant, so the value stored in <code class="cCode">MSGID</code> is completely initialized (for example, padded with NULL characters). The actual padding character used for initialization varies between releases of the Oracle Tuxedo /Q component. If <code class="cCode">TPQNOMSGID</code> is set, the message identifier is not available.
</div>
<p class="pBody"><a name="wp1214714"> </a>
The remaining members of the control structure are not used on input to <code class="cCode">TPENQUEUE()</code>.
</p>
<p class="pBody"><a name="wp999911"> </a>
If the call to <code class="cCode">TPENQUEUE()</code> failed and <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPEDIAGNOSTIC</code>, a value indicating the reason for failure is returned in <code class="cCode">DIAGNOSTIC</code>. The possible values are defined below in the <code class="cCode">DIAGNOSTICS</code> section.
</p>
<h4 class="pHeading3"><a name="wp999912"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp999913"> </a>
Upon successful completion, <code class="cCode">TPENQUEUE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp999914"> </a>
Errors
</h4>
<p class="pBody"><a name="wp999915"> </a>
Under the following conditions, <code class="cCode">TPENQUEUE()</code> fails and sets <code class="cCode">TP-STATUS</code> to the following values (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists). 
</p>
<h4 class="pDefTerm"><a name="wp999916"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999917"> </a>
Invalid arguments were given (for example, <code class="cCode">QSPACE-NAME</code> is <code class="cCode">SPACES</code> or settings in <code class="cCodeEmphasis">TPQUEDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp999918"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp999919"> </a>
Cannot access the <code class="cCode">QSPACE-NAME</code> because it is not available (that is, the associated <a href="../rf5/rf5.html">TMQUEUE(5)</a> server is not available), or cannot start a global transaction due to the lack of entries in the Global Transaction Table (GTT).
</div>
<h4 class="pDefTerm"><a name="wp999920"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1270757"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPENQUEUE()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1270758"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1270759"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1270760"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp999922"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp999923"> </a>
A blocking condition exists and <code class="cCode">TPBLOCK</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp999924"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp999925"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp999926"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999927"> </a>
<code class="cCode">TPENQUEUE()</code> was called improperly. There is no effect on the queue or the transaction.
</div>
<h4 class="pDefTerm"><a name="wp999928"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999929"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp999930"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp999931"> </a>
An operating system error has occurred. There is no effect on the queue.
</div>
<h4 class="pDefTerm"><a name="wp999932"> </a>
[<code class="cCode">TPEDIAGNOSTIC</code>] 
</h4><div class="pDefPara"><a name="wp999933"> </a>
Enqueuing a message from the specified queue failed. The reason for failure can be determined by the diagnostic value returned via <code class="cCodeEmphasis">TPQUEDEF-REC</code>.
</div>
<h4 class="pHeading3"><a name="wp999934"> </a>
Diagnostic Values
</h4>
<p class="pBody"><a name="wp999935"> </a>
The following diagnostic values are returned during the enqueuing of a message. 
</p>
<h4 class="pDefTerm"><a name="wp999936"> </a>
[<code class="cCode">QMEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp999937"> </a>
An invalid setting was specified.
</div>
<h4 class="pDefTerm"><a name="wp999938"> </a>
[<code class="cCode">QMEBADRMID</code>] 
</h4><div class="pDefPara"><a name="wp999939"> </a>
An invalid resource manager identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp999940"> </a>
[<code class="cCode">QMENOTOPEN</code>] 
</h4><div class="pDefPara"><a name="wp999941"> </a>
The resource manager is not currently open.
</div>
<h4 class="pDefTerm"><a name="wp999942"> </a>
[<code class="cCode">QMETRAN</code>] 
</h4><div class="pDefPara"><a name="wp999943"> </a>
The call was not in transaction mode or was made with the <code class="cCode">TPNOTRAN</code> setting and an error occurred trying to start a transaction in which to enqueue the message. This diagnostic is not returned by a queue manager from Oracle Tuxedo release 7.1 or later.
</div>
<h4 class="pDefTerm"><a name="wp999944"> </a>
[<code class="cCode">QMEBADMSGID</code>] 
</h4><div class="pDefPara"><a name="wp999945"> </a>
An invalid message identifier was specified.
</div>
<h4 class="pDefTerm"><a name="wp999946"> </a>
[<code class="cCode">QMESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp999947"> </a>
A system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp999948"> </a>
[<code class="cCode">QMEOS</code>] 
</h4><div class="pDefPara"><a name="wp999949"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp999950"> </a>
[<code class="cCode">QMEABORTED</code>] 
</h4><div class="pDefPara"><a name="wp999951"> </a>
The operation was aborted. When executed within a global transaction, the global transaction has been marked rollback-only. Otherwise, the queue manager aborted the operation.
</div>
<h4 class="pDefTerm"><a name="wp999952"> </a>
[<code class="cCode">QMEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp999953"> </a>
An enqueue was done when the transaction state was not active.
</div>
<h4 class="pDefTerm"><a name="wp999954"> </a>
[<code class="cCode">QMEBADQUEUE</code>] 
</h4><div class="pDefPara"><a name="wp1181719"> </a>
An invalid, deleted, or reserved queue name was specified.
</div>
<h4 class="pDefTerm"><a name="wp1166358"> </a>
[<code class="cCode">QMENOSPACE</code>] 
</h4><div class="pDefPara"><a name="wp1166550"> </a>
Due to an insufficient resource, such as no space on the queue, the message with its required quality of service (persistent or non-persistent storage) was not enqueued. <code class="cCode">QMENOSPACE</code> is returned when any of the following configured resources is exceeded: (1) the amount of disk (persistent) space allotted to the queue space, (2) the amount of memory (non-persistent) space allotted to the queue space, (3) the maximum number of simultaneously active transactions allowed for the queue space, (4) the maximum number of messages that the queue space can contain at any one time, (5) the maximum number of concurrent actions that the Queuing Services component can handle, or (6) the maximum number of authenticated users that may concurrently use the Queuing Services component.
</div>
<h4 class="pDefTerm"><a name="wp1181731"> </a>
[<code class="cCode">QMERELEASE</code>] 
</h4><div class="pDefPara"><a name="wp1181732"> </a>
An attempt was made to enqueue a message to a queue manager that is from a version of the Oracle Tuxedo system that does not support a newer feature.
</div>
<h4 class="pDefTerm"><a name="wp1175534"> </a>
[<code class="cCode">QMESHARE</code>] 
</h4><div class="pDefPara"><a name="wp1175535"> </a>
When enqueuing a message from a specified queue, the specified queue is opened <em class="cEmphasis">exclusively</em> by another application. The other application is one based on an Oracle product other than the Oracle Tuxedo system that opened the queue for exclusive read and/or write using the Queuing Services API (QSAPI).
</div>
<h4 class="pHeading3"><a name="wp999958"> </a>
See Also
</h4>
<p class="pBody"><a name="wp999959"> </a>
<a href="../rfcm/rfcmd.html">qmadmin(1)</a>, <a href="rf3cbl.html#wp999573"><code class="cCode">TPDEQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp1001527"><code class="cCode">TPSPRIO(3cbl)</code></a>, <a href="../rf5/rf5.html">TMQFORWARD(5)</a>, <a href="../rf5/rf5.html">TMQUEUE(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000056"> </a>
TPFORWAR(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000057"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000058"> </a>
<code class="cCode">TPFORWAR()</code> - forward an Oracle Tuxedo ATMI service request to another routine
</p>
<h4 class="pHeading3"><a name="wp1000059"> </a>
Synopsis
</h4>
<a name="wp1000060"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS.<br /> <br />COPY TPFORWAR REPLACING TPSVCDEF-REC BY </code><code class="cCodeEmphasis">TPSVCDEF-REC<br /></code><code class="cCode"> TPTYPE-REC BY </code><code class="cCodeEmphasis">TPTYPE-REC<br /></code><code class="cCode"> DATA-REC BY </code><code class="cCodeEmphasis">DATA-REC<br /></code><code class="cCode"> TPSTATUS-REC BY </code><code class="cCodeEmphasis">TPSTAUS-REC</code><code class="cCode"> </code></pre></div><h4 class="pHeading3"><a name="wp1000061"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000062"> </a>
<code class="cCode">TPFORWAR()</code> allows a service routine to forward a client&#8217;s request to another service routine for further processing. Since <code class="cCode">TPFORWAR()</code> contains an <code class="cCode">EXIT PROGRAM</code> statement, it should be called from within the same routine that was invoked to ensure correct return of control to the Oracle Tuxedo ATMI dispatcher (that is, <code class="cCode">TPFORWAR()</code> should not be invoked in a sub-program of the service routine since control would not return to the Oracle Tuxedo ATMI dispatcher). <code class="cCode">TPFORWAR()</code> cannot be called from within a conversational service.
</p>
<p class="pBody"><a name="wp1000063"> </a>
This routine forwards a request to the service named by <code class="cCode">SERVICE-NAME</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code> using data contained in <code class="cCodeEmphasis">DATA-REC</code>. A service routine forwarding a request receives no reply. After the request is forwarded, the service routine returns to the Oracle Tuxedo ATMI dispatcher and the server is free to do other work. Note that because no reply is expected from a forwarded request, the request may be forwarded without error to any service routine in the same executable as the service which forwarded the request.
</p>
<p class="pBody"><a name="wp1000064"> </a>
If the service routine is in transaction mode, this routine puts the caller&#8217;s portion of the transaction in a state where it may be completed when the originator of the transaction issues either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. If a transaction was explicitly started with <code class="cCode">TPBEGIN()</code> while in a service routine, the transaction must be ended with either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> before calling <code class="cCode">TPFORWAR()</code>. Thus, all services in a &#8220;forward chain&#8221; are either all started in transaction mode or none are started in transaction mode.
</p>
<p class="pBody"><a name="wp1000068"> </a>
The last server in a forward chain sends a reply back to the originator of the request using <code class="cCode">TPRETURN()</code>. In essence, <code class="cCode">TPFORWAR()</code> transfers to another server the responsibility of sending a reply back to the awaiting requester.
</p>
<p class="pBody"><a name="wp1000069"> </a>
<code class="cCode">TPFORWAR()</code> should be called after receiving all replies expected from service requests initiated by the service routine. Any outstanding replies which are not received will automatically be dropped by the Oracle Tuxedo ATMI dispatcher upon receipt. In addition, the communications handle for those replies become invalid and the request is not forwarded to <code class="cCode">SERVICE-NAME</code>.
</p>
<p class="pBody"><a name="wp1000070"> </a>
<code class="cCodeEmphasis">DATA-REC</code> is the record to be sent and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies the amount of data in <code class="cCodeEmphasis">DATA-REC</code> that should be sent. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a request with zero length data is sent. If <code class="cCode">REC-TYPE</code> is <code class="cCode">STRING</code> and <code class="cCode">LEN</code> is <code class="cCode">0</code>, then the request is sent with no data portion.
</p>
<p class="pBody"><a name="wp1000071"> </a>
Since the service routine writer does not regain control after calling <code class="cCode">TPFORWAR()</code>, a blocking send with signal restart is used (that is, <code class="cCode">TPSIGRSTRT</code> is implied). Currently, settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are reserved for future use and any specified are ignored.
</p>
<h4 class="pHeading3"><a name="wp1000072"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000073"> </a>
A service routine does not return any value to its caller, the Oracle Tuxedo ATMI dispatcher. Thus, <code class="cCode">TP-STATUS</code> is not set.
</p>
<h4 class="pHeading3"><a name="wp1000074"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000075"> </a>
If any errors occur either in the handling of the parameters passed to the routine or in its processing, a &#8220;failed&#8221; message is sent back to the original requester (unless no reply is to be sent). The existence of outstanding replies or subordinate connections, or the caller&#8217;s transaction being marked abort-only, qualify as failures which generate failed messages. Failed messages are detected by the requester with the <code class="cCode">TPESVCERR()</code> error indication. When such an error occurs, the caller&#8217;s data is not sent. Also, this error causes the caller&#8217;s current transaction to be marked abort-only.
</p>
<p class="pBody"><a name="wp1000076"> </a>
If a transaction timeout occurs, either during the service routine or while the request is being forwarded, the requester waiting for a reply with either <code class="cCode">TPCALL()</code> or <code class="cCode">TPGETRPLY()</code> will get a <code class="cCode">TPETIME</code> error return. When a service fails inside a transaction, the transaction times out and is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. All further ATMI calls for that transaction will fail with <code class="cCode">TPETIME</code>. The waiting requester will not receive any data. Service routines, however, are expected to terminate using either <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code>. A conversational service routine must use <code class="cCode">TPRETURN()</code>; it cannot use <code class="cCode">TPFORWAR()</code>.
</p>
<p class="pBody"><a name="wp1000077"> </a>
If a service routine returns without using either <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code> or <code class="cCode">TPFORWAR()</code> is called from a conversational server, the server will print a warning message in a log file and return a service error to the original requester. All open connections to subordinates will be disconnected immediately, and any outstanding asynchronous replies will be marked stale. If the server was in transaction mode at the time of failure, the transaction is marked abort-only. Note also that if either <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code> are used outside of a service routine (for example, in clients, or in <code class="cCode">TPSVRINIT()</code> or <code class="cCode">TPSVRDONE()</code>), then these routines simply return having no effect.
</p>
<h4 class="pHeading3"><a name="wp1000078"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000079"> </a>
<a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1301314"> </a>
TPGBLKTIME(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1301315"> </a>
Name
</h4>
<p class="pBody"><a name="wp1301316"> </a>
<code class="cCode">TPGBLKTIME()</code> - retrieves the blocktime value previously set by <code class="cCode">TPSBLKTIME</code>
</p>
<h4 class="pHeading3"><a name="wp1301317"> </a>
Synopsis
</h4>
<a name="wp1301318"> </a><div class="pPreformatted"><pre>01 TPBLKDEF-REC.<br />	COPY TPBLKDEF.<br />01 TPSTATUS-REC.<br />	COPY TPSTATUS.<br /><br />CALL &#8220;TPGBLKTIME&#8221; USING TPBLKDEF-REC TPSTATUS-REC.</pre></div><h4 class="pHeading3"><a name="wp1301338"> </a>
Description
</h4>
<p class="pBody"><a name="wp1301339"> </a>
<code class="cCode">TPGBLKTIME()</code> retrieves a previously set, per second, blocktime value and places this value in <code class="cCode">BLKTIME</code> in <code class="cCode">TBLKDEF-REC</code>. If <code class="cCode">TPGBLKTIME()</code> specifies a blocktime flag value, and no such flag value has been set, the return value is <code class="cCode">0</code>. A blocktime flag value less than <code class="cCode">0</code> produces an error.
</p>
<p class="pBody"><a name="wp1301340"> </a>
The following is a list of valid <code class="cCode">TPBLKDEF-REC</code> <code class="cCodeEmphasis">flag</code> values:
</p>
<p class="pBody"><a name="wp1301341"> </a>
<code class="cCode">TPBLK-NEXT</code>
</p>
<div class="pDefPara"><a name="wp1301342"> </a>
This value retrieves the per second<span style="font-weight: bold"> </span>blocktime value for the previously set <code class="cCode">TPSBLKTIME() </code>using a <code class="cCode">TBLKNEXT</code> value.
</div>
<h4 class="pDefTerm"><a name="wp1301343"> </a>
<code class="cCode">TPBLK-ALL</code>
</h4><div class="pDefPara"><a name="wp1301344"> </a>
This value retrieves the per second<span style="font-weight: bold"> </span>blocktime value for the previously set <code class="cCode">TPSBLKTIME() </code>using a <code class="cCode">TBLKALL</code> value.
</div>
<p class="pBody"><a name="wp1301345"> </a>
If <code class="cCode">TPGBLKTIME()</code> does not specify a <code class="cCode">TPBLK-NEXT</code> or <code class="cCode">TPBLK-ALL</code> blocktime flag value, it returns the applicable blocktime value for the next blocking API set due to a previous <code class="cCode">TPSBLKTIME()</code> call with the <code class="cCode">TPBLK-NEXT</code> or <code class="cCode">TPBLK-ALL</code> flag blocktime value, or a system-wide default blocktime value.
</p>
<a name="wp1301346"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>When a workstation client calls <code class="cCode">TPGBLKTIME()</code> without a <code class="cCode">TPBLK-NEXT</code> or <code class="cCode">TPBLK-ALL</code> blocktime flag value, the system-wide default blocktime value cannot be returned. A <code class="cCode">0</code> value is returned instead.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1301347"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1301348"> </a>
Upon successful completion, <code class="cCode">TPGBLKTIME()</code> sets <code class="cCode">TP-STATUS</code> to <code class="cCode">[TPOK]</code> and returns the previously set blocktime, if any, in <code class="cCode">BLKTIME</code> in <code class="cCode">TBLKDEF-REC</code>. A <code class="cCode">BLKTIME</code> 0 value indicates that there are no previously set input blocktime values.
</p>
<h4 class="pHeading3"><a name="wp1301349"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1301350"> </a>
Under the following conditions, <code class="cCode">TPGBLKTIME</code> fails and sets <code class="cCode">TP-STATUS</code> to one of the following values. The failure does not affect transaction timeout values 
</p>
<h4 class="pDefTerm"><a name="wp1301351"> </a>
	[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1301352"> </a>
Invalid arguments were given. For example, a value other than <code class="cCode">TPBLK-NEXT</code> or <code class="cCode">TPBLK-ALL</code> was specified in <code class="cCode">TPBLKDEF-REC</code>.
</div>
<h4 class="pDefTerm"><a name="wp1301353"> </a>
	[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1301354"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. 
</div>
<h4 class="pHeading3"><a name="wp1301855"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1301871"> </a>
<a href="rf3cbl.html#wp998931">TPCALL(3cbl)</a>, <a href="rf3cbl.html#wp999450">TPCONNECT(3cbl)</a>, <a href="rf3cbl.html#wp1000927">TPRECV(3cbl)</a>, <a href="rf3cbl.html#wp1344910">TPSBLKTIME(3cbl)</a>, UBBCONFIG<a href="../rf5/rf5.html"></a>(5)
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1045063"> </a>
TPGETCTXT(3cbl) 
</h3>
<h4 class="pHeading3"><a name="wp1045064"> </a>
Name
</h4>
<p class="pBody"><a name="wp1045065"> </a>
<code class="cCode">TPGETCTXT()</code> - retrieves a context identifier for the current application association
</p>
<h4 class="pHeading3"><a name="wp1045066"> </a>
Synopsis
</h4>
<a name="wp1045067"> </a><div class="pPreformatted"><pre>01 TPCONTEXTDEF-REC.<br />   COPY TPCONTEXTDEF.<br /> <br />01 TPSTATUS-REC.<br />   COPY TPSTATUS.<br /> <br />CALL &quot;TPGETCTXT&quot; USING TPCONTEXTDEF-REC TPSTATUS-REC.</pre></div><h4 class="pHeading3"><a name="wp1045068"> </a>
Description
</h4>
<p class="pBody"><a name="wp1045069"> </a>
<code class="cCode">TPGETCTXT()</code> retrieves an identifier that represents the current application context and places that identifier in <code class="cCode">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code>. Typically, a COBOL application:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1045070"> </a>Calls <code class="cCode">TPINITIALIZE()</code> with the <code class="cCode">TP-MULTI-CONTEXTS</code> flag set.</li>
<li><a name="wp1045071"> </a>Calls <code class="cCode">TPGETCTXT()</code> and saves the <code class="cCode">TPCONTEXTDEF-REC</code>.</li>
<li><a name="wp1062672"> </a>Calls <code class="cCode">TPINITIALIZE()</code>, again with the <code class="cCode">TP-MULTI-CONTEXTS</code> flag.</li>
<li><a name="wp1065623"> </a>Calls <code class="cCode">TPGETCTXT()</code> again and saves the returned context.</li>
<li><a name="wp1063188"> </a>Calls <code class="cCode">TPSETCTXT()</code> to switch back to the first context.</li>
</ol></div>
<p class="pBody"><a name="wp1045073"> </a>
<code class="cCode">TPGETCTXT()</code> may be called in single-context applications as well as in multi-context applications.
</p>
<h4 class="pHeading3"><a name="wp1045074"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1045075"> </a>
Upon successful completion, <code class="cCode">TPGETCTXT</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and places the program&#8217;s context identifier in <code class="cCode">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code>. <code class="cCode">CONTEXT</code> is set to the current context ID, which may be represented by either:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1113459"> </a>An actual context ID</li>
<li><a name="wp1113497"> </a><code class="cCode">TPNULLCONTEXT</code>, indicating that this program is not currently associated with a context</li>
</ul></div>
<a name="wp1113498"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td><code class="cCode">TPINVALIDCONTEXT</code> cannot be returned in COBOL programs because this value is possible only in multithreaded programs.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1045076"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1045077"> </a>
Upon failure, <code class="cCode">TPGETCTXT</code> sets <code class="cCode">TP-STATUS</code> to one of the following values.
</p>
<h4 class="pDefTerm"><a name="wp1045078"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1045079"> </a>
Invalid arguments have been given.
</div>
<h4 class="pDefTerm"><a name="wp1045082"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1045083"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error has been written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1045084"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1045085"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1045086"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1045087"> </a>
<a href="rf3cbl.html#wp1005398">Introduction to the COBOL Application-Transaction Monitor Interface</a>, <a href="rf3cbl.html#wp1047746"><code class="cCode">TPSETCTXT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1044551"> </a>
TPGETLEV(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000136"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000137"> </a>
<code class="cCode">TPGETLEV()</code> - check if an Oracle Tuxedo ATMI transaction is in progress
</p>
<h4 class="pHeading3"><a name="wp1000138"> </a>
Synopsis
</h4>
<a name="wp1000139"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPTRXLEV-REC</code><code class="cCode">.<br /> COPY TPTRXLEV. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPGETLEV&quot; USING </code><code class="cCodeEmphasis">TPTRXLEV-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000140"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000141"> </a>
<code class="cCode">TPGETLEV()</code> returns to the caller the current transaction level. Currently, the only levels defined are <code class="cCode">TP-NOT-IN-TRAN</code> and <code class="cCode">TP-IN-TRAN</code>.
</p>
<h4 class="pHeading3"><a name="wp1000142"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000143"> </a>
Upon successful completion, <code class="cCode">TPGETLEV()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and sets values in <code class="cCodeEmphasis">TPTRXLEV-REC</code> to either a <code class="cCode">TP-NOT-IN-TRAN</code> to indicate that no transaction is in progress, or <code class="cCode">TP-IN-TRAN</code> to indicate that a transaction is in progress.
</p>
<h4 class="pHeading3"><a name="wp1000144"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000145"> </a>
Under the following conditions, <code class="cCode">TPGETLEV()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000146"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000147"> </a>
<code class="cCode">TPGETLEV()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1000148"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000149"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000150"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000151"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000152"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1000153"> </a>
When using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT(),</code> and <code class="cCode">TPABORT()</code> to delineate an Oracle Tuxedo ATMI transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI transaction.
</p>
<h4 class="pHeading3"><a name="wp1000154"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000155"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1001241"><code class="cCode">TPSCMT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000197"> </a>
TPGETRPLY(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000198"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000199"> </a>
<code class="cCode">TPGETRPLY()</code> - get reply from asynchronous message
</p>
<h4 class="pHeading3"><a name="wp1000200"> </a>
Synopsis
</h4>
<a name="wp1000201"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPGETRPLY&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000202"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000203"> </a>
<code class="cCode">TPGETRPLY()</code> returns a reply from a previously sent request. <code class="cCode">TPGETRPLY()</code> either returns a reply for a particular request, or it returns any reply that is available. Both options are described below.
</p>
<p class="pBody"><a name="wp1000204"> </a>
<code class="cCodeEmphasis">DATA-REC</code> specifies where the reply is to be read into and, on input, <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> indicates the maximum number of bytes that should be moved into <code class="cCodeEmphasis">DATA-REC</code>. Also, <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> must be specified. Upon successful return from <code class="cCode">TPGETRPLY()</code>, <code class="cCode">LEN</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">DATA-REC</code>, <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, both in <code class="cCodeEmphasis">TPTYPE-REC</code>, contain the data&#8217;s type and subtype, respectively. If the reply is larger than <code class="cCodeEmphasis">DATA-REC</code>, then <code class="cCodeEmphasis">DATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the reply is discarded and <code class="cCode">TPGETRPLY()</code> sets <code class="cCode">TPTRUNCATE()</code>.
</p>
<p class="pBody"><a name="wp1000205"> </a>
If <code class="cCode">LEN</code> is <code class="cCode">0</code> upon successful return, then the reply has no data portion and <code class="cCodeEmphasis">DATA-REC</code> was not modified. It is an error for <code class="cCode">LEN</code> to be <code class="cCode">0</code> on input.
</p>
<p class="pBody"><a name="wp1000206"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1000207"> </a>
<code class="cCode">TPGETANY</code> 
</h4><div class="pDefPara"><a name="wp1000208"> </a>
This setting signifies that <code class="cCode">TPGETRPLY()</code> should ignore the communications handle indicated by <code class="cCode">COMM-HANDLE</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code>, return any reply available and set <code class="cCode">COMM-HANDLE</code> to the communications handle for the reply returned. If no replies exist, <code class="cCode">TPGETRPLY()</code> can wait for one to arrive. Either <code class="cCode">TPGETANY</code> or <code class="cCode">TPGETHANDLE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000209"> </a>
<code class="cCode">TPGETHANDLE</code> 
</h4><div class="pDefPara"><a name="wp1000210"> </a>
This setting signifies that <code class="cCode">TPGETRPLY()</code> should use the communications handle identified by <code class="cCode">COMM-HANDLE</code> and return a reply available for that <code class="cCode">COMM-HANDLE</code>. If no replies exist, <code class="cCode">TPGETRPLY()</code> can wait for one to arrive. Either <code class="cCode">TPGETANY</code> or <code class="cCode">TPGETHANDLE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000211"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1000212"> </a>
When this value is set, the type of <code class="cCodeEmphasis">DATA-REC</code> is not allowed to change. That is, the type and subtype of the reply record must match <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, respectively. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000213"> </a>
<code class="cCode">TPCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1000214"> </a>
The type and/or subtype of the reply record differs from <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000215"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000216"> </a>
<code class="cCode">TPGETRPLY()</code> does not wait for the reply to arrive. If the reply is available, then <code class="cCode">TPGETRPLY()</code> gets the reply and returns. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000217"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000218"> </a>
When <code class="cCode">TPBLOCK</code> is specified and no data is available, the caller blocks until the reply arrives or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000219"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1000220"> </a>
This setting signifies that the caller is willing to block indefinitely for its reply and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000221"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1000222"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000223"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000224"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000225"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000226"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<p class="pBody"><a name="wp1000227"> </a>
Except as noted below, <code class="cCode">COMM-HANDLE</code> is no longer valid after its reply is received.
</p>
<h4 class="pHeading3"><a name="wp1000228"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000229"> </a>
Upon successful completion, <code class="cCode">TPGETRPLY()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. When <code class="cCode">TP-STATUS</code> is set to <code class="cCode">TPOK()</code> or <code class="cCode">TPESVCFAIL()</code>, <code class="cCode">APPL-RETURN-CODE</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> contains an application-defined value that was sent as part of <code class="cCode">TPRETURN()</code>. If the size of the incoming message was larger then the size specified in <code class="cCode">LEN</code> on input, <code class="cCode">TPTRUNCATE()</code> is set and only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">DATA-REC</code>, the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp1000230"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000231"> </a>
Under the following conditions, <code class="cCode">TPGETRPLY()</code> fails and sets <code class="cCode">TP-STATUS</code> as indicated below. Note that if <code class="cCode">TPGETHANDLE</code> is set, then <code class="cCode">COMM-HANDLE</code> is invalidated unless otherwise stated. If <code class="cCode">TPGETANY </code>is set, then <code class="cCode">COMM-HANDLE</code> identifies the communications handle for the reply on which the failure occurred; if an error occurred before a reply could be retrieved, then <code class="cCode">COMM-HANDLE</code> is <code class="cCode">0</code>. Also, the failure does not affect the caller&#8217;s transaction, if one exists, unless otherwise stated. 
</p>
<h4 class="pDefTerm"><a name="wp1000232"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000233"> </a>
Invalid arguments were given (for example, settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are invalid).
</div>
<h4 class="pDefTerm"><a name="wp1000234"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp1000235"> </a>
Either the type and subtype of the reply are not known to the caller; or, <code class="cCode">TPNOCHANGE</code> was set and the <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> do not match the type and subtype of the reply sent by the service. Neither <code class="cCodeEmphasis">DATA-REC</code> nor <code class="cCodeEmphasis">TPTYPE-REC</code> are changed. If the reply was to be received on behalf of the caller&#8217;s current transaction, then the transaction is marked abort-only since the reply is discarded.
</div>
<h4 class="pDefTerm"><a name="wp1000236"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp1000237"> </a>
<code class="cCode">COMM-HANDLE</code> contains an invalid communications handle.
</div>
<h4 class="pDefTerm"><a name="wp1000238"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1276990"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPGETRPLY()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1272079"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.) In either case, no changes are made to <code class="cCodeEmphasis">DATA-REC</code> or <code class="cCodeEmphasis">TPTYPE-REC</code>. If <code class="cCode">TPGETHANDLE</code> was set, <code class="cCode">COMM-HANDLE</code> remains valid unless the caller is in transaction mode.
<a name="wp1272080"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1000240"> </a>
When a service fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1272157"> </a>
[<code class="cCode">TPESVCFAIL</code>] 
</h4><div class="pDefParaCont"><a name="wp1227922"> </a>
The service routine sending the caller&#8217;s reply called <code class="cCode">TPRETURN()</code> with <code class="cCode">TPFAIL()</code>. This is an application-level failure. The contents of the service&#8217;s reply, if one was sent, is available in <code class="cCodeEmphasis">DATA-REC</code>. <code class="cCode">APPL-RETURN-CODE</code> contains an application-defined value that was sent as part of <code class="cCode">TPRETURN()</code>. If the reply was received on behalf of the caller&#8217;s transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp1000242"> </a>
[<code class="cCode">TPESVCERR</code>] 
</h4><div class="pDefPara"><a name="wp1227940"> </a>
An error was encountered by a service routine during its completion in <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code> (for example, bad arguments were passed). No reply data is returned when this error occurs (that is, neither <code class="cCodeEmphasis">DATA-REC</code> nor <code class="cCodeEmphasis">TPTYPE-REC</code> are changed). If the reply was received on behalf of the caller&#8217;s transaction, then the transaction is marked abort-only. Note that regardless of whether the transaction has timed out, the only valid communications before the transaction is aborted are calls to <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOREPLY</code>, <code class="cCode">TPNOTRAN</code>, and <code class="cCode">TPNOBLOCK</code> set.
</div>
<h4 class="pDefTerm"><a name="wp1000244"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1000245"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified. <code class="cCode">COMM-HANDLE</code> remains valid.
</div>
<h4 class="pDefTerm"><a name="wp1000246"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1000247"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1000248"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000249"> </a>
<code class="cCode">TPGETRPLY()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1000250"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000251"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000252"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000253"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000254"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000255"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999069"><code class="cCode">TPCANCEL(3cbl)</code></a>, <a href="rf3cbl.html#wp1001140"><code class="cCode">TPRETURN(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000332"> </a>
TPGETUNSOL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000333"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000334"> </a>
<code class="cCode">TPGETUNSOL()</code> - get unsolicited message
</p>
<h4 class="pHeading3"><a name="wp1000335"> </a>
Synopsis
</h4>
<a name="wp1000336"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPGETUNSOL&quot; USING </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000337"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000338"> </a>
<code class="cCode">TPGETUNSOL()</code> gets unsolicited messages that were sent via <code class="cCode">TPBROADCAST()</code> or <code class="cCode">TPNOTIFY()</code>. This routine may only be called from an unsolicited message handler.
</p>
<p class="pBody"><a name="wp1000339"> </a>
Upon successful return, <code class="cCode">LEN IN</code> <code class="cCodeEmphasis">TPTYPE_REC</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">DATA-REC</code>. <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, both in <code class="cCodeEmphasis">TPTYPE-REC</code>, contain the data&#8217;s type and subtype, respectively. If the message is larger than <code class="cCodeEmphasis">DATA-REC</code>, then <code class="cCodeEmphasis">DATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the message is discarded and sets <code class="cCode">TPTRUNCATE()</code>. If <code class="cCode">LEN</code> is <code class="cCode">0</code>, upon successful completion, then the message has no data portion and <code class="cCodeEmphasis">DATA-REC</code> was not modified.
</p>
<p class="pBody"><a name="wp1000340"> </a>
It is an error for <code class="cCode">LEN</code> to be <code class="cCode">0</code> on input.
</p>
<h4 class="pHeading3"><a name="wp1000341"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000342"> </a>
Upon successful completion, <code class="cCode">TPGETUNSOL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. If the size of the incoming message was larger then the size specified in <code class="cCode">LEN</code> on input, <code class="cCode">TPTRUNCATE()</code> is set and only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">DATA-REC</code>, the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp1000343"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000344"> </a>
Under the following conditions, <code class="cCode">TPGETUNSOL()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000345"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000346"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1000347"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000348"> </a>
<code class="cCode">TPGETUNSOL()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1000349"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000350"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000351"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000352"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000353"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000354"> </a>
<a href="rf3cbl.html#wp1047466"><code class="cCode">TPSETUNSOL(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000395"> </a>
TPGPRIO(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000396"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000397"> </a>
<code class="cCode">TPGPRIO()</code> - get service request priority
</p>
<h4 class="pHeading3"><a name="wp1000398"> </a>
Synopsis
</h4>
<a name="wp1000399"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPPRIDEF-REC</code><code class="cCode">.<br /> COPY TPPRIDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPGPRIO&quot; USING </code><code class="cCodeEmphasis">TPPRIDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000400"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000401"> </a>
<code class="cCode">TPGPRIO()</code> returns the priority for the last request sent or received. Priorities can range from 1 to 100, inclusive, with 100 being the highest priority. <code class="cCode">TPGPRIO()</code> may be called after <code class="cCode">TPCALL()</code> or <code class="cCode">TPACALL()</code>, (also <code class="cCode">TPENQUEUE()</code> or <code class="cCode">TPDEQUEUE()</code>, assuming the queued management facility is installed), and the priority returned is for the request sent. Also, <code class="cCode">TPGPRIO()</code> may be called within a service routine to find out at what priority the invoked service was sent. <code class="cCode">TPGPRIO()</code> may be called any number of times and will return the same value until the next request is sent.
</p>
<p class="pBody"><a name="wp1000402"> </a>
Since the conversation primitives are not associated with priorities, issuing <code class="cCode">TPSEND()</code> or <code class="cCode">TPRECV()</code> has no effect on the priority returned by <code class="cCode">TPGPRIO()</code>. Also, there is no priority associated with a conversational service routine unless a <code class="cCode">TPCALL()</code> or <code class="cCode">TPACALL()</code> is done within that service.
</p>
<h4 class="pHeading3"><a name="wp1000403"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000404"> </a>
Upon successful completion, <code class="cCode">TPGPRIO()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and returns a request&#8217;s priority in <code class="cCode">PRIORITY</code> in <code class="cCodeEmphasis">TPPRIDEF-REC</code>.
</p>
<h4 class="pHeading3"><a name="wp1000405"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000406"> </a>
Under the following conditions, <code class="cCode">TPGPRIO()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000407"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1000408"> </a>
<code class="cCode">TPGPRIO()</code> was called and no requests (via <code class="cCode">TPCALL()</code> or <code class="cCode">TPACALL()</code>) have been sent, or it is called within a conversational service for which no requests have been sent.
</div>
<h4 class="pDefTerm"><a name="wp1000409"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000410"> </a>
<code class="cCode">TPGPRIO()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1000411"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000412"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000413"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000414"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000415"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000416"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>, <a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999573"><code class="cCode">TPDEQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp999853"><code class="cCode">TPENQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp1001527"><code class="cCode">TPSPRIO(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000457"> </a>
TPINITIALIZE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000458"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000459"> </a>
<code class="cCode">TPINITIALIZE()</code> - joins an Oracle Tuxedo ATMI application
</p>
<h4 class="pHeading3"><a name="wp1000460"> </a>
Synopsis
</h4>
<a name="wp1000461"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPINFDEF-REC</code><code class="cCode">.<br />   COPY TPINFDEF. <br /> <br />01 </code><code class="cCodeEmphasis">USER-DATA-REC</code><code class="cCode"> PIC X(any-length). <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />   COPY TPSTATUS. <br /> <br />CALL &quot;TPINITIALIZE&quot; </code><code class="cCodeEmphasis">TPINFDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">USER-DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000462"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000463"> </a>
<code class="cCode">TPINITIALIZE()</code> allows a client to join an Oracle Tuxedo ATMI application. Before a client can use any of the Oracle Tuxedo communication or transaction routines, it must first join an Oracle Tuxedo ATMI application. <code class="cCode">TPINITIALIZE()</code> has two modes of operation: single-context mode and multi-context mode, which will be discussed in greater detail below. Because calling <code class="cCode">TPINITIALIE()</code> is optional when in single-context mode, a single-context client may also join an application by calling many ATMI routines (for example, <code class="cCode">TPACALL()</code> or <code class="cCode">TPCALL()</code>) which transparently call <code class="cCode">TPINITIALIZE()</code> with default values for the members of <code class="cCodeEmphasis">TPINFDEF-REC</code>. A client may want to call <code class="cCode">TPINITIALIZE()</code> directly so that it can set the parameters described below. In addition, <code class="cCode">TPINITIALIZE()</code> must be used when multi-context mode is required or when application authentication is required (see the description of the <code class="cCode">SECURITY</code> keyword in <a href="../rf5/rf5.html">UBBCONFIG(5)</a>). After <code class="cCode">TPINITIALIZE()</code> successfully returns, the client can initiate service requests and define transactions.
</p>
<p class="pBody"><a name="wp1000467"> </a>
In single-context mode, if <code class="cCode">TPINITIALIZE()</code> is called more than once (that is, after the client has already joined the application), no action is taken and success is returned.
</p>
<h5 class="pHeading4"><a name="wp1000468"> </a>
Description of the TPINFDEF-REC Record
</h5>
<p class="pBody"><a name="wp1113563"> </a>
The <code class="cCodeEmphasis">TPINFDEF-REC</code> record includes the following members.
</p>
<a name="wp1044051"> </a><div class="pPreformatted"><pre><code class="cCode">05 USRNAME            PIC X(30). <br />05 CLTNAME            PIC X(30). <br />05 PASSWD             PIC X(30). <br />05 GRPNAME            PIC X(30). <br />05 NOTIFICATION-FLAG  PIC S9(9) COMP-5. <br />  88 TPU-SIG             VALUE 1. <br />  88 TPU-DIP             VALUE 2. <br />  88 TPU-IGN             VALUE 3. <br />05 ACCESS-FLAG        PIC S9(9) COMP-5. <br />  88 TPSA-FASTPATH       VALUE 1. <br />  88 TPSA-PROTECTED      VALUE 2. <br />05 CONTEXTS-FLAG      PIC S9(9) COMP-5.<br />  88 TP-SINGLE-CONTEXT   VALUE 0.<br />  88 TP-MULTI-CONTEXTS   VALUE 1.<br />05 DATALEN            PIC S9(9) COMP-5.</code></pre></div><p class="pBody"><a name="wp1000470"> </a>
<code class="cCode">USRNAME</code> is a name representing the caller. <code class="cCode">CLTNAME</code> is a client name whose semantics are application defined. The value <code class="cCode">sysclient</code> is reserved by the system for the <code class="cCode">CLTNAME</code> field. The <code class="cCode">USRNAME</code> and <code class="cCode">CLTNAME</code> fields are associated with the client at <code class="cCode">TPINITIALIZE()</code> time and are used for both broadcast notification and administrative statistics retrieval. <code class="cCode">PASSWD</code> is an application password in unencrypted format that is used for validation against the application password. The <code class="cCode">PASSWD</code> is significant up to 30 characters. <code class="cCode">GRPNAME</code> is used to associate the client with a resource manager group name. If <code class="cCode">GRPNAME</code> is <code class="cCode">SPACES</code>, then the client is not associated with a resource manager and is in the default client group.
</p>
<h5 class="pHeading4"><a name="wp1114101"> </a>
Single-context Mode Versus Multi-context Mode
</h5>
<p class="pBody"><a name="wp1114102"> </a>
<code class="cCode">TPINITIALIZE()</code> has two modes of operation: single-context mode and multi-context mode. In single-context mode, a process may join at most one application at any one time. Single-context mode is specified by calling <code class="cCode">TPINITIALIZE()</code> with the <code class="cCode">TP-SINGLE-CONTEXT</code> setting of <code class="cCode">CONTEXTS-FLAG</code> or by calling another function that invokes <code class="cCode">TPINITIALIZE()</code> implicitly.
</p>
<p class="pBody"><a name="wp1114103"> </a>
In single-context mode, if <code class="cCode">TPINITIALIZE()</code> is called more than once (that is, after the client has already joined the application), no action is taken and success is returned.
</p>
<p class="pBody"><a name="wp1114104"> </a>
Multi-context mode is entered by calling <code class="cCode">TPINITIALIZE()</code> with the <code class="cCode">TP-MULTI-CONTEXTS</code> setting of <code class="cCode">CONTEXTS-FLAG</code>. In multi-context mode, each call to <code class="cCode">TPINITIALIZE()</code> results in the creation of a separate application association.
</p>
<p class="pBody"><a name="wp1114105"> </a>
An <em class="cEmphasis">application association</em> is a context that associates a process and an Oracle Tuxedo application. A client may have associations with multiple Oracle Tuxedo applications, and may also have multiple associations with the same application. All of a client&#8217;s associations must be made to applications running the same release of the Oracle Tuxedo system, and either all associations must be native clients or all associations must be Workstation clients. 
</p>
<p class="pBody"><a name="wp1114106"> </a>
For native clients, the value of the <code class="cCode">TUXCONFIG</code> environment variable is used to identify the application to which the new association will be made. For Workstation clients, the value of the <code class="cCode">WSNADDR</code> or <code class="cCode">WSENVFILE</code> environment variable is used to identify the application to which the new association will be made. The context for the current COBOL process is set to the new association.
</p>
<p class="pBody"><a name="wp1114107"> </a>
In multi-context mode the application can get a handle for the current context, by calling <code class="cCode">TPGETCTXT()</code>, and pass that handle as a parameter to <code class="cCode">TPSETCTXT()</code>, thus setting the context in which a particular COBOL process will operate.
</p>
<p class="pBody"><a name="wp1114108"> </a>
Mixing single-context mode and multi-context mode is not allowed. Once an application has chosen one of these modes, calling <code class="cCode">TPINITIALIZE()</code> in the other mode is not allowed unless <code class="cCode">TPTERM()</code> is first called for all application associations.
</p>
<h5 class="pHeading4"><a name="wp1000474"> </a>
TPINFDEF-REC Record Descriptions
</h5>
<p class="pBody"><a name="wp1113569"> </a>
The settings of <code class="cCodeEmphasis">TPINFDEF-REC</code> are used to indicate both the client specific notification mechanism and the mode of system access. These settings may override the application default; however, in the event that they cannot, <code class="cCode">TPINITIALIZE()</code> will print a warning in a log file, ignore the setting and return the application default setting in <code class="cCodeEmphasis">TPINFDEF-REC</code> upon return from <code class="cCode">TPINITIALIZE()</code>. For client notification, the possible settings are as follows: 
</p>
<h4 class="pDefTerm"><a name="wp1000475"> </a>
<code class="cCode">TPU-SIG</code> 
</h4><div class="pDefPara"><a name="wp1000476"> </a>
Select unsolicited notification by signals. This setting is not allowed in conjunction with the <code class="cCode">TP-MULTI-CONTEXTS</code> setting of <code class="cCode">CONTEXTS-FLAG</code>.
</div>
<h4 class="pDefTerm"><a name="wp1000477"> </a>
<code class="cCode">TPU-DIP</code> 
</h4><div class="pDefPara"><a name="wp1000478"> </a>
Select unsolicited notification by dip-in.
</div>
<h4 class="pDefTerm"><a name="wp1000479"> </a>
<code class="cCode">TPU-IGN</code> 
</h4><div class="pDefPara"><a name="wp1000480"> </a>
Ignore unsolicited notification.
</div>
<p class="pBody"><a name="wp1000481"> </a>
Only one of the above can be used at a time. If the client does not select a notification method, then the application default method will be set upon return from <code class="cCode">TPINITIALIZE()</code>.
</p>
<p class="pBody"><a name="wp1000482"> </a>
For setting the mode of system access, the possible settings are as follows: 
</p>
<h4 class="pDefTerm"><a name="wp1000483"> </a>
<code class="cCode">TPSA-FASTPATH</code> 
</h4><div class="pDefPara"><a name="wp1000484"> </a>
Set system access to fastpath.
</div>
<h4 class="pDefTerm"><a name="wp1000485"> </a>
<code class="cCode">TPSA-PROTECTED</code> 
</h4><div class="pDefPara"><a name="wp1000486"> </a>
Set system access to protected.
</div>
<p class="pBody"><a name="wp1000487"> </a>
Only one of the above can be used at a time. If the client does not select a notification method or a system access mode, then the application default method(s) will be set upon return from <code class="cCode">TPINITIALIZE()</code>. See <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details on both client notification methods and system access modes.
</p>
<p class="pBody"><a name="wp1000488"> </a>
<code class="cCode">DATALEN</code> is the length of the application specific data that will be sent to the service. A <code class="cCode">SPACES</code> value for <code class="cCode">USRNAME</code> and <code class="cCode">CLTNAME</code> is allowed for applications not making use of the application authentication feature of the Oracle Tuxedo system. Currently, <code class="cCode">GRPNAME</code> must be <code class="cCode">SPACES</code>. Clients using this option will get defined in the Oracle Tuxedo system with the following: default values for <code class="cCode">USRNAME</code>, <code class="cCode">CLTNAME</code>, and <code class="cCode">GRPNAME</code>; default settings; and no application data.
</p>
<h4 class="pHeading3"><a name="wp1000489"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000490"> </a>
Upon successful completion, <code class="cCode">TPINITIALIZE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. Upon failure, <code class="cCode">TPINITIALIZE()</code> leaves the calling process in its original context, returns <code class="cCode">-1</code>, and sets <code class="cCode">TP-STATUS</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1000491"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000492"> </a>
Upon failure, <code class="cCode">TPINITIALIZE()</code> sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000493"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000494"> </a>
Invalid arguments were specified.
</div>
<h4 class="pDefTerm"><a name="wp1000495"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1000496"> </a>
The client cannot join the application because of space limitations.
</div>
<h4 class="pDefTerm"><a name="wp1000497"> </a>
[<code class="cCode">TPEPERM</code>] 
</h4><div class="pDefPara"><a name="wp1000498"> </a>
The client cannot join the application because it does not have permission to do so or because it has not supplied the correct application password. Permission may be denied based on an invalid application password, failure to pass application specific authentication or use of restricted names.
</div>
<h4 class="pDefTerm"><a name="wp1000499"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1044509"> </a>
<code class="cCode">TPINITIALIZE()</code> was called improperly. For example: (a) the caller is a server; (b) the <code class="cCode">TP-MULTI-CONTEXTS</code> setting was specified in single-context mode; or (c) the <code class="cCode">TP-MULTI-CONTEXTS</code> setting was not specified in multi-context mode.
</div>
<h4 class="pDefTerm"><a name="wp1044510"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1044503"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000503"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000504"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000505"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1000509"> </a>
The interfaces described in <code class="cCode">TPINITIALIZE()</code> are supported on UNIX system and MS-DOS operating systems. However, signal-based notification is not supported on MS-DOS. If it is selected at <code class="cCode">TPINITIALIZE()</code> time, then a <code class="cCode">USERLOG()</code> message is generated and the method is automatically set to dip-in.
</p>
<h4 class="pHeading3"><a name="wp1000510"> </a>
Environment Variables
</h4>
<h4 class="pDefTerm"><a name="wp1000511"> </a>
<code class="cCode">TUXCONFIG</code> 
</h4><div class="pDefPara"><a name="wp1044514"> </a>
Is used within <code class="cCode">TPINITIALIZE()</code> when invoked by a non-workstation native client. It indicates the application to which the client should connect. Note that this environment variable is referenced only when <code class="cCode">TPINITIALIZE()</code> is called. Subsequent calls make use of the application context.
</div>
<h4 class="pDefTerm"><a name="wp1044513"> </a>
<code class="cCode">WSENVFILE</code> 
</h4><div class="pDefPara"><a name="wp1000512"> </a>
Is used within <code class="cCode">TPINITIALIZE()</code> when invoked by a Workstation client. It indicates a file containing environment variable settings that should be set in the caller&#8217;s environment. See <a href="../rf5/rf5.html">compilation(5)</a> for more details on environment variable settings necessary for Workstation clients. Note that this file is processed only when <code class="cCode">TPINITIALIZE()</code> is called and not before.
</div>
<h4 class="pDefTerm"><a name="wp1000513"> </a>
<code class="cCode">WSNADDR</code> 
</h4><div class="pDefPara"><a name="wp1000514"> </a>
Is used within <code class="cCode">TPINITIALIZE()</code> when invoked by a Workstation client. It indicates the network address(es) of the workstation listener that is to be contacted for access to the application. This variable is required for Workstation clients and is ignored for native clients.
</div>
<div class="pDefParaCont"><a name="wp1000515"> </a>
TCP/IP addresses may be specified in the following forms:
<a name="wp1000516"> </a>
<code class="cCodeEmphasis">&quot;//host.name:port_number&quot;<br />&quot;//#.#.#.#:port_number&quot;</code>
<a name="wp1000517"> </a>
In the first format, the domain finds an address for <code class="cCodeEmphasis">hostname</code> using the local name resolution facilities (usually DNS). <code class="cCodeEmphasis">hostname</code> must be the local machine, and the local name resolution facilities must unambiguously resolve <code class="cCodeEmphasis">hostname</code> to the address of the local machine.
<a name="wp1000518"> </a>
In the second example, the &quot;<code class="cCodeEmphasis">#.#.#.#</code>&quot; is in dotted-decimal format. In dotted- decimal format, each <code class="cCodeEmphasis">#</code> should be a number from 0 to 255. This dotted-decimal number represents the IP address of the local machine.
<a name="wp1000519"> </a>
In both of the above formats, <code class="cCodeEmphasis">port_number</code> is the TCP port number at which the domain process will listen for incoming requests. <code class="cCodeEmphasis">port_number</code> can either be a number between 0 and 65535 or a name. If <code class="cCodeEmphasis">port_number</code> is a name, then it must be found in the network services database on your local machine.
<a name="wp1000520"> </a>
The address can also be specified in hexadecimal format when preceded by the characters &#8220;0x&#8221;. Each character after the initial &#8220;0x&#8221; is a number between 0 and 9 or a letter between A and F (case insensitive). The hexadecimal format is useful for arbitrary binary network addresses such as IPX/SPX or TCP/IP.
<a name="wp1000521"> </a>
The address can also be specified as an arbitrary string. The value should be the same as that specified for the <code class="cCode">NLSADDR</code> parameter in the <code class="cCode">NETWORKS</code> section of the configuration file.
<a name="wp1000522"> </a>
More than one address can be specified if desired by specifying a comma-separated list of pathnames for <code class="cCode">WSNADDR</code>. Addresses are tried in order until a connection is established. Any member of an address list can be specified as a parenthesized grouping of pipe-separated network addresses. For example:
<a name="wp1000523"> </a><div class="pPreformatted"><pre><code class="cCode"> WSNADDR=&quot;(//m1.acme.com:3050|//m2.acme.com:3050),//m3.acme.com:3050&quot;</code></pre></div><a name="wp1120163"> </a>
For users running under Windows, the address string looks like the following:
<a name="wp1120164"> </a><div class="pPreformatted"><pre><code class="cCode">set WSNADDR=(//m1.acme.com:3050^|//m2.acme.com:3050),//m3.acme.com:3050</code></pre></div><a name="wp1219187"> </a>
Because the pipe symbol (<code class="cCode">|</code>) is considered a special character in Windows, it must be preceded by a carat ( ^ )&#8212;an escape character in the Windows environment&#8212;when it is specified on the command line. However, if <code class="cCode">WSNADDR</code> is defined in an envfile, the Oracle Tuxedo system gets the values defined by <code class="cCode">WSNADDR</code> through the <a href="../rf3c/rf3c.html">tuxgetenv(3c)</a> function. In this context, the pipe symbol (<code class="cCode">|</code>) is not considered a special character, so you do not need to escape it with a carat (<code class="cCode">^</code>).
<a name="wp1227067"> </a>
The Oracle Tuxedo system randomly selects one of the parenthesized addresses. This strategy distributes the load randomly across a set of listener processes. Addresses are tried in order until a connection is established. Use the value specified in the application configuration file for the workstation listener to be called. If the value begins with the characters &#8220;0x&#8221;, it is interpreted as a string of hex-digits, otherwise it is interpreted as ASCII characters.
</div>
<h4 class="pDefTerm"><a name="wp1227079"> </a>
<code class="cCode">WSFADDR</code>
</h4><div class="pDefPara"><a name="wp1227068"> </a>
Used within <code class="cCode">TPINITIALIZE()</code> when invoked by a Workstation client. It specifies the network address used by the Workstation client when connecting to the workstation listener or workstation handler. This variable, along with the <code class="cCode">WSFRANGE</code> variable, determines the range of TCP/IP ports to which a Workstation client will attempt to bind before making an outbound connection. This address must be a TCP/IP address. The port portion of the TCP/IP address represents the base address from which a range of TCP/IP ports can be bound by the Workstation client. The <code class="cCode">WSFRANGE</code> variable specifies the size of the range. For example, if this address is <code class="cCode">//mymachine.bea.com:30000</code> and <code class="cCode">WSFRANGE</code> is 200, then all native processes attempting to make outbound connections from this <code class="cCodeEmphasis">LMID</code> will bind a port on <code class="cCode">mymachine.bea.com</code> between 30000 and 30200. If not set, this variable defaults to the empty string, which implies the operating system chooses a local port randomly. 
</div>
<h4 class="pDefTerm"><a name="wp1227069"> </a>
<code class="cCode">WSFRANGE</code>
</h4><div class="pDefPara"><a name="wp1227070"> </a>
Used within <code class="cCode">TPINITIALIZE()</code>when invoked by a Workstation client. It specifies the range of TCP/IP ports to which a Workstation client process will attempt to bind before making an outbound connection. The <code class="cCode">WSFADDR</code> parameter specifies the base address of the range. For example, if the <code class="cCode">WSFADDR</code> parameter is set to <code class="cCode">//mymachine.bea.com:30000</code> and <code class="cCode">WSFRANGE</code> is set to 200, then all native processes attempting to make outbound connections from this <code class="cCodeEmphasis">LMID</code> will bind a port on <code class="cCode">mymachine.bea.com</code> between 30000 and 30200. The valid range is 1-65535. The default is 1. 
</div>
<h4 class="pDefTerm"><a name="wp1000525"> </a>
<code class="cCode">WSDEVICE</code> 
</h4><div class="pDefPara"><a name="wp1000526"> </a>
Is used within <code class="cCode">TPINITIALIZE()</code> when invoked by a Workstation client. It indicates the device name to be used to access the network. This variable is used by Workstation clients and ignored for native clients. Note that certain supported transport level network interfaces do not require a device name; for example, sockets and NetBIOS. Workstation clients supported by such interfaces need not specify <code class="cCode">WSDEVICE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1000527"> </a>
<code class="cCode">WSTYPE</code> 
</h4><div class="pDefPara"><a name="wp1000528"> </a>
Is used within <code class="cCode">TPINITIALIZE()</code> when invoked by a Workstation client to negotiate encode/decode responsibilities with the native site. This variable is optional for Workstation clients and ignored for native clients.
</div>
<h4 class="pDefTerm"><a name="wp1000529"> </a>
<code class="cCode">WSRPLYMAX</code> 
</h4><div class="pDefPara"><a name="wp1000530"> </a>
Is used by <code class="cCode">TPINITIALIZE()</code> to set the maximum amount of core memory that should be used for buffering application replies before they are dumped to file. The default value for this parameter varies with each instantiation. The instantiation specific programmer&#8217;s guide should be consulted for further information.
</div>
<h4 class="pDefTerm"><a name="wp1000531"> </a>
<code class="cCode">TMMINENCRYPTBITS</code> 
</h4><div class="pDefPara"><a name="wp1000532"> </a>
Is used to establish the minimum level of encryption required to connect to the Oracle Tuxedo system. &#8220;0&#8221; means no encryption, while &#8220;56&#8221; and &#8220;128&#8221; specify the encryption key length (in bits). If this minimum level of encryption cannot be met, link establishment will fail. The default is &#8220;0&#8221;
</div>
<h4 class="pDefTerm"><a name="wp1000533"> </a>
<code class="cCode">TMMAXENCRYPTBITS</code> 
</h4><div class="pDefPara"><a name="wp1000534"> </a>
Is used to negotiate the level of encryption up to this level when connecting to the Oracle Tuxedo system. &#8220;0&#8221; means no encryption, while &#8220;56&#8221; and &#8220;128&#8221; specify the encryption length (in bits). The default value is &#8220;128.&#8221;
</div>
<h4 class="pHeading3"><a name="wp1000535"> </a>
Warning
</h4>
<p class="pBody"><a name="wp1000536"> </a>
Signal-based notification is not allowed in multi-context mode. In addition, clients that select signal-based notification may not be able to receive signals from the system due to signal restrictions. When clients cannot receive signals, the system generates a log message that it is switching notification for the selected client to dip-in and the client is notified then and thereafter via dip-in notification. See the description of the <code class="cCode">NOTIFY</code> parameter in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for a detailed discussion of notification methods.
</p>
<p class="pBody"><a name="wp1097773"> </a>
Because signaling of clients is always done by the system, the behavior of notification is always consistent, regardless of where the originating notification call is made. Therefore to use signal-based notification:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1097784"> </a>A native client must be running as an application administrator</li>
<li><a name="wp1097787"> </a>A Workstation client is not required to be running as the application administrator</li>
</ul></div>
<p class="pBody"><a name="wp1097790"> </a>
The ID for the application administrator is identified in the configuration file for the application.
</p>
<p class="pBody"><a name="wp1000537"> </a>
If signal-based notification is selected for a client, then certain ATMI calls may fail, returning <code class="cCode">TPGOTSIG</code> due to receipt of an unsolicited message if <code class="cCode">TPSIGRSTRT</code> is not specified.
</p>
<h4 class="pHeading3"><a name="wp1000538"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000539"> </a>
<a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a>, <a href="rf3cbl.html#wp1047746"><code class="cCode">TPSETCTXT(3cbl)</code></a>, <a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1066533"> </a>
TPKEYCLOSE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1066534"> </a>
Name
</h4>
<p class="pBody"><a name="wp1066535"> </a>
<code class="cCode">TPKEYCLOSE()</code> - close a previously opened key handle
</p>
<h4 class="pHeading3"><a name="wp1066536"> </a>
Synopsis
</h4>
<a name="wp1066537"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPKEYDEF-REC</code>.<br />   COPY TPKEYDEF.<br /><br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>. <br />   COPY TPSTATUS.<br /><br />CALL &quot;TPKEYCLOSE&quot; USING <code class="cCodeEmphasis">TPKEYDEF-REC</code> <code class="cCodeEmphasis">TPSTATUS-REC</code>.</pre></div><h4 class="pHeading3"><a name="wp1066538"> </a>
Description
</h4>
<p class="pBody"><a name="wp1066539"> </a>
<code class="cCode">TPKEYCLOSE()</code> releases a previously opened key handle and all resources associated with it. Any sensitive information, such as the principal&#8217;s private key, is erased from memory.
</p>
<p class="pBody"><a name="wp1066540"> </a>
The calling process must supply <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. <code class="cCodeEmphasis">KEY-HANDLE</code> is a key identifier returned by a previous call to <code class="cCode">TPKEYOPEN()</code>. 
</p>
<h4 class="pHeading3"><a name="wp1066541"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1066542"> </a>
Upon successful completion, <code class="cCode">TPKEYCLOSE()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to [<code class="cCode">TPOK</code>]. 
</p>
<h4 class="pHeading3"><a name="wp1066543"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1066544"> </a>
Upon failure, <code class="cCode">TPKEYCLOSE()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to one of the following values.
</p>
<h4 class="pDefTerm"><a name="wp1066545"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1066546"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code> is not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1066547"> </a>
 [<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1066548"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1066549"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1066550"> </a>
<a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a>, <a href="rf3cbl.html#wp1143651"><code class="cCode">TPKEYOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1066613"><code class="cCode">TPKEYSETINFO(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1066551"> </a>
TPKEYGETINFO(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1066552"> </a>
Name
</h4>
<p class="pBody"><a name="wp1066553"> </a>
<code class="cCode">TPKEYGETINFO()</code> - get information associated with a key handle
</p>
<h4 class="pHeading3"><a name="wp1066554"> </a>
Synopsis
</h4>
<a name="wp1247167"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPKEYDEF-REC</code>.<br />   COPY TPKEYDEF.<br /><br />01<code class="cCode"> ATTVALUE-REC.<br /></code>   COPY user data<br /><br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>.<br />   COPY TPSTATUS.<br /><br />CALL &quot;TPKEYGETINFO&quot; USING <code class="cCodeEmphasis">TPKEYDEF-REC</code><code class="cCode"> ATTVALUE-REC </code><code class="cCodeEmphasis">TPSTATUS-REC</code>.</pre></div><h4 class="pHeading3"><a name="wp1066556"> </a>
Description
</h4>
<p class="pBody"><a name="wp1155752"> </a>
<code class="cCode">TPKEYGETINFO()</code> reports information about a key handle. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1156249"> </a>
The calling process must supply <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>, which is a key identifier returned by a previous call to <code class="cCode">TPKEYOPEN()</code>.
</p>
<p class="pBody"><a name="wp1322321"> </a>
The attribute for which information is desired is identified by <code class="cCodeEmphasis">ATTRIBUTE-NAME</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. The attribute name may be padded with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>. Some attributes are specific to a cryptographic service provider, but the following core set of attributes should be supported by all providers.
</p>
<p class="pGraphic"><a name="wp1322372"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1322324table1322322">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1322324"> </a>
Attribute
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1322326"> </a>
Value
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322328"> </a>
<code class="cCode">PRINCIPAL</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322330"> </a>
The name identifying the principal associated with the key (key handle), represented as a NULL-terminated character string.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322332"> </a>
<code class="cCode">PKENCRYPT_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322334"> </a>
An ASN.1 Distinguished Encoding Rules (DER) <em class="cEmphasis">object identifier</em> of the public key algorithm used by the key for public key encryption.
</div>
<div class="pCellBody"><a name="wp1322335"> </a>
The object identifier for RSA is identified in the following table.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322337"> </a>
<code class="cCode">PKENCRYPT_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322339"> </a>
The key length of the public key algorithm (RSA modulus size). The value must be within the range of 512 to 2048 bits, inclusive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322341"> </a>
<code class="cCode">SIGNATURE_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322343"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier</em> of the digital signature algorithm used by the key for digital signature.
</div>
<div class="pCellBody"><a name="wp1322344"> </a>
The object identifiers for RSA and DSA are identified in the following table.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322346"> </a>
<code class="cCode">SIGNATURE_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322348"> </a>
The key length of the digital signature algorithm (RSA modulus size). The value must be within the range of 512 to 2048 bits, inclusive.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322350"> </a>
<code class="cCode">ENCRYPT_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322352"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier</em> of the symmetric key algorithm used by the key for bulk data encryption.
</div>
<div class="pCellBody"><a name="wp1322353"> </a>
The object identifiers for AES, DES, 3DES, and RC2 are identified in the following table. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322355"> </a>
<code class="cCode">ENCRYPT_BITS</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322357"> </a>
The key length of the symmetric key algorithm. The value must be within the range of 40 to 256 bits, inclusive.
</div>
<div class="pCellBody"><a name="wp1322358"> </a>
When an algorithm with a fixed key length is set in <code class="cCode">ENCRYPT_ALG</code>, the <code class="cCode">ENCRYPT_BITS</code> value is automatically set to the fixed key length. For example, if <code class="cCode">ENCRYPT_ALG</code> is set to DES, the <code class="cCode">ENCRYPT_BITS</code> value is automatically set to 56.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322360"> </a>
<code class="cCode">DIGEST_ALG</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322362"> </a>
An ASN.1 DER <em class="cEmphasis">object identifier </em>of the message digest algorithm used by the key for digital signature.
</div>
<div class="pCellBody"><a name="wp1322363"> </a>
The object identifiers for MD5 and SHA-1 are identified in the following table. 
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322365"> </a>
<code class="cCode">PROVIDER</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322367"> </a>
The name of the cryptographic service provider.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322369"> </a>
<code class="cCode">VERSION</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1322371"> </a>
The version number of the cryptographic service provider&#8217;s software.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1324195"> </a>
The ASN.1 DER algorithm object identifiers supported by the default public key implementation are given in the following table.
</p>
<p class="pGraphic"><a name="wp1324229"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1324198table1324196">
  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1324198"> </a>
ASN.1 DER Algorithm Object Identifier
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1324200"> </a>
Algorithm
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324202"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x02, 0x05 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324204"> </a>
<code class="cCode">MD5</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324206"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x1a }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324208"> </a>
<code class="cCode">SHA1</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324210"> </a>
{ 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324212"> </a>
<code class="cCode">RSA</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324214"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x0c }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324216"> </a>
<code class="cCode">DSA</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1337110"> </a>
{ 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x01, 0x02 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1337112"> </a>
AES128-cbc
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1337275"> </a>
{ 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x01, 0x2a }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1336245"> </a>
AES256-cbc
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324218"> </a>
{ 0x06, 0x05, 0x2b, 0x0e, 0x03, 0x02, 0x07 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324220"> </a>
<code class="cCode">DES</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324222"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x03, 0x07 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324224"> </a>
<code class="cCode">3DES</code>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324226"> </a>
{ 0x06, 0x08, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x03, 0x02 }
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1324228"> </a>
<code class="cCode">RC2</code>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1337156"> </a>
The information associated with the specified attribute will be stored in user-defined <code class="cCode">ATTVALUE-REC</code>, padded at the end with <code class="cCode">SPACES</code>. The maximum amount of data that can be stored at this location is specified by the caller in <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>.
</p>
<p class="pBody"><a name="wp1251990"> </a>
After <code class="cCode">TPKEYGETINFO()</code> completes, <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code> is set to the size of the data actually returned (not including padding values). If the number of bytes that need to be returned exceeds <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code>, <code class="cCode">TPKEYGETINFO()</code> fails (with the <code class="cCode">TPELIMIT</code> error code) and sets <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code> to the required amount of space.
</p>
<h4 class="pHeading3"><a name="wp1249664"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1254287"> </a>
Upon successful completion, <code class="cCode">TPKEYGETINFO()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp1254289"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1066602"> </a>
Upon failure, <code class="cCode">TPKEYGETINFO()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1066603"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1066604"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">KEY-HANDLE</code> is not a valid key.
</div>
<h4 class="pDefTerm"><a name="wp1066605"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1066606"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pDefTerm"><a name="wp1066607"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1066608"> </a>
Insufficient space was provided to hold the requested attribute value.
</div>
<h4 class="pDefTerm"><a name="wp1066609"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1066610"> </a>
The requested attribute is not associated with this key.
</div>
<h4 class="pHeading3"><a name="wp1066611"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1066612"> </a>
<a href="rf3cbl.html#wp1066533"><code class="cCode">TPKEYCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1143651"><code class="cCode">TPKEYOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1066613"><code class="cCode">TPKEYSETINFO(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1143651"> </a>
TPKEYOPEN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1143652"> </a>
Name
</h4>
<p class="pBody"><a name="wp1143653"> </a>
<code class="cCode">TPKEYOPEN()</code> - open a key handle for digital signature generation, message encryption, or message decryption
</p>
<h4 class="pHeading3"><a name="wp1143654"> </a>
Synopsis
</h4>
<a name="wp1144248"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPKEYDEF-REC</code>. <br />   COPY TPKEYDEF.<br /><br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>. <br />   COPY TPSTATUS.<br /><br />CALL &quot;TPKEYOPEN&quot; USING <code class="cCodeEmphasis">TPKEYDEF-REC</code> <code class="cCodeEmphasis">TPSTATUS-REC</code>.</pre></div><h4 class="pHeading3"><a name="wp1143656"> </a>
Description
</h4>
<p class="pBody"><a name="wp1144252"> </a>
<code class="cCode">TPKEYOPEN()</code> makes a key handle available to the calling process. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1144253"> </a>
A key may be used for one or more of the following purposes:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1144254"> </a>Automatically generating a digital signature, which protects a message&#8217;s content and proves that a specific principal originated the message. (A principal may be a person or a process.) This type of key is a private key and is available only to the key&#8217;s owner.</li>
<p class="pBodyRelative"><a name="wp1146549"> </a>
Calling <code class="cCode">TPKEYOPEN()</code> with the principal&#8217;s name and the <code class="cCode">TPKEY-SIGNATURE</code> and <code class="cCode">TPKEY-AUTOSIGN</code> settings returns a handle to the principal&#8217;s public key and enables signature generation in <code class="cCode">AUTOSIGN</code> mode. The public key software generates and attaches the digital signature to the message just before the message is sent.
</p>
<li><a name="wp1144256"> </a>Verifying a digital signature, which proves that a message&#8217;s content remains unaltered and that a specific principal originated the message.</li>
<p class="pBodyRelative"><a name="wp1148826"> </a>
Signature verification does not require a call to <code class="cCode">TPKEYOPEN()</code>; the verifying process uses the public key specified in the digital certificate accompanying the digitally signed message to verify the signature.
</p>
<li><a name="wp1144258"> </a>Automatically encrypting a message destined for a specific principal. This type of key is available to any process with access to the principal&#39;s public key and digital certificate.</li>
<p class="pBodyRelative"><a name="wp1151107"> </a>
Calling <code class="cCode">TPKEYOPEN()</code> with the principal&#8217;s name and the <code class="cCode">TPKEY-ENCRYPT</code> and <code class="cCode">TPKEY-AUTOENCRYPT</code> settings returns a handle to the principal&#8217;s public key (via the principal&#8217;s digital certificate) and enables encryption in <code class="cCode">AUTOENCRYPT</code> mode. The public key software encrypts the message and attaches an encryption envelope to the message just before the message is sent; the encryption envelope enables the receiving process to decrypt the message.
</p>
<li><a name="wp1144260"> </a>Decrypting a message intended for a specific principal. This type of key is a private key and is available only to the key&#8217;s owner.</li>
<p class="pBodyRelative"><a name="wp1153376"> </a>
Calling <code class="cCode">TPKEYOPEN()</code> with the principal&#8217;s name and the <code class="cCode">TPKEY-DECRYPT</code> setting returns a handle to the principal&#8217;s private key and digital certificate.
</p>
</ul></div>
<p class="pBody"><a name="wp1162904"> </a>
The key handle returned by <code class="cCode">TPKEYOPEN()</code> is stored in <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>.
</p>
<p class="pBody"><a name="wp1143661"> </a>
The calling process must supply <code class="cCodeEmphasis">PRINCIPAL-NAME</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>, which specifies the key owner&#8217;s identity. This name may be padded at the end with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>. If <code class="cCodeEmphasis">PRINCIPAL-NAME</code> is all <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>, a default identity is assumed. The default identity may be based on the current login session, the current operating system account, or another attribute such as a local hardware device.
</p>
<p class="pBody"><a name="wp1143662"> </a>
The calling process may have to supply <code class="cCodeEmphasis">LOCATION</code> in <code class="cCode">TPKEYDEF-REC</code>, which specifies the location of a key owner&#8217;s identity. If the underlying provider does not require a location field, this field may be populated with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>.
</p>
<p class="pBody"><a name="wp1143663"> </a>
To authenticate the identity of <code class="cCodeEmphasis">PRINCIPAL-NAME</code>, proof material such as a password or pass phrase may be required. If required, the proof material should be stored in <code class="cCodeEmphasis">IDENTITY-PROOF</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. Otherwise, this field may be populated with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>.
</p>
<p class="pBody"><a name="wp1162927"> </a>
The length of the proof material (in bytes) is specified by <code class="cCodeEmphasis">PROOF-LEN</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. If <code class="cCodeEmphasis">PROOF-LEN</code> is 0,<code class="cCodeEmphasis">IDENTITY-PROOF</code> is assumed to be a character string padded at the end with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>, in which case trailing <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code> are not considered part of the proof material.
</p>
<p class="pBody"><a name="wp1143664"> </a>
There may be a choice of cryptographic service providers, based on the local machine&#8217;s configuration and operating environment. If you need to choose one, set <code class="cCodeEmphasis">CRYPTO-PROVIDER</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code> to the name of the required provider. Otherwise, set this field to <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>, and a default provider will be assumed.
</p>
<p class="pBody"><a name="wp1143665"> </a>
The type of key access required for a key&#8217;s mode of operation is determined by specifying one or more of the following settings in <code class="cCodeEmphasis">TPKEYDEF-REC</code>.
</p>
<h4 class="pDefTerm"><a name="wp1143666"> </a>
<code class="cCodeEmphasis">TPKEY-SIGNATURE</code>:
</h4><div class="pDefPara"><a name="wp1143667"> </a>
This private key is available to generate digital signatures.
</div>
<h4 class="pDefTerm"><a name="wp1155680"> </a>
<code class="cCodeEmphasis">TPKEY-AUTOSIGN</code>:
</h4><div class="pDefPara"><a name="wp1155681"> </a>
Whenever this process transmits a message, the public key software uses the signer&#8217;s private key to generate a digital signature and then attaches the digital signature to the message.
</div>
<h4 class="pDefTerm"><a name="wp1143670"> </a>
<code class="cCodeEmphasis">TPKEY-ENCRYPT</code>:
</h4><div class="pDefPara"><a name="wp1143671"> </a>
This public key is available to identify the recipient of an encrypted message.
</div>
<h4 class="pDefTerm"><a name="wp1143674"> </a>
<code class="cCodeEmphasis">TPKEY-AUTOENCRYPT</code>:
</h4><div class="pDefPara"><a name="wp1143675"> </a>
Whenever this process transmits a message, the public key software encrypts the message, uses the recipient&#8217;s public key to generate an encryption envelope, and then attaches the encryption envelope to the message.
</div>
<h4 class="pDefTerm"><a name="wp1155673"> </a>
<code class="cCodeEmphasis">TPKEY-DECRYPT</code>:
</h4><div class="pDefPara"><a name="wp1155674"> </a>
This private key is available for decryption.
</div>
<p class="pBody"><a name="wp1143676"> </a>
Various combinations of these settings are allowed. If a key is used only for encryption (<code class="cCodeEmphasis">TPKEY-ENCRYPT</code> and <code class="cCodeEmphasis">TPKEY-AUTOENCRYPT</code>), <code class="cCodeEmphasis">IDENTITY-PROOF</code> is not required.
</p>
<h4 class="pHeading3"><a name="wp1163006"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1163007"> </a>
Upon successful completion, <code class="cCode">TPKEYOPEN()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to [<code class="cCode">TPOK</code>]. In addition, <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code> is set to a value that represents this key, for use by other functions such as <code class="cCode">TPKEYGETINFO()</code>.
</p>
<h4 class="pHeading3"><a name="wp1143679"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1143680"> </a>
Upon failure, <code class="cCode">TPKEYOPEN()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1143681"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1143682"> </a>
Invalid arguments were given. For example, the settings (flag) values are not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1143683"> </a>
[<code class="cCode">TPEPERM</code>]
</h4><div class="pDefPara"><a name="wp1143684"> </a>
Permission failure. The cryptographic service provider was not able to access a private key for this principal, given the proof information and current environment.
</div>
<h4 class="pDefTerm"><a name="wp1143685"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1143686"> </a>
An error occurred. Consult the system error log file for details.
</div>
<h4 class="pHeading3"><a name="wp1163016"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1143697"> </a>
<a href="rf3cbl.html#wp1066533"><code class="cCode">TPKEYCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a>, <a href="rf3cbl.html#wp1066613"><code class="cCode">TPKEYSETINFO(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1066613"> </a>
TPKEYSETINFO(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1066614"> </a>
Name
</h4>
<p class="pBody"><a name="wp1066615"> </a>
<code class="cCode">TPKEYSETINFO()</code> - set optional parameters associated with a key handle
</p>
<h4 class="pHeading3"><a name="wp1066616"> </a>
Synopsis
</h4>
<a name="wp1066617"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPKEYDEF-REC</code>. <br />   COPY TPKEYDEF.<br /><br />0<code class="cCode">1 ATTVALUE-REC.<br /></code>   COPY user data<br /><br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>.<br />   COPY TPSTATUS.<br /><br />CALL &quot;TPKEYSETINFO&quot; USING <code class="cCodeEmphasis">TPKEYDEF-REC</code><code class="cCode"> ATTVALUE-REC </code><code class="cCodeEmphasis">TPSTATUS-REC</code>.</pre></div><h4 class="pHeading3"><a name="wp1066618"> </a>
Description
</h4>
<p class="pBody"><a name="wp1066619"> </a>
<code class="cCode">TPKEYSETINFO()</code> sets an optional attribute parameter for a key handle. A key handle represents a specific principal&#8217;s key and the information associated with it.
</p>
<p class="pBody"><a name="wp1249534"> </a>
The key for which information is to be modified is identified by <code class="cCodeEmphasis">KEY-HANDLE</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. <code class="cCodeEmphasis">KEY-HANDLE</code> is a key identifier returned by a previous call to <code class="cCode">TPKEYOPEN()</code>.
</p>
<p class="pBody"><a name="wp1249535"> </a>
The attribute for which information is to be modified is identified by <code class="cCodeEmphasis">ATTRIBUTE-NAME</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code>. The attribute name may be padded with <code class="cCode">SPACES</code> or <code class="cCode">LOW-VALUES</code>. Some attributes may be specific to a certain cryptographic service provider, but the core set of attributes presented on the <a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a> reference page should be supported by all providers.
</p>
<p class="pBody"><a name="wp1249594"> </a>
The information in user-defined <code class="cCode">ATTVALUE-REC</code> is to be associated with <code class="cCodeEmphasis">ATTRIBUTE-NAME</code>. Upon successful completion of <code class="cCode">TPKEYSETINFO()</code>, the information in <code class="cCode">ATTVALUE-REC</code> is stored or processed in a manner defined by the cryptographic service provider. If the data content of <code class="cCode">ATTVALUE-REC</code> is self-describing, <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code> in <code class="cCodeEmphasis">TPKEYDEF-REC</code> is ignored (and may be 0). Otherwise, <code class="cCodeEmphasis">ATTRIBUTE-VALUE-LEN</code> must contain the length of data in <code class="cCode">ATTVALUE-REC</code>.
</p>
<h4 class="pHeading3"><a name="wp1066623"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1066624"> </a>
Upon successful completion, <code class="cCode">TPKEYSETINFO()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to [<code class="cCode">TPOK</code>]. 
</p>
<h4 class="pHeading3"><a name="wp1066625"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1066626"> </a>
Upon failure, <code class="cCode">TPKEYSETINFO()</code> sets <code class="cCodeEmphasis">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1066627"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1066628"> </a>
Invalid arguments were given. For example, <code class="cCodeEmphasis">KEY-HANDLE</code> is not set correctly.
</div>
<h4 class="pDefTerm"><a name="wp1066629"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1066630"> </a>
An error occurred. Consult the system error log file for more details.
</div>
<h4 class="pDefTerm"><a name="wp1066631"> </a>
[<code class="cCode">TPELIMIT</code>]
</h4><div class="pDefPara"><a name="wp1066632"> </a>
The attribute value provided is too large.
</div>
<h4 class="pDefTerm"><a name="wp1066633"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1066634"> </a>
The requested attribute is not recognized by the key&#8217;s cryptographic service provider.
</div>
<h4 class="pHeading3"><a name="wp1066635"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1066636"> </a>
<a href="rf3cbl.html#wp1066533"><code class="cCode">TPKEYCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1066551"><code class="cCode">TPKEYGETINFO(3cbl)</code></a>, <a href="rf3cbl.html#wp1143651"><code class="cCode">TPKEYOPEN(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000626"> </a>
TPNOTIFY(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000627"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000628"> </a>
<code class="cCode">TPNOTIFY()</code> - send notification by client identifier
</p>
<h4 class="pHeading3"><a name="wp1000629"> </a>
Synopsis
</h4>
<a name="wp1000630"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPNOTIFY&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000631"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000632"> </a>
<code class="cCode">TPNOTIFY()</code> allows a server to send an unsolicited message to an individual client.
</p>
<p class="pBody"><a name="wp1000633"> </a>
<code class="cCode">CLIENTID</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code> contains a client identifier saved from the <code class="cCodeEmphasis">TPSVCDEF-REC</code> of a previous or current service invocation.
</p>
<p class="pBody"><a name="wp1000634"> </a>
<code class="cCodeEmphasis">DATA-REC</code> is the record to be sent and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies how much of <code class="cCodeEmphasis">DATA-REC</code> should be sent. If <code class="cCodeEmphasis">DATA-REC</code> is a record of type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a request is sent with no data portion.
</p>
<p class="pBody"><a name="wp1000635"> </a>
Upon successful return from <code class="cCode">TPNOTIFY()</code>, the message has been delivered to the system for forwarding to the identified client. If <code class="cCode">TPACK()</code> was set, then a successful return means the message has been received by the client. Furthermore, if the client has registered an unsolicited message handler, the handler will have been called.
</p>
<p class="pBody"><a name="wp1000636"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1000637"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000638"> </a>
The request is not sent if a blocking condition exists (for example, the internal buffers into which the message is transferred are full). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000639"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000640"> </a>
If a blocking condition exists in sending the notification, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000641"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1000642"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000643"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1000644"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000645"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000646"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000647"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000648"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000649"> </a>
<code class="cCode">TPACK</code> 
</h4><div class="pDefPara"><a name="wp1000650"> </a>
This setting signifies that the caller will block waiting for an acknowledgment from the client. Either <code class="cCode">TPNOACK()</code> or <code class="cCode">TPACK()</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000651"> </a>
<code class="cCode">TPNOACK</code> 
</h4><div class="pDefPara"><a name="wp1000652"> </a>
This setting signifies that the caller will not block waiting for an acknowledgment from the client. Either <code class="cCode">TPNOACK()</code> or <code class="cCode">TPACK()</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp1000653"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000654"> </a>
Upon successful completion, <code class="cCode">TPNOTIFY()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp1000655"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000656"> </a>
Under the following conditions, <code class="cCode">TPNOTIFY() </code>fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000657"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000658"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1000659"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1000660"> </a>
The target client does not exist and <code class="cCode">TPACK()</code> was set.
</div>
<h4 class="pDefTerm"><a name="wp1000661"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1000662"> </a>
A blocking timeout occurred. A blocking timeout can occur under either of the following circumstances: (a)<code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified, or (b) <code class="cCode">TPACK</code> and <code class="cCode">TPTIME</code> are specified (in which case no acknowledgment is received).
</div>
<h4 class="pDefTerm"><a name="wp1000663"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1000664"> </a>
A blocking condition was found on sending the notification and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1000665"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1000666"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1000667"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000668"> </a>
<code class="cCode">TPNOTIFY()</code> was called in an improper context (for example, within a client).
</div>
<h4 class="pDefTerm"><a name="wp1000669"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000670"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000671"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000672"> </a>
An operating system error has occurred.
</div>
<h4 class="pDefTerm"><a name="wp1000673"> </a>
[<code class="cCode">TPERELEASE</code>] 
</h4><div class="pDefPara"><a name="wp1000674"> </a>
When <code class="cCode">TPACK()</code> is specified and the target is a client from a prior release of the Oracle Tuxedo system that does not support the acknowledgment protocol.
</div>
<h4 class="pHeading3"><a name="wp1000675"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000676"> </a>
<a href="rf3cbl.html#wp998826"><code class="cCode">TPBROADCAST(3cbl)</code></a>, <a href="rf3cbl.html#wp999231"><code class="cCode">TPCHKUNSOL(3cbl)</code></a>, <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp1047466"><code class="cCode">TPSETUNSOL(3cbl)</code></a>, <a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000732"> </a>
TPOPEN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000733"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000734"> </a>
<code class="cCode">TPOPEN()</code> - open the Oracle Tuxedo ATMI resource manager
</p>
<h4 class="pHeading3"><a name="wp1000735"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1000736"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPOPEN&quot; USING </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp1000737"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000738"> </a>
<code class="cCode">TPOPEN()</code> opens the resource manager to which the caller is linked. At most one resource manager can be linked to the caller. This routine is used in place of resource manager-specific <code class="cCode">open()</code> calls and allows a service routine to be free of calls that may hinder portability. Since resource managers differ in their initialization semantics, the specific information needed to open a particular resource manager is placed in a configuration file.
</p>
<p class="pBody"><a name="wp1000739"> </a>
If a resource manager is already open (that is, <code class="cCode">TPOPEN()</code> is called more than once), no action is taken and success is returned.
</p>
<h4 class="pHeading3"><a name="wp1000740"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000741"> </a>
Upon successful completion, <code class="cCode">TPOPEN()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. More information concerning the reason a resource manager failed to open can be gotten by interrogating the resource manager in its own specific manner. Note that any calls to determine the exact nature of a resource manager&#8217;s error hinder portability.
</p>
<h4 class="pHeading3"><a name="wp1000742"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000743"> </a>
Under the following conditions, <code class="cCode">TPOPEN()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1000744"> </a>
[<code class="cCode">TPERMERR</code>] 
</h4><div class="pDefPara"><a name="wp1000745"> </a>
A resource manager failed to open correctly. More information concerning the reason a resource manager failed to open can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1000746"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000747"> </a>
<code class="cCode">TPOPEN()</code> was called in an improper context (for example, by a client that has not joined an Oracle Tuxedo ATMI server group).
</div>
<h4 class="pDefTerm"><a name="wp1000748"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000749"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000750"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000751"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000752"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000753"> </a>
<a href="rf3cbl.html#wp999299"><code class="cCode">TPCLOSE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000793"> </a>
TPPOST(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000794"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000795"> </a>
<code class="cCode">TPPOST()</code> - post an event
</p>
<h4 class="pHeading3"><a name="wp1000796"> </a>
Synopsis
</h4>
<a name="wp1000797"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPEVTDEF-REC</code><code class="cCode">.<br /> COPY TPEVTDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPPOST&quot; USING </code><code class="cCodeEmphasis">TPEVTDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000798"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000799"> </a>
The caller uses <code class="cCode">TPPOST()</code> to post an event and any accompanying data. The event is named by <code class="cCode">EVENT-NAME</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> and <code class="cCodeEmphasis">DATA-REC</code> contains the data to be posted. The posted event and its data are dispatched by the Oracle Tuxedo EventBroker to all subscribers whose subscriptions successfully evaluate against <code class="cCode">EVENT-NAME</code> and whose optional filter rules successfully evaluate against <code class="cCodeEmphasis">DATA-REC</code>.
</p>
<p class="pBody"><a name="wp1000800"> </a>
<code class="cCode">EVENT-NAME</code> must be 31 characters or less, but cannot be <code class="cCode">SPACES</code>. <code class="cCode">EVENT-NAME</code>&#8217;s first character cannot be a dot (&#8220;.&#8221;) as this character is reserved as the starting character for all events defined by the Oracle Tuxedo system itself.
</p>
<p class="pBody"><a name="wp1000801"> </a>
<code class="cCodeEmphasis">DATA-REC</code> is the typed record to be posted and <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> specifies the amount of data in <code class="cCodeEmphasis">DATA-REC</code> that should be posted with the event. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be 0). If <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does require a length to be specified, then <code class="cCode">LEN</code> must not be 0 (if it is 0, no data will be posted). If <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and the event is posted with no data.
</p>
<p class="pBody"><a name="wp1000802"> </a>
When <code class="cCode">TPPOST()</code> is used within a transaction, the transaction boundary can be extended to include those servers and/or stable-storage message queues notified by the EventBroker. When a transactional posting is made, some of the recipients of the event posting are notified on behalf of the poster&#8217;s transaction (for example, servers and queues), while some are not (for example, clients).
</p>
<p class="pBody"><a name="wp1000803"> </a>
If the poster is within a transaction and <code class="cCode">TPTRAN</code> is set, the posted event goes to the EventBroker in transaction mode such that it dispatches the event as part of the poster&#8217;s transaction. The broker dispatches transactional event notifications only to those service routine and stable-storage queue subscriptions that had <code class="cCode">TPEVTRAN</code> set in <code class="cCodeEmphasis">TPEVTDEF-REC</code> when the subscription was made. Client notifications, and those service routine and stable-storage queue subscriptions that had <code class="cCode">TPEVNOTRAN</code> set in <code class="cCodeEmphasis">TPEVTDEF-REC</code> when the subscription was made, are also dispatched by the EventBroker but not as part of the posting process&#8217; transaction.
</p>
<p class="pBody"><a name="wp1000804"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPEVTDEF-REC</code>: 
</p>
<h4 class="pDefTerm"><a name="wp1000805"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1000806"> </a>
If the caller is in transaction mode and this setting is used, then the event posting is not made on behalf of the caller&#8217;s transaction. A caller in transaction mode that uses this setting is still subject to the transaction timeout (and no other). If the event posting fails, the caller&#8217;s transaction is not affected. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000807"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp1000808"> </a>
If the caller is in transaction mode and this setting is used, then the event posting is made on behalf of the caller&#8217;s transaction. This setting is ignored if the caller is not in transaction mode. Either <code class="cCode">TPNOTRAN</code> or <code class="cCode">TPTRAN</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000809"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp1000810"> </a>
Informs <code class="cCode">TPPOST()</code> not to wait for the EventBroker to process all subscriptions for <code class="cCode">EVENT-NAME </code>before returning. When <code class="cCode">TPNOREPLY</code> is set, <code class="cCode">EVENT-COUNT</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is set to zero regardless of whether <code class="cCode">TPPOST()</code> returns successfully or not. When the caller is in transaction mode, this setting cannot be used when <code class="cCode">TPTRAN</code> is also set. Either <code class="cCode">TPNOREPLY</code> or <code class="cCode">TPREPLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000811"> </a>
<code class="cCode">TPREPLY</code> 
</h4><div class="pDefPara"><a name="wp1000812"> </a>
Informs <code class="cCode">TPPOST()</code> to wait for all subscriptions to be processed before returning. When <code class="cCode">TPREPLY</code> is set, the routine returns [<code class="cCode">TPOK</code>] on success and sets <code class="cCode">EVENT-COUNT</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> to the number of event notifications dispatched by the EventBroker on behalf of <code class="cCode">EVENT-NAME</code>. When the caller is in transaction mode, this setting must be used when <code class="cCode">TPTRAN</code> is also set. Either <code class="cCode">TPNOREPLY</code> or <code class="cCode">TPREPLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000813"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000814"> </a>
The event is not posted if a blocking condition exists. If such a condition occurs, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEBLOCK</code>]. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000815"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000816"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either<code class="cCode"> TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000817"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1000818"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000819"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1000820"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000821"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000822"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000823"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000824"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPGOTSIG</code>]. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp1000825"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000826"> </a>
Upon successful completion, <code class="cCode">TPPOST()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. In addition, <code class="cCode">EVENT-COUNT</code> contains the number of event notifications dispatched by the EventBroker on behalf of <code class="cCode">EVENT-NAME</code> (that is, postings for those subscriptions whose event expression evaluated successfully against <code class="cCode">EVENT-NAME</code> and whose filter rule evaluated successfully against <code class="cCodeEmphasis">DATA-REC</code>). Upon return where <code class="cCode">TP-STATUS</code> is set to [<code class="cCode">TPESVCFAIL</code>], <code class="cCode">EVENT-COUNT</code> contains the number of non-transactional event notifications dispatched by the EventBroker on behalf of <code class="cCode">EVENT-NAME</code>.
</p>
<h4 class="pHeading3"><a name="wp1000827"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000828"> </a>
Under the following conditions, <code class="cCode">TPPOST()</code> fails and sets <code class="cCode">TP-STATUS</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1000829"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000830"> </a>
Invalid arguments were given (for example,<code class="cCode"> EVENT-NAME</code> is <code class="cCode">SPACES</code>).
</div>
<h4 class="pDefTerm"><a name="wp1094949"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1094950"> </a>
Cannot access the Oracle Tuxedo User EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1094951"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1000834"> </a>
The caller is in transaction mode, <code class="cCode">TPTRAN</code> was set, and <code class="cCode">TPPOST()</code> contacted an EventBroker that does not support transaction propagation (that is, <a href="../rf5/rf5.html">TMUSREVT(5)</a> is not running in an Oracle Tuxedo ATMI group that supports transactions).
</div>
<h4 class="pDefTerm"><a name="wp1000835"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1272595"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPPOST()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1272596"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1272597"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1272598"> </a>
When <code class="cCode">TPPOST()</code> fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1000837"> </a>
[<code class="cCode">TPESVCFAIL</code>] 
</h4><div class="pDefPara"><a name="wp1000838"> </a>
The EventBroker encountered an error posting a transactional event to either a service routine or to a stable storage queue on behalf of the caller&#8217;s transaction. The caller&#8217;s current transaction is marked abort-only. When this error is returned, <code class="cCode">EVENT-COUNT</code> contains the number of non-transactional event notifications dispatched by the EventBroker on behalf of <code class="cCode">EVENT-NAME</code>; transactional postings are not counted since their effects will be aborted upon completion of the transaction. Note that so long as the transaction has not timed out, further communication may be performed before aborting the transaction and that any work performed on behalf of the caller&#8217;s transaction will be aborted upon transaction completion (that is, for subsequent communication to have any lasting effect, it should be done with <code class="cCode">TPNOTRAN</code> set).
</div>
<h4 class="pDefTerm"><a name="wp1000839"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1000840"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1000841"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1000842"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1000843"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000844"> </a>
<code class="cCode">TPPOST()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1000845"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000846"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000847"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000848"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000849"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000850"> </a>
<a href="rf3cbl.html#wp1001590"><code class="cCode">TPSUBSCRIBE(3cbl)</code></a>, <a href="rf3cbl.html#wp1002132"><code class="cCode">TPUNSUBSCRIBE(3cbl)</code></a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1000927"> </a>
TPRECV(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1000928"> </a>
Name
</h4>
<p class="pBody"><a name="wp1000929"> </a>
<code class="cCode">TPRECV()</code> - receive a message in a conversational connection
</p>
<h4 class="pHeading3"><a name="wp1000930"> </a>
Synopsis
</h4>
<a name="wp1000931"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPRECV&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1000932"> </a>
Description
</h4>
<p class="pBody"><a name="wp1000933"> </a>
<code class="cCode">TPRECV()</code> is used to receive data sent across an open connection from another program. <code class="cCode">COMM-HANDLE</code>, specifies on which open connection to receive data. <code class="cCode">COMM-HANDLE</code> is a communications handle returned from either <code class="cCode">TPCONNECT()</code> or <code class="cCode">TPSVCSTART()</code>. <code class="cCodeEmphasis">DATA-REC</code> specifies where the message is read into, and, on input, <code class="cCode">LEN</code> indicates the maximum number of bytes that should be moved into <code class="cCodeEmphasis">DATA-REC</code>.
</p>
<p class="pBody"><a name="wp1000934"> </a>
Upon successful and for several event types, <code class="cCode">LEN</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">DATA-REC</code>. <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> contain the data&#8217;s type and subtype, respectively. If the message is larger than <code class="cCodeEmphasis">DATA-REC</code>, then <code class="cCodeEmphasis">DATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the reply is discarded and <code class="cCode">TPRECV()</code> sets <code class="cCode">TPTRUNCATE</code>.
</p>
<p class="pBody"><a name="wp1000935"> </a>
If <code class="cCode">LEN</code> is <code class="cCode">0</code> upon successful return, then the reply has no data portion and <code class="cCodeEmphasis">DATA-REC</code> was not modified. It is an error for <code class="cCode">LEN</code> to be <code class="cCode">0</code> on input.
</p>
<p class="pBody"><a name="wp1000936"> </a>
<code class="cCode">TPRECV()</code> can be issued only by the program that does not have control of the connection.
</p>
<p class="pBody"><a name="wp1000937"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1000938"> </a>
<code class="cCode">TPNOCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1000939"> </a>
When this setting is used, the type of <code class="cCodeEmphasis">DATA-REC</code> is not allowed to change. That is, the type and subtype of the message received must match <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, respectively. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000940"> </a>
<code class="cCode">TPCHANGE</code> 
</h4><div class="pDefPara"><a name="wp1000941"> </a>
The type and/or subtype of the message received is allowed to differ from those specified in <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, respectively, so long as the receiver recognizes the incoming record type. Either <code class="cCode">TPNOCHANGE</code> or <code class="cCode">TPCHANGE</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000942"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1000943"> </a>
<code class="cCode">TPRECV()</code> does wait for data to arrive. If data is already available to receive, then <code class="cCode">TPRECV()</code> gets the data and returns. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000944"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1073311"> </a>
When <code class="cCode">TPBLOCK</code> is specified and no data is available to receive, the caller blocks until data arrives. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1073312"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1000947"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts will still affect the program. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000948"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1000949"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000950"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000951"> </a>
If a signal interrupts the underlying receive system call, then the call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1000952"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1000953"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<div class="pDefParaCont"><a name="wp1000954"> </a>
If an event exists for the communications handle, <code class="cCode">COMM-HANDLE</code>, then <code class="cCode">TPRECV()</code> will return setting <code class="cCode">TP-STATUS</code> to <code class="cCode">TPEEVENT()</code>. The event type is returned in <code class="cCode">TPEVENT()</code>. Data can be received along with the <code class="cCode">TPEV-SVCSUCC</code>, <code class="cCode">TPEV-SVCFAIL</code>, and <code class="cCode">TPEV-SENDONLY</code> events. Valid events for <code class="cCode">TPRECV()</code> are as follows.
</div>
<h4 class="pDefTerm"><a name="wp1000955"> </a>
<code class="cCode">TPEV-DISCONIMM</code> 
</h4><div class="pDefPara"><a name="wp1000956"> </a>
Received by the subordinate of a conversation, this event indicates that the originator of the conversation has issued an immediate disconnect on the connection via <code class="cCode">TPDISCON()</code>, or an error occurred when the originator issued <code class="cCode">TPRETURN()</code> or <code class="cCode">TPCOMMIT()</code> with the connection still open. This event is also returned to the originator or subordinate when a connection is broken due to a communications error (for example, a server, machine, or network failure). Because this is an immediate disconnection notification (that is, abortive rather than orderly), data in transit may be lost. If the two programs were participating in the same transaction, then the transaction is marked abort-only. <code class="cCode">COMM-HANDLE</code> is no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp1000957"> </a>
<code class="cCode">TPEV-SENDONLY</code> 
</h4><div class="pDefPara"><a name="wp1000958"> </a>
The program on the other end of the connection has relinquished control of the connection. The recipient of this event is allowed to send data but cannot receive any data until it relinquishes control.
</div>
<h4 class="pDefTerm"><a name="wp1000959"> </a>
<code class="cCode">TPEV-SVCERR</code> 
</h4><div class="pDefPara"><a name="wp1000960"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">TPRETURN()</code>. <code class="cCode">TPRETURN()</code> encountered an errors that precluded the service from returning successfully. For example, bad arguments may have been passed to <code class="cCode">TPRETURN()</code> or <code class="cCode">TPRETURN()</code> may have been called while the service had open connections to other subordinates. Due to the nature of this event, any application-defined data or return code are not available. The connection has been torn down and <code class="cCode">COMM-HANDLE</code> is no longer valid. If this event occurred as part of the recipient&#8217;s transaction, then the transaction is marked as abort-only.
</div>
<h4 class="pDefTerm"><a name="wp1000961"> </a>
<code class="cCode">TPEV-SVCFAIL</code> 
</h4><div class="pDefPara"><a name="wp1000962"> </a>
Received by the originator of a conversation, this event indicates that the subordinate service on the other end of the conversation has finished unsuccessfully as defined by the application (that is, it called <code class="cCode">TPRETURN()</code> with <code class="cCode">TPFAIL()</code> or <code class="cCode">TPEXIT()</code>). If the subordinate service was in control of this connection when <code class="cCode">TPRETURN()</code> was called, then it can pass an application-defined return value and a record back to the originator of the connection. As part of ending the service routine, the server has torn down the connection. Thus, <code class="cCode">COMM-HANDLE</code> is no longer valid. If this event occurred as part of the recipient&#8217;s transaction, then the transaction is marked abort-only.
</div>
<h4 class="pDefTerm"><a name="wp1000963"> </a>
<code class="cCode">TPEV-SVCSUCC</code> 
</h4><div class="pDefPara"><a name="wp1000964"> </a>
Received by the originator of a conversation, this event indicates that the subordinate service on the other end of the conversation has finished successfully as defined by the application (that is, it called <code class="cCode">TPRETURN()</code> with <code class="cCode">TPSUCCESS()</code>). As part of ending the service routine, the server has torn down the connection. Thus, <code class="cCode">COMM-HANDLE</code> is no longer valid. If the recipient is in transaction mode, then it can either commit (if it is also the initiator) or abort the transaction causing the work done by the server (if also in transaction mode) to either commit or abort.
</div>
<h4 class="pHeading3"><a name="wp1000965"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1000966"> </a>
Upon successful completion, <code class="cCode">TPRECV()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. When <code class="cCode">TP-STATUS</code> is set to [<code class="cCode">TPEEVENT</code>] and <code class="cCode">TPEVENT()</code> is either <code class="cCode">TPEV-SVCSUCC</code> or <code class="cCode">TPEV-SVCFAIL</code>, <code class="cCode">APPL-RETURN-CODE</code> contains an application-defined value that was sent as part of <code class="cCode">TPRETURN()</code>. If the size of the incoming message was larger then the size specified in <code class="cCode">LEN</code> on input, <code class="cCode">TPTRUNCATE()</code> is set and only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">DATA-REC</code>, the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp1000967"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1000968"> </a>
Under the following conditions, <code class="cCode">TPRECV()</code> fails and sets <code class="cCode">TP-STATUS</code> to (unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists): 
</p>
<h4 class="pDefTerm"><a name="wp1000969"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1000970"> </a>
Invalid arguments were given (for example, settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> are invalid.
</div>
<h4 class="pDefTerm"><a name="wp1000971"> </a>
[<code class="cCode">TPEOTYPE</code>] 
</h4><div class="pDefPara"><a name="wp1000972"> </a>
Either the type of subtype of the incoming message are not known to the caller, or <code class="cCode">TPNOCHANGE</code> was set and <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code> do not match the type and subtype of the incoming message. If the conversation is part of the caller&#8217;s transaction, then the transaction is marked abort-only since the incoming message is discarded.
</div>
<h4 class="pDefTerm"><a name="wp1000973"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp1000974"> </a>
<code class="cCode">COMM-HANDLE</code> contains an invalid communications handle.
</div>
<h4 class="pDefTerm"><a name="wp1000975"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1272624"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPRECV()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1272625"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.) In either case, no changes are made to <code class="cCodeEmphasis">DATAREC</code>.
<a name="wp1272626"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1272627"> </a>
When an ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1000977"> </a>
[<code class="cCode">TPEEVENT</code>] 
</h4><div class="pDefPara"><a name="wp1000978"> </a>
An event occurred and its type is available in <code class="cCode">TPEVENT()</code>.
</div>
<h4 class="pDefTerm"><a name="wp1000979"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1000980"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1000981"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1000982"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1000983"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1000984"> </a>
<code class="cCode">TPRECV()</code> was called in an improper context (for example, the connection was established such that the calling program can only send data).
</div>
<h4 class="pDefTerm"><a name="wp1000985"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1000986"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1000987"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1000988"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1000989"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1000990"> </a>
A server can pass an application-defined return value and typed record when calling <code class="cCode">TPRETURN()</code>. The return value is available in <code class="cCode">APPL-RETURN-CODE</code> and the record is available in <code class="cCodeEmphasis">DATA-REC</code>.
</p>
<h4 class="pHeading3"><a name="wp1000991"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1000992"> </a>
<a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp999791"><code class="cCode">TPDISCON(3cbl)</code></a>, <a href="rf3cbl.html#wp1001318"><code class="cCode">TPSEND(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001071"> </a>
TPRESUME(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001072"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001073"> </a>
<code class="cCode">TPRESUME()</code> - resume a global transaction
</p>
<h4 class="pHeading3"><a name="wp1001074"> </a>
Synopsis
</h4>
<a name="wp1001075"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPTRXDEF-REC</code>.<br /> COPY TPTRXDEF. <br /> <br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPRESUME&quot; USING <code class="cCodeEmphasis">TPTRXDEF-REC TPSTATUS-REC</code>. </pre></div><h4 class="pHeading3"><a name="wp1001076"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001077"> </a>
<code class="cCode">TPRESUME()</code> is used to resume work on behalf of a previously suspended transaction. Once the caller resumes work on a transaction, it must either suspend it with <code class="cCode">TPSUSPEND()</code>, or complete it with one of <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> at a later time.
</p>
<p class="pBody"><a name="wp1001078"> </a>
The caller must ensure that its linked resource managers have been opened (via <code class="cCode">TPOPEN()</code>) before it can resume work on any transaction.
</p>
<p class="pBody"><a name="wp1001079"> </a>
<code class="cCode">TPRESUME()</code> places the caller in transaction mode on behalf of the global transaction identifier contained in <code class="cCode">TRANID()</code>.
</p>
<h4 class="pHeading3"><a name="wp1001080"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1001081"> </a>
Upon successful completion, <code class="cCode">TPRESUME()</code> sets [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp1001082"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001083"> </a>
Under the following conditions, <code class="cCode">TPRESUME()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001084"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001085"> </a>
Either <code class="cCode">TRANID()</code> contains a non-existent transaction identifier (including previously completed or timed-out transactions), or it contains a transaction identifier that the caller is not allowed to resume. The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1001086"> </a>
[<code class="cCode">TPEMATCH</code>] 
</h4><div class="pDefPara"><a name="wp1001087"> </a>
<code class="cCode">TRANID()</code> contains a transaction identifier that another program has already resumed. The caller&#8217;s state with respect to the transaction is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1001088"> </a>
[<code class="cCode">TPETRAN</code>] 
</h4><div class="pDefPara"><a name="wp1001089"> </a>
The Oracle Tuxedo system is unable to resume the global transaction because the caller is currently participating in work outside any global transaction with one or more resource managers. All such work must be completed before a global transaction can be resumed. The caller&#8217;s state with respect to the local transaction is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1001090"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001091"> </a>
<code class="cCode">TPRESUME()</code> was called in an improper context (for example, the caller is already in transaction mode). The caller&#8217;s state with respect to transaction mode is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1001092"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001093"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001094"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001095"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001096"> </a>
Notes
</h4>
<p class="pBody"><a name="wp1001097"> </a>
XA-compliant resource managers must be successfully opened to be included in the global transaction. (See <code class="cCode">TPOPEN()</code> for details.)
</p>
<p class="pBody"><a name="wp1001098"> </a>
A program resuming a suspended transaction must reside on the same logical machine (<code class="cCode">LMID</code>) as the program that suspended the transaction. For a Workstation client, the workstation handler (WSH) to which it is connected must reside on the same logical machine as the handler for the Workstation client that suspended the transaction.
</p>
<h4 class="pHeading3"><a name="wp1001099"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001100"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001740"><code class="cCode">TPSUSPEND(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001140"> </a>
TPRETURN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001141"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001142"> </a>
<code class="cCode">TPRETURN()</code> - returns from an Oracle Tuxedo ATMI service routine
</p>
<h4 class="pHeading3"><a name="wp1001143"> </a>
Synopsis
</h4>
<a name="wp1001144"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCRET-REC</code><code class="cCode">.<br /> COPY TPSVCRET. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />COPY TPRETURN REPLACING TPSVCRET-REC BY </code><code class="cCodeEmphasis">TPSVCRET-REC<br /></code><code class="cCode"> <br /> TPTYPE-REC BY </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> <br /> DATA-REC BY </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> T<br /> PSTATUS-REC BY </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001145"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001146"> </a>
<code class="cCode">TPRETURN()</code> indicates that a service routine has completed. Since <code class="cCode">TPRETURN()</code> contains an <code class="cCode">EXIT PROGRAM</code> statement, it should be called from within the same routine that was invoked to ensure correct return of control to the Oracle Tuxedo ATMI dispatcher (that is, <code class="cCode">TPRETURN()</code> should not be invoked in a sub-program of the service routine since control would not return to the Oracle Tuxedo ATMI dispatcher).
</p>
<p class="pBody"><a name="wp1001147"> </a>
<code class="cCode">TPRETURN()</code> is used to send a service&#8217;s reply message. If the service receiving the reply is waiting in either <code class="cCode">TPCALL()</code>, <code class="cCode">TPGETRPLY()</code>, or <code class="cCode">TPRECV()</code>, then after a successful call to <code class="cCode">TPRETURN()</code>, the reply is available in the receiver&#8217;s record.
</p>
<p class="pBody"><a name="wp1001148"> </a>
For conversational services, <code class="cCode">TPRETURN()</code> also tears down the connection. That is the service routine cannot call <code class="cCode">TPDISCON()</code> directly. To ensure correct results, the program that connected to the conversation service should not call <code class="cCode">TPDISCON()</code>; rather, it should wait for notification that the conversational service has completed (that is, it should wait for one of the events, like <code class="cCode">TPEV-SVCSUCC</code> or <code class="cCode">TPEV-SVCFAIL</code>. sent by <code class="cCode">TPRETURN()</code>).
</p>
<p class="pBody"><a name="wp1001149"> </a>
If a service routine was in transaction mode, <code class="cCode">TPRETURN()</code> places the service&#8217;s portion of the transaction in a state from which it may be either committed or aborted when the transaction is completed. A service may be invoked multiple times as part of the same transaction so it is not necessarily fully committed nor aborted until either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code> is called by the originator of the transaction.
</p>
<p class="pBody"><a name="wp1001150"> </a>
<code class="cCode">TPRETURN()</code> should be called after receiving all replies expected from request/response service requests initiated by the service routine. Otherwise, depending on the nature of the service, either a [<code class="cCode">TPESVCERR</code>] status or a <code class="cCode">TPEV-SVCERR</code> event will be returned to the program that initiated communications with the service routine. Any outstanding replies which are not received will automatically be dropped by the Oracle Tuxedo ATMI dispatcher upon receipt. In addition, the communications handle for those replies become invalid.
</p>
<p class="pBody"><a name="wp1001151"> </a>
<code class="cCode">TPRETURN()</code> should also be called after closing all connections initiated by the service. Otherwise, depending on the nature of the service, either a [<code class="cCode">TPESVCERR</code>] status or a <code class="cCode">TPEV-SVCERR</code> event will be returned to the program that initiated communications with the service routine. Also, an immediate disconnect event (that is, <code class="cCode">TPEV-DISCONIMM)</code> is sent over all open connections to subordinates.
</p>
<p class="pBody"><a name="wp1001152"> </a>
Concerning control of a connection, if the service routine does not have control over the connection with which it was invoked when it issued <code class="cCode">TPRETURN()</code>, then two outcomes are possible. First, if the service routine calls <code class="cCode">TPRETURN()</code> with <code class="cCode">TP-RETURN-VAL IN</code> <code class="cCodeEmphasis">TPSVCRET-REC</code> set to <code class="cCode">TPFAIL()</code> and <code class="cCode">REC-TYPE IN</code> <code class="cCodeEmphasis">TPTYPE-REC</code> set to <code class="cCode">SPACES</code> (that is, no data is sent), then a <code class="cCode">TPEV-SVCFAIL</code> event is sent to the originator of this conversation. Second, if any other invocation of <code class="cCode">TPRETURN()</code> is used, a <code class="cCode">TPEV-SVCERR</code> event is sent to the originator.
</p>
<p class="pBody"><a name="wp1001153"> </a>
Since a conversational service has only one open connection which it did not initiate, the server knows over which communications handle the data (and any event) should be sent. For this reason, a communication handle is not passed to <code class="cCode">TPRETURN()</code>.
</p>
<p class="pBody"><a name="wp1001154"> </a>
The following is a description of the <code class="cCode">TPRETURN()</code> arguments. <code class="cCode">TP-RETURN-VAL</code> can be set to one of the following. 
</p>
<h4 class="pDefTerm"><a name="wp1001155"> </a>
<code class="cCode">TPSUCCESS</code> 
</h4><div class="pDefPara"><a name="wp1001156"> </a>
The service has terminated successfully. If data is present, then it will be sent (barring any failures processing the return). If the caller is in transaction mode, then <code class="cCode">TPRETURN()</code> places the caller&#8217;s portion of the transaction in a state such that it can be committed when the transaction ultimately commits. Note that a call to <code class="cCode">TPRETURN()</code> does not necessarily finalize an entire transaction. Also, even though the caller indicates success, if there are any outstanding replies or open connections, if any work done within the service caused its transaction to be marked abort-only, then a failed message is sent (that is, the recipient of the reply receives a <code class="cCode">TPESVCERR()</code> indication or a <code class="cCode">TPEV-SVCERR</code> event). Note that if a transaction becomes abort-only while in the service routine for any reason, then <code class="cCode">TP-RETURN-VAL</code> should be set to <code class="cCode">TPFAIL()</code>. If <code class="cCode">TPSUCCESS()</code> is specified for a conversational service, a <code class="cCode">TPEV-SVCSUCC</code> event is generated.
</div>
<h4 class="pDefTerm"><a name="wp1001157"> </a>
<code class="cCode">TPFAIL</code> 
</h4><div class="pDefPara"><a name="wp1001158"> </a>
The service has terminated unsuccessfully from an application standpoint. An error will be reported to the program receiving the reply. That is, the call to get the reply will fail and the recipient receives a [<code class="cCode">TPSVCERR</code>] indication or a <code class="cCode">TPEV-SVCERR</code> event. If the caller is in transaction mode, then <code class="cCode">TPRETURN()</code> marks the transaction as abort-only (note that the transaction may already be marked abort-only). Barring any failures in processing the return, the caller&#8217;s data is sent, if present. One reason for not sending the caller&#8217;s data is when a transaction timeout has occurred. In this case, the program waiting for the reply will receive an error of [<code class="cCode">TPETIME</code>].
</div>
<h4 class="pDefTerm"><a name="wp1001159"> </a>
<code class="cCode">TPEXIT</code> 
</h4><div class="pDefPara"><a name="wp1001160"> </a>
This value is the same as <code class="cCode">TPFAIL()</code>, with respect to completing the service, but the server will exit after the transaction is marked as abort-only and the reply is sent back to the requester. If the server is restartable, then the server will automatically be restarted.
</div>
<p class="pBody"><a name="wp1001161"> </a>
If <code class="cCode">TP-RETURN-VAL</code> is not set to one of these three values, then it defaults to <code class="cCode">TPFAIL()</code>.
</p>
<p class="pBody"><a name="wp1001162"> </a>
An application-defined return code, <code class="cCode">APPL-CODE</code> in <code class="cCodeEmphasis">TPSVCRET-REC</code>, may be sent to the program receiving the service reply. This code is sent regardless of the setting of <code class="cCode">TP-RETURN-VAL</code> as long as a reply can be successfully sent (that is, as long as the receiving call returns success or [<code class="cCode">TPESVCFAIL</code>], or receives one of the events <code class="cCode">TPEV-SVCSUCC</code> or <code class="cCode">TPEV-SVCFAIL</code>). The value of <code class="cCode">APPL-CODE</code> is available in the receiver in the variable, <code class="cCode">APPL-RETURN-CODE</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code>.
</p>
<p class="pBody"><a name="wp1001163"> </a>
<code class="cCodeEmphasis">DATA-REC</code> is a record to be sent and <code class="cCode">LEN</code> specifies the amount of <code class="cCodeEmphasis">DATA-REC</code> that should be sent. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of type and subtype that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored. In this case, if a reply is expected by the program that invokes the service, then a reply is sent with no data portion. If no reply is expected, then <code class="cCode">TPRETURN()</code> ignores any data passed to it and returns sending no reply. If <code class="cCode">REC-TYPE</code> is <code class="cCode">STRING</code> and <code class="cCode">LEN</code> is <code class="cCode">0</code>, then the request is sent with no data portion.
</p>
<p class="pBody"><a name="wp1001164"> </a>
If the service is conversational, there are several cases in which the application return code and the data portion are not transmitted: 
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1001166"> </a>If the connection has been terminated when the call is made (that is, the caller has received <code class="cCode">TPEV-DISCONIMM</code> on the connection), then this call simply ends the service routine and rolls back the current transaction, if one exists. In this case, the caller&#8217;s data record cannot be transmitted.</li>
<li><a name="wp1001168"> </a>If the caller does not have control of the connection, either <code class="cCode">TPEV-SVCERR</code> or <code class="cCode">TPEV-SVCFAIL</code> is sent to the originator of the connection as described above. Regardless of which event the originator receives, no data record is transmitted. If the originator receives the <code class="cCode">TPEV_SVCFAIL</code> event, however, the return code is available in the originator&#8217;s <code class="cCode">APPL-RETURN-CODE</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code>.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp1001169"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001170"> </a>
Because <code class="cCode">TPRETURN()</code> contains an <code class="cCode">EXIT PROGRAM</code> statement, no value is returned to the caller, nor does control return to the service routine. If a service routine returns without using <code class="cCode">TPRETURN()</code> (that is, it uses an <code class="cCode">EXIT PROGRAM</code> statement directly or just simply &#8220;falls out of the service routine&#8221;), the server will return a service error to the service requester. In addition, all open connections to subordinates will be disconnected immediately, and any outstanding asynchronous replies will be dropped. If the server was in transaction mode at the time of failure, the transaction is marked abort-only. Note also that if <code class="cCode">TPRETURN()</code> is used outside of a service routine (that is, by routines that are not services), then it returns having no effect.
</p>
<h4 class="pHeading3"><a name="wp1001171"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001172"> </a>
Errors encountered either in handling arguments or in processing cause <code class="cCode">TP-STATUS</code> to be set to [<code class="cCode">TPESVCERR</code>] for a program receiving the service&#8217;s outcome via either <code class="cCode">TPCALL()</code> or <code class="cCode">TPGETRPLY()</code>, and cause the event, <code class="cCode">TPEV-SVCERR</code>, to be sent over the conversation to a program using <code class="cCode">TPSEND()</code> or <code class="cCode">TPRECV()</code>.
</p>
<h4 class="pHeading3"><a name="wp1001174"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001175"> </a>
<a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1000056"><code class="cCode">TPFORWAR(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1353588"> </a>
TPRMCLOSE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1353589"> </a>
Name
</h4>
<p class="pBody"><a name="wp1353590"> </a>
<code class="cCode">TPRMCLOSE()</code> - Routine for closing a specified RM configured in a multiple RM server group.
</p>
<h4 class="pHeading3"><a name="wp1353591"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1355261"> </a>
<code class="cCode">01  TPRMDEF-REC.<br />	COPY TPRMDEF.<br />01  TPSTATUS-REC.<br />	COPY TPSTATUS.<br /><br />CALL &quot;TPRMCLOSE&quot; USING TPRMDEF-REC TPSTATUS-REC.</code>
</p>
<h4 class="pHeading3"><a name="wp1353593"> </a>
Description
</h4>
<p class="pBody"><a name="wp1353594"> </a>
<code class="cCode">TPCLOSERM()</code> closes a specified resource manager by the argument rmid. If current context is in a transaction context, this routine does nothing and returns to caller. 
</p>
<p class="pBody"><a name="wp1353595"> </a>
<code class="cCode">TPCLOSERM ()</code> can only close those resource manager opened via TPOPENRM() routine.
</p>
<h4 class="pHeading3"><a name="wp1353596"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1353597"> </a>
Upon successful completion, <code class="cCode">TPRMCLOSE()</code> sets <code class="cCode">TP-STATUS</code> to <code class="cCode">[TPOK]</code>.
</p>
<p class="pBody"><a name="wp1353598"> </a>
Upon failure, <code class="cCode">TPRMCLOSE()</code> leaves the calling process in it original context and sets TP-STATUS to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1353599"> </a>
Error
</h4>
<p class="pBody"><a name="wp1353600"> </a>
Under following conditions, <code class="cCode">TPRMOPEN()</code> fails and sets <code class="cCode">TP-STATUS</code> to:
</p>
<h4 class="pDefTerm"><a name="wp1353601"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp1353602"> </a>
A resource manager failed to close correctly. More information concerning the reason a resource manager failed to close can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1353603"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1353604"> </a>
<code class="cCode">TPRMCLOSE() </code>was called in a improper context (for example, by a client which has not associated an Oracle Tuxedo multiple resource managers server group, it is invoked by a server which is not in a multiple resource managers server group, the specified resource manager by the parameter rmid is not opened via <code class="cCode">TPRMOPEN()</code> routine or current process is not built with <code class="cCode">-M</code> option in buildserver). 
</div>
<div class="pDefParaCont"><a name="wp1353605"> </a>
<code class="cCode">TPRMCLOSE() </code>is executed in a ongoing transaction context.
</div>
<h4 class="pDefTerm"><a name="wp1353606"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1353607"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">RMNAME</code> parameter is not a valid resource manager name configured in current multiple resource managers server group).
</div>
<h4 class="pDefTerm"><a name="wp1353608"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1353609"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1353610"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1353611"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1353612"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1353613"> </a>
<a href="rf3cbl.html#wp1000732"><code class="cHyperlinkCode">
TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp999299"><code class="cHyperlinkCode">
TPCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1354208"><code class="cHyperlinkCode">
TPRMOPEN(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1353615"> </a>
TPRMEND(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1353616"> </a>
Name
</h4>
<p class="pBody"><a name="wp1353617"> </a>
<code class="cCode">TPRMEND()</code> - Routine for ending current work performed on behalf of a transaction branch in a specified RM.
</p>
<h4 class="pHeading3"><a name="wp1353618"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1355313"> </a>
<code class="cCode">01  TPRMDEF-REC.<br />	COPY TPRMDEF.<br />01  TPSTATUS-REC.<br />	COPY TPSTATUS.<br />CALL &quot;TPRMEND&quot; USING TPRMDEF-REC TPSTATUS-REC.</code>
</p>
<h4 class="pHeading3"><a name="wp1355314"> </a>
Description
</h4>
<p class="pBody"><a name="wp1353621"> </a>
<code class="cCode">TPRMEND()</code> ends current work performed on behalf of a transaction branch in a specified RM. This routine informs the resource manager to disassociate with the transaction branch. If current RM is still not opened or current context is not in a transaction state, <code class="cCode">TPRMEND ()</code> does nothing and set <code class="cCode">TP-STATUS</code> to error. 
</p>
<h4 class="pHeading3"><a name="wp1353622"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1353623"> </a>
Upon successful completion, <code class="cCode">TPRMEND()</code> sets <code class="cCode">TP-STATUS</code> to [TPOK].
</p>
<p class="pBody"><a name="wp1353624"> </a>
Upon failure, <code class="cCode">TPRMEND()</code> leaves the calling process in it original context and sets TP-STATUS to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1353625"> </a>
Error
</h4>
<p class="pBody"><a name="wp1353626"> </a>
Under following conditions, <code class="cCode">TPRMEND()</code> fails and sets <code class="cCode">TP-STATUS</code> to:
</p>
<h4 class="pDefTerm"><a name="wp1353627"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp1353628"> </a>
An error occurred in dissociating the transaction branch operation. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1353629"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1353630"> </a>
<code class="cCode">TPRMEND()</code> was called in a improper context(for example, by a client which has not associated with an Oracle Tuxedo multiple resource managers server group, it is invoked by a server which is not in a multiple resource managers server group, the specified resource manager by the parameter rmid is not opened via TMRMOPEN() routine or current process is not built with &quot;-M&quot; option in buildserver, or current context is not in a transaction mode). 
</div>
<h4 class="pDefTerm"><a name="wp1353631"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1353632"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">RMNAME</code> parameter is not a valid resource manager identifier configured in current multiple resource managers server group)
</div>
<p class="pBody"><a name="wp1353633"> </a>
<code class="cCode">[TPESYSTEM]</code>
</p>
<div class="pDefPara"><a name="wp1353634"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1353635"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1353636"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1354202"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1354206"> </a>
<a href="rf3cbl.html#wp1354208"><code class="cHyperlinkCode">
TPRMOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1353588"><code class="cHyperlinkCode">
TPRMCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1354024"><code class="cHyperlinkCode">
TPRMSTART(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1354208"> </a>
TPRMOPEN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1353641"> </a>
Name
</h4>
<p class="pBody"><a name="wp1353642"> </a>
<code class="cCode">TPRMOPEN()</code> - Routine for opening a specified RM configured in a multiple RM server group.
</p>
<h4 class="pHeading3"><a name="wp1353643"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1353644"> </a>
<code class="cCode">01  TPRMDEF-REC.<br />	COPY TPRMDEF.<br />01 TPSTATUS-REC.<br />	COPY TPSTATUS.<br />CALL &quot;TPRMOPEN&quot; USING TPRMDEF-REC TPSTATUS-REC.</code>
</p>
<h4 class="pHeading3"><a name="wp1353645"> </a>
Description
</h4>
<p class="pBody"><a name="wp1353646"> </a>
<code class="cCode">TPRMOPEN()</code> opens a specified RM configured in a multiple RMs server. If current context is in a transaction, this routine also informs the opened RM to join this transaction work unit on behalf of a transaction branch. If current RM is already opened, then this routine skips the open operation and tries to inform the RM to join this transaction work unit when this routine is invoked in a transaction context.
</p>
<h4 class="pHeading3"><a name="wp1353647"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1353648"> </a>
Upon successful completion, <code class="cCode">TPRMOPEN()</code> sets <code class="cCode">TP-STATUS</code> to <code class="cCode">[TPOK]</code>.
</p>
<p class="pBody"><a name="wp1353649"> </a>
Upon failure, <code class="cCode">TPRMOPEN()</code> leaves the calling process in it original context and sets <code class="cCode">TP-STATUS </code>to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1353650"> </a>
Error
</h4>
<p class="pBody"><a name="wp1353651"> </a>
Under following conditions, <code class="cCode">TPRMOPEN()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1353652"> </a>
<code class="cCode">[TPERMERR</code>]
</h4><div class="pDefPara"><a name="wp1353653"> </a>
A resource manager failed to open correctly. More information concerning the reason a resource manager failed to open can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1353654"> </a>
<code class="cCode">[TPEPROTO</code>]
</h4><div class="pDefPara"><a name="wp1353655"> </a>
<code class="cCode">TPRMOPEN()</code> has been called in a improper context(for example, by a client which has not associated with an Oracle Tuxedo Multiple RMs server group? it is invoked by a server which is not in a Multiple RMs server group or current process is not built with &quot;-M&quot; option in buildserver).
</div>
<h4 class="pDefTerm"><a name="wp1353656"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1353657"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">RMNAME</code> is not a valid resource manager identifier configured in Multiple RMs server group). 
</div>
<div class="pDefParaCont"><a name="wp1353658"> </a>
The other case is this RM is not a CAE specification of RM.
</div>
<h4 class="pDefTerm"><a name="wp1353659"> </a>
<code class="cCode">[TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1353660"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1353661"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1353662"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1354021"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1354022"> </a>
<a href="rf3cbl.html#wp1000732"><code class="cHyperlinkCode">
TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp999299"><code class="cHyperlinkCode">
TPCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1353588"><code class="cHyperlinkCode">
TPRMCLOSE(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1354024"> </a>
TPRMSTART(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1353667"> </a>
Name
</h4>
<p class="pBody"><a name="wp1353668"> </a>
<code class="cCode">TPRMSTART()</code> - Routine for starting work on behalf of a transaction branch of specified RM in a multiple RM server group.
</p>
<h4 class="pHeading3"><a name="wp1354108"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1354109"> </a>
<code class="cCode">01  TPRMDEF-REC.<br />	COPY TPRMDEF.<br />01  TPSTATUS-REC.<br />	COPY TPSTATUS.<br />CALL &quot;TPRMSTART&quot; USING TPRMDEF-REC TPSTATUS-REC.</code>
</p>
<h4 class="pHeading3"><a name="wp1353675"> </a>
Description
</h4>
<p class="pBody"><a name="wp1353676"> </a>
<code class="cCode">TPRMSTART()</code> informs the opened RM to join current transaction work unit on behalf of a transaction branch. If current RM is already in started state, then this routine skips the operation. If current RM is still not opened, <code class="cCode">TPRMSTART()</code> does nothing and sets <code class="cCode">TP-STATUS</code> to error condition.
</p>
<h4 class="pHeading3"><a name="wp1353677"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1353678"> </a>
Upon successful completion, <code class="cCode">TPRMSTART()</code> sets <code class="cCode">TP-STATUS</code> to <code class="cCode">[TPOK]</code>.
</p>
<p class="pBody"><a name="wp1353679"> </a>
Upon failure, <code class="cCode">TPRMSTART()</code> leaves the calling process in it original context and sets <code class="cCode">TP-STATUS</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1353680"> </a>
Error
</h4>
<p class="pBody"><a name="wp1353681"> </a>
Under following conditions, <code class="cCode">TPRMOPEN()</code> fails and sets <code class="cCode">TP-STATUS</code> to:
</p>
<h4 class="pDefTerm"><a name="wp1353682"> </a>
<code class="cCode">[TPERMERR]</code>
</h4><div class="pDefPara"><a name="wp1353683"> </a>
A resource manager failed to open correctly. More information concerning the reason a resource manager failed to open can be obtained by interrogating a resource manager in its own specific manner. Note that any calls to determine the exact nature of the error hinder portability.
</div>
<h4 class="pDefTerm"><a name="wp1353684"> </a>
<code class="cCode">[TPEPROTO]</code>
</h4><div class="pDefPara"><a name="wp1353685"> </a>
TPRMSTART() was called in a improper context (for example, by a client which has not associated with an Oracle Tuxedo Multiple RMs server group, it is invoked by a server which is not in a Multiple RMs server group or current process is not built with <code class="cCode">-M</code> option in buildserver, current RM is still not open).
</div>
<h4 class="pDefTerm"><a name="wp1353686"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1353687"> </a>
Invalid parameters were given (for example, the flags value is not 0, or the <code class="cCode">RMNAME</code> is not a valid resource manager name configured in Multiple RMs server group).
</div>
<h4 class="pDefTerm"><a name="wp1353688"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara2"><a name="wp1353689"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div><h4 class="pDefTerm"><a name="wp1353690"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1353691"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1353692"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1351112"> </a>
<a href="rf3cbl.html#wp1354208"><code class="cHyperlinkCode">
TPRMOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1353588"><code class="cHyperlinkCode">
TPRMCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1353615"><code class="cHyperlinkCode">
TPRMEND(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1344910"> </a>
TPSBLKTIME(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1302106"> </a>
Name
</h4>
<p class="pBody"><a name="wp1302107"> </a>
<code class="cCode">TPSBLKTIME()</code> - routine for setting blocktime in seconds for the next service call or for all service calls
</p>
<h4 class="pHeading3"><a name="wp1302108"> </a>
Synopsis
</h4>
<a name="wp1302109"> </a><div class="pPreformatted"><pre>01 TPBLKDEF-REC.<br />	COPY TPBLKDEF.<br />01 TPSTATUS-REC.<br />	COPY TPSTATUS.<br /><br />CALL &#8220;TPSBLKTIME&#8221; USING TPBLKDEF-REC TPSTATUS-REC.</pre></div><h4 class="pHeading3"><a name="wp1302110"> </a>
Description
</h4>
<p class="pBody"><a name="wp1302111"> </a>
<code class="cCode">TPSBLKTIME()</code> is used to set the blocktime value, in seconds, of a <span style="font-style: italic">potential blocking</span> API. A <span style="font-style: italic">potential blocking </span>API is defined as any system API that can use the flag <code class="cCode">TBNOBLOCK</code> as a value. It does not have any effect on transaction timeout values.
</p>
<p class="pBody"><a name="wp1302112"> </a>
<code class="cCode">BLKTIME </code>in <code class="cCode">TPBLKDEF-REC</code> sets blocking time in seconds. The blocktime range is 0 to 32767. A 0 blocktime value indicates that any previously set blocking time flag value is cancelled, and the blocking time set with a different blocktime flag value prevails. If <code class="cCode">TPSBLKTIME()</code> is not called, the <code class="cCode">BLOCKTIME</code> value in the <code class="cCode">*SERVICES</code> section or the default <code class="cCode">*RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file is used. 
</p>
<a name="wp1302113"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Blocking timeouts set with <code class="cCode">TPSBLKTIME()</code> take precedence over the <code class="cCode">BLOCKTIME parameter</code> set in the <code class="cCode">SERVICES</code> and <code class="cCode">RESOURCES</code> section of the <code class="cCode">UBBCONFIG</code> file. The precedence for blocktime checking is as follows:<br /><code class="cCode">TPSBLKTIME(TPBLK-NEXT)</code>, <code class="cCode">TPSBLKTIME(TPBLK-ALL)</code>, <code class="cCode">*SERVICES</code>, <code class="cCode">*RESOURCES</code></td>
</tr>
</table>

<p class="pBody"><a name="wp1302400"> </a>
Exactly one of the following values must be in <code class="cCode">TPBLKDEF-REC</code>:
</p>
<h4 class="pDefTerm"><a name="wp1302401"> </a>
<code class="cCode">TPBLK-NEXT</code>
</h4><div class="pDefPara"><a name="wp1302402"> </a>
Sets the blocktime value, in seconds, for the <span style="font-style: italic">next</span> potential blocking API. <br />Any API that is called containing the <code class="cCode">TPNOBLOCK</code> flag is not effected by <code class="cCode">TPSBLKTIME (TPBLK-NEXT)</code>and continues to be non-blocking.
</div>
<div class="pDefParaCont"><a name="wp1302403"> </a>
A <code class="cCode">TPBLK-NEXT</code> blocktime value overrides a <code class="cCode">TPBLK-ALL</code> blocktime value for those API calls that immediately follow it.
<a name="wp1302404"> </a>
<code class="cCode">TPSBLKTIME(TPBLK-NEXT)</code> operates on a <span style="font-style: italic">per-thread</span> basis. Therefore, it is not necessary for applications to use any mutex around the <code class="cCode">TPSBLKTIME(TPBLK-NEXT) call</code> and the subsequent API call which it affects.
</div>
<h4 class="pDefTerm"><a name="wp1302405"> </a>
<code class="cCode">TPBLK-ALL</code>
</h4><div class="pDefPara"><a name="wp1302406"> </a>
This flag sets the blocktime value, in seconds, for the <span style="font-style: italic">all </span>subsequent<span style="font-style: italic"> </span>potential blocking APIs until the next <code class="cCode">TPSBLKTIME()</code> is called within that context. Any API that is called containing the <code class="cCode">TPNOBLOCK</code> flag is not effected by <code class="cCode">TPSBLKTIME(TPBLK-ALL) and</code> continues to be non-blocking.
</div>
<div class="pDefParaCont"><a name="wp1302407"> </a>
<code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> operates on a <span style="font-style: italic">per-context</span> basis. Therefore, it is necessary to call <code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> in only one thread of context that is used in multiple threads.
<a name="wp1302411"> </a>
<code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> will not affect any context that follows after <a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a> is called.
</div>
<a name="wp1302412"> </a><table class="Note">
<tr>
<td valign="top"><strong>Notes:</strong></td>
<td>In order to perform blocking time values that are not affected by thread timing dependencies, it is best that <code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> is called in a multi-threaded context immediately after <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> using the <code class="cCode">TP-MULT-ICONTEXTS</code> flag and before the return value of <a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a> is made available to other threads.</td></tr>
</table>

<a name="wp1302422"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>When <code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> is called in a service on a multi-threaded server, it will affect the <span style="font-style: italic">currently </span>executed thread only. To set the blocktime for all services, it is best that you use <code class="cCode">TPSBLKTIME(TPBLK-ALL)</code> with <a href="rf3cbl.html#wp1268536"><code class="cCode">TPSVRINIT(3cbl)</code></a>.</td>
</tr>
</table>
<h4 class="pHeading3"><a name="wp1302426"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1302427"> </a>
Upon successful completion, <code class="cCode">TPSBLKTIME()</code> sets <code class="cCode">TP-STATUS</code> to <code class="cCode">[TPOK]</code>.
</p>
<h4 class="pHeading3"><a name="wp1302428"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1302429"> </a>
Under the following conditions, <code class="cCode">TPSBLKTIME</code> fails and sets <code class="cCode">TP-STATUS</code> to one of the following values. The failure does not affect transaction timeout values. 
</p>
<h4 class="pDefTerm"><a name="wp1302474"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1302475"> </a>
Invalid arguments were given. For example, a value other than <code class="cCode">TPBLK-NEXT</code> or <code class="cCode">TPBLK-ALL</code> was specified in <code class="cCode">TPBLKDEF-REC</code>.
</div>
<h4 class="pDefTerm"><a name="wp1302476"> </a>
[<code class="cCode">TPERELEASE</code>] 
</h4><div class="pDefParaCont"><a name="wp1302477"> </a>
<code class="cCode">TPSBLKTIME()</code> was called in a client attached to a workstation handler running an earlier Tuxedo release.
</div>
<h4 class="pDefTerm"><a name="wp1302478"> </a>
	[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1302479"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file. 
</div>
<h4 class="pHeading3"><a name="wp1302480"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1302496"> </a>
<a href="rf3cbl.html#wp998931">TPCALL(3cbl)</a>, <a href="rf3cbl.html#wp999450">TPCONNECT(3cbl)</a>, <a href="rf3cbl.html#wp1000927">TPRECV(3cbl)</a>, <a href="rf3cbl.html#wp1301314">TPGBLKTIME(3cbl)</a>, UBBCONFIG<a href="../rf5/rf5.html"></a>(5)
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001241"> </a>
TPSCMT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001242"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001243"> </a>
<code class="cCode">TPSCMT()</code> - set when <code class="cCode">TPCOMMIT</code> should return
</p>
<h4 class="pHeading3"><a name="wp1001244"> </a>
Synopsis
</h4>
<a name="wp1001245"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPCMTDEF-REC</code><code class="cCode">.<br /> COPY TPCMTDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPSCMT&quot; USING </code><code class="cCodeEmphasis">TPCMTDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001246"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001247"> </a>
<code class="cCode">TPSCMT()</code> sets the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic to the value specified in <code class="cCodeEmphasis">TPCMTDEF-REC</code>. The <code class="cCode">TP-COMMIT-CONTROL</code> characteristic affects the way <code class="cCode">TPCOMMIT()</code> behaves with respect to returning control to its caller. A program can call <code class="cCode">TPSCMT()</code> regardless of whether it is in transaction mode or not. Note that if the caller is participating in a transaction that another program must commit, then its call to <code class="cCode">TPSCMT()</code> does not affect that transaction. Rather, it affects subsequent transactions that the caller will commit.
</p>
<p class="pBody"><a name="wp1001248"> </a>
In most cases, a transaction is committed only when an Oracle Tuxedo ATMI program calls <code class="cCode">TPCOMMIT()</code>. There is one exception: when a service is dispatched in transaction mode because the <code class="cCode">AUTOTRAN</code> variable in the <code class="cCode">SERVICES</code> section of the <code class="cCode">UBBCONFIG</code> file is enabled, then the transaction completes upon calling <code class="cCode">TPRETURN()</code>. If <code class="cCode">TPFORWAR()</code> is called, then the transaction will be completed by the server ultimately calling <code class="cCode">TPRETURN()</code>. Thus, the setting of the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic in the service that calls <code class="cCode">TPRETURN()</code> determines when <code class="cCode">TPCOMMIT()</code> returns control within a server. If <code class="cCode">TPCOMMIT()</code> returns a heuristic error code, the server will write a message to a log file.
</p>
<p class="pBody"><a name="wp1001249"> </a>
When a client joins an Oracle Tuxedo ATMI application, the initial setting for this characteristic comes from a configuration file. (See the <code class="cCode">CMTRET</code> variable in the <code class="cCode">RESOURCES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>.)
</p>
<p class="pBody"><a name="wp1001250"> </a>
The following are the valid settings for <code class="cCodeEmphasis">TPCMTDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1001251"> </a>
<code class="cCode">TP-CMT-LOGGED</code> 
</h4><div class="pDefPara"><a name="wp1001252"> </a>
This setting indicates that <code class="cCode">TPCOMMIT()</code> should return after the commit decision has been logged by the first phase of the two-phase commit protocol but before the second phase has completed. This setting allows for faster response to the caller of <code class="cCode">TPCOMMIT()</code> although there is a risk that a transaction participant might decide to heuristically complete (that is, aborted) its work due to timing delays waiting for the second phase to complete. If this occurs, there is no way to indicate this situation to the caller since <code class="cCode">TPCOMMIT()</code> has already returned (although Oracle Tuxedo writes a message to a log file when a resource manager takes a heuristic decision). Under normal conditions, participants that promise to commit during the first phase will do so during the second phase. Typically, problems caused by network or site failures are the sources for heuristic decisions being made during the second phase.
</div>
<h4 class="pDefTerm"><a name="wp1001253"> </a>
<code class="cCode">TP-CMT-COMPLETE</code> 
</h4><div class="pDefPara"><a name="wp1001254"> </a>
This setting indicates that <code class="cCode">TPCOMMIT()</code> should return after the two-phase commit protocol has finished completely. This setting allows for <code class="cCode">TPCOMMIT()</code> to return an indication that a heuristic decision occurred during the second phase of commit.
</div>
<h4 class="pHeading3"><a name="wp1001255"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001256"> </a>
Upon successful completion, <code class="cCode">TPSCMT()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and returns the previous value of the <code class="cCode">TP-COMMIT-CONTROL</code> characteristic.
</p>
<h4 class="pHeading3"><a name="wp1001257"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001258"> </a>
Under the following conditions, <code class="cCode">TPSCMT()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001259"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001260"> </a>
<code class="cCodeEmphasis">TPCMTDEF-REC</code> is not set to <code class="cCode">TP-CMT-LOGGED</code> or <code class="cCode">TP-CMT-COMPLETE</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001261"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001262"> </a>
<code class="cCode">TPSCMT()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1001263"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001264"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001265"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001266"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001267"> </a>
Notices
</h4>
<p class="pBody"><a name="wp1001268"> </a>
When using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT()</code>, and <code class="cCode">TPABORT()</code> to delineate an Oracle Tuxedo ATMI transaction, it is important to remember that only the work done by a resource manager that meets the XA interface (and is linked to the caller appropriately) has transactional properties. All other operations performed in a transaction are not affected by either <code class="cCode">TPCOMMIT()</code> or <code class="cCode">TPABORT()</code>. See <a href="../rfcm/rfcmd.html">buildserver(1)</a> for details on linking resource managers that meet the XA interface into a server such that operations performed by that resource manager are part of an Oracle Tuxedo ATMI transaction.
</p>
<h4 class="pHeading3"><a name="wp1001269"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001270"> </a>
<a href="rf3cbl.html#wp998418"><code class="cCode">TPABORT(3cbl)</code></a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp999360"><code class="cCode">TPCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1044551"><code class="cCode">TPGETLEV(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001318"> </a>
TPSEND(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001319"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001320"> </a>
<code class="cCode">TPSEND()</code> - routine to send a message in a conversational connection
</p>
<h4 class="pHeading3"><a name="wp1001321"> </a>
Synopsis
</h4>
<a name="wp1001322"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPSEND&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001323"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001324"> </a>
<code class="cCode">TPSEND()</code> is used to send data across an open connection to another program. The caller must have control of the connection. <code class="cCode">COMM-HANDLE</code> specifies the open connection to send data over. <code class="cCode">COMM-HANDLE</code> is a communications handle returned from either <code class="cCode">TPCONNECT()</code> or <code class="cCode">TPSVCSTART()</code>.
</p>
<p class="pBody"><a name="wp1001325"> </a>
<code class="cCodeEmphasis">DATA-REC</code> contains the data to be sent and <code class="cCode">LEN</code> specifies how much of the data to send. Note that if <code class="cCodeEmphasis">DATA-REC</code> is a record of a type that does not require a length to be specified, then <code class="cCode">LEN</code> is ignored (and may be <code class="cCode">0</code>). If <code class="cCode">REC-TYPE</code> is <code class="cCode">SPACES</code>, <code class="cCodeEmphasis">DATA-REC</code> and <code class="cCode">LEN</code> are ignored and a message is sent with no data (this might be done, for instance, to grant control of the connection without transmitting any data).
</p>
<p class="pBody"><a name="wp1001326"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1001327"> </a>
<code class="cCode">TPRECVONLY</code> 
</h4><div class="pDefPara"><a name="wp1001328"> </a>
This setting signifies that, after the caller&#8217;s data is sent, the caller gives up control of the connection (that is, the caller cannot issue anymore <code class="cCode">TPSEND()</code> calls). When the receiver on the other end of the connection receives the data sent by <code class="cCode">TPSEND()</code>, it will also receive an event (<code class="cCode">TPEV-SENDONLY</code>) indicating that it has control of the connection (and cannot issue anymore <code class="cCode">TPRECV()</code> calls). Either <code class="cCode">TPRECVONLY</code> or <code class="cCode">TPSENDONLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001329"> </a>
<code class="cCode">TPSENDONLY</code> 
</h4><div class="pDefPara"><a name="wp1001330"> </a>
This setting signifies that the caller wants to remain in control of the connection. Either <code class="cCode">TPRECVONLY</code> or <code class="cCode">TPSENDONLY</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001331"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1001332"> </a>
The data and any events are not sent if a blocking condition exists (for example, the data buffers through which the message is sent are full). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001333"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1001334"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001335"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1001336"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts will still affect the program. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001337"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1001338"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001339"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1001340"> </a>
If a signal interrupts any underlying system calls, then the interrupted call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001341"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1001342"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted and the call fails. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<p class="pBody"><a name="wp1001343"> </a>
If an event exists for <code class="cCode">COMM-HANDLE</code>, then <code class="cCode">TPSEND()</code> will return without sending the caller&#8217;s data. The event type is returned in <code class="cCode">TPEVENT()</code>. Valid events for <code class="cCode">TPSEND()</code> are as follows. 
</p>
<h4 class="pDefTerm"><a name="wp1001344"> </a>
<code class="cCode">TPEV-DISCONIMM</code> 
</h4><div class="pDefPara"><a name="wp1001345"> </a>
Received by the subordinate of a conversation, this event indicates that the originator of the conversation has issued an immediate disconnect on the connection via <code class="cCode">TPDISCON()</code>, or the originator of the connection issued <code class="cCode">TPRETURN()</code> with open subordinate connections. This event is also returned to the originator or subordinate when a connection is broken due to a communications error (for example, a server, machine, or network failure).
</div>
<h4 class="pDefTerm"><a name="wp1001346"> </a>
<code class="cCode">TPEV-SVCFAIL</code> 
</h4><div class="pDefPara"><a name="wp1001347"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">TPRETURN()</code> without having control of the conversation. In addition. <code class="cCode">TPRETURN()</code> was issued with <code class="cCode">TPFAIL()</code> set and no data record (that is, the <code class="cCode">REC-TYPE</code> passed to <code class="cCode">TPRETURN()</code> was set to <code class="cCode">SPACES</code>).
</div>
<h4 class="pDefTerm"><a name="wp1001348"> </a>
<code class="cCode">TPEV-SVCERR</code> 
</h4><div class="pDefPara"><a name="wp1001349"> </a>
Received by the originator of a conversation, this event indicates that the subordinate of the conversation has issued <code class="cCode">TPRETURN()</code> without having control of the conversation. In addition, <code class="cCode">TPRETURN()</code> was issued in a manner different from that described for <code class="cCode">TPEV-SVCFAIL</code> below.
</div>
<p class="pBody"><a name="wp1001350"> </a>
Because each of these events indicates an immediate disconnection notification (that is, abortive rather than orderly), data in transit may be lost. The communications handle used for the connection is no longer valid. If the two programs were participating in the same transaction, then the transaction has been marked abort-only.
</p>
<h4 class="pHeading3"><a name="wp1001351"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001352"> </a>
Upon successful completion, <code class="cCode">TPSEND()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. If an event exists and no errors were encountered, <code class="cCode">TPSEND()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEEVENT</code>]. When <code class="cCode">TP-STATUS</code> is set to [<code class="cCode">TPEEVENT</code>] and <code class="cCode">TP-EVENT</code> is either <code class="cCode">TPEV-SVCSUCC</code> or <code class="cCode">TPEV-SVCFAIL</code>, <code class="cCode">APPL-RETURN-CODE</code> contains an application-defined value that was sent as part of <code class="cCode">TPRETURN()</code>.
</p>
<h4 class="pHeading3"><a name="wp1001353"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001354"> </a>
Under the following conditions, <code class="cCode">TPSEND()</code> fails and sets <code class="cCode">TP-STATUS</code> to (unless otherwise noted, failure does not affect caller&#8217;s transaction, if one exits): 
</p>
<h4 class="pDefTerm"><a name="wp1001355"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001356"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1001357"> </a>
[<code class="cCode">TPEBADDESC</code>] 
</h4><div class="pDefPara"><a name="wp1001358"> </a>
<code class="cCode">COMM-HANDLE</code> contains an invalid communications handle.
</div>
<h4 class="pDefTerm"><a name="wp1001359"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1280050"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPSEND()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1280051"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1280052"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1274504"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001361"> </a>
[<code class="cCode">TPEEVENT</code>] 
</h4><div class="pDefPara"><a name="wp1001362"> </a>
An event occurred and its type is available in <code class="cCode">TPEVENT()</code>. <code class="cCodeEmphasis">DATA-REC</code> is not sent when this error occurs.
</div>
<h4 class="pDefTerm"><a name="wp1001363"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1001364"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1001365"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1001366"> </a>
A signal was received and <code class="cCode">TPSIGRSTRT</code> was not specified.
</div>
<h4 class="pDefTerm"><a name="wp1001367"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001368"> </a>
<code class="cCode">TPSEND()</code> was called in an improper context (for example, the connection was established such that the calling program can only receive data).
</div>
<h4 class="pDefTerm"><a name="wp1001369"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001370"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001371"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001372"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001373"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001374"> </a>
<a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp999791"><code class="cCode">TPDISCON(3cbl)</code></a>, <a href="rf3cbl.html#wp1000927"><code class="cCode">TPRECV(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1047746"> </a>
TPSETCTXT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1047747"> </a>
Name
</h4>
<p class="pBody"><a name="wp1047748"> </a>
<code class="cCode">TPSETCTXT()</code> - sets a context identifier for the current application association
</p>
<h4 class="pHeading3"><a name="wp1047749"> </a>
Synopsis
</h4>
<a name="wp1047750"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPCONTEXTDEF-REC</code>.<br />   COPY TPCONTEXTDEF.</pre></div><a name="wp1047751"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPSTATUS-REC</code>.<br />   COPY TPSTATUS.</pre></div><a name="wp1047752"> </a><div class="pPreformatted"><pre>CALL &quot;TPSETCTXT&quot; USING TPCONTEXTDEF-REC TPSTATUS-REC.</pre></div><h4 class="pHeading3"><a name="wp1047753"> </a>
Description
</h4>
<p class="pBody"><a name="wp1047754"> </a>
<code class="cCode">TPSETCTXT()</code> defines the context in which the current program operates. (Multithreaded COBOL applications are not currently supported.) Subsequent Oracle Tuxedo calls reference the application indicated by <code class="cCodeEmphasis">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code>. The value of <code class="cCodeEmphasis">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code> should have been provided by a previous call to <code class="cCode">TPGETCTXT()</code>. If the value of <code class="cCodeEmphasis">CONTEXT</code> is <code class="cCode">TPNULLCONTEXT</code>, then the program is disassociated from any Oracle Tuxedo context. <code class="cCode">TPINVALIDCONTEXT</code> is not a valid input value for <code class="cCodeEmphasis">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code>.
</p>
<h4 class="pHeading3"><a name="wp1047755"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1047756"> </a>
Upon successful completion, <code class="cCode">TPSETCTXT()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<p class="pBody"><a name="wp1123513"> </a>
Upon failure, <code class="cCode">TPSETCTXT()</code> leaves the calling process in its original context and sets <code class="cCode">TP-STATUS</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1047757"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1047758"> </a>
Upon failure, <code class="cCode">TPSETCTXT()</code> sets <code class="cCode">TP-STATUS</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1047759"> </a>
[<code class="cCode">TPEINVAL</code>]
</h4><div class="pDefPara"><a name="wp1047760"> </a>
Invalid arguments have been given.
</div>
<h4 class="pDefTerm"><a name="wp1047761"> </a>
[<code class="cCode">TPENOENT</code>]
</h4><div class="pDefPara"><a name="wp1047762"> </a>
The value of <code class="cCodeEmphasis">CONTEXT</code> in <code class="cCode">TPCONTEXTDEF-REC</code> is not a valid context.
</div>
<h4 class="pDefTerm"><a name="wp1047763"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1047764"> </a>
<code class="cCode">TPSETCTXT()</code> has been called in an improper context. For example, it has been called in a process that has not called <code class="cCode">TPINITIALIZE()</code> or that has called <code class="cCode">TPINITIALIZE()</code> without specifying the <code class="cCode">TP-MULTI-CONTEXTS</code> setting.
</div>
<h4 class="pDefTerm"><a name="wp1047765"> </a>
[<code class="cCode">TPESYSTEM</code>]
</h4><div class="pDefPara"><a name="wp1047766"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error has been written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1047767"> </a>
[<code class="cCode">TPEOS</code>]
</h4><div class="pDefPara"><a name="wp1047768"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1047769"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1047770"> </a>
<a href="rf3cbl.html#wp1005398">Introduction to the COBOL Application-Transaction Monitor Interface</a>, <a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1047466"> </a>
TPSETUNSOL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001441"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001442"> </a>
<code class="cCode">TPSETUNSOL()</code> - sets method for handling unsolicited messages
</p>
<h4 class="pHeading3"><a name="wp1001443"> </a>
Synopsis
</h4>
<a name="wp1001444"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">CURR-ROUTINE</code><code class="cCode">  PIC S9(9) COMP-5. <br /> <br />01 </code><code class="cCodeEmphasis">PREV-ROUTINE</code><code class="cCode">  PIC S9(9) COMP-5. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br />   COPY TPSTATUS.  <br /> <br />CALL &quot;TPSETUNSOL&quot; USING </code><code class="cCodeEmphasis">CURR-ROUTINE</code><code class="cCode"> </code><code class="cCodeEmphasis">PREV-ROUTINE</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001445"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001446"> </a>
<code class="cCode">TPSETUNSOL()</code> allows a client to identify the routine that should be invoked when an unsolicited message is received by the Oracle Tuxedo ATMI libraries. Before the first call to <code class="cCode">TPSETUNSOL()</code>, any unsolicited messages received by the Oracle Tuxedo ATMI libraries on behalf of the client are logged and ignored. A call to <code class="cCode">TPSETUNSOL()</code> with a function number, <code class="cCodeEmphasis">CURR-ROUTINE</code>, set to <code class="cCode">0</code> has the same effect. The method used by the system for notification and detection is determined by the application default, which can be overridden on a per-client basis (see <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>).
</p>
<p class="pBody"><a name="wp1001447"> </a>
The routine number passed, in <code class="cCode">CURR-ROUTINE</code>, on the call to <code class="cCode">TPSETUNSOL()</code> selects one of 16 predefined routines. The routine names must be <code class="cCode">_tm_dispatch1</code> through <code class="cCode">_tm_dispatch8</code> for C routines that provide unsolicited message handling and <code class="cCode">TMDISPATCH9</code> through <code class="cCode">TMDISPATCH16</code> for COBOL routines that provide the same message handling. The C functions (<code class="cCode">_tm_dispatch1</code> through <code class="cCode">_tm_dispatch8</code>) must conform to the parameter definition described in <a href="../rf3c/rf3c.html">tpsetunsol(3c)</a>. The COBOL routines (<code class="cCode">TMDISPATCH9</code> through <code class="cCode">TMDISPATCH16</code>) must use <code class="cCode">TPGETUNSOL()</code> to receive the data.
</p>
<p class="pBody"><a name="wp1001448"> </a>
Processing within the unsolicited message handling routine in a C application is restricted to the following Oracle Tuxedo functions: <code class="cCode">tpalloc()</code>, <code class="cCode">tpfree()</code>, <code class="cCode">tpgetctxt()</code>, <code class="cCode">tpgetlev()</code>, <code class="cCode">tprealloc()</code>, and <code class="cCode">tptypes()</code>.
</p>
<p class="pBody"><a name="wp1001464"> </a>
Processing within the unsolicited message handling routine in a COBOL application is restricted to the following Oracle Tuxedo functions: <code class="cCode">TPGETLEV()</code> and <code class="cCode">TPGETCTXT()</code>.
</p>
<h4 class="pHeading3"><a name="wp1001465"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001466"> </a>
Upon successful completion, <code class="cCode">TPSETUNSOL()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>] and returns the previous setting for the unsolicited message handling routine (<code class="cCode">0</code> in <code class="cCode">PREV-ROUTINE</code> is a successful return indicating that no message handling routine had been set previously).
</p>
<h4 class="pHeading3"><a name="wp1001467"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001468"> </a>
Under the following conditions, <code class="cCode">TPSETUNSOL()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001469"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001470"> </a>
Invalid arguments were given (for example, <code class="cCode">CURR-ROUTINE</code> is not a valid routine value).
</div>
<h4 class="pDefTerm"><a name="wp1001471"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001472"> </a>
<code class="cCode">TPSETUNSOL()</code> was called in an improper context (for example, from within a server).
</div>
<h4 class="pDefTerm"><a name="wp1001473"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001474"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001475"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001476"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001477"> </a>
Portability
</h4>
<p class="pBody"><a name="wp1001481"> </a>
The interfaces described in <code class="cCode">TPNOTIFY()</code> are supported on native site UNIX-based processors. In addition, the routines <code class="cCode">TPBROADCAST()</code> and <code class="cCode">TPCHKUNSOL()</code> as well as the routine <code class="cCode">TPSETUNSOL()</code> are supported on UNIX and MS-DOS workstation processors.
</p>
<p class="pBody"><a name="wp1001485"> </a>
<code class="cCode">TPSETUNSOL()</code> is not supported on Windows, due to the way that Dynamic Link Libraries and Shared Libraries work in this environment; <code class="cCode">TPEPROTO()</code> is returned . Use the C-language interface <code class="cCode">tpsetunsol()</code> to set up a handler function.
</p>
<h4 class="pHeading3"><a name="wp1001486"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001487"> </a>
<a href="rf3cbl.html#wp1045063"><code class="cCode">TPGETCTXT(3cbl)</code></a>, <a href="rf3cbl.html#wp1000332"><code class="cCode">TPGETUNSOL(3cbl)</code></a>, <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp1269572"><code class="cCode">TPTERM(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001527"> </a>
TPSPRIO(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001528"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001529"> </a>
<code class="cCode">TPSPRIO()</code> - set service request priority
</p>
<h4 class="pHeading3"><a name="wp1001530"> </a>
Synopsis
</h4>
<a name="wp1001531"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPPRIDEF-REC</code><code class="cCode">.<br /> COPY TPPRIDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPSPRIO&quot; USING </code><code class="cCodeEmphasis">TPPRIDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001532"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001533"> </a>
<code class="cCode">TPSPRIO()</code> sets the priority for the next request sent or forwarded. The priority set affects only the next request sent. (Priority can also be set for messages enqueued or dequeued by <code class="cCode">TPENQUEUE()</code> or <code class="cCode">TPDEQUEUE()</code> if the queued management facility is installed.) By default, the setting of <code class="cCode">PRIORITY</code> in <code class="cCodeEmphasis">TPPRIDEF-REC</code> increments or decrements a service&#8217;s default priority up to a maximum of 100 or down to a minimum of 1 depending on its sign, where 100 is the highest priority. The default priority for a request is determined by the service to which the request is being sent. This default may be specified administratively (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a>), or accept the system default of 50. <code class="cCode">TPSPRIO()</code> has no effect on messages sent via <code class="cCode">TPCONNECT()</code> or <code class="cCode">TPSEND()</code>.
</p>
<p class="pBody"><a name="wp1001534"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPPRIDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1001535"> </a>
<code class="cCode">TPABSOLUTE</code> 
</h4><div class="pDefPara"><a name="wp1001536"> </a>
The priority of the next request should be sent out at the absolute value of <code class="cCode">PRIORITY</code>. The absolute value of <code class="cCode">PRIORITY</code> must be within the range 1 and 100, inclusive, with 100 being the highest priority. Any value outside of this range causes a default value to be used.
</div>
<h4 class="pDefTerm"><a name="wp1001537"> </a>
<code class="cCode">TPRELATIVE</code> 
</h4><div class="pDefPara"><a name="wp1001538"> </a>
The priority of the next request should be sent out at the relative value of <code class="cCode">PRIORITY</code>.
</div>
<h4 class="pHeading3"><a name="wp1001539"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001540"> </a>
Upon successful completion, <code class="cCode">TPSPRIO()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp1001541"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001542"> </a>
Under the following conditions, <code class="cCode">TPSPRIO()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001543"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001544"> </a>
<code class="cCodeEmphasis">TPPRIDEF-REC</code> settings are invalid.
</div>
<h4 class="pDefTerm"><a name="wp1001545"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001546"> </a>
<code class="cCode">TPSPRIO()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1001547"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001548"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001549"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001550"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001551"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001552"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>, <a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999573"><code class="cCode">TPDEQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp999853"><code class="cCode">TPENQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp1000395"><code class="cCode">TPGPRIO(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001590"> </a>
TPSUBSCRIBE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001591"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001592"> </a>
<code class="cCode">TPSUBSCRIBE()</code> - subscribe to an event
</p>
<h4 class="pHeading3"><a name="wp1001593"> </a>
Synopsis
</h4>
<a name="wp1001594"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPEVTDEF-REC</code><code class="cCode">.<br /> COPY TPEVTDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode">.<br /> COPY TPQUEDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPSUBSCRIBE&quot; USING </code><code class="cCodeEmphasis">TPEVTDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPQUEDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001595"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001596"> </a>
The caller uses <code class="cCode">TPSUBSCRIBE()</code> to subscribe to an event or set of events named by <code class="cCode">EVENT-EXPR</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code>. Subscriptions are maintained by the Oracle Tuxedo EventBroker, <code class="cCode">TMUSREVT()</code>, and are used to notify subscribers when events are posted via <code class="cCode">TPPOST()</code>. Each subscription specifies a notification method which can take one of three forms: client notification, service calls, or message enqueuing to stable-storage queues. Notification methods are determined by the subscriber&#8217;s process type and the setting of the <code class="cCode">TPEV-METHOD-FLAG </code>in <code class="cCodeEmphasis">TPEVTDEF-REC</code>.
</p>
<p class="pBody"><a name="wp1001597"> </a>
The event or set of events being subscribed to is named by the regular expression, <code class="cCode">EVENT-EXPR </code>in <code class="cCodeEmphasis">TPEVTDEF-REC</code>, and cannot be <code class="cCode">SPACES</code>. Regular expressions are of the form specified in <code class="cCode">tpsubscribe(3c)</code>. For example, if <code class="cCode">EVENT-EXPR</code> is <code class="cCode">&quot;\e\e..*&quot;</code>, the caller is subscribing to all system-generated events; if <code class="cCode">EVENT-EXPR</code> is <code class="cCode">&quot;\e\e.SysServer.*&quot;</code>, the caller is subscribing to all system-generated events related to servers. If <code class="cCode">EVENT-EXPR </code>is <code class="cCode">&quot;[A-Z].*&quot;</code>, the caller is subscribing to all user events starting with A-Z; if <code class="cCode">EVENT-EXPR</code> is <code class="cCode">&quot;.*(ERR|err).*&quot;</code>, the caller is subscribing to all user events containing either the substring &quot;<code class="cCode">ERR</code>&quot; or the substring &quot;<code class="cCode">err</code>&quot; in the event name (for example, &quot;<code class="cCode">account_error</code>&quot; and &quot;<code class="cCode">ERROR_STATE</code>&quot; events would both qualify).
</p>
<p class="pBody"><a name="wp1226149"> </a>
<code class="cCode">EVENT-FILTER</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is a string containing a Boolean filter rule that must be evaluated successfully before the EventBroker posts the event. Upon receiving an event to be posted, the EventBroker applies the filter rule, if one exists, to the posted event&#8217;s data. If the data passes the filter rule, the EventBroker invokes the notification method; otherwise, the broker does not invoke the associated notification method. The caller can subscribe to the same event multiple times with different filter rules.
</p>
<p class="pBody"><a name="wp1001599"> </a>
Filter rules are specific to the typed records to which they are applied. For FML and view records, the filter rule is a string that can be passed to each Boolean expression compiler (see <a href="../rf3fml/rf3fml.html">Fboolco,&#160;Fbo</a><a href="../rf3fml/rf3fml.html">olco32,&#160;Fv</a><a href="../rf3fml/rf3fml.html">boolco,&#160;Fvboo</a><a href="../rf3fml/rf3fml.html">lco32(3fml)</a>) and evaluated against the posted record (see <a href="../rf3fml/rf3fml.html">Fboolev,&#160;Fbo</a><a href="../rf3fml/rf3fml.html">olev32,&#160;Fvbo</a><a href="../rf3fml/rf3fml.html">olev,&#160;Fvbo</a><a href="../rf3fml/rf3fml.html">olev32(3fml)</a>). For <code class="cCode">STRING</code> records, the filter rule is a regular expression of the form specified in <code class="cCode">tpsubscribe(3c)</code>. All other record types require customized filter evaluators (see <a href="../rf3c/rf3c.html">buffer(3c)</a> and <a href="../rf5/rf5.html">typesw(5)</a> for details on adding customized filter evaluators). If no filter rule is associated with <code class="cCode">EVENT-EXPR</code>, then<code class="cCode"> EVENT-FILTER</code> must be <code class="cCode">SPACES</code>.
</p>
<p class="pBody"><a name="wp1001600"> </a>
If the subscriber is an Oracle Tuxedo ATMI client process and <code class="cCode">TPEVNOTIFY</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is set, then the EventBroker sends an unsolicited message to the subscriber when the event to which it subscribed is posted. That is, when an event name is posted that evaluates successfully against<code class="cCode"> EVENT-EXPR</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCode">EVENT-EXPR</code>. If the data passes the filter rule or if there is no filter rule for the event, then the subscriber receives an unsolicited notification along with any data posted with the event. In order to receive unsolicited notifications, the client must register (via <code class="cCode">TPSETUNSOL()</code>) an unsolicited message handling routine. If an Oracle Tuxedo ATMI server process calls <code class="cCode">TPSUBSCRIBE()</code> with <code class="cCode">TPEVNOTIFY</code> set, then <code class="cCode">TPSUBSCRIBE()</code> fails and sets <code class="cCode">TP-STATUS</code> in <code class="cCodeEmphasis">TPSTATUS-REC</code> to [<code class="cCode">TPEPROTO</code>].
</p>
<p class="pBody"><a name="wp1001601"> </a>
Clients receiving event notification via unsolicited messages should remove their subscriptions from the EventBroker&#8217;s list of active subscriptions before exiting (see <code class="cCode">TPUNSUBSCRIBE()</code> for details). Using <code class="cCode">TPUNSUBSCRIB()</code>&#8217;s wildcard handle, -1, clients can conveniently remove all of their &#8220;non-persistent&#8221; subscriptions which include those associated with the unsolicited notification method (see the description of <code class="cCode">TPEVPERSIST</code> below for subscriptions and their associated notification methods that persist after a process exits). If a client exits without removing its non-persistent subscriptions, then the EventBroker will remove them when it detects that the client is no longer accessible.
</p>
<p class="pBody"><a name="wp1001602"> </a>
When <code class="cCode">TPEVNOTIFY</code> is set, <code class="cCode">TPEVNOTRAN</code> and <code class="cCode">TPEVNOPERSIST</code> must also be set; otherwise <code class="cCode">TPSUBSCRIBE()</code> fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEINVAL</code>]. That is, an event subscription for a client having the unsolicited notification method cannot be transactional nor can it be persistent.
</p>
<p class="pBody"><a name="wp1001603"> </a>
If the subscriber (regardless of process type) sets <code class="cCode">TPEVSERVICE()</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code>, then event notifications are sent to the Oracle Tuxedo ATMI service routine named by <code class="cCode">NAME-1</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code>. That is, when an event name is posted that evaluates successfully against <code class="cCode">EVENT-EXPR</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCode">EVENT-EXPR</code>. If the data passes the filter rule or if there is no filter rule for the event, then a service request is sent to <code class="cCode">NAME-1</code> along with any data posted with the event. The service name in <code class="cCode">NAME-1</code> can be any valid Oracle Tuxedo ATMI service name and it may or may not be active at the time the subscription is made. Service routines invoked by the EventBroker should return with no reply data. That is, they should call <code class="cCode">TPRETURN()</code> with <code class="cCode">REC-TYPE</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> set to SPACES. Any data passed to <code class="cCode">TPRETURN()</code> will be dropped.
</p>
<p class="pBody"><a name="wp1001604"> </a>
If <code class="cCode">TPEVTRAN</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is also set, then if the process calling <code class="cCode">TPPOST()</code> is in transaction mode, the EventBroker calls the subscribed service routine such that it will be part of the poster&#8217;s transaction. Both the EventBroker, <code class="cCode">TMUSREVT()</code>, and the subscribed service routine must belong to server groups that support transactions (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details). If <code class="cCode">TPEVNOTRAN</code> is set, then the EventBroker calls the subscribed service routine such that it will not be part of the poster&#8217;s transaction.
</p>
<p class="pBody"><a name="wp1001605"> </a>
If the subscriber (regardless of process type) sets <code class="cCode">TPEVQUEUE()</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code>, then event notifications are enqueued to the queue space named by <code class="cCode">NAME-1</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> and the queue named by <code class="cCode">NAME-2 </code>in <code class="cCodeEmphasis">TPEVTDEF-REC</code>. That is, when an event name is posted that evaluates successfully against <code class="cCode">EVENT-EXPR</code>, the EventBroker tests the posted data against the filter rule associated with <code class="cCode">EVENT-EXPR</code>. If the data passes the filter rule or if there is no filter rule for the event, then the EventBroker enqueues a message to the queue space named by <code class="cCode">NAME-1 </code>and the queue named by <code class="cCode">NAME-2</code> along with any data posted with the event. The queue space and queue name can be any valid Oracle Tuxedo ATMI queue space and queue name, either of which may or may not exist at the time the subscription is made.
</p>
<p class="pBody"><a name="wp1001606"> </a>
<code class="cCodeEmphasis">TPQUEDEF-REC</code> can contain options further directing the EventBroker&#8217;s enqueuing of the posted event. If the caller has no options to specify, then <code class="cCodeEmphasis">TPQUEDEF-REC</code> should be set to<code class="cCode"> LOW-VALUE</code>. Otherwise, options can be set as described in the &#8220;Control Parameter&#8221; subsection of the <code class="cCode">TPENQUEUE()</code> reference page (specifically, see the section describing the valid list of settings controlling input information for <code class="cCode">TPENQUEUE()</code>).
</p>
<p class="pBody"><a name="wp1001607"> </a>
If <code class="cCode">TPEVTRAN</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is also set, then if the process calling <code class="cCode">TPPOST()</code> is in transaction mode, the EventBroker enqueues the posted event and its data such that it will be part of the poster&#8217;s transaction. The EventBroker, <code class="cCode">TMUSREVT()</code>, must belong to a server group that supports transactions (see <a href="../rf5/rf5.html">UBBCONFIG(5)</a> for details). If <code class="cCode">TPEVNOTRAN</code> is set, then the EventBroker enqueues the posted event and its data such that it will not be part of the poster&#8217;s transaction.
</p>
<p class="pBody"><a name="wp1001608"> </a>
By default, the Oracle Tuxedo EventBroker deletes subscriptions when the resource to which it is posting is not available (for example, the EventBroker cannot access a service routine and/or a queue space/queue name associated with an event subscription). Setting <code class="cCode">TPEVPERSIST</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> indicates that the subscriber wants this subscription to persist across such errors (usually because the resource will become available again in the future). Persistent subscriptions are allowed only for <code class="cCode">TPEVSERVICE()</code> and <code class="cCode">TPEVQUEUE()</code> notification methods. <code class="cCode">TPEVPERSIST</code> cannot be used when <code class="cCode">TPEVNOTIFY</code> is set; otherwise, the function fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEINVAL</code>]. When <code class="cCode">TPEVNOPERSIST</code> is used, the EventBroker will remove this subscription if it encounters an error accessing either the client, the service name, or queue space/queue name designated in this subscription.
</p>
<p class="pBody"><a name="wp1001609"> </a>
If <code class="cCode">TPEVPERSIST</code> is used with <code class="cCode">TPEVTRAN</code> and the resource is not available at the time of event notification, then the EventBroker will return to the poster such that its transaction must be aborted. That is, even though the subscription remains intact, the resource&#8217;s unavailability will cause the poster&#8217;s transaction to fail.
</p>
<p class="pBody"><a name="wp1001610"> </a>
If the EventBroker&#8217;s list of active subscriptions already contains a subscription that matches the one being requested by <code class="cCode">TPSUBSCRIBE()</code>, then the function fails setting <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEMATCH</code>]. For a subscription to match an existing one, both <code class="cCode">EVENT-EXPR</code> and <code class="cCode">EVENT-FILTER</code> must match those of a subscription already in the EventBroker&#8217;s active list of subscriptions. In addition, depending on the notification method, other criteria are used to determine matches.
</p>
<p class="pBody"><a name="wp1001611"> </a>
If <code class="cCode">TPEVNOTIFY</code> is set, then the caller&#8217;s system-defined client identifier (known as a <code class="cCode">CLIENTID</code>) is also used to detect matches. That is, <code class="cCode">TPSUBSCRIBE()</code> fails if <code class="cCode">EVENT-EXPR</code>, <code class="cCode">EVENT-FILTER</code>, and the caller&#8217;s <code class="cCode">CLIENTID</code> match those of a subscription already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1001612"> </a>
If <code class="cCode">TPEVSERVICE()</code> is set, then <code class="cCode">TPSUBSCRIBE()</code> fails if <code class="cCode">EVENT-EXPR</code>, <code class="cCode">EVENT-FILTER</code>, and the service name set in <code class="cCode">NAME-1</code> match those of a subscription already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1001613"> </a>
If <code class="cCode">TPEVQUEUE()</code> is set, then EventBroker uses the queue space, queue name, and correlation identifier, in addition to <code class="cCode">EVENT-EXPR </code>and <code class="cCode">EVENT-FILTER</code>, when determining matches. The correlation identifier can be used to differentiate among several subscriptions for the same event expression and filter rule, destined for the same queue. Thus, if the caller has set both <code class="cCode">TPEVQUEUE()</code> and <code class="cCode">TPQNOCOORID()</code>, then <code class="cCode">TPSUBSCRIBE()</code> fails if <code class="cCode">EVENT-EXPR</code>, <code class="cCode">EVENT-FILTER</code>, the queue space name set in <code class="cCode">NAME-1</code>, and the queue name set in <code class="cCode">NAME-2</code> match those of a subscription (which also does not have a correlation identifier specified) already known to the EventBroker. Further, if <code class="cCode">TPQCOORID()</code> is set, then <code class="cCode">TPSUBSCRIBE()</code> fails if <code class="cCode">EVENT-EXPR</code>, <code class="cCode">EVENT-FILTER</code>, <code class="cCode">NAME-1</code>,<code class="cCode"> NAME-2</code>, and <code class="cCode">CORRID</code> in <code class="cCodeEmphasis">TPQUEDEF-REC</code> match those of a subscription (which has the same correlation identifier specified) already known to the EventBroker.
</p>
<p class="pBody"><a name="wp1001614"> </a>
The following is a list of settings in <code class="cCodeEmphasis">TPEVTDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1001615"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1001616"> </a>
The subscription is not made if a blocking condition exists. If such a condition occurs, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEBLOCK</code>]. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001617"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1001618"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001619"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1001620"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001621"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1001622"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001623"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1001624"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1001625"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1001626"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPGOTSIG</code>]. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp1001627"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001628"> </a>
Upon successful completion, <code class="cCode">TPSUBSCRIBE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. In addition, <code class="cCode">TPSUBSCRIBE()</code> sets <code class="cCode">SUBSCRIPTION-HANDLE</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> to the handle for this subscription. <code class="cCode">SUBSCRIPTION-HANDLE</code> can be used when calling <code class="cCode">TPUNSUBSCRIBE()</code> to remove this subscription from the EventBroker&#8217;s list of active subscriptions. Either the subscriber or any other process is allowed to use the returned handle to delete this subscription.
</p>
<h4 class="pHeading3"><a name="wp1001629"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001630"> </a>
Under the following conditions, <code class="cCode">TPSUBSCRIBE()</code> fails and sets <code class="cCode">TP-STATUS</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1001631"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001632"> </a>
Invalid arguments were given (for example, <code class="cCode">EVENT-EXPR</code> is <code class="cCode">SPACES</code>).
</div>
<h4 class="pDefTerm"><a name="wp1001633"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1001634"> </a>
Cannot access the Oracle Tuxedo EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1001635"> </a>
[<code class="cCode">TPELIMIT</code>] 
</h4><div class="pDefPara"><a name="wp1001636"> </a>
The subscription failed because the EventBroker&#8217;s maximum number of subscriptions has been reached.
</div>
<h4 class="pDefTerm"><a name="wp1001637"> </a>
[<code class="cCode">TPEMATCH</code>] 
</h4><div class="pDefPara"><a name="wp1001638"> </a>
The subscription failed because it matched one already listed with the EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1247129"> </a>
[<code class="cCode">TPEPERM</code>] 
</h4><div class="pDefPara"><a name="wp1247130"> </a>
The client is not attached as <code class="cCode">tpsysadm</code> and the subscription action is either a service call or the enqueuing of a message.
</div>
<h4 class="pDefTerm"><a name="wp1001639"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1276684"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPSUBSCRIBE()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1276685"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1276686"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1276687"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001641"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1001642"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1001643"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1001644"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1001645"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001646"> </a>
<code class="cCode">TPSUBSCRIBE()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1001647"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001648"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001649"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001650"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001651"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001652"> </a>
<a href="../rf3c/rf3c.html">buffer(3c)</a>, <a href="../rf3c/rf3c.html">tpsubscribe(3c)</a>, <a href="rf3cbl.html#wp999853"><code class="cCode">TPENQUEUE(3cbl)</code></a>, <a href="rf3cbl.html#wp1000793"><code class="cCode">TPPOST(3cbl)</code></a>, <a href="rf3cbl.html#wp1047466"><code class="cCode">TPSETUNSOL(3cbl)</code></a>, <a href="rf3cbl.html#wp1002132"><code class="cCode">TPUNSUBSCRIBE(3cbl)</code></a>, <a href="../rf3fml/rf3fml.html">Fboolco,&#160;Fbool</a><a href="../rf3fml/rf3fml.html">co32,&#160;Fvbo</a><a href="../rf3fml/rf3fml.html">olco,&#160;Fvbo</a><a href="../rf3fml/rf3fml.html">olco32(3fml)</a>, <a href="../rf3fml/rf3fml.html">Fboolev,&#160;Fb</a><a href="../rf3fml/rf3fml.html">oolev32,&#160;Fv</a><a href="../rf3fml/rf3fml.html">boolev,&#160;Fvbo</a><a href="../rf3fml/rf3fml.html">olev32(3fml)</a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">EVENT_MIB(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a>, <a href="../rf5/rf5.html">tuxtypes(5)</a>, <a href="../rf5/rf5.html">typesw(5)</a>, <a href="../rf5/rf5.html">UBBCONFIG(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001740"> </a>
TPSUSPEND(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001741"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001742"> </a>
<code class="cCode">TPSUSPEND()</code> - suspend a global transaction
</p>
<h4 class="pHeading3"><a name="wp1001743"> </a>
Synopsis
</h4>
<a name="wp1001744"> </a><div class="pPreformatted"><pre>01 <code class="cCodeEmphasis">TPTRXDEF-REC</code>.<br /> COPY TPTRXDEF. <br /> <br />01 <code class="cCodeEmphasis">TPSTATUS-REC</code>.<br /> COPY TPSTATUS.  <br /> <br />CALL &quot;TPSUSPEND&quot; USING <code class="cCodeEmphasis">TPTRXDEF-REC TPSTATUS-REC</code>. </pre></div><h4 class="pHeading3"><a name="wp1001745"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001746"> </a>
<code class="cCode">TPSUSPEND()</code> is used to suspend the transaction active in the caller&#8217;s program. A transaction begun with <code class="cCode">TPBEGIN()</code> may be suspended with <code class="cCode">TPSUSPEND()</code>. Either the suspending program or another program may use <code class="cCode">TPRESUME()</code> to resume work on a suspended transaction. When <code class="cCode">TPSUSPEND()</code> returns, the caller is no longer in transaction mode. However, while a transaction is suspended, all resources associated with that transaction (such as database locks) remain active. Like an active transaction, a suspended transaction is susceptible to the transaction timeout value that was assigned when the transaction first began.
</p>
<p class="pBody"><a name="wp1001747"> </a>
For the transaction to be resumed in another process, the caller of <code class="cCode">TPSUSPEND()</code> must have been the initiator of the transaction by explicitly calling <code class="cCode">TPBEGIN()</code>. <code class="cCode">TPSUSPEND()</code> may also be called by a process other than the originator of the transaction (for example, a server that receives a request in transaction mode). In the latter case, only the caller of <code class="cCode">TPSUSPEND()</code> may call <code class="cCode">TPRESUME()</code> to resume that transaction. This case is allowed so that a process can temporarily suspend a transaction to begin and do some work in another transaction before completing the original transaction (for example, to run a transaction to log a failure before rolling back the original transaction).
</p>
<p class="pBody"><a name="wp1001748"> </a>
<code class="cCode">TPSUSPEND()</code> populates <code class="cCode">TRANID</code> with the transaction identifier being suspended.
</p>
<p class="pBody"><a name="wp1001749"> </a>
To ensure success, the caller must have completed all outstanding transactional communication with servers before issuing <code class="cCode">TPSUSPEND()</code>. That is, the caller must have received all replies for requests sent with <code class="cCode">TPACALL()</code> that were associated with the caller&#8217;s transaction. Also, the caller must have closed all connections with conversational services associated with the caller&#8217;s transaction (that is, <code class="cCode">TPRECV()</code> must have returned the TPEV-SVCSUCC event). If either rule is not followed, then <code class="cCode">TPSUSPEND()</code> fails, the caller&#8217;s current transaction is not suspended and all transactional communication handles remain valid. Communication handles not associated with the caller&#8217;s transaction remain valid regardless of the outcome of <code class="cCode">TPSUSPEND()</code>.
</p>
<h4 class="pHeading3"><a name="wp1001750"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1001751"> </a>
Upon successful completion, <code class="cCode">TPSUSPEND()</code> sets <code class="cCode">[TPOK]</code>.
</p>
<h4 class="pHeading3"><a name="wp1001752"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001753"> </a>
Under the following conditions, <code class="cCode">TPSUSPEND()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001754"> </a>
[<code class="cCode">TPEABORT</code>] 
</h4><div class="pDefPara"><a name="wp1001755"> </a>
The caller&#8217;s active transaction has been aborted. All communication handles associated with the transaction are no longer valid.
</div>
<h4 class="pDefTerm"><a name="wp1001756"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001757"> </a>
<code class="cCode">TPSUSPEND()</code> was called in an improper context (for example, the caller is not in transaction mode). The caller&#8217;s state with respect to transaction mode is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1001758"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001759"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001760"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001761"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001762"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001763"> </a>
<a href="rf3cbl.html#wp998473"><code class="cCode">TPACALL(3cbl)</code></a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp1000927"><code class="cCode">TPRECV(3cbl)</code></a>, <a href="rf3cbl.html#wp1001071"><code class="cCode">TPRESUME(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001806"> </a>
TPSVCSTART(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001807"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001808"> </a>
<code class="cCode">TPSVCSTART()</code> - start an Oracle Tuxedo ATMI service
</p>
<h4 class="pHeading3"><a name="wp1001809"> </a>
Synopsis
</h4>
<a name="wp1001810"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode">.<br /> COPY TPSVCDEF. <br /> <br />01 </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode">.<br /> COPY TPTYPE. <br /> <br />01 </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode">.<br /> COPY User data. <br /> <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br /> <br />CALL &quot;TPSVCSTART&quot; USING </code><code class="cCodeEmphasis">TPSVCDEF-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPTYPE-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">DATA-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1001811"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001812"> </a>
<code class="cCode">TPSVCSTART()</code> is the first Oracle Tuxedo ATMI routine to be called when writing a service routines. In fact, it is an error to issue any other call within a service routine before calling <code class="cCode">TPSVCSTART()</code>. <code class="cCode">TPVCSTART()</code> is used to retrieve the service&#8217;s parameters and data. This routine is used for services that receive requests via <code class="cCode">TPCALL()</code> or <code class="cCode">TPACALL()</code> routines as well as by services that communicate via <code class="cCode">TPCONNECT()</code>, <code class="cCode">TPSEND()</code>, and <code class="cCode">TPRECV()</code> routines.
</p>
<p class="pBody"><a name="wp1001813"> </a>
Service routines processing requests made via either <code class="cCode">TPCALL()</code>, <code class="cCode">TPACALL()</code>, or <code class="cCode">TPFORWAR()</code> receive at most one incoming message (upon successfully returning from <code class="cCode">TPSVCSTART</code>) and send at most one reply (upon exiting the service routine with <code class="cCode">TPRETURN()</code>).
</p>
<p class="pBody"><a name="wp1001814"> </a>
Conversational services, on the other hand, are invoked by connection requests with at most one incoming message along with a means of referring to the open connection. Upon successfully returning from <code class="cCode">TPSVCSTART()</code>, either the connecting program or the conversational service may send and receive data as defined by the application. The connection is half-duplex in nature meaning that one side controls the conversation (that is, it sends data) until it explicitly gives up control to the other side of the connection.
</p>
<p class="pBody"><a name="wp1001815"> </a>
Concerning transactions, service routines can participate in at most one transaction if invoked in transaction mode. As far as the service routine writer is concerned, the transaction ends upon returning from the service routine. If the service routine is not invoked in transaction mode, then the service routine may originate as many transactions as it wants using <code class="cCode">TPBEGIN()</code>, <code class="cCode">TPCOMMIT()</code>, and <code class="cCode">TPABORT()</code>. Note that <code class="cCode">TPRETURN()</code> is not used to complete a transaction. Thus, it is an error to call <code class="cCode">TPRETURN()</code> with an outstanding transaction that originated within the service routine.
</p>
<p class="pBody"><a name="wp1001816"> </a>
<code class="cCodeEmphasis">DATA-REC</code> specifies where the service&#8217;s data is read into, and, on input, <code class="cCode">LEN</code> in <code class="cCodeEmphasis">TPTYPE-REC</code> indicates the maximum number of bytes that should be moved into <code class="cCodeEmphasis">DATA-REC</code>. Upon successful return from <code class="cCode">TPSVCSTART</code>, <code class="cCode">LEN</code> contains the actual number of bytes moved into <code class="cCodeEmphasis">DATA-REC</code>. <code class="cCode">REC-TYPE</code> and <code class="cCode">SUB-TYPE</code>, both in <code class="cCodeEmphasis">TPTYPE-REC</code>, contain the data&#8217;s type and subtype, respectively. If the message is larger than <code class="cCodeEmphasis">DATA-REC</code>, then <code class="cCodeEmphasis">DATA-REC</code> will contain only as many bytes as will fit in the record. The remainder of the message is discarded and <code class="cCode">TPSVCSTART()</code> sets <code class="cCode">TPTRUNCATE()</code>.
</p>
<p class="pBody"><a name="wp1001817"> </a>
If <code class="cCode">LEN</code> is <code class="cCode">0</code> upon successful return, then the service has no incoming data and <code class="cCodeEmphasis">DATA-REC</code> was not modified. It is an error for <code class="cCode">LEN</code> to be <code class="cCode">0</code> on input.
</p>
<p class="pBody"><a name="wp1001818"> </a>
Upon successful return, <code class="cCode">SERVICE-NAME</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code> is populated with the service name that the requesting program used to invoke the service.
</p>
<p class="pBody"><a name="wp1001819"> </a>
The following are the possible settings in <code class="cCodeEmphasis">TPSVCDEF-REC</code> upon return of <code class="cCode">TPSVCSTART()</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1001820"> </a>
<code class="cCode">TPREQRSP</code> 
</h4><div class="pDefPara"><a name="wp1001821"> </a>
The service was invoked with either <code class="cCode">TPCALL()</code> or <code class="cCode">TPACALL()</code>. This setting is mutually exclusive with <code class="cCode">TPCONV</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001822"> </a>
<code class="cCode">TPCONV</code> 
</h4><div class="pDefPara"><a name="wp1001823"> </a>
The service was invoked with <code class="cCode">TPCONNECT()</code>. The communications handle for the conversation is available in <code class="cCode">COMM-HANDLE</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code>. This setting is mutually exclusive with <code class="cCode">TPREQRSP</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001824"> </a>
<code class="cCode">TPNOTRAN</code> 
</h4><div class="pDefPara"><a name="wp1001825"> </a>
The service routine is not in transaction mode. This setting is mutually exclusive with <code class="cCode">TPTRAN</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001826"> </a>
<code class="cCode">TPTRAN</code> 
</h4><div class="pDefPara"><a name="wp1001827"> </a>
The service routine is in transaction mode. This setting is mutually exclusive with <code class="cCode">TPNOTRAN</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001828"> </a>
<code class="cCode">TPNOREPLY</code> 
</h4><div class="pDefPara"><a name="wp1001829"> </a>
The program invoking the service routine is not expecting a reply. This setting is meaningful only when <code class="cCode">TPREQRSP</code> is set. This setting is mutually exclusive with <code class="cCode">TPREPLY</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001830"> </a>
<code class="cCode">TPREPLY</code> 
</h4><div class="pDefPara"><a name="wp1001831"> </a>
The program invoking the service routine is expecting a reply. This setting is meaningful only when <code class="cCode">TPREQRSP</code> is set. This setting is mutually exclusive with <code class="cCode">TPNOREPLY</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001832"> </a>
<code class="cCode">TPSENDONLY</code> 
</h4><div class="pDefPara"><a name="wp1001833"> </a>
The service is invoked such that it can send data across the connection and the program on the other end of the connection can only receive data. This setting is meaningful only when <code class="cCode">TPCONV</code> is set. This setting is mutually exclusive with <code class="cCode">TPRECVONLY</code>.
</div>
<h4 class="pDefTerm"><a name="wp1001834"> </a>
<code class="cCode">TPRECVONLY</code> 
</h4><div class="pDefPara"><a name="wp1001835"> </a>
The service is invoked such that it can only receive data from the connection and the program on the other end of the connection can send data. This setting is meaningful only when <code class="cCode">TPCONV</code> is set. This setting is mutually exclusive with <code class="cCode">TPSENDONLY</code>.
</div>
<p class="pBody"><a name="wp1001836"> </a>
<code class="cCode">APPKEY</code> in <code class="cCodeEmphasis">TPSVCDEF-REC</code> is set to the application key assigned to the requesting client program by the application-defined authentication service. This key value is passed along with any and all service requests made while within this invocation of the service routine. <code class="cCode">APPKEY</code> will have a value of -1 for originating clients that do not pass through the application authentication service. This includes clients of an earlier release level interoperating with a security application.
</p>
<h4 class="pHeading3"><a name="wp1001837"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1001838"> </a>
Upon successful completion, <code class="cCode">TPSVCSTART()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. If the size of the incoming message was larger then the size specified in <code class="cCode">LEN</code> on input, <code class="cCode">TPTRUNCATE()</code> is set and only <code class="cCode">LEN</code> amount of data was moved to <code class="cCodeEmphasis">DATA-REC</code>, the remaining data is discarded.
</p>
<h4 class="pHeading3"><a name="wp1001839"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1001840"> </a>
Under the following conditions, <code class="cCode">TPSVCSTART()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1001841"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1001842"> </a>
Invalid arguments were given.
</div>
<h4 class="pDefTerm"><a name="wp1001843"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1001844"> </a>
<code class="cCode">TPSVCSTART()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1001845"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1001846"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1001847"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1001848"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1001849"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001850"> </a>
<a href="../rfcm/rfcmd.html">buildserver(1)</a>, <a href="rf3cbl.html#wp998758"><code class="cCode">TPBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp998931"><code class="cCode">TPCALL(3cbl)</code></a>, <a href="rf3cbl.html#wp999450"><code class="cCode">TPCONNECT(3cbl)</code></a>, <a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a>, <a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001902"><code class="cCode">TPSVRDONE(3cbl)</code></a>, <a href="rf3cbl.html#wp1268536"><code class="cCode">TPSVRINIT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1001902"> </a>
TPSVRDONE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1001903"> </a>
Name
</h4>
<p class="pBody"><a name="wp1001904"> </a>
<code class="cCode">TPSVRDONE()</code> - Oracle Tuxedo ATMI server termination routine
</p>
<h4 class="pHeading3"><a name="wp1001905"> </a>
Synopsis
</h4>
<a name="wp1001906"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br />PROCEDURE DIVISION. <br />* User code <br />EXIT PROGRAM.</code></pre></div><h4 class="pHeading3"><a name="wp1001907"> </a>
Description
</h4>
<p class="pBody"><a name="wp1001908"> </a>
The Oracle Tuxedo ATMI server abstraction calls <code class="cCode">TPSVRDONE()</code> after it has finished processing service requests but before it exits. When this routine is invoked, the server is still part of the system but its own services have been unadvertised. Thus, Oracle Tuxedo ATMI communication can be performed and transactions can be defined in this routine. However, if <code class="cCode">TPSVRDONE()</code> returns with open connections, asynchronous replies pending or while still in transaction mode, the Oracle Tuxedo system will close its connections, ignore any pending replies and roll back the transaction before the server exits.
</p>
<p class="pBody"><a name="wp1001909"> </a>
If an application does not provide this routine in a server, then the default version provided by the Oracle Tuxedo system is called instead. The default <code class="cCode">TPSVRDONE()</code> calls <code class="cCode">TPCLOSE()</code> and <code class="cCode">USERLOG()</code> to announce that the server is about to exit.
</p>
<h4 class="pHeading3"><a name="wp1001910"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1001911"> </a>
If either <code class="cCode">TPRETURN()</code> or <code class="cCode">TPFORWAR()</code> are called in <code class="cCode">TPSVRDONE()</code>, then these routines simply return having no effect.
</p>
<h4 class="pHeading3"><a name="wp1001912"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1001913"> </a>
<a href="rf3cbl.html#wp999299"><code class="cCode">TPCLOSE(3cbl)</code></a>, <a href="rf3cbl.html#wp1268536"><code class="cCode">TPSVRINIT(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1268536"> </a>
TPSVRINIT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1268537"> </a>
Name
</h4>
<p class="pBody"><a name="wp1268538"> </a>
<code class="cCode">TPSVRINIT()</code> - Oracle Tuxedo ATMI server initialization routine
</p>
<h4 class="pHeading3"><a name="wp1268539"> </a>
Synopsis
</h4>
<a name="wp1268540"> </a><div class="pPreformatted"><pre><code class="cCode">LINKAGE SECTION. <br /> <br />01 </code><code class="cCodeEmphasis">CMD-LINE.<br /> 05 ARGC  PIC 9(4) COMP-5.<br /> 05 ARGV.<br />  10 ARGS PIC X OCCURS 0 TO 9999 DEPENDING ON ARGC</code><code class="cCode">. <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br />PROCEDURE DIVISION USING </code><code class="cCodeEmphasis">CMD-LINE</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">. <br />* User code <br />EXIT PROGRAM</code></pre></div><h4 class="pHeading3"><a name="wp1268541"> </a>
Description
</h4>
<p class="pBody"><a name="wp1268542"> </a>
The Oracle Tuxedo ATMI server abstraction calls <code class="cCode">TPSVRINIT()</code> during its initialization. This routine is called after the program has become a server but before it handles any service requests; thus, Oracle Tuxedo ATMI communication may be performed and transactions may be defined in this routine. However, if <code class="cCode">TPSVRINIT()</code> returns with either open connections or asynchronous replies pending, or while still in transaction mode, the Oracle Tuxedo system closes the connections, ignores any pending replies, and aborts the transaction before the server exits.
</p>
<p class="pBody"><a name="wp1268543"> </a>
If an application does not provide this routine in a server, then the default version provided by the Oracle Tuxedo system is called, instead. The default <code class="cCode">TPSVRINIT()</code> calls <code class="cCode">TPOPEN()</code> and <code class="cCode">USERLOG()</code> to announce that the server has started successfully.
</p>
<p class="pBody"><a name="wp1268544"> </a>
Application-specific options can be passed into a server and processed in <code class="cCode">TPSVRINIT()</code>. (For details, see <a href="../rf5/rf5.html">servopts(5)</a>). The options are passed through <code class="cCodeEmphasis">ARGC</code> and <code class="cCodeEmphasis">ARGV</code>. <code class="cCodeEmphasis">ARGC</code> contains the number of arguments that have been passed; <code class="cCodeEmphasis">ARGV</code>, the content of those arguments, specified in character format with single spaces separating arguments. <code class="cCode">getopt()</code> is used in an Oracle Tuxedo system.
</p>
<p class="pBody"><a name="wp1268548"> </a>
If successful, <code class="cCode">TPSVRINIT()</code> returns [<code class="cCode">TPOK</code>] in <code class="cCode">TP-STATUS</code> and the service can start accepting requests. If an error occurs in <code class="cCode">TPSVRINIT</code>, the application can cause the server to exit gracefully (without taking any service requests) by returning any value other than [<code class="cCode">TPOK</code>] in <code class="cCode">TP-STATUS</code>.
</p>
<p class="pBody"><a name="wp1268549"> </a>
When <code class="cCode">TPSVRINIT()</code> returns any value other than [<code class="cCode">TPOK</code>], the system does not restart the server. Instead, the administrator must run <code class="cCode">tmboot</code> to restart the server.
</p>
<h4 class="pHeading3"><a name="wp1268550"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1268551"> </a>
When <code class="cCode">TPRETURN()</code>or <code class="cCode">TPFORWAR()</code> is used outside a service routine (for example, in a client, <code class="cCode">TPSVRINIT()</code>, or <code class="cCode">TPSVRDONE()</code>), then the routine returns with no effect.
</p>
<h4 class="pHeading3"><a name="wp1268552"> </a>
Usage
</h4>
<p class="pBody"><a name="wp1269827"> </a>
When called in <code class="cCode">TPSVRINIT()</code>, the <code class="cCode">TPRETURN()</code> and <code class="cCode">TPFORWAR()</code> routines simply return with no effect.
</p>
<h4 class="pHeading3"><a name="wp1269848"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1269846"> </a>
<a href="rf3cbl.html#wp1000732"><code class="cCode">TPOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1001902"><code class="cCode">TPSVRDONE(3cbl)</code></a>
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1269572"> </a>
TPTERM(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002010"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002011"> </a>
<code class="cCode">TPTERM()</code> - leaves an application
</p>
<h4 class="pHeading3"><a name="wp1002012"> </a>
Synopsis
</h4>
<a name="wp1002013"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br />CALL &quot;TPTERM&quot; USING </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002014"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002015"> </a>
<code class="cCode">TPTERM()</code> removes a client from an Oracle Tuxedo ATMI application. If the client is in transaction mode, then the transaction is rolled back. When <code class="cCode">TPTERM()</code> returns successfully, the caller can no longer perform Oracle Tuxedo client operations. Any outstanding conversations are immediately disconnected.
</p>
<p class="pBody"><a name="wp1122644"> </a>
If <code class="cCode">TPTERM()</code> is called more than once (that is, if it is called after the caller has already left the application), no action is taken and success is returned.
</p>
<h5 class="pHeading4"><a name="wp1122650"> </a>
Multi-contexting Issues
</h5>
<p class="pBody"><a name="wp1122651"> </a>
After invoking <code class="cCode">TPTERM()</code>, a program is placed in the <code class="cCode">TPNULLCONTEXT</code> context. Most ATMI functions invoked by a program in the <code class="cCode">TPNULLCONTEXT</code> context perform an implicit <code class="cCode">TPINITIALIZE()</code>. Whether or not the call to <code class="cCode">TPINITIALIZE()</code> succeeds depends on the usual determining factors, unrelated to context-specific issues.
</p>
<h4 class="pHeading3"><a name="wp1122645"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1002018"> </a>
Upon successful completion, <code class="cCode">TPTERM()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. Upon success in a multi-contexted application, the application&#8217;s current context is changed to <code class="cCode">TPNULLCONTEXT</code>. It is the user&#8217;s responsibility to use <code class="cCode">TPSETCTXT()</code> to change the context subsequently, as desired.
</p>
<p class="pBody"><a name="wp1123207"> </a>
Upon failure, <code class="cCode">TPTERM()</code> returns -1 and sets <code class="cCode">TP-STATUS</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1002019"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002020"> </a>
Upon failure, <code class="cCode">TPTERM()</code> sets <code class="cCode">TP-STATUS</code> to one of the following values:
</p>
<h4 class="pDefTerm"><a name="wp1002021"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1002022"> </a>
<code class="cCode">TPTERM()</code> was called in an improper context (for example, the caller is a server).
</div>
<h4 class="pDefTerm"><a name="wp1002023"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1002024"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1002025"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1002026"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1002027"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002028"> </a>
<a href="rf3cbl.html#wp1000457"><code class="cCode">TPINITIALIZE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002068"> </a>
TPUNADVERTISE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002069"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002070"> </a>
<code class="cCode">TPUNADVERTISE()</code> - routine for unadvertising service names
</p>
<h4 class="pHeading3"><a name="wp1002071"> </a>
Synopsis
</h4>
<a name="wp1002072"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">SVC-NAME</code><code class="cCode"> PIC X(127). <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br />CALL &quot;TPUNADVERTISE&quot; USING </code><code class="cCodeEmphasis">SVC-NAME</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002073"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002074"> </a>
<code class="cCode">TPUNADVERTISE()</code> allows a server to unadvertise a service that it offers. By default, a server&#8217;s services are advertised when it is booted and they are unadvertised when it is shut down.
</p>
<p class="pBody"><a name="wp1002075"> </a>
All servers belonging to a multiple server, single queue (MSSQ) set must offer the same set of services. These routines enforce this rule by affecting the advertisements of all servers sharing an MSSQ set.
</p>
<p class="pBody"><a name="wp1002076"> </a>
<code class="cCode">TPUNADVERTISE()</code> removes <code class="cCodeEmphasis">SVC-NAME</code> as an advertised service for the server (or the set of servers sharing the caller&#8217;s MSSQ set). <code class="cCodeEmphasis">SVC-NAME</code> cannot be <code class="cCode">SPACES</code>. Also, <code class="cCodeEmphasis">SVC-NAME</code> should be 127 characters or less. (See the <code class="cCode">SERVICES</code> section of <a href="../rf5/rf5.html">UBBCONFIG(5)</a>). Longer names will be accepted and truncated to 127 characters. Care should be taken such that truncated names do not match other service names.
</p>
<h4 class="pHeading3"><a name="wp1002077"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1002078"> </a>
Upon successful completion, <code class="cCode">TPUNADVERTISE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>].
</p>
<h4 class="pHeading3"><a name="wp1002079"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002080"> </a>
Under the following conditions, <code class="cCode">TPUNADVERTISE()</code> fails and sets <code class="cCode">TP-STATUS</code> to: 
</p>
<h4 class="pDefTerm"><a name="wp1002081"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1002082"> </a>
Invalid arguments were given (for example <code class="cCodeEmphasis">SVC-NAME</code> is <code class="cCode">SPACES</code>).
</div>
<h4 class="pDefTerm"><a name="wp1002083"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1002084"> </a>
<code class="cCodeEmphasis">SVC-NAME</code> is not currently advertised by the server.
</div>
<h4 class="pDefTerm"><a name="wp1002085"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1002086"> </a>
<code class="cCode">TPUNADVERTISE()</code> was called in an improper context (for example, by a client).
</div>
<h4 class="pDefTerm"><a name="wp1002087"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1002088"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1002089"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1002090"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1002091"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002092"> </a>
<a href="rf3cbl.html#wp998560"><code class="cCode">TPADVERTISE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002132"> </a>
TPUNSUBSCRIBE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002133"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002134"> </a>
<code class="cCode">TPUNSUBSCRIBE()</code> - unsubscribe to an event
</p>
<h4 class="pHeading3"><a name="wp1002135"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1002136"> </a>
<code style="font-style: normal" class="cCode">01 </code><span style="font-style: italic">TPEVTDEF-REC</span><code style="font-style: normal" class="cCode">.<br /> COPY TPEVTDEF.<br />01 </code><span style="font-style: italic">TPSTATUS-REC</span><code style="font-style: normal" class="cCode">.<br /> COPY TPSTATUS.<br />CALL &quot;TPUNSUBSCRIBE&quot; USING </code><span style="font-style: italic">TPEVTDEF-REC</span><code style="font-style: normal" class="cCode"> </code><span style="font-style: italic">TPSTATUS-REC</span><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp1002137"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002138"> </a>
The caller uses <code class="cCode">TPUNSUBSCRIBE()</code> to remove an event subscription or a set of event subscriptions from the Oracle Tuxedo EventBroker&#8217;s list of active subscriptions. <code class="cCode">SUBSCRIPTION-HANDLE</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> is an event subscription handle returned by <code class="cCode">TPSUBSCRIBE()</code>. Setting <code class="cCode">SUBSCRIPTION-HANDLE </code>to the wildcard value, -1, directs <code class="cCode">TPUNSUBSCRIBE()</code> to unsubscribe to all non-persistent subscriptions previously made by the calling process. Non-persistent subscriptions are those made with <code class="cCode">TPEVNOPERSIST</code> set when <code class="cCode">TPSUBSCRIBE()</code> was called. Persistent subscriptions can be deleted only by using the handle returned by <code class="cCode">TPSUBSCRIBE()</code>.
</p>
<p class="pBody"><a name="wp1002139"> </a>
Note that the <code class="cCode">-1</code> handle removes only those subscriptions made by the calling process and not any made by previous instantiations of the caller (for example, a server that dies and restarts cannot use the wildcard to unsubscribe to any subscriptions made by the original server).
</p>
<p class="pBody"><a name="wp1002140"> </a>
The following is a list of valid settings in <code class="cCodeEmphasis">TPEVTDEF-REC</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1002141"> </a>
<code class="cCode">TPNOBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1002142"> </a>
The subscription is not removed if a blocking condition exists. If such a condition occurs, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPEBLOCK</code>]. Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1002143"> </a>
<code class="cCode">TPBLOCK</code> 
</h4><div class="pDefPara"><a name="wp1002144"> </a>
When <code class="cCode">TPBLOCK</code> is specified and a blocking condition exists, the caller blocks until the condition subsides or a timeout occurs (either transaction or blocking timeout). Either <code class="cCode">TPNOBLOCK</code> or <code class="cCode">TPBLOCK</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1002145"> </a>
<code class="cCode">TPNOTIME</code> 
</h4><div class="pDefPara"><a name="wp1002146"> </a>
This setting signifies that the caller is willing to block indefinitely and wants to be immune to blocking timeouts. Transaction timeouts may still occur. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1002147"> </a>
<code class="cCode">TPTIME</code> 
</h4><div class="pDefPara"><a name="wp1002148"> </a>
This setting signifies that the caller will receive blocking timeouts if a blocking condition exists and the blocking time is reached. Either <code class="cCode">TPNOTIME</code> or <code class="cCode">TPTIME</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1002149"> </a>
<code class="cCode">TPSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1002150"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is reissued. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pDefTerm"><a name="wp1002151"> </a>
<code class="cCode">TPNOSIGRSTRT</code> 
</h4><div class="pDefPara"><a name="wp1002152"> </a>
If a signal interrupts any underlying system calls, then the interrupted system call is not restarted, the call fails and sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPGOTSIG</code>]. Either <code class="cCode">TPNOSIGRSTRT</code> or <code class="cCode">TPSIGRSTRT</code> must be set.
</div>
<h4 class="pHeading3"><a name="wp1002153"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1002154"> </a>
Upon successful completion, <code class="cCode">TPUNSUBSCRIBE()</code> sets <code class="cCode">TP-STATUS</code> to [<code class="cCode">TPOK</code>]. In addition, <code class="cCode">TPUNSUBSCRIBE()</code> sets <code class="cCode">EVENT-COUNT</code> in <code class="cCodeEmphasis">TPEVTDEF-REC</code> to the number of subscriptions deleted (zero or greater) from the EventBroker&#8217;s list of active subscriptions. <code class="cCode">EVENT-COUNT</code> may contain a number greater than 1 only when the wildcard handle, -1, is used. Also,<code class="cCode"> EVENT-COUNT</code> may contain a number greater than 0 even when <code class="cCode">TPUNSUBSCRIBE()</code> completes unsuccessfully (that is, when the wildcard handle is used, the EventBroker may have successfully removed some subscriptions before it encountered an error deleting others).
</p>
<h4 class="pHeading3"><a name="wp1002155"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002156"> </a>
Under the following conditions, <code class="cCode">TPUNSUBSCRIBE()</code> fails and sets <code class="cCode">TP-STATUS</code> to one of the following values. (Unless otherwise noted, failure does not affect the caller&#8217;s transaction, if one exists.) 
</p>
<h4 class="pDefTerm"><a name="wp1002157"> </a>
[<code class="cCode">TPEINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1002158"> </a>
Invalid arguments were given (for example, <code class="cCode">SUBSCRIPTION-HANDLE</code> is an invalid subscription handle).
</div>
<h4 class="pDefTerm"><a name="wp1002159"> </a>
[<code class="cCode">TPENOENT</code>] 
</h4><div class="pDefPara"><a name="wp1002160"> </a>
Cannot access the Oracle Tuxedo EventBroker.
</div>
<h4 class="pDefTerm"><a name="wp1002161"> </a>
[<code class="cCode">TPETIME</code>] 
</h4><div class="pDefPara"><a name="wp1276719"> </a>
This error code indicates that either a timeout has occurred or <code class="cCode">TPUNSUBSCRIBE()</code> has been attempted, in spite of the fact that the current transaction is already marked rollback only.
</div>
<div class="pDefParaCont"><a name="wp1276720"> </a>
If the caller is in transaction mode, then either the transaction is already rollback only or a transaction timeout has occurred. The transaction is marked abort-only. If the caller is not in transaction mode, a blocking timeout has occurred. (A blocking timeout can occur only if both <code class="cCode">TPBLOCK</code> and <code class="cCode">TPTIME</code> are specified.)
<a name="wp1276721"> </a>
If a transaction timeout has occurred, then, with one exception, any attempts to send new requests or receive outstanding replies will fail with <code class="cCode">TPETIME</code> until the transaction has been aborted. The exception is a request that does not block, expects no reply, and is not sent on behalf of the caller&#8217;s transaction (that is, <code class="cCode">TPACALL()</code> with <code class="cCode">TPNOTRAN</code>, <code class="cCode">TPNOBLOCK</code>, and <code class="cCode">TPNOREPLY</code> set).
<a name="wp1276722"> </a>
When a transactional ATMI call fails inside a transaction, the transaction is put into the <code class="cCode">TX_ROLLBACK_ONLY</code> state. This state is treated, for most purposes, as though it were equivalent to a timeout. All further ATMI calls for this transaction (with the exception of those issued in the circumstances described in the previous paragraph) will fail with <code class="cCode">TPETIME</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002163"> </a>
[<code class="cCode">TPEBLOCK</code>] 
</h4><div class="pDefPara"><a name="wp1002164"> </a>
A blocking condition exists and <code class="cCode">TPNOBLOCK</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1002165"> </a>
[<code class="cCode">TPGOTSIG</code>] 
</h4><div class="pDefPara"><a name="wp1002166"> </a>
A signal was received and <code class="cCode">TPNOSIGRSTRT</code> was specified.
</div>
<h4 class="pDefTerm"><a name="wp1002167"> </a>
[<code class="cCode">TPEPROTO</code>] 
</h4><div class="pDefPara"><a name="wp1002168"> </a>
<code class="cCode">TPUNSUBSCRIBE()</code> was called improperly.
</div>
<h4 class="pDefTerm"><a name="wp1002169"> </a>
[<code class="cCode">TPESYSTEM</code>] 
</h4><div class="pDefPara"><a name="wp1002170"> </a>
An Oracle Tuxedo system error has occurred. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1002171"> </a>
[<code class="cCode">TPEOS</code>] 
</h4><div class="pDefPara"><a name="wp1002172"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1002173"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002174"> </a>
<a href="rf3cbl.html#wp1000793"><code class="cCode">TPPOST(3cbl)</code></a>, <a href="rf3cbl.html#wp1001590"><code class="cCode">TPSUBSCRIBE(3cbl)</code></a>, <a href="../rf5/rf5.html">EVENTS(5)</a>, <a href="../rf5/rf5.html">EVENT_MIB(5)</a>, <a href="../rf5/rf5.html">TMSYSEVT(5)</a>, <a href="../rf5/rf5.html">TMUSREVT(5)</a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002230"> </a>
TXBEGIN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002231"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002232"> </a>
<code class="cCode">TXBEGIN()</code> - begin a global transaction
</p>
<h4 class="pHeading3"><a name="wp1002233"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1002234"> </a>
<code class="cCode">01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />CALL &quot;TXBEGIN&quot; USING </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.</code>
</p>
<h4 class="pHeading3"><a name="wp1002235"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002236"> </a>
<code class="cCode">TXBEGIN()</code> is used to place the calling thread of control in transaction mode. The calling thread must first ensure that its linked resource managers have been opened (via <code class="cCode">TXOPEN()</code>) before it can start transactions. <code class="cCode">TXBEGIN</code> fails (with a <code class="cCode">TX-STATUS</code> value of [<code class="cCode">TX-PROTOCOL-ERROR</code>]) if the caller is already in transaction mode or <code class="cCode">TXOPEN()</code> has not been called.
</p>
<p class="pBody"><a name="wp1002237"> </a>
Once in transaction mode, the calling thread must call <code class="cCode">TXCOMMIT()</code> or <code class="cCode">TXROLLBACK()</code> to complete its current transaction. There are certain cases related to transaction chaining where <code class="cCode">TXBEGIN()</code> does not need to be called explicitly to start a transaction. See <code class="cCode">TXCOMMIT()</code> and <code class="cCode">TXROLLBACK()</code> for details. <code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1210648"> </a>
Optional Set-up
</h4>
<p class="pBody"><a name="wp1210649"> </a>
<code class="cCode">TXSETTIMEOUT()</code>
</p>
<h4 class="pHeading3"><a name="wp1210650"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002241"> </a>
Upon successful completion, <code class="cCode">TXBEGIN()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002242"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002243"> </a>
Under the following conditions, <code class="cCode">TXBEGIN()</code> fails and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1002244"> </a>
[<code class="cCode">TX-OUTSIDE</code>] 
</h4><div class="pDefPara"><a name="wp1002245"> </a>
The transaction manager is unable to start a global transaction because the calling thread of control is currently participating in work outside any global transaction with one or more resource managers. All such work must be completed before a global transaction can be started. The caller&#8217;s state with respect to the local transaction is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1002246"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002247"> </a>
The function was called in an improper context (for example, the caller is already in transaction mode). The caller&#8217;s state with respect to transaction mode is unchanged.
</div>
<h4 class="pDefTerm"><a name="wp1002248"> </a>
[<code class="cCode">TX-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002249"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error trying to start a new transaction. When this error is returned, the caller is not in transaction mode. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1002250"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002251"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. When this error is returned, the caller is not in transaction mode. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002252"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002253"> </a>
<a href="rf3cbl.html#wp1002357"><code class="cCode">TXCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1009819"><code class="cCode">TXROLLBACK(3cbl)</code></a>, <a href="rf3cbl.html#wp998698"><code class="cCode">TXSETTIMEOUT(3cbl)</code></a> 
</p>
<h4 class="pHeading3"><a name="wp1002254"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1002255"> </a>
XA-compliant resource managers must be successfully opened to be included in the global transaction. (See <code class="cCode">TXOPEN</code> for details.)
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002297"> </a>
TXCLOSE(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002298"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002299"> </a>
<code class="cCode">TXCLOSE()</code> - close a set of resource managers
</p>
<h4 class="pHeading3"><a name="wp1002300"> </a>
Synopsis
</h4>
<a name="wp1002301"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />PROCEDURE DIVISION. <br />CALL &quot;TXCLOSE&quot; USING </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002302"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002303"> </a>
<code class="cCode">TXCLOSE()</code> closes a set of resource managers in a portable manner. It invokes a transaction manager to read resource manager-specific information in a transaction manager-specific manner and pass this information to the resource managers linked to the caller.
</p>
<p class="pBody"><a name="wp1002304"> </a>
<code class="cCode">TXCLOSE()</code> closes all resource managers to which the caller is linked. This function is used in place of resource-manager-specific &#8220;close&#8221; calls and allows an application program to be free of calls which may hinder portability. Since resource managers differ in their termination semantics, the specific information needed to &#8220;close&#8221; a particular resource manager must be published by each resource manager.
</p>
<p class="pBody"><a name="wp1002305"> </a>
<code class="cCode">TXCLOSE()</code> should be called when an application thread of control no longer wishes to participate in global transactions. <code class="cCode">TXCLOSE()</code> fails (returning [<code class="cCode">TX-PROTOCOL-ERROR</code>]) if the caller is in transaction mode. That is, no resource managers are closed even though some may not be participating in the current transaction.
</p>
<p class="pBody"><a name="wp1002306"> </a>
When <code class="cCode">TXCLOSE()</code> returns success (<code class="cCode">TX-OK</code>), all resource managers linked to the calling thread are closed.
</p>
<p class="pBody"><a name="wp1002307"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002308"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002309"> </a>
Upon successful completion, <code class="cCode">TXCLOSE()</code> returns <code class="cCode">TX-OK</code>, a non-negative value.
</p>
<h4 class="pHeading3"><a name="wp1002310"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002311"> </a>
Under the following conditions, <code class="cCode">TXCLOSE()</code> fails and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp1002312"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002313"> </a>
The function was called in an improper context (for example, the caller is in transaction mode). No resource managers are closed.
</div>
<h4 class="pDefTerm"><a name="wp1002314"> </a>
[<code class="cCode">TX-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002315"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error. The exact nature of the error is written to a log file. All resource managers that could be closed are closed.
</div>
<h4 class="pDefTerm"><a name="wp1002316"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002317"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002318"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002319"> </a>
<a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002357"> </a>
TXCOMMIT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002358"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002359"> </a>
<code class="cCode">TXCOMMIT()</code> - commit a transaction
</p>
<h4 class="pHeading3"><a name="wp1002360"> </a>
Synopsis
</h4>
<a name="wp1002361"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION. <br />* Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />PROCEDURE DIVISION. <br />CALL &quot;TXCOMMIT&quot; USING </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002362"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002363"> </a>
<code class="cCode">TXCOMMIT()</code> is used to commit the work of the transaction active in the caller&#8217;s thread of control.
</p>
<p class="pBody"><a name="wp1002364"> </a>
If the <code class="cCodeEmphasis">transaction_control</code> characteristic (see <code class="cCode">TXSETTRANCTL()</code>) is <code class="cCode">TX-UNCHAINED</code>, then when <code class="cCode">TXCOMMIT()</code> returns, the caller is no longer in transaction mode. However, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, then when <code class="cCode">TXCOMMIT()</code> returns, the caller remains in transaction mode on behalf of a new transaction (see the <code class="cCode">RETURN VALUE</code> and <code class="cCode">ERRORS</code> sections below).
</p>
<p class="pBody"><a name="wp1002365"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002366"> </a>
Optional Set-up
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1002367"> </a><code class="cCode">TXSETCOMMITRET()</code></li>
<li><a name="wp1002368"> </a><code class="cCode">TXSETTRANCTL()</code></li>
<li><a name="wp1002369"> </a><code class="cCode">TXSETTIMEOUT()</code></li>
</ul></div>
<h4 class="pHeading3"><a name="wp1002370"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002371"> </a>
Upon successful completion, <code class="cCode">TXCOMMIT()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002372"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002373"> </a>
Under the following conditions, <code class="cCode">TXCOMMIT()</code> fails and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp1002374"> </a>
[<code class="cCode">TX-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002375"> </a>
The current transaction committed successfully; however, a new transaction could not be started and the caller is no longer in transaction mode. This return value may occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002376"> </a>
[<code class="cCode">TX-ROLLBACK</code>] 
</h4><div class="pDefPara"><a name="wp1002377"> </a>
The current transaction could not commit and has been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002378"> </a>
[<code class="cCode">TX-ROLLBACK-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002379"> </a>
The transaction could not commit and has been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002380"> </a>
[<code class="cCode">TX-MIXED</code>] 
</h4><div class="pDefPara"><a name="wp1002381"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002382"> </a>
[<code class="cCode">TX-MIXED-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002383"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002384"> </a>
[<code class="cCode">TX-HAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1002385"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002386"> </a>
[<code class="cCode">TX-HAZARD-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002387"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002388"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002389"> </a>
The function was called in an improper context (for example, the caller is not in transaction mode). The caller&#8217;s state with respect to transaction mode is not changed.
</div>
<h4 class="pDefTerm"><a name="wp1002390"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002391"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file. The caller&#8217;s state with respect to the transaction is unknown.
</div>
<h4 class="pHeading3"><a name="wp1002392"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002393"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp1002642"><code class="cCode">TXSETCOMMITRET(3cbl)</code></a>, <a href="rf3cbl.html#wp998698"><code class="cCode">TXSETTIMEOUT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002713"><code class="cCode">TXSETTRANCTL(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002447"> </a>
TXINFORM(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002448"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002449"> </a>
<code class="cCode">TXINFORM()</code> - return global transaction information
</p>
<h4 class="pHeading3"><a name="wp1002450"> </a>
Synopsis
</h4>
<a name="wp1002451"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />01 </code><code class="cCodeEmphasis">TX-INFO-AREA</code><code class="cCode">.<br /> COPY TXINFDEF. <br />PROCEDURE DIVISION. <br />CALL &quot;TXINFORM&quot; USING </code><code class="cCodeEmphasis">TX-INFO-AREA, TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002452"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002453"> </a>
<code class="cCode">TXINFORM()</code> returns global transaction information in <code class="cCodeEmphasis">TX-INFO-AREA</code>. In addition, this function returns a value indicating whether the caller is currently in transaction mode or not.
</p>
<p class="pBody"><a name="wp1002454"> </a>
<code class="cCode">TXINFORM()</code> populates the <code class="cCodeEmphasis">TX-INFO-AREA</code> record with global transaction information. The contents of the <code class="cCodeEmphasis">TX-INFO-AREA</code> record are described under <code class="cCode">INTRO()</code>.
</p>
<p class="pBody"><a name="wp1002455"> </a>
If <code class="cCode">TXINFORM</code> is called in transaction mode, then <code class="cCode">TX-IN-TRAN</code> is set, <code class="cCodeEmphasis">XID-REC</code> will be populated with a current transaction branch identifier and <code class="cCode">TRANSACTION-STATE</code> will contain the state of the current transaction. If the caller is not in transaction mode, <code class="cCode">TX-NOT-IN-TRAN</code> is set and <code class="cCodeEmphasis">XID-REC</code> will be populated with the NULL XID (see <code class="cCode">TXINTRO</code> for details). In addition, regardless of whether the caller is in transaction mode, <code class="cCodeEmphasis">COMMIT-RETURN,</code> <code class="cCodeEmphasis">TRANSACTION-CONTROL,</code> and <code class="cCodeEmphasis">TRANSACTION-TIMEOUT</code> contain the current settings of the <code class="cCodeEmphasis">commit_return</code> and <code class="cCodeEmphasis">transaction_control</code> characteristics, and the transaction timeout value in seconds.
</p>
<p class="pBody"><a name="wp1189154"> </a>
The transaction timeout value returned reflects the setting that will be used when the next transaction is started. Thus, it may not reflect the timeout value for the caller&#8217;s current global transaction since calls made to <code class="cCode">TXSETTIMEOUT()</code> after the current transaction was begun may have changed its value.
</p>
<p class="pBody"><a name="wp1002457"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002458"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002459"> </a>
Upon successful completion, <code class="cCode">TXINFORM()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002460"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002461"> </a>
Under the following conditions, <code class="cCode">TXINFORM()</code> fails and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp1002462"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002463"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">TXOPEN()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1002464"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002465"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002466"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002467"> </a>
<a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1002642"><code class="cCode">TXSETCOMMITRET(3cbl)</code></a>, <a href="rf3cbl.html#wp998698"><code class="cCode">TXSETTIMEOUT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002713"><code class="cCode">TXSETTRANCTL(3cbl)</code></a> 
</p>
<h4 class="pHeading3"><a name="wp1002468"> </a>
Warnings
</h4>
<p class="pBody"><a name="wp1002469"> </a>
Within the same global transaction, subsequent calls to <code class="cCode">TXINFORM</code> are guaranteed to provide an XID with the same <code class="cCodeEmphasis">gtrid</code> component, but not necessarily the same <code class="cCodeEmphasis">bqual</code> component.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002509"> </a>
TXOPEN(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002510"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002511"> </a>
<code class="cCode">TXOPEN()</code> - open a set of resource managers
</p>
<h4 class="pHeading3"><a name="wp1002512"> </a>
Synopsis
</h4>
<a name="wp1002513"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />PROCEDURE DIVISION. <br />CALL &quot;TXOPEN&quot; USING </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002514"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002515"> </a>
<code class="cCode">TXOPEN()</code> opens a set of resource managers in a portable manner. It invokes a transaction manager to read resource manager-specific information in a transaction manager-specific manner and pass this information to the resource managers linked to the caller.
</p>
<p class="pBody"><a name="wp1002516"> </a>
<code class="cCode">TXOPEN()</code> attempts to open all resource managers that have been linked with the application. This function is used in place of resource manager-specific &#8220;open&#8221; calls and allows an application program to be free of calls which may hinder portability. Since resource managers differ in their initialization semantics, the specific information needed to &#8220;open&#8221; a particular resource manager must be published by each resource manager.
</p>
<p class="pBody"><a name="wp1002517"> </a>
If <code class="cCode">TXOPEN()</code> returns <code class="cCode">TX-ERROR</code>, then no resource managers are open. If <code class="cCode">TXOPEN()</code> returns <code class="cCode">TX-OK</code>, some or all of the resource managers have been opened. Resource managers that are not open will return resource manager-specific errors when accessed by the application. <code class="cCode">TXOPEN()</code> must successfully return before a thread of control participates in global transactions.
</p>
<p class="pBody"><a name="wp1002518"> </a>
Once <code class="cCode">TXOPEN()</code> returns success, subsequent calls to <code class="cCode">TXOPEN</code> (before an intervening call to <code class="cCode">TXCLOSE()</code>) are allowed. However, such subsequent calls will return success, and the TM will not attempt to reopen any RMs.
</p>
<p class="pBody"><a name="wp1002519"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002520"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002521"> </a>
Upon successful completion, <code class="cCode">TXOPEN()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002522"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002523"> </a>
Under the following conditions, <code class="cCode">TXOPEN()</code> fails and returns one of these negative values.
</p>
<h4 class="pDefTerm"><a name="wp1002524"> </a>
[<code class="cCode">TX-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002525"> </a>
Either the transaction manager or one or more of the resource managers encountered a transient error. No resource managers are open. The exact nature of the error is written to a log file.
</div>
<h4 class="pDefTerm"><a name="wp1002526"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002527"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002528"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1009818"> </a>
<a href="rf3cbl.html#wp1002297"><code class="cCode">TXCLOSE(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1009819"> </a>
TXROLLBACK(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1009820"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002569"> </a>
<code class="cCode">TXROLLBACK()</code> - roll back a transaction
</p>
<h4 class="pHeading3"><a name="wp1002570"> </a>
Synopsis
</h4>
<a name="wp1002571"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />PROCEDURE DIVISION. <br />CALL &quot;TXROLLBACK&quot; USING </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002572"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002573"> </a>
<code class="cCode">TXROLLBACK()</code> is used to roll back the work of the transaction active in the caller&#8217;s thread of control.
</p>
<p class="pBody"><a name="wp1002574"> </a>
If the <code class="cCodeEmphasis">transaction_control</code> characteristic (see <code class="cCode">TXSETTRANCTL()</code>) is <code class="cCode">TX-UNCHAINED</code>, then when <code class="cCode">TXROLLBACK()</code> returns, the caller is no longer in transaction mode. However, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, then when <code class="cCode">TXROLLBACK()</code> returns, the caller remains in transaction mode on behalf of a new transaction (see the <code class="cCode">RETURN VALUE </code>and <code class="cCode">ERRORS</code> sections below).
</p>
<p class="pBody"><a name="wp1002575"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002576"> </a>
Optional Set-up
</h4>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1002577"> </a><code class="cCode">TXSETTRANCTL()</code></li>
<li><a name="wp1002578"> </a><code class="cCode">TXSETTIMEOUT()</code></li>
</ul></div>
<h4 class="pHeading3"><a name="wp1002579"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002580"> </a>
Upon successful completion, <code class="cCode">TXROLLBACK()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002581"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002582"> </a>
Under the following conditions, <code class="cCode">TXROLLBACK()</code> fails and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp1002583"> </a>
[<code class="cCode">TX-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002584"> </a>
The current transaction rolled back; however, a new transaction could not be started and the caller is no longer in transaction mode. This return value may occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002585"> </a>
[<code class="cCode">TX-MIXED</code>] 
</h4><div class="pDefPara"><a name="wp1002586"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002587"> </a>
[<code class="cCode">TX-MIXED-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002588"> </a>
The work done on behalf of the transaction was partially committed and partially rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002589"> </a>
[<code class="cCode">TX-HAZARD</code>] 
</h4><div class="pDefPara"><a name="wp1002590"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002591"> </a>
[<code class="cCode">TX-HAZARD-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002592"> </a>
Due to a failure, some of the work done on behalf of the transaction may have been committed and some of it may have been rolled back. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002593"> </a>
[<code class="cCode">TX-COMMITTED</code>] 
</h4><div class="pDefPara"><a name="wp1002594"> </a>
The work done on behalf of the transaction was heuristically committed. In addition, if the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>, a new transaction is started.
</div>
<h4 class="pDefTerm"><a name="wp1002595"> </a>
[<code class="cCode">TX-COMMITTED-NO-BEGIN</code>] 
</h4><div class="pDefPara"><a name="wp1002596"> </a>
The work done on behalf of the transaction was heuristically committed. In addition, a new transaction could not be started and the caller is no longer in transaction mode. This return value can occur only when the <code class="cCodeEmphasis">transaction_control</code> characteristic is <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002597"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002598"> </a>
The function was called in an improper context (for example, the caller is not in transaction mode).
</div>
<h4 class="pDefTerm"><a name="wp1002599"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002600"> </a>
Either the transaction manager or one or more of the resource managers encountered a fatal error. The nature of the error is such that the transaction manager and/or one or more of the resource managers can no longer perform work on behalf of the application. The exact nature of the error is written to a log file. The caller&#8217;s state with respect to the transaction is unknown.
</div>
<h4 class="pHeading3"><a name="wp1002601"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002602"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp998698"><code class="cCode">TXSETTIMEOUT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002713"><code class="cCode">TXSETTRANCTL(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002642"> </a>
TXSETCOMMITRET(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002643"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002644"> </a>
<code class="cCode">TXSETCOMMITRET()</code> - set <code class="cCode">commit_return</code> characteristic
</p>
<h4 class="pHeading3"><a name="wp1002645"> </a>
Synopsis
</h4>
<a name="wp1002646"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />*<br />01 </code><code class="cCodeEmphasis">TX-INFO-AREA</code><code class="cCode">.<br /> COPY TXINFDEF. <br />PROCEDURE DIVISION. <br />CALL &quot;TXSETCOMMITRET&quot; USING </code><code class="cCodeEmphasis">TX-INFO-AREA TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002647"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002648"> </a>
<code class="cCode">TXSETCOMMITRET()</code> sets the <code class="cCodeEmphasis">commit_return</code> characteristic to the value specified in <code class="cCodeEmphasis">COMMIT-RETURN</code>. This characteristic affects the way <code class="cCode">TXCOMMIT()</code> behaves with respect to returning control to its caller. <code class="cCode">TXSETCOMMITRET()</code> may be called regardless of whether its caller is in transaction mode. This setting remains in effect until changed by a subsequent call to <code class="cCode">TXSETCOMMITRET()</code>.
</p>
<p class="pBody"><a name="wp1002649"> </a>
The initial setting for this characteristic is <code class="cCode">TX-COMMIT-COMPLETED</code>.
</p>
<p class="pBody"><a name="wp1002650"> </a>
The following are the valid settings for <code class="cCodeEmphasis">COMMIT-RETURN</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1002651"> </a>
<code class="cCode">TX-COMMIT-DECISION-LOGGED</code> 
</h4><div class="pDefPara"><a name="wp1002652"> </a>
This flag indicates that <code class="cCode">TXCOMMIT()</code> should return after the commit decision has been logged by the first phase of the two-phase commit protocol but before the second phase has completed. This setting allows for faster response to the caller of <code class="cCode">TXCOMMIT()</code>. However, there is a risk that a transaction will have a heuristic outcome, in which case the caller will not find out about this situation via return codes from <code class="cCode">TXCOMMIT()</code>. Under normal conditions, participants that promise to commit during the first phase will do so during the second phase. In certain unusual circumstances however (for example, long-lasting network or node failures) phase 2 completion may not be possible and heuristic results may occur.
</div>
<h4 class="pDefTerm"><a name="wp1002653"> </a>
<code class="cCode">TX-COMMIT-COMPLETED</code> 
</h4><div class="pDefPara"><a name="wp1002654"> </a>
This flag indicates that <code class="cCode">TXCOMMIT()</code> should return after the two-phase commit protocol has finished completely. This setting allows the caller of <code class="cCode">TXCOMMIT()</code> to see return codes that indicate that a transaction had or may have had heuristic results.
</div>
<p class="pBody"><a name="wp1002655"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp1002656"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002657"> </a>
Upon successful completion, <code class="cCode">TXSETCOMMITRET()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002658"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002659"> </a>
Under the following conditions, <code class="cCode">TXSETCOMMITRET()</code> does not change the setting of the <code class="cCodeEmphasis">commit_return</code> characteristic and returns one of these negative values: 
</p>
<h4 class="pDefTerm"><a name="wp1002660"> </a>
[<code class="cCode">TX-EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1002661"> </a>
<code class="cCodeEmphasis">COMMIT-RETURN</code> is not one of <code class="cCode">TX-COMMIT-DECISION-LOGGED</code> or <code class="cCode">TX-COMMIT-COMPLETED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002662"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002663"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">TXOPEN()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1002664"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp1002665"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002666"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1094809"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp1002357"><code class="cCode">TXCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002447"><code class="cCode">TXINFORM(3cbl)</code></a>, <a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1009819"><code class="cCode">TXROLLBACK(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1002713"> </a>
TXSETTRANCTL(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp1002714"> </a>
Name
</h4>
<p class="pBody"><a name="wp1002715"> </a>
<code class="cCode">TXSETTRANCTL()</code> - set <code class="cCodeEmphasis">transaction_control</code> characteristic
</p>
<h4 class="pHeading3"><a name="wp1002716"> </a>
Synopsis
</h4>
<a name="wp1002717"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />01 </code><code class="cCodeEmphasis">TX-INFO-AREA</code><code class="cCode">.<br /> COPY TXINFDEF. <br />PROCEDURE DIVISION. <br />CALL &quot;TXSETTRANCTL&quot; USING </code><code class="cCodeEmphasis">TX-INFO-AREA TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp1002718"> </a>
Description
</h4>
<p class="pBody"><a name="wp1002719"> </a>
<code class="cCode">TXSETTRANCTL()</code> sets the <code class="cCodeEmphasis">transaction_control</code> characteristic to the value specified in <code class="cCodeEmphasis">TRANSACTION-CONTROL</code>. This characteristic determines whether <code class="cCode">TXCOMMIT()</code> and <code class="cCode">TXROLLBACK()</code> start a new transaction before returning to their caller. <code class="cCode">TXSETTRANCTL()</code> may be called regardless of whether the application program is in transaction mode. This setting remains in effect until changed by a subsequent call to <code class="cCode">TXSETTRANCTL()</code>.
</p>
<p class="pBody"><a name="wp1002720"> </a>
The initial setting for this characteristic is <code class="cCode">TX-UNCHAINED</code>.
</p>
<p class="pBody"><a name="wp1002721"> </a>
The following are the valid settings for <code class="cCodeEmphasis">TRANSACTION-CONTROL</code>. 
</p>
<h4 class="pDefTerm"><a name="wp1002722"> </a>
<code class="cCode">TX-UNCHAINED</code> 
</h4><div class="pDefPara"><a name="wp1002723"> </a>
This flag indicates that <code class="cCode">TXCOMMIT()</code> and <code class="cCode">TXROLLBACK()</code> should not start a new transaction before returning to their caller. The caller must issue <code class="cCode">TXBEGIN()</code> to start a new transaction.
</div>
<h4 class="pDefTerm"><a name="wp1002724"> </a>
<code class="cCode">TX-CHAINED</code> 
</h4><div class="pDefPara"><a name="wp1002725"> </a>
This flag indicates that <code class="cCode">TXCOMMIT()</code> and <code class="cCode">TXROLLBACK()</code> should start a new transaction before returning to their caller.
<a name="wp1002726"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</div>
<h4 class="pHeading3"><a name="wp1002727"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp1002728"> </a>
Upon successful completion, <code class="cCode">TXSETTRANCTL()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp1002729"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1002730"> </a>
Under the following conditions, <code class="cCode">TXSETTRANCTL()</code> does not change the setting of the <code class="cCodeEmphasis">transaction_control</code> characteristic and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp1002731"> </a>
[<code class="cCode">TX-EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp1002732"> </a>
<code class="cCodeEmphasis">TRANSACTION-CONTROL</code> is not one of <code class="cCode">TX-UNCHAINED</code> or <code class="cCode">TX-CHAINED</code>.
</div>
<h4 class="pDefTerm"><a name="wp1002733"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp1002734"> </a>
The function was called in an improper context (for example, the caller has not yet called <code class="cCode">TXOPEN()</code>).
</div>
<h4 class="pDefTerm"><a name="wp1002735"> </a>
[<code class="cCode">TX-FAIL]</code> 
</h4><div class="pDefPara"><a name="wp1002736"> </a>
The transaction manager encountered a fatal error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp1002737"> </a>
See Also
</h4>
<p class="pBody"><a name="wp1002738"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp1002357"><code class="cCode">TXCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1009819"><code class="cCode">TXROLLBACK(3cbl)</code></a>, <a href="rf3cbl.html#wp1002447"><code class="cCode">TXINFORM(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998698"> </a>
TXSETTIMEOUT(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998699"> </a>
Name
</h4>
<p class="pBody"><a name="wp998700"> </a>
<code class="cCode">TXSETTIMEOUT()</code> - set <code class="cCodeEmphasis">transaction_timeout</code> characteristic
</p>
<h4 class="pHeading3"><a name="wp998701"> </a>
Synopsis
</h4>
<a name="wp998702"> </a><div class="pPreformatted"><pre><code class="cCode">DATA DIVISION.<br /> * Include TX definitions. <br />01 </code><code class="cCodeEmphasis">TX-RETURN-STATUS</code><code class="cCode">.<br /> COPY TXSTATUS. <br />* <br />01 </code><code class="cCodeEmphasis">TX-INFO-AREA</code><code class="cCode">.<br /> COPY TXINFDEF. <br />PROCEDURE DIVISION. <br />CALL &quot;TXSETTIMEOUT&quot; USING </code><code class="cCodeEmphasis">TX-INFO-AREA TX-RETURN-STATUS</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998703"> </a>
Description
</h4>
<p class="pBody"><a name="wp1210671"> </a>
<code class="cCode">TXSETTIMEOUT()</code> sets the <code class="cCodeEmphasis">transaction_timeout</code> characteristic to the value specified in <code class="cCodeEmphasis">TRANSACTION-TIMEOUT</code>. This value specifies the time period in which the transaction must complete before becoming susceptible to transaction timeout; that is, the interval between the AP calling <code class="cCode">TXBEGIN()</code> and <code class="cCode">TXCOMMIT()</code> or <code class="cCode">TXROLLBACK()</code>. <code class="cCode">TXSETTIMEOUT()</code> may be called regardless of whether its caller is in transaction mode or not. If <code class="cCode">TXSETTIMEOUT()</code> is called in transaction mode, the new timeout value does not take effect until the next transaction.
</p>
<p class="pBody"><a name="wp998705"> </a>
The initial <code class="cCodeEmphasis">transaction_timeout</code> value is 0 (no timeout).
</p>
<p class="pBody"><a name="wp998706"> </a>
<code class="cCodeEmphasis">TRANSACTION-TIMEOUT</code> specifies the number of seconds allowed before the transaction becomes susceptible to transaction timeout. It may be set to any value up to the maximum value for an S9(9) <code class="cCode">COMP-5</code> as defined by the system. A <code class="cCodeEmphasis">TRANSACTION-TIMEOUT</code> value of zero disables the timeout feature.
</p>
<p class="pBody"><a name="wp998707"> </a>
<code class="cCodeEmphasis">TX-RETURN-STATUS</code> is the record used to return a value.
</p>
<h4 class="pHeading3"><a name="wp998708"> </a>
Return Value
</h4>
<p class="pBody"><a name="wp998709"> </a>
Upon successful completion, <code class="cCode">TXSETTIMEOUT()</code> returns <code class="cCode">TX-OK</code>, a non-negative return value.
</p>
<h4 class="pHeading3"><a name="wp998710"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998711"> </a>
Under the following conditions, <code class="cCode">TXSETTIMEOUT()</code> does not change the setting of the <code class="cCodeEmphasis">transaction_timeout</code> characteristic and returns one of these negative values:
</p>
<h4 class="pDefTerm"><a name="wp998712"> </a>
[<code class="cCode">TX-EINVAL</code>] 
</h4><div class="pDefPara"><a name="wp998713"> </a>
The timeout value specified is invalid.
</div>
<h4 class="pDefTerm"><a name="wp998714"> </a>
[<code class="cCode">TX-PROTOCOL-ERROR</code>] 
</h4><div class="pDefPara"><a name="wp998715"> </a>
The function was called improperly. For example, it was called before the caller called <code class="cCode">TXOPEN()</code>.
</div>
<h4 class="pDefTerm"><a name="wp998716"> </a>
[<code class="cCode">TX-FAIL</code>] 
</h4><div class="pDefPara"><a name="wp998717"> </a>
The transaction manager encountered an error. The nature of the error is such that the transaction manager can no longer perform work on behalf of the application. The exact nature of the error is written to a log file.
</div>
<h4 class="pHeading3"><a name="wp998718"> </a>
See Also
</h4>
<p class="pBody"><a name="wp998719"> </a>
<a href="rf3cbl.html#wp1002230"><code class="cCode">TXBEGIN(3cbl)</code></a>, <a href="rf3cbl.html#wp1002357"><code class="cCode">TXCOMMIT(3cbl)</code></a>, <a href="rf3cbl.html#wp1002447"><code class="cCode">TXINFORM(3cbl)</code></a>, <a href="rf3cbl.html#wp1002509"><code class="cCode">TXOPEN(3cbl)</code></a>, <a href="rf3cbl.html#wp1009819"><code class="cCode">TXROLLBACK(3cbl)</code></a> 
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp998615"> </a>
USERLOG(3cbl)
</h3>
<h4 class="pHeading3"><a name="wp998616"> </a>
Name
</h4>
<p class="pBody"><a name="wp1062341"> </a>
<code class="cCode">USERLOG()</code> - write a message to the Oracle Tuxedo ATMI central event log
</p>
<h4 class="pHeading3"><a name="wp1062342"> </a>
Synopsis
</h4>
<a name="wp1062343"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">LOG-REC</code><code class="cCode">.<br /> COPY User data. <br />01 </code><code class="cCodeEmphasis">LOGREC-LEN</code><code class="cCode"> PIC S9(9) COMP-5. <br />01 </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.<br /> COPY TPSTATUS. <br />CALL &quot;USERLOG&quot; USING </code><code class="cCodeEmphasis">LOG-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">LOGREC-LEN</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><h4 class="pHeading3"><a name="wp998620"> </a>
Description
</h4>
<p class="pBody"><a name="wp998621"> </a>
<code class="cCode">USERLOG()</code> places <code class="cCode">LOG-REC</code> into a fixed output file&#8212;the Oracle Tuxedo ATMI central event log.
</p>
<p class="pBody"><a name="wp998625"> </a>
The central event log is an ordinary UNIX file whose pathname is composed as follows:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp998626"> </a>If the shell variable <code class="cCode">ULOGPFX</code> is set, its value is used as the prefix for the filename. If <code class="cCode">ULOGPFX</code> is not set, <code class="cCode">ULOG</code> is used. The prefix is determined the first time <code class="cCode">USERLOG()</code> is called.</li>
<li><a name="wp998627"> </a>Each time <code class="cCode">USERLOG()</code> is called the date is determined, and the month, day, and year are concatenated to the prefix as <code class="cCode">mmddyy</code> to set the name for the file.</li>
<li><a name="wp998628"> </a>The first time a process writes to the user log, it first writes an additional message indicating the associated Oracle Tuxedo version.</li>
</ul></div>
<p class="pBody"><a name="wp998629"> </a>
The message is then appended to the file. With this scheme, processes that call <code class="cCode">USERLOG()</code> on successive days will write into different files.
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp998630"> </a>Messages are appended to the log file with a tag made up of the time (<code class="cCode">hhmmss</code>), system name, process name, and process-id of the calling process. The tag is terminated with a colon (<code class="cCode">:</code>).</li>
<li><a name="wp998631"> </a>Oracle Tuxedo system-generated error messages in the log file are prefixed by a unique identification string of the form:</li>
<a name="wp998632"> </a><div class="pPreformattedRelative"><pre><code class="cCode">catalog&gt;:number&gt;:</code></pre></div><li><a name="wp998633"> </a>This string gives the name of the internationalized catalog containing the message string, plus the message number. By convention, Oracle Tuxedo system-generated error messages are used only once, so the string uniquely identifies a location in the source code.</li>
<li><a name="wp998634"> </a>If the last character of the <code class="cCodeEmphasis">format</code> specification is not a newline character, <code class="cCode">USERLOG()</code> appends one.</li>
<li><a name="wp998635"> </a>If the first character of the shell variable <code class="cCode">ULOGDEBUG</code> is <code class="cCode">1</code> or <code class="cCode">y</code>, the message sent to <code class="cCode">USERLOG()</code> is also written to the standard error of the calling process.</li>
<li><a name="wp998636"> </a><code class="cCode">USERLOG()</code> is used by the Oracle Tuxedo system to record a variety of events.</li>
<li><a name="wp998637"> </a>The <code class="cCode">USERLOG</code> mechanism is entirely independent of any database transaction logging mechanism.</li>
</ul></div>
<h4 class="pHeading3"><a name="wp998638"> </a>
Portability
</h4>
<p class="pBody"><a name="wp998642"> </a>
The <code class="cCode">USERLOG</code> interface is supported on UNIX and MS-DOS operating systems. The system name produced as part of the log message is not available on MS-DOS systems; therefore, the value <code class="cCode">PC</code> is used as the system name for MS-DOS systems.
</p>
<h4 class="pHeading3"><a name="wp998643"> </a>
Examples
</h4>
<p class="pBody"><a name="wp998644"> </a>
If the variable <code class="cCode">ULOGPFX</code> is set to <code class="cCode">/application/logs/log</code> and if the first call to <code class="cCode">USERLOG()</code> occurred on 9/7/90, the log file created is named <code class="cCode">/application/logs/log.090790</code>. If the call:
</p>
<a name="wp998645"> </a><div class="pPreformatted"><pre><code class="cCode">01 </code><code class="cCodeEmphasis">LOG-REC</code><code class="cCode"> PIC X(15) VALUE &#8220;UNKNOWN USER&#8221;.<br />01 </code><code class="cCodeEmphasis">LOGREC-LEN</code><code class="cCode"> PIC S9(9) VALUES IS 13.<br />CALL &#8220;USERLOG&#8221; USING </code><code class="cCodeEmphasis">LOG-REC</code><code class="cCode"> </code><code class="cCodeEmphasis">LOGREC-LEN</code><code class="cCode"> </code><code class="cCodeEmphasis">TPSTATUS-REC</code><code class="cCode">.</code></pre></div><p class="pBody"><a name="wp998649"> </a>
is made at 4:22:14pm on the UNIX named <code class="cCode">logsys</code> by the <code class="cCode">program whose process ID is 23431</code>, the following line appears in the log file:
</p>
<a name="wp998650"> </a><div class="pPreformatted"><pre>162214.logsys!security.23431: UNKNOWN USER</pre></div><p class="pBody"><a name="wp998651"> </a>
If the message is sent to the central event log while the process is in transaction mode, the user log entry has additional components in the tag. These components consist of the literal <code class="cCode">gtrid</code> followed by three <code class="cCode">PIC S9(9) COMP-5</code> hexadecimal values. The values uniquely identify the global transaction and make up what is referred to as the global transaction identifier. This identifier is used mainly for administrative purposes, but it does make an appearance in the tag that prefixes the messages in the central event log. If the foregoing message is written to the central event log in transaction mode, the resulting log entry will look like this:
</p>
<a name="wp998652"> </a><div class="pPreformatted"><pre>162214.logsys!security.23431: gtrid x2 x24e1b803 x239: UNKNOWN USER</pre></div><p class="pBody"><a name="wp998653"> </a>
If the shell variable <code class="cCode">ULOGDEBUG</code> has a value of <code class="cCode">y</code>, the log message is also written to the standard error of the program named <code class="cCode">security</code>.
</p>
<h4 class="pHeading3"><a name="wp998654"> </a>
Errors
</h4>
<p class="pBody"><a name="wp998655"> </a>
<code class="cCode">USERLOG()</code> hangs if the message sent to it is larger than <code class="cCode">BUFSIZ</code> as defined in <code class="cCode">stdio.h</code>
</p>
<h4 class="pHeading3"><a name="wp998656"> </a>
Diagnostics
</h4>
<p class="pBody"><a name="wp998657"> </a>
<code class="cCode">USERLOG()</code> returns values include the inability to open, or write to the current log file. Inability to write to the standard error, when <code class="cCode">ULOGDEBUG</code> is set, is not considered an error.
</p>
<h4 class="pHeading3"><a name="wp998658"> </a>
Notices
</h4>
<p class="pBody"><a name="wp998659"> </a>
It is recommended that applications&#8217; use of <code class="cCode">USERLOG</code> messages be limited to messages that can be used to help debug application errors; flooding the log with incidental information can make it hard to spot actual errors.
</p>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="rf3cbl.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<img id="LongDescNotReq9" src="/global_resources/images/nexttop_disabled.gif" border="0" alt="Next" />
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
