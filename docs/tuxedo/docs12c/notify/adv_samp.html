<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="1" />
<meta name="LOC_US_CHANGE" content="41263" />
<meta name="LOC_US_SRCFILE" content="//depot/tuxedo/tux11gr1/notify/fm/adv_samp.fm" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/28/11 08:19:12" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>Building the Advanced Sample Application</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Using the CORBA Notification Service
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="int_samp.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="admin.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
<a accesskey="2" href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in new window">     <img id="LongDescNotReq5" src="/global_resources//images/doc_nav_index.gif" border="0" alt="Open Index in new window" /></a>&nbsp;
<a href="../pdf/notify.pdf" target="pdf"><img id="LongDescNotReq6" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq7" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1076455"> </a>
Building the Advanced Sample Application
</h1>
<p class="pBody"><a name="wp1074213"> </a>
This topic includes the following sections:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1071526"> </a><a href="adv_samp.html#wp1070799">Overview</a></li>
<li><a name="wp1071530"> </a><a href="adv_samp.html#wp1051503">Building and Running the Advanced Sample Application</a></li>
</ul></div>
<a name="wp1076821"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB were deprecated in Tuxedo 8.1 and are no longer supported. All Oracle Tuxedo CORBA Java client and Oracle Tuxedo CORBA Java client ORB text references, associated code samples, should only be used to help implement/run third party Java ORB libraries, and for programmer reference only.</td>
</tr>
</table>

<a name="wp1076822"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>Technical support for third party CORBA Java ORBs should be provided by their respective vendors. Oracle Tuxedo does not provide any technical support or documentation for third party CORBA Java ORBs.</td>
</tr>
</table>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1070799"> </a>
Overview
</h2><p class="pBody"><a name="wp1071958"> </a>
The Advanced sample application simulates a newsroom environment in which a news reporter posts a story, a wire service posts the story as an event to the Notification Service, and a news subscriber consumes the story.
</p>
<p class="pBody"><a name="wp1070844"> </a>
One implementation of the Advanced sample application is provided: the C++ that uses the CosNotification Service API.
</p>
<p class="pBody"><a name="wp1048662"> </a>
The Advanced sample application consists of the reporter, subscriber, and wire service applications that use the Oracle Tuxedo CORBA Notification Service. The reporter application implements a client application. This application prompts the user to enter news articles and calls the WireService server using application specific IDL. The WireService server, in turn, posts the events. The subscriber implements a joint client/server application. This application acts as client when it subscribes and unsubscribes for events, and acts as a server when it receives events. To receive events, the Subscriber implements callback objects which are invoked by the Notification Service when an event needs to be delivered.
</p>
<a name="wp1073502"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>On UNIX systems, you cannot immediately restart the subscriber because the port takes some time (the actual time depends on the platform) to become available again. If you restart too soon, you will get a <code class="cCode">CORBA::OBJ_ADAPTER</code> exception. If this occurs, just wait and try again. On Solaris systems, the port can take up to 10 minutes to become available. To see if the port is still in use, use this command: <code class="cCode">&#8220;Restart -a | grep &lt;</code><em class="cEmphasis">the port number</em><code class="cCode">&gt;&#8221;</code>.</td>
</tr>
</table>

<p class="pBody"><a name="wp1048945"> </a>
This Advanced sample application demonstrates how to use the Oracle Simple Events API, the CosNotification Service API, transient and persistent subscriptions, and data filtering. 
</p>
<p class="pBody"><a name="wp1048951"> </a>
This Advanced sample provides three executables (see <a href="adv_samp.html#wp1048959">Figure&#160;6-1</a>):
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1068083"> </a>A WireService application that posts events. It is a Notification Service client and an Oracle Tuxedo CORBA server. It implements an OMG IDL interface, which the Reporter application uses.</li>
<li><a name="wp1068084"> </a>A Reporter application that reports news stories by invoking methods on the WireService. The WireService, in turn, converts the stories into events and posts them using the Notification Service. The reporter is a pure client.</li>
<li><a name="wp1048955"> </a>A Subscriber application that subscribes to the Notification Service and receives events. The subscriber is a joint client/server that acts as a client when it subscribes for events, and acts as a server when it receives events.</li>
<div class="pFigureTitle"><a name="wp1048959"> </a>
Figure&#160;6-1  Advanced Sample Application Components
</div>

 
 <p class="pGraphic"><a name="wp1050200"> </a>
<br />
<img src="wwimages/evt_adv.gif" height="276" width="456" alt="Advanced Sample Application Components" id="wp1050201"/><br />

</p>
</ul></div>
<p class="pBody"><a name="wp1072985"> </a>
The event poster, the WireService application, uses the structured event <code class="cCode">domain_name</code>, <code class="cCode">type_name</code>, and <code class="cCode">filterable_data</code> fields to construct three events: a news event, a subscriber shutdown event, and a subscriber cancel event.
</p>
<div class="pSmartList1Bullet"><ul>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1073020"> </a>News event</li>
<p class="pBodyRelative"><a name="wp1073021"> </a>
For this event, the domain name is a string and is preset by the application as &#8220;News&#8221;. The type name is a string and defined by the Reporter application user at run time. It is set to the category of news (for example, &#8220;Sports&#8221;). Filterable data contains a name/value pair whose name is &#8220;Story&#8221; and whose value is a string that contains the body of the news story being posted.
</p>
<li><a name="wp1073034"> </a>Subscriber Shutdown event</li>
<p class="pBodyRelative"><a name="wp1073055"> </a>
For this event, the domain name is a string and is preset by the application as &#8220;NewsAdmin&#8221;. The type name is a string and is preset by the application as &#8220;Shutdown&#8221;. The filterable data is not used.
</p>
<li><a name="wp1073040"> </a>Subscriber Cancel event</li>
<p class="pBodyRelative"><a name="wp1073105"> </a>
For this event, the domain name is a string and is preset by the application as &#8220;NewsAdmin&#8221;. The type name is a string and is preset by the application as &#8220;Cancel&#8221;. The filterable data is not used.
</p>
</ul></div>
</ul></div>
<p class="pBody"><a name="wp1073115"> </a>
The Subscriber application uses the structured event <code class="cCode">domain_name</code>, <code class="cCode">type_name</code>, and <code class="cCode">filterable_data</code> fields to construct two subscriptions: a news subscription that processes news stories; and a shutdown subscription that processes Cancel and Shutdown events. At run time, the Subscriber application establishes these two subscriptions with the Notification Service.
</p>
<div class="pSmartList1Bullet"><ul>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1073146"> </a>News subscription</li>
<p class="pBodyRelative"><a name="wp1072986"> </a>
The Subscriber application uses the structured event <code class="cCode">domain_name</code>, <code class="cCode">type_name</code>, and <code class="cCode">filterable_data</code> fields to create a subscription to the Notification Service. The subscription defines the domain name as a fixed string with the content of &#8220;News&#8221;. At run time, the Subscriber application queries the user for the &#8220;News Category&#8221; and &#8220;Keyword&#8221; and uses the inputs to define the type_name and data_filter fields in the subscription. Obviously, the users of both applications, the reporter and the subscriber, must collaborate on the &#8220;News Category&#8221; and &#8220;keyword&#8221; strings for the subscription to match an event, otherwise, no News events will be delivered to the subscriber. The subscription does not do any checking of the <code class="cCode">filterable_data</code> field, but rather assumes that the body of the story will be a string, and that the story will be in the first Named/Value pair in the <code class="cCode">filterable_data</code> field of a structured event.
</p>
<li><a name="wp1073178"> </a>Shutdown subscription</li>
<p class="pBodyRelative"><a name="wp1073185"> </a>
The Subscriber application uses the structured event domain_name and type_name, fields to create a subscription to the Notification Service. The subscription defines the domain_name as a fixed string with the content of &#8220;NewsAdmin&#8221;, the type_name as a string of either &#8220;Shutdown&#8221; or &#8220;Cancel&#8221;. The filterable_data field is an empty string. 
</p>
</ul></div>
</ul></div>
<p class="pBody"><a name="wp1068372"> </a>
The Reporter application is responsible for implementing the user interface for reporting news as well as for producing Shutdown and Cancel events. Rather than use the Notification Service directly to post events, it calls methods on the WireService server.
</p>
<p class="pBody"><a name="wp1068224"> </a>
The WireService server uses the Notification Service to post three kinds of events:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1068226"> </a> &#8220;News&#8221; events (used to deliver news to subscribers)</li>
<li><a name="wp1068227"> </a> &#8220;Shutdown&#8221; events (used to shut down subscribers temporarily)</li>
<li><a name="wp1068228"> </a> &#8220;Cancel&#8221; events (used to shut down subscribers permanently)</li>
</ul></div>
<p class="pBody"><a name="wp1068229"> </a>
The Notification Service, in turn, delivers the events to the subscribers. 
</p>
<p class="pBody"><a name="wp1068407"> </a>
The subscriber uses the Notification Service to create a persistent subscription to news events. The subscriber implements a persistent callback object (via the <code class="cCode">NewsConsumer_i</code> servant class), which is used to receive and process news events. When the subscriber subscribes, it gives the Notification Service a reference to this callback object. When a matching event occurs, the Notification Service invokes a <code class="cCode">push_structured_event</code> method on this callback object to push the event to the subscriber. This method prints out the event.
</p>
<p class="pBody"><a name="wp1068417"> </a>
The subscriber also uses the Notification Service to create a transient subscription to Shutdown and Cancel events. The subscriber implements another callback object (via the <code class="cCode">ShutdownConsumer_i</code> servant class), which is used to receive and process these events.
</p>
<p class="pBody"><a name="wp1068423"> </a>
Whenever the subscriber runs, it prompts the user for a name. The first time this user runs the subscriber program, the subscriber creates a persistent subscription to News events. To do this, the subscriber prompts the user for which kind of news stories to subscribe to and which port number the subscriber should run on. The subscriber runs on this port, subscribes, then writes the subscription ID, the filter ID (if using the CosNotification API), and the port number to a file (the name of the file is <code class="cCode">&lt;</code><code class="cCodeEmphasis">user_name</code><code class="cCode">&gt;.pstore</code>). The next time the subscriber runs, the subscriber prompts the user for a name, opens up the file <code class="cCode">&lt;</code><code class="cCodeEmphasis">user_name</code><code class="cCode">&gt;.pstore</code> then reads the subscription ID, filter ID (if using the CosNotification API) and port number for this user from the file. This satisfies the requirement that the subscriber runs on the same port number each time because its news callback object&#39;s object reference is persistent.
</p>
<p class="pBody"><a name="wp1068436"> </a>
The Subscriber creates a transient subscription to receive the Shutdown and Cancel events, therefore, the transient subscription is created and destroyed every time the subscriber is run and shut down. This subscription ID is not written out to the file <code class="cCode">&lt;</code><code class="cCodeEmphasis">user_name</code><code class="cCode">&gt;.pstore</code>.
</p>
<p class="pBody"><a name="wp1068442"> </a>
When the subscriber receives a Shutdown event, it destroys the shutdown/callback subscription but leaves the News subscription intact. If News events are posted after the subscriber is shut down and before it is restarted, then the notification service will either deliver the events when the subscriber is restarted, or will put the events on the error queue. (You can use the <code class="cCode">ntsadmin</code> utility to either delete these events from the error queue or retry delivering them.)
</p>
<p class="pBody"><a name="wp1068450"> </a>
Whether the event is redelivered or is put on the error queue depends on whether the subscriber restarts quickly enough. This depends on the retry parameters of the queue. See <code class="cCode">advanced.inc</code> (in the notification samples&#39; common directory) for the values of the queue retry parameters.
</p>
<p class="pBody"><a name="wp1068456"> </a>
News events have two parts: a category (for example, headline) and a story (a multiple-line text string). The Subscriber application prompts the user to input a news category. Next the subscriber subscribes to news events whose category matches this string. The Reporter application prompts the user for a news category and a story. Next the reporter (by invoking a method on the wire service) posts a corresponding news event. The event will only be delivered to subscribers who subscribed to that category of news.
</p>
<a name="wp1069025"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The category is a string. The same string must be used by the Reporter user and the Subscriber user. There are no fixed categories in this sample. Therefore both users, the Reporter user and the Subscriber user, must type the same string when prompted for a category (including case and white space).</td>
</tr>
</table>

<p class="pBody"><a name="wp1069041"> </a>
This sample also uses data filtering. When a user first runs the Subscriber, the user will be prompted for a &#8220;keyword.&#8221; Events whose category matches <em class="cEmphasis">and</em> whose story contains the keyword will be delivered to the subscriber. For example, if the user enters a keyword of &#8220;none,&#8221; data filtering will not be used (thus the user will receive all events for the chosen news category). If the user enters a keyword &#8220;smith&#8221;, it translates to <code class="cCode">&#8220;Story %% &#8217;.*smith.*&#8217;&#8221;</code>. This keyword specifies that the subscription only accepts events that have a &#8220;Story&#8221; field that contains a string, and that the field starts with any number of characters, has a literal string &#8220;smith&#8221;, and then ends with any number of characters.
</p>
<p class="pBody"><a name="wp1069042"> </a>
To run this sample, you need to run at least one Reporter and at least one Subscriber; however, you may run multiple Reporters and multiple Subscribers. Events posted by any Reporter will be delivered to all matching Subscribers (based on the category). 
</p>
<p class="pBody"><a name="wp1069069"> </a>
Also, be sure to start any subscribers before posting events. Events posted before the subscribers are started will not be delivered.
</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h2 class="pHeading1"><a name="wp1051503"> </a>
Building and Running the Advanced Sample Application
</h2><p class="pBody"><a name="wp1072353"> </a>
To build and run the Introductory sample application, you must perform these steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1072354"> </a>Verify that the <code class="cCode">&quot;TUXDIR&quot;</code> environment variable is set to the correct directory path.</li>
<li><a name="wp1076662"> </a>Unset and <code class="cCode">&#8220;JAVA_HOME&#8221;</code></li>
<li><a name="wp1072355"> </a>Copy the files for the Introductory sample application into a work directory. </li>
<li><a name="wp1072356"> </a>Change the protection attributes on the files to grant write and execute access.</li>
<li><a name="wp1073563"> </a>For UNIX, ensure the <code class="cCode">make</code> file is in your path. For Microsoft Windows, ensure the <code class="cCode">nmake</code> file is in your path</li>
<li><a name="wp1072358"> </a>Set the application environment variables.</li>
<li><a name="wp1072359"> </a>Build the sample.</li>
<li><a name="wp1072360"> </a>Boot the system.</li>
<li><a name="wp1072361"> </a>Run the Subscriber and Reporter applications.</li>
<li><a name="wp1072362"> </a>Shut down the system.</li>
<li><a name="wp1072363"> </a>Restore the directory to its original state.</li>
</ol></div>
<p class="pBody"><a name="wp1072364"> </a>
These steps are described in detail in the following sections.
</p>
<h3 class="pHeading2"><a name="wp1072387"> </a>
Verifying the Settings of the Environment Variables
</h3>
<p class="pBody"><a name="wp1072388"> </a>
Before you build and run the Advanced sample application, you need to ensure that the <code class="cCode">TUXDIR</code> environment variable is set on your system. In most cases, this environment variable is set as part of the installation procedure. However, you need to check the environment variables to ensure they reflect the correct information.
</p>
<p class="pBody"><a name="wp1072392"> </a>
<a href="adv_samp.html#wp1072396">Table&#160;6-1</a> lists the environment variables required to run the Callback sample application.
</p>
<p class="pGraphic"><a name="wp1072421"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1072396table1072393"><caption><a name="wp1072396"> </a>
Table 6-1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Required Environment Variables for the Callback Sample Application</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1072400"> </a>
Environment Variable
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1072402"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072404"> </a>
<code class="cCode">TUXDIR</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072407"> </a>
The directory path where you installed the Oracle Tuxedo software. For example:
</div>
<div class="pCellBody"><a name="wp1072408"> </a>
<b class="cBold">Windows</b>
</div>
<div class="pCellBody"><a name="wp1072409"> </a>
<code class="cCode">TUXDIR=c:\tuxdir</code>
</div>
<div class="pCellBody"><a name="wp1072410"> </a>
<b class="cBold">UNIX</b>
</div>
<div class="pCellBody"><a name="wp1072411"> </a>
<code class="cCode">TUXDIR=/usr/local/tuxdir</code>
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1072434"> </a>
To verify that the information for the environment variables defined during installation is correct, perform the following steps:
</p>
<p class="pBody"><a name="wp1072435"> </a>
<b class="cBold">Windows</b>
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1072436"> </a>From the Start menu, select Settings.</li>
<li><a name="wp1072437"> </a>From the Settings menu, select the Control Panel.</li>
<p class="pBodyRelative"><a name="wp1072438"> </a>
The Control Panel appears.
</p>
<li><a name="wp1072439"> </a>Click the System icon.</li>
<p class="pBodyRelative"><a name="wp1072440"> </a>
The System Properties window appears.
</p>
<li><a name="wp1072441"> </a>Click the Environment tab.</li>
<p class="pBodyRelative"><a name="wp1072442"> </a>
The Environment page appears.
</p>
<li><a name="wp1072443"> </a>Check the setting for <code class="cCode">TUXDIR </code></li>
</ol></div>
<p class="pBody"><a name="wp1072444"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1072445"> </a>
<code class="cCode">ksh prompt&gt;printenv TUXDIR</code>
</p>
<p class="pBody"><a name="wp1072448"> </a>
To change the settings, perform the following steps:
</p>
<p class="pBody"><a name="wp1072449"> </a>
<b class="cBold">Windows</b>
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1072450"> </a>On the Environment page in the System Properties window, click the environment variable you want to change.</li>
<li><a name="wp1072451"> </a>Enter the correct information for the environment variable in the Value field.</li>
<li><a name="wp1072452"> </a>Click OK to save the changes.</li>
</ol></div>
<p class="pBody"><a name="wp1072453"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1072454"> </a>
<code class="cCode">ksh prompt&gt;export TUXDIR=</code><code class="cCodeEmphasis">directorypath</code>
</p>
<h3 class="pHeading2"><a name="wp1072460"> </a>
Copying the Files for the Advanced Sample Application into a Work Directory
</h3>
<p class="pBody"><a name="wp1026042"> </a>
You need to copy the files for the Advanced sample application into a work directory on your local machine. 
</p>
<a name="wp1073577"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>The application directory and the common directory must be copied to the same parent directory.</td>
</tr>
</table>

<p class="pBody"><a name="wp1073574"> </a>
The files for the Advanced sample application are located in the following directories:
</p>
<p class="pBody"><a name="wp1026044"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1072506"> </a>
For the C++ Advanced sample:<code class="cCodeEmphasis"> drive:\tuxdir</code><code class="cCode">\samples\corba\notification\advanced_cos_cxx<br /></code><code class="cCodeEmphasis">drive:\tuxdir</code><code class="cCode">\samples\corba\notification\common</code>
</p>
<p class="pBody"><a name="wp1072464"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1072609"> </a>
For the C++ Advanced sample:<code class="cCodeEmphasis"> /usr/local/tuxdir</code><code class="cCode">/samples/corba/notification/advanced_cos_cxx<br /></code><code class="cCodeEmphasis">/usr/local/tuxdir</code><code class="cCode">/samples/corba/notification/common</code>
</p>
<p class="pBody"><a name="wp1071178"> </a>
You use the files listed in <a href="adv_samp.html#wp1053514">Table&#160;6-2</a> and <a href="adv_samp.html#wp1053072">Table&#160;6-3</a> to build and run the C++ Advanced sample application, which is implemented using the CosNotification API.
</p>
<p class="pBody"><a name="wp1053551"> </a>
You use the files listed in <a href="adv_samp.html#wp1053514">Table&#160;6-2</a> and <a href="adv_samp.html#wp1053072">Table&#160;6-3</a> to build and run the Advanced sample application.
</p>
<p class="pGraphic"><a name="wp1026053"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1053514table1053512"><caption><a name="wp1053514"> </a>
Table 6-2  Files Located in the advanced_cos_c++ Notification Directory

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1072195"> </a>
File
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1072197"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071368"> </a>
<code class="cCode">Readme.txt </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071370"> </a>
Describes the Advanced sample application and provides instructions for setting up the environment and building and running the application.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071372"> </a>
<code class="cCode">setenv.cmd</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071374"> </a>
Sets the environment for Microsoft Windows systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071376"> </a>
<code class="cCode">setenv.ksh</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071378"> </a>
Sets the environment for UNIX systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071380"> </a>
<code class="cCode">makefile.nt </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071382"> </a>
Makefile for Microsoft Windows systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071384"> </a>
<code class="cCode">makefile.mk </code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071386"> </a>
Makefile for UNIX systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071388"> </a>
<code class="cCode">makefile.inc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071390"> </a>
Common makefile used by the <code class="cCode">makefile.nt</code> and the <code class="cCode">makefile.mk</code> files.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071392"> </a>
<code class="cCode">Reporter.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071394"> </a>
Code for the reporter.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071396"> </a>
<code class="cCode">Subscriber.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071398"> </a>
Code for the subscriber.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071400"> </a>
<code class="cCode">NewsConsumer_i.h</code> and<code class="cCode"> NewsConsumer.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071402"> </a>
Callback servant class that subscribers use to receive news events. (For the Subscriber application.)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071404"> </a>
<code class="cCode">ShutdownConsumer_i.h </code>and<code class="cCode"> ShutdownConsumer.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071406"> </a>
Callback servant classes that subscribers use to receive Shutdown and Cancel events. (For the Subscriber application.)
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071408"> </a>
<code class="cCode">WireServiceServer.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071410"> </a>
Code for the WireService server.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071412"> </a>
<code class="cCode">News.icf</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071414"> </a>
ICF file for the WireService interfaces.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071416"> </a>
<code class="cCode">WireService_i.h</code> and<code class="cCode"> WireService.cpp</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1071418"> </a>
Implements the WireService interfaces.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p class="pBody"><a name="wp1053448"> </a>
<a href="adv_samp.html#wp1053072">Table&#160;6-3</a> lists other files that the Advanced sample application uses. With the exception of the IDL files, the files are located in the Notification common directory.
</p>
<p class="pGraphic"><a name="wp1053053"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1053072table1053070"><caption><a name="wp1053072"> </a>
Table 6-3  Other Files That the Advanced Sample Uses&#160;

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1053155"> </a>
File
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1053157"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="straddledcells" colspan="2" rowspan="1"><div class="pCellBody"><a name="wp1072752"> </a>
<b class="cBold">The following files are located in the common directory.</b>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1069671"> </a>
News.idl
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1069673"> </a>
IDL definitions for the WireService server.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1069675"> </a>
news_flds
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1069677"> </a>
FML field definitions used to perform data filtering and news events.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053159"> </a>
<code class="cCode">common.nt</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053161"> </a>
Makefile symbols for Microsoft Windows systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053163"> </a>
<code class="cCode">common.mk</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053165"> </a>
Makefile symbols for UNIX systems.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053167"> </a>
<code class="cCode">advanced.inc</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053169"> </a>
Makefile for administrative targets.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053171"> </a>
<code class="cCode">ex.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053173"> </a>
Utilities to print exceptions (C++ only).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053175"> </a>
<code class="cCode">client_ex.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053177"> </a>
Client utilities to handle exceptions (C++ only).
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072815"> </a>
<code class="cCode">server_ex.h</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072817"> </a>
Server utilities to handle exceptions.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="straddledcells" colspan="2" rowspan="1"><div class="pCellBody"><a name="wp1072756"> </a>
<b class="cBold">The following files are located in the \tuxdir\include directory.</b>
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053695"> </a>
<code class="cCode">CosEventComm.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053697"> </a>
The OMG IDL code that declares the CosEventComm module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053691"> </a>
<code class="cCode">CosNotification.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053693"> </a>
The OMG IDL code that declares the CosNotification module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053687"> </a>
<code class="cCode">CosNotifyComm.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053689"> </a>
The OMG IDL code that declares the CosNotifyComm module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053683"> </a>
<code class="cCode">Tobj_Events.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053685"> </a>
The OMG IDL code that declares the Tobj_Events module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053679"> </a>
<code class="cCode">Tobj_SimpleEvents.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1053681"> </a>
The OMG IDL code that declares the Tobj_SimpleEvents module.
</div>
<p class="pTableNote"><a name="wp1073753"> </a><table>
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>This file is needed only for the application that was developed using Oracle Simple Events API.</td></tr>
</table>
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td class="straddledcells" colspan="2" rowspan="1"><div class="pCellBody"><a name="wp1073720"> </a>
The following files are needed only for the application that <b class="cBold">was developed</b> using CosNotification Service API.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072847"> </a>
<code class="cCode">CosEventChannelAdmin.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072849"> </a>
The OMG IDL code that declares the CosEventChannelAdmin module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072843"> </a>
<code class="cCode">CosNotifyFilter.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072845"> </a>
The OMG IDL code that declares the CosNotifyFilter module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072839"> </a>
<code class="cCode">CosNotifyChannelAdmin.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072841"> </a>
The OMG IDL code that declares the CosNotifyChannelAdmin module.
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072835"> </a>
<code class="cCode">Tobj_Notification.idl</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1072837"> </a>
The OMG IDL code that declares the Tobj_Notification module.
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h3 class="pHeading2"><a name="wp1053207"> </a>
Changing the Protection Attribute on the Files for the Advanced Sample Application
</h3>
<p class="pBody"><a name="wp1026120"> </a>
During the installation of the Oracle Tuxedo software, the Advanced sample application files are marked read-only. Before you can edit or build the files in the Advanced sample application, you need to change the protection attribute of the files you copied into your work directory, as follows:
</p>
<p class="pBody"><a name="wp1026121"> </a>
<b class="cBold">Windows</b>
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054438"> </a>Change (<code class="cCode">cd</code>) to your work directory</li>
<li><a name="wp1054465"> </a><code class="cCode">prompt&gt;attrib -r</code> <code class="cCodeEmphasis">drive:</code>\<code class="cCodeEmphasis">workdirectory</code><code class="cCode">\*.*</code></li>
</ol></div>
<p class="pBody"><a name="wp1026123"> </a>
<b class="cBold">UNIX</b>
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054476"> </a>Change (<code class="cCode">cd</code>) to your work directory</li>
<li><a name="wp1054499"> </a><code class="cCode">prompt&gt;/bin/ksh</code></li>
<li><a name="wp1026125"> </a><code class="cCode">ksh prompt&gt;chmod u+w /</code><code class="cCodeEmphasis">workdirectory</code><code class="cCode">/*.*</code></li>
</ol></div>
<p class="pBody"><a name="wp1026126"> </a>
On the UNIX operating system platform, you also need to change the permission of <code class="cCode">setenv.ksh</code> to give execute permission to the file, as follows:
</p>
<p class="pBody"><a name="wp1026127"> </a>
<code class="cCode">ksh prompt&gt;chmod +x setenv.ksh</code>
</p>
<h3 class="pHeading2"><a name="wp1026188"> </a>
Setting Up the Environment
</h3>
<p class="pBody"><a name="wp1054521"> </a>
To set up the environment, enter the following command:
</p>
<p class="pBody"><a name="wp1054540"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1054581"> </a>
<code class="cCode">prompt&gt;.\setenv.cmd</code>
</p>
<p class="pBody"><a name="wp1054558"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1054559"> </a>
<code class="cCode">prompt&gt;. ./setenv.ksh</code>
</p>
<h3 class="pHeading2"><a name="wp1054520"> </a>
Building the Advanced Sample Application
</h3>
<p class="pBody"><a name="wp1055062"> </a>
You use the <code class="cCode">make</code> command to run <code class="cCode">makefiles</code>, which are provided for Microsoft Windows and UNIX, to build the sample application. For Microsoft Windows, use <code class="cCode">nmake</code>. For UNIX, use <code class="cCode">make</code>.
</p>
<h4 class="pHeading3"><a name="wp1053886"> </a>
Makefile Summary
</h4>
<p class="pBody"><a name="wp1055029"> </a>
The<code class="cCode"> </code>makefile automates the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1074785"> </a>Checks that the set environment command (<code class="cCode">setenv.cmd</code>) has been run. If the environment variables have not been set, the makefile prints an error message to the screen and exits.</li>
<li><a name="wp1074786"> </a>Includes the <code class="cCode">common.nt</code> (for Microsoft Windows) or <code class="cCode">common.mk</code> (for UNIX) command file. This file defines the makefile symbols used by the samples. These symbols allow the UNIX and Microsoft Windows makefiles to delegate the build rules to platform-independent makefiles.</li>
<li><a name="wp1067665"> </a>Includes the <code class="cCode">makefile.inc</code> command file. This file builds the <code class="cCode">is_reporter</code>, <code class="cCode">is_subscriber</code> and <code class="cCode">AS_WIRESERVICE </code>executables, and cleans up the directory of unnecessary files and directories.</li>
<li><a name="wp1067666"> </a>Includes the <code class="cCode">advanced.inc</code> command file. This file executes <code class="cCode">tmadmin</code> and <code class="cCode">qadmin</code> commands to create the transaction log and the queues required by the persistent subscriptions. It also creates the <code class="cCode">UBBCONFIG</code> file and executes the <code class="cCode">tmloadcf -y ubb</code> command to create the <code class="cCode">TUXCONFIG</code> file.</li>
</ol></div>
<h4 class="pHeading3"><a name="wp1026203"> </a>
Executing the Makefile
</h4>
<p class="pBody"><a name="wp1055035"> </a>
Before executing the <code class="cCode">makefile</code>, you need to check the following:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1038937"> </a>Ensure that you have the appropriate administrative privileges to build and run applications.</li>
<li><a name="wp1027247"> </a>On Microsoft Windows, make sure <code class="cCode">nmake</code> is in the path of your machine.</li>
<li><a name="wp1027248"> </a>On UNIX, make sure <code class="cCode">make</code> is in the path of your machine.</li>
</ul></div>
<p class="pBody"><a name="wp1054933"> </a>
To build the Advanced sample application, enter the <code class="cCode">make</code> command as follows:
</p>
<p class="pBody"><a name="wp1053934"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBody"><a name="wp1053935"> </a>
<code class="cCode">nmake -f makefile.nt</code>
</p>
<p class="pBody"><a name="wp1053936"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBody"><a name="wp1053937"> </a>
<code class="cCode">make -f makefile.mk</code>
</p>
<h3 class="pHeading2"><a name="wp1027305"> </a>
Starting the Advanced Sample Application
</h3>
<p class="pBody"><a name="wp1027309"> </a>
To start the Advanced sample application, enter the following commands:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054195"> </a>To boot the Oracle Tuxedo system:</li>
<p class="pBodyRelative"><a name="wp1027310"> </a>
<code class="cCode">prompt&gt;tmboot -y</code>
</p>
<p class="pBodyRelative"><a name="wp1027312"> </a>
This command starts the following server processes:
</p>
<div class="pSmartList2Bullet"><ul>
<li><a name="wp1027409"> </a><code class="cCode">TMSUSREVT</code></li>
<p class="pBodyRelative"><a name="wp1073795"> </a>
An Oracle Tuxedo system-provided, EventBroker server that is used by the Notification Service.
</p>
<li><a name="wp1027319"> </a><code class="cCode">TMNTS</code></li>
<p class="pBodyRelative"><a name="wp1054187"> </a>
An Oracle Tuxedo CORBA Notification Service server that processes requests for subscriptions and event postings.
</p>
<li><a name="wp1054188"> </a><code class="cCode">TMNTSFWD_T</code></li>
<p class="pBodyRelative"><a name="wp1069990"> </a>
An Oracle Tuxedo CORBA Notification Service server that forwards events to subscribers that have transient subscriptions. This server is required for transient subscriptions.
</p>
<li><a name="wp1069751"> </a><code class="cCode">TMNTSFWD_P</code></li>
<p class="pBodyRelative"><a name="wp1069982"> </a>
An Oracle Tuxedo CORBA Notification Service server that forwards persistent events to subscribers that have persistent subscriptions. This server is required for persistent subscriptions.
</p>
<li><a name="wp1027321"> </a><code class="cCode">TMQUEUE</code></li>
<p class="pBodyRelative"><a name="wp1069862"> </a>
The message queue manager is an Oracle Tuxedo system-provided server that enqueues and dequeues messages on behalf of programs calling <code class="cCode">tpenqueue</code>(3) and <code class="cCode">tpdequeue</code>(3), respectively. This server is required for persistent subscriptions.
</p>
<li><a name="wp1069801"> </a><code class="cCode">TMQFORWARD</code></li>
<p class="pBodyRelative"><a name="wp1069964"> </a>
The message forwarding server is an Oracle Tuxedo system-provided server that forwards messages that have been stored using <code class="cCode">tpenqueue</code>(3c) for later processing. This server is required for persistent subscriptions.
</p>
<li><a name="wp1069795"> </a><code class="cCode">WIRE_SERVICE_SERVER</code></li>
<p class="pBodyRelative"><a name="wp1069773"> </a>
A server, specifically built for the Advanced sample application, that receives events from the Reporter application and posts them to the Notification Service. This receive and server posts three types of events: News, Shutdown, and Cancel.
</p>
<li><a name="wp1069768"> </a><code class="cCode">ISL</code></li>
<p class="pBodyRelative"><a name="wp1066158"> </a>
The IIOP Listener/Handler process.
</p>
</ul></div>
<li><a name="wp1066159"> </a>To start the Subscriber application:</li>
<p class="pBodyRelative"><a name="wp1072963"> </a>
For C++: <code class="cCode">prompt&gt;is_subscriber</code>
</p>
<p class="pBodyRelative"><a name="wp1076794"> </a>
To start another Subscriber, open another window, change (<code class="cCode">cd</code>) to your work directory, set the environment variables (by running <code class="cCode">setenv.cmd</code> or <code class="cCode">setenv.ksh</code>), and enter the start command that is appropriate for your platform.
</p>
<li><a name="wp1054277"> </a>To start the Reporter application, open another window and enter the following:</li>
<p class="pBodyRelative"><a name="wp1072972"> </a>
For C++: <code class="cCode">prompt&gt;is_reporter<br /></code>
</p>
<p class="pBodyRelative"><a name="wp1076795"> </a>
To start another Reporter, open another window, change (<code class="cCode">cd</code>) to your work directory, set the environment variables (by running <code class="cCode">setenv.cmd</code> or <code class="cCode">setenv.ksh</code>), and enter the start command that is appropriate for your platform.
</p>
</ol></div>
<h3 class="pHeading2"><a name="wp1027435"> </a>
Using the Advanced Sample Application
</h3>
<p class="pBody"><a name="wp1054425"> </a>
To use the Advanced sample application, you must use the Subscriber application to subscribe to an event and the Reporter application to post to an event. Be sure to subscribe before you post each event; otherwise, events will be lost. 
</p>
<h4 class="pHeading3"><a name="wp1054424"> </a>
Using the Subscriber Application to Subscribe to Events
</h4>
<p class="pBody"><a name="wp1072303"> </a>
Perform the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054420"> </a>When you start the Subscriber application (<code class="cCode">prompt&gt;is_subscriber</code>) for the first time, the following prompts are displayed:</li>
<p class="pBodyRelative"><a name="wp1054387"> </a>
<code class="cCode">Name?</code>                          (Enter a name (without spaces).)<br /><code class="cCode">Port (e.g. 2463)</code>   (Enter the port number that this subscriber should run on.)<br /><code class="cCode">Category (or all)</code>  (Enter the category of news you want or &quot;all.&quot;)<br /><code class="cCode">Keyword (or none) </code>(Enter a keyword that you want all delivered stories to<br />                                      contain.)
</p>
</ol></div>
<a name="wp1070007"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>If the Subscriber application is shut down by a Shutdown event from the Reporter application (Shutdown events do not cancel persistent subscriptions), on subsequent startups of the Subscriber application, you will only be prompted for your name. The Subscriber application retrieves the remaining information from the <code class="cCode">&lt;user_name&gt;.pstore</code> file. This guarantees that the same port number is used, which is required for persistent subscriptions.</td>
</tr>
</table>

<a name="wp1070155"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>If the Subscriber application is shut down by a Cancel event from the Reporter application (Cancel events cancel all subscriptions including persistent subscriptions), on subsequent startups of the Subscriber application, you will be prompted for your name, port number, category, and keyword. </td>
</tr>
</table>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054388"> </a>You may type in any string for the news category, that is, there is no fixed list of news categories. However, when you use the Reporter application to post an event, make sure you specify the same string for the news category.</li>
<p class="pBodyRelative"><a name="wp1070012"> </a>
Similarly, you may type in a string for a keyword. There is no fixed list of keywords either so when you run the reporter and enter the story, make sure that the story contains the same string; otherwise, the story will not be delivered to your subscription.
</p>
<p class="pBodyRelative"><a name="wp1070018"> </a>
The first time the Subscriber application is run for your username, category (or all), and keyword (optional), it creates a news subscription. On subsequent runs, the subscriber reuses this subscription. In all cases, the Subscriber application prints &#8220;Ready&#8221; when it is ready to receive events.
</p>
</ol></div>
<a name="wp1054389"> </a><table class="Note">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>The Subscriber application creates a subscription then prints &#8220;Ready&#8221; when it is ready to receive events.</td>
</tr>
</table>
<a name="wp1054423"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You should always use the Subscriber application to subscribe to events before you use the Reporter application to post events; otherwise, events will be lost. This is because even though the Subscriber application creates a persistent subscription to News events, that subscription is not created until the Subscriber application is started.</td>
</tr>
</table>

<a name="wp1070200"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You can start multiple subscribers by opening another window and repeating this procedure.</td>
</tr>
</table>

<h4 class="pHeading3"><a name="wp1054428"> </a>
Using the Reporter Application to Post Events
</h4>
<p class="pBody"><a name="wp1072304"> </a>
Perform the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054431"> </a>When you start the Reporter application (<code class="cCode">prompt&gt; is_reporter</code>), the following prompt is displayed:</li>
<p class="pBodyRelative"><a name="wp1054395"> </a>
<code class="cCode">(r) Report news<br />(s) Shutdown subscribers<br />(c) Cancel Subscribers<br />(e) Exit</code>
</p>
<p class="pBodyRelative"><a name="wp1054396"> </a>
<code class="cCode">Option?</code> 
</p>
<li><a name="wp1055463"> </a>Enter <code class="cCode">r</code> to report news. The following prompt is displayed:</li>
<p class="pBodyRelative"><a name="wp1054397"> </a>
<code class="cCode">Category?</code> 
</p>
<li><a name="wp1055462"> </a>Enter the news category. It must match exactly the category you typed on the Subscriber application (including white space and case).</li>
<p class="pBodyRelative"><a name="wp1055156"> </a>
After you enter the news category, the following prompt is displayed:
</p>
<p class="pBodyRelative"><a name="wp1054398"> </a>
<code class="cCode">Enter story (terminate with &#39;.&#39;) </code>
</p>
<li><a name="wp1055461"> </a>Enter your story. It can span multiple lines. Finish the story by typing a period only (&quot;.&quot;) on a line, followed by a carriage return. If you typed in a keyword when subscribing, make sure the story contains this string (including white space and case).</li>
<p class="pBodyRelative"><a name="wp1054399"> </a>
Subscribers whose category and keyword (if specified) matches the category and a keyword in this story will receive and print out the story. 
</p>
<li><a name="wp1070099"> </a>If you choose the &#8220;<code class="cCode">s</code>&#8221; option, a Shutdown event will be posted and received by all the subscribers and the subscribers will shut down. While the subscribers are shut down, you may post another news story (by using the &#8220;<code class="cCode">r</code>&#8221; option again). The Notification Service will place the news story on the pending queue but the News event subscription is persistent and, therefore, is still in effect. After you restart the subscribers, they will receive this second news story (unless a restart delay caused the event to be moved to the error queue). This is because the subscriber created a persistent subscription for news stories. </li>
<a name="wp1070148"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You can use the <code class="cCode">ntsadmin</code> <code class="cCode">retryerrevents</code> command to move events from the error queue back to the pending queue.</td>
</tr>
</table>

<li><a name="wp1070108"> </a>If you choose the &#8220;<code class="cCode">c</code>&#8221; option, a Cancel event will be posted and received by all the subscribers. The subscribers will cancel their news subscriptions and shut down. If you try to restart the subscribers, then you will be prompted again for port, category, and keyword because you are creating a new subscription.</li>
<li><a name="wp1055171"> </a>When you are finished reporting news, choose the Exit <code class="cCode">(e)</code> option.</li>
<a name="wp1070180"> </a><table class="ListNote">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>You can start multiple reporters by opening another window and repeating this procedure. Any news story reported by any reporter will be delivered to all matching subscribers. Make sure you have exited all reporters before shutting down the system.</td>
</tr>
</table>

</ol></div>
<h3 class="pHeading2"><a name="wp1055234"> </a>
Shutting Down the System and Cleaning Up the Directory
</h3>
<p class="pBody"><a name="wp1054402"> </a>
Make sure the Reporter and Subscriber processes have stopped and perform the following steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<li><a name="wp1054403"> </a>To shut down the system, in any window, type:</li>
<p class="pBodyRelative"><a name="wp1055251"> </a>
<code class="cCode">prompt&gt;tmshutdown -y</code>
</p>
<li><a name="wp1055276"> </a>To restore the directory to its original state, in any window, type:</li>
<p class="pBodyRelative"><a name="wp1055309"> </a>
<b class="cBold">Windows</b>
</p>
<p class="pBodyRelative"><a name="wp1055321"> </a>
<code class="cCode">prompt&gt;nmake -f makefile.nt clean</code>
</p>
<p class="pBodyRelative"><a name="wp1055311"> </a>
<b class="cBold">UNIX</b>
</p>
<p class="pBodyRelative"><a name="wp1055327"> </a>
<code class="cCode">prompt&gt;make -f makefile.mk clean</code>
</p>
</ol></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="adv_samp.html"><img id="LongDescNotReq8" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="int_samp.html"><img id="LongDescNotReq9" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="admin.html"><img id="LongDescNotReq10" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
