<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>

<!-- LOCALIZATION RELATED INFORMATION -->
<meta name="LOC_PROJ_ID" content="WLPF8.1" />
<meta name="LOC_OWNER" content="BEAJ" />
<meta name="LOC_STATUS" content="READY!" />
<meta name="LOC_COMMENT" content="LOC_COMMENT" />
<meta name="LOC_US_REV" content="" />
<meta name="LOC_US_CHANGE" content="" />
<meta name="LOC_US_SRCFILE" content="" />
<!-- LOCALIZATION RELATED INFORMATION -->

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 Platinum Edition for FrameMaker 8.6.6577.0" />
    <meta name="TEMPLATEBASE" content="BEA_WFP_Template_V1.04" />
    <meta name="LASTUPDATED" content="11/21/13 02:10:34" />
    <link rel="StyleSheet" href="/global_resources/edocs.css" type="text/css" media="all" />

<title>TSAM Plus Commands Reference</title>

<!-- BEA scripts begin -->

<script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script>
<!-- This script outputs the banner required for edocs documentation. -->

<script language="Javascript" src="floatwin.js" type="text/javascript"></script>
<!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. -->

<script language="Javascript1.1" src="/global_resources/js/footer.js" type="text/javascript"></script>
<!-- This script outputs the footer with the correct copyright date and link to copyright page.-->

<script language="Javascript1.1" src="/global_resources/js/googlesearch4.js" type="text/javascript"></script>
<!-- This script outputs the google search form. -->

<script language="Javascript1.1" src="/global_resources/js/note.js" type="text/javascript"></script>
<!-- This script outputs a note such as a BETA note. -->

<script language="JavaScript1.1" src="/global_resources/js/search.js" type="text/javascript"></script>
<!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. -->

<!-- BEA scripts end -->

  </head>

  <body>


<script language="Javascript1.1" type="text/javascript">
GoogleURL();
</script><noscript>This script outputs the google search URL required for search on edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
Banner();
</script><noscript>This script outputs the banner required for edocs documentation.</noscript>

<script language="Javascript1.1" type="text/javascript">
GoogleSearchCollection();
</script><noscript>This script outputs the google search parameters required for search on edocs documentation.</noscript>

<!-- page title -->
<h1 class="booktitle">Reference Guide
</h1>
<!-- page title end -->

    <table id="SummaryNotReq1" width="100%" border="0" align="left" cellpadding="2%" cellspacing="0">
      <tr> 
        <td>
&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq1" src="/global_resources/images/doc_nav_prev.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="tsamaccount.html"><img id="LongDescNotReq2" src="/global_resources/images/doc_nav_next.gif" border="0" alt="Next" /></a>&nbsp;
<img id="LongDescNotReq3" src="/global_resources/images/doc_nav_dots.gif" border="0" alt="" />&nbsp;
<a accesskey="1" href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window">      <img id="LongDescNotReq4" src="/global_resources/images/doc_nav_contents.gif" alt="Open TOC in new window" border="0" /></a>&nbsp;
&nbsp;
<a href="../pdf/ref.pdf" target="pdf"><img id="LongDescNotReq5" src="/global_resources/images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF - New Window" title="View as PDF - New Window" border="0" /></a>&nbsp;
<a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img id="LongDescNotReq6" src="/global_resources/images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader - New Window" title="Get Adobe Reader - New Window" border="0" /></a>
<a name="link_group_0"></a>
	</td>
      </tr>
    </table>

<a name="skipnav" title="Content starts here"><img src="/global_resources/images/_.gif" alt="Content starts here" border="0" height="1" width="1" /></a>



<h1 class="pChapHead"><a name="wp1074157"> </a>
TSAM Plus Commands Reference
</h1>
<p class="pBody"><a name="wp1075245"> </a>
The Oracle TSAM Plus Reference Guide describes system processes and commands delivered with the Oracle TSAM Plus software.
</p>
<p class="pBody"><a name="wp1077311"> </a>
<a href="tsamref.html#wp1075251">Table&#160;1</a> lists the Oracle TSAM Plus system processes and commands.
</p>
<p class="pGraphic"><a name="wp1075276"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1075251table1075246"><caption><a name="wp1075251"> </a>
Table&#160;1  <span style="font-style: normal; font-weight: bold; text-decoration: none; vertical-align: baseline">Oracle TSAM Plus System Processes and Commands&#160;</span>

</caption>

  <tr bgcolor="#CCCCCC" align="center" valign="top">    <th scope="col"><div class="pCellHeading"><a name="wp1075255"> </a>
Name
</div>
</th>
    <th scope="col"><div class="pCellHeading"><a name="wp1075257"> </a>
Description
</div>
</th>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1077576"> </a>
<a href="tsamref.html#wp1077463"><code class="cCode">LMS (Local Monitor Server)</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1077579"> </a>
The Oracle TSAM Plus Agent Local Monitor Server
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075266"> </a>
<a href="tsamref.html#wp1077449"><code class="cCode">tpgetcallinfo</code></a>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075268"> </a>
Routine for retrieving call path message monitoring attributes
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1077463"> </a>
LMS (Local Monitor Server)
</h3>
<h4 class="pHeading3"><a name="wp1077464"> </a>
Name
</h4>
<p class="pBody"><a name="wp1077465"> </a>
LMS&#8212;The Oracle TSAM Plus Agent Local Monitor Server
</p>
<h4 class="pHeading3"><a name="wp1077466"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1077609"> </a>
<code class="cCode">LMS SRVGRP=&quot;identifier&quot; SRVID=&quot;number&quot; [other_parms]</code>
</p>
<p class="pBody"><a name="wp1078870"> </a>
<code class="cCode">CLOPT= &quot;-A -- -l tsam-manager-dataserver-url[,tsam-manager-backupdataserver-url] [-t heartbeat-interval] [-n fetch_coll_capacity] [-m metrics-shm-size]&#8221;</code>
</p>
<h4 class="pHeading3"><a name="wp1077468"> </a>
Description
</h4>
<p class="pBody"><a name="wp1077469"> </a>
LMS is an Oracle TSAM Plus Agent Tuxedo server. It provides the following functions:
</p>
<div class="pSmartList1Bullet"><ul>
<li><a name="wp1077470"> </a>Acts as the local Tuxedo domain data collection proxy</li>
<p class="pBodyRelative"><a name="wp1077471"> </a>
The performance metrics collected by the Oracle TSAM Plus framework are passed to the plug-in. Oracle TSAM Plus default plug-in sends the data to the LMS using the Tuxedo service infrastructure.
</p>
<li><a name="wp1077472"> </a>Plug-in metrics are stored in the LMS before being sent to the Oracle TSAM Plus manager data server. The LMS and Oracle TSAM Plus manager use the HTTP+XML protocol.</li>
<li><a name="wp1077473"> </a>Other management information exchanges between the LMS and Oracle TSAM Plus manager.</li>
</ul></div>
<p class="pBody"><a name="wp1077653"> </a>
The LMS must be configured in the UBBCONFIG file and set with the proper options. One Tuxedo machine must be configured with one LMS. Multiple LMS on one machine is not supported. LMS is recommended to be configured at the end of UBBCONFIG so that it can retrieve all server information when Tuxedo domain booted. LMS still can synchronize the configuration to TSAM Plus manager periodically.
</p>
<h4 class="pHeading3"><a name="wp1077475"> </a>
Options
</h4>
<h4 class="pDefTerm"><a name="wp1077476"> </a>
<code class="cCode">-l </code>
</h4><div class="pDefPara"><a name="wp1077477"> </a>
Mandatory parameter. It is followed by one or two addresses of the Oracle TSAM Plus manager data servers. The host address and port number are set based on your Oracle TSAM Plus manager installation. The format is:
</div>
<div class="pDefParaCont"><a name="wp1077667"> </a>
<code class="cCode">host:port/tsam</code>
<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp1077676"> </a><code class="cCode">host</code> is the host DNS name or IP address of the box where TSAM Plus manager is installed.</li>
<li><a name="wp1077697"> </a><code class="cCode">port</code> is the TCP port number. </li>
<li><a name="wp1077698"> </a><code class="cCode">tsam</code> is the Oracle TSAM Plus manager reserved path name.</li>
</ul></div>
</div>
<div class="pDefPara"><a name="wp1078477"> </a>
If specifying two TSAM Plus manager addresses, use a comma (,) separator.
<a name="wp1078516"> </a>
In the event that two addresses are specified, TSAM Plus agent always connects the first address first, and then tries to connect the backup address if the first address is not reachable.
<a name="wp1078479"> </a>
Whenever the connection is broken, TSAM Plus agent always tries to connect first address first.
</div>
<a name="wp1078480"> </a><table class="Note">
<tr>
<td valign="top"><strong>Note:</strong></td>
<td>Configuring two TSAM Plus manager addresses has been supported since TSAM Plus 12.1.1.1.</td>
</tr>
</table>

<h4 class="pDefTerm"><a name="wp1077507"> </a>
<code class="cCode">-m</code>
</h4><div class="pDefPara"><a name="wp1077762"> </a>
Optional parameter. Specifies the size of shared memory used to store raw data metrics. The optional trailing letter k or m denotes KB or MB bytes, otherwise the unit is in bytes. The effective value is rounded up to 4K size since it is the page size for most platforms.
</div>
<div class="pDefParaCont"><a name="wp1077798"> </a>
The default value is 10MB if this option is not present. The size of the shared memory will not grow at run time when there is no free space to store new data. In this case oldest data is replaced with new data.
</div>
<h4 class="pDefTerm"><a name="wp1079346"> </a>
<code class="cCode">-r</code>
</h4><div class="pDefParaCont"><a name="wp1079402"> </a>
Specifies the maximum sleep time (in milliseconds) of reconnecting when TSAM agent keeps failing to connect TSAM manager. The default value is 60,000 milliseconds.
</div>
<h4 class="pDefTerm"><a name="wp1077510"> </a>
<code class="cCode">-t</code>
</h4><div class="pDefPara"><a name="wp1077511"> </a>
Optional parameter. It specifies the time interval in seconds that LMS should connect to the Oracle TSAM Plus manager with configuration synchronization. The default value is 100 seconds.
</div>
<h4 class="pDefTerm"><a name="wp1078545"> </a>
<code class="cCode">-n</code>
</h4><div class="pDefParaCont"><a name="wp1078546"> </a>
Optional parameter, introduced since TSAM Plus 12.1.1.1. It specifies the amount of monitoring data sent by TSAM Plus agent to TSAM Plus manager per request. Valid value range is from 1 to 100 and the default value is 16. If configuring a value that is greater than 100, 100 will be used.
</div>
<h4 class="pHeading3"><a name="wp1077520"> </a>
Example(s)
</h4>
<p class="pBody"><a name="wp1077524"> </a>
<a href="tsamref.html#wp1077526">Listing&#160;1-1</a> shows the LMS in UBBCONFIG.
</p>
<div class="pCodeTitle"><a name="wp1077526"> </a>
Listing&#160;1-1	   LMS in UBBCONFIG
</div> <a name="wp1077872"> </a><div class="pPreformatted"><pre>...<br />*SERVERS<br />LMS SRVGRP=LMSGRP SRVID=1 <br />CLOPT=&#8221;-A -- -l tsamweb.abc.com:8080/tsam -m 20M -t 180 -n 64&#8221;</pre></div><a name="wp1077873"> </a><div class="pPreformatted"><pre>...<br /></pre></div><p>&nbsp;</p>
<hr noshade="noshade"/>
<h3 class="pRefObject"><a name="wp1077449"> </a>
tpgetcallinfo
</h3>
<h4 class="pHeading3"><a name="wp1075279"> </a>
Name
</h4>
<p class="pBody"><a name="wp1075280"> </a>
t<code class="cCode">pgetcallinfo()</code>&#8212; Routine for retrieving call path message monitoring attributes.
</p>
<h4 class="pHeading3"><a name="wp1075281"> </a>
Synopsis
</h4>
<p class="pBody"><a name="wp1075282"> </a>
<code class="cCode">int tpgetcallinfo(const char *msg, FBFR32 **obuf, long flags)</code>
</p>
<h4 class="pHeading3"><a name="wp1075283"> </a>
Description
</h4>
<p class="pBody"><a name="wp1075284"> </a>
<code class="cCode">tpgetcallinfo()</code> is used for call path monitoring only.<code class="cCode"> </code>It supports the following parameters:
</p>
<h4 class="pDefTerm"><a name="wp1075805"> </a>
<code class="cCode">msg</code>
</h4><div class="pDefPara"><a name="wp1075819"> </a>
The typed buffer use for measurement.
</div>
<h4 class="pDefTerm"><a name="wp1075286"> </a>
<code class="cCode">obuf</code>
</h4><div class="pDefPara"><a name="wp1075826"> </a>
The FML32 buffer used to contain the fields.
</div>
<h4 class="pDefTerm"><a name="wp1075287"> </a>
<code class="cCode">flags</code>
</h4><div class="pDefPara"><a name="wp1075843"> </a>
Reserved for future use.
</div>
<p class="pBody"><a name="wp1075288"> </a>
For monitored calls, <code class="cCode">tpgetcallinfo()</code>uses the following fields: following fields:
</p>
<h4 class="pDefTerm"><a name="wp1075289"> </a>
<code class="cCode">tpgetcallinfo()</code>
</h4><div class="pDefPara"><a name="wp1075855"> </a>
Retrieves the message monitoring attributes when call path monitoring is enabled.
</div>
<h4 class="pDefTerm"><a name="wp1075876"> </a>
<code class="cCode">tpgetcallinfo()</code> 
</h4><div class="pDefPara"><a name="wp1075869"> </a>
Can be used in different scenarios to accomplish different functions. Typical usage is as follows:
<div class="pSmartList1NoteBullet"><ul>
<li><a name="wp1075290"> </a>Application server calls <code class="cCode">tpgetcallinfo()</code> to check the requested message monitoring attributes. It can provide the following information:</li>
<a name="wp1075291"> </a><table class="ListNote">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>- Correlation ID of the request. It is generated by the caller</td>
</tr>
</table>
<a name="wp1075292"> </a><table class="ListNote">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>- Begins time stamping when the monitoring initiator starts the call</td>
</tr>
</table>
<a name="wp1075293"> </a><table class="ListNote">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>- Last stop time stamp on the call path tree of the monitored request. Usually, it is used to measure the process requested message waiting time for a service</td>
</tr>
</table>
<a name="wp1075294"> </a><table class="ListNote">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td>- Workstation client address if the request is from a Tuxedo workstation client</td>
</tr>
</table>
<li><a name="wp1075295"> </a>The monitoring initiator calls <code class="cCode">tpgetcallinfo()</code> to get the end to the monitored call end time. </li>
<a name="wp1076387"> </a><table class="ListNote">
<tr>
<td valign="top"><b class="texthide">Note:</b></td>
<td><span style="font-weight: bold">Note: </span><code class="cCode">tpgetcallinfo()</code> can be called at any time for a reply buffer after a reply is received. This is especially useful with <code class="cCode">tpacall</code>/<code class="cCode">tpgetrply</code>.</td>
</tr>
</table>
</ul></div>
</div>
<p class="pBody"><a name="wp1075299"> </a>
<a href="tsamref.html#wp1075303">Table&#160;2</a> lists the FML monitor metrics field names.
</p>
<p class="pGraphic"><a name="wp1075397"> </a>
</p>
<div align="left">
<table class="table" cellpadding="3" cellspacing="0" id="wp1075303table1075300"><caption><a name="wp1075303"> </a>
Table&#160;2  Monitor Initiator Field Names

</caption>

  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075314"> </a>
Field Name
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075317"> </a>
Type
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075320"> </a>
Description
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075323"> </a>
Service
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075325"> </a>
Monitoring 
</div>
<div class="pCellBody"><a name="wp1075326"> </a>
Initiator
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075328"> </a>
<code class="cCode">TA_MONCORRID</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075330"> </a>
string
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075332"> </a>
The monitored call correlation ID. It is a critical call path monitoring metric.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075334"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075336"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075338"> </a>
<code class="cCode">TA_MONLASTTIMESEC</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075340"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075342"> </a>
Timestamp for the last stop on the call path tree in seconds.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075344"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075346"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075348"> </a>
<code class="cCode">TA_MONLASTTIMEUSEC</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075350"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075352"> </a>
Timestamp of last stop on the call path tree in microseconds.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075354"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075356"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075358"> </a>
<code class="cCode">TA_MONSTARTTTIMESEC</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075360"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075362"> </a>
Timestamp when the monitoring initiator starts the call in seconds.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075364"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075366"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075368"> </a>
<code class="cCode">TA_MONSTARTTIMEUSEC</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075370"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075372"> </a>
Timestamp of the monitoring initiator starts the call in microseconds.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075374"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075376"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075378"> </a>
<code class="cCode">TA_MONCLTADDR</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075380"> </a>
string
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075382"> </a>
The workstation client address
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075384"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075386"> </a>
N
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075388"> </a>
<code class="cCode">TA_MONTOTALTIME</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075390"> </a>
long
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075392"> </a>
The end-to-end time used for a monitored call in milliseconds.
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075394"> </a>
N
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1075396"> </a>
Y
</div>
</td>
</tr>
  <tr align="left" valign="top">    <td class="table" scope="row"><div class="pCellBody"><a name="wp1080026"> </a>
<code class="cCode">TA_ECID</code>
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1080028"> </a>
string
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1080030"> </a>
Execution context ID 
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1080032"> </a>
Y
</div>
</td>
    <td class="table" scope="row"><div class="pCellBody"><a name="wp1080034"> </a>
Y
</div>
</td>
</tr>
</table>
</div>
<p class="pGraphic">

</p>
<h4 class="pHeading3"><a name="wp1075398"> </a>
Return Values
</h4>
<p class="pBody"><a name="wp1075399"> </a>
Upon successfully getting a FML32 buffer containing the monitoring attributes, returns 0.
</p>
<p class="pBody"><a name="wp1075400"> </a>
Upon failure, <code class="cCode">tpgetcallinfo()</code> returns -1 and sets <code class="cCode">tperrno</code> to indicate the error condition.
</p>
<h4 class="pHeading3"><a name="wp1075401"> </a>
Errors
</h4>
<p class="pBody"><a name="wp1075402"> </a>
Upon failure, <code class="cCode">tpgetcallinfo()</code> sets <code class="cCode">tperrno</code> to one of the following values,
</p>
<h4 class="pDefTerm"><a name="wp1075403"> </a>
<code class="cCode">[TPEINVAL]</code>
</h4><div class="pDefPara"><a name="wp1075404"> </a>
Invalid arguments were given (for example, msg is NULL or obuf is not a valid FML32 buffer)
</div>
<h4 class="pDefTerm"><a name="wp1075405"> </a>
<code class="cCode">[TPESYSTEM]</code>
</h4><div class="pDefPara"><a name="wp1075406"> </a>
The message input does not contain monitoring attributes. Usually this is because the call path monitoring is not turned on for the message.
</div>
<h4 class="pDefTerm"><a name="wp1075407"> </a>
<code class="cCode">[TPEOS]</code>
</h4><div class="pDefPara"><a name="wp1075408"> </a>
An operating system error has occurred.
</div>
<h4 class="pHeading3"><a name="wp1075409"> </a>
Example(s)
</h4>
<p class="pBody"><a name="wp1077320"> </a>
<a href="tsamref.html#wp1075410">Listing&#160;1-1</a> provides a service-side <code class="cCode">tpgetcallinfo</code> example.
</p>
<div class="pCodeTitle"><a name="wp1075410"> </a>
Listing&#160;1-1	   Service-Side tpgetcallinfo Example
</div> <a name="wp1075411"> </a><div class="pPreformatted"><pre>#include &lt;stdio.h&gt;<br />#include &lt;atmi.h&gt;<br />#include &lt;userlog.h&gt;<br />#include &lt;fml32.h&gt;<br />#include &lt;tpadm.h&gt;  <br />#if defined(__STDC__) || defined(__cplusplus)<br />tpsvrinit(int argc, char *argv[])<br />#else<br />tpsvrinit(argc, argv)<br />int argc;<br />char **argv;<br />#endif<br />{<br /><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* tpsvrinit logic */<br />#ifdef __cplusplus<br />extern &quot;C&quot;<br />#endif<br />void<br />#if defined(__STDC__) || defined(__cplusplus)<br />APPSVC(TPSVCINFO *rqst)<br />#else<br />TOUPPER(rqst)<br />TPSVCINFO *rqst;<br />#endif<br />{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;FBFR32 *metainfo;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;int len = 0;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* Allocate the metainfo space */<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;metainfo = tpalloc(&quot;FML32&quot;, NULL, 1024);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (metainfo == NULL ) {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;userlog(&quot;Memory allocation failed&quot;);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tpreturn(TPFAIE, 0, 0, 0);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* Get the monitoring attributes*/<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;if ( tpgetcallinfo(rqst-&gt;data, &amp;metainfo, 0) == 0 ) <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;char *corrid;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long laststopsec, starttimesec;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if ((corrid = Ffind32(metainfo, TA_MONCORRID, 0, &amp;len) ) {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;userlog(&quot;Correlation ID = %s&quot;, corrid);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;len = sizeof(starttimesec);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (( Fget32(metainfo, TA_MONSTARTTIMESEC, &amp;starttimesec, &amp;len) == 0) {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;userlog(&quot;Message beginning time = %ld&quot;, starttimesec);</pre></div><a name="wp1075412"> </a><div class="pPreformatted"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br />}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;len = sizeof(lasttimesec);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (( Fget32(metainfo, TA_MONLASTTIMESEC, &amp;lasttimesec, &amp;len)  == 0) 		{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;userlog(&quot;Message entering my queue time = %ld&quot;, lasttimesec);</pre></div><a name="wp1077943"> </a><div class="pPreformatted"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;tpfree(metainfo);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* rest of service processment */<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;......<br />}</pre></div>
 
<br/>
    <table id="SummaryNotReq2" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
&nbsp;
<a href="tsamref.html"><img id="LongDescNotReq7" src="/global_resources/images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a accesskey="4" href="index.html"><img id="LongDescNotReq8" src="/global_resources/images/prevtop.gif" border="0" alt="Previous" /></a>&nbsp;
<a accesskey="5" href="tsamaccount.html"><img id="LongDescNotReq9" src="/global_resources/images/nexttop.gif" border="0" alt="Next" /></a>
<script language="Javascript1.1" type="text/javascript">
Copyright();
</script>
<noscript><a href="http://edocs.bea.com/copyright.html">&copy; BEA Systems</a></noscript>
        </td>
      </tr>
    </table>

<!-- WebAnalytics BEGIN -->

<!--#include virtual="/global_resources/edocs_wt.html"-->
      
<!-- WebAnalytics END -->

  </body>
</html>
